{
  "Topic": {
    "TopicId": "r-7gyj7310q6fdizmvxqvg",
    "ForumId": "15",
    "Title": "Text Processor If/If Not errors",
    "LastUpdated": "2024-08-07T16:12:51.1943581Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "ae1f515e-8511-46f9-9ccd-3c0615ad92b9",
      "UserId": 587281,
      "Username": "PsychoVyse",
      "AvatarUrl": "https://secure.gravatar.com/avatar/f359107abf9dc8cfe62bba1e4a8e84a7?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I'm trying to understand how msg() works compared to how it used to in Quest 5.8 in regards the either{} equivalent code If/If Not{} and I'm struggling to understand why it doesn't work how I want it to, I tried to look at the Git Hub Wiki but there wasn't any clear answer there as far as I could see.\r\n\r\nHere's my example:\r\n\r\ndata.js\r\n```\r\n\"use strict\"\r\n\r\ncreateItem(\"me\", PLAYER(), {\r\n  loc:\"lounge\",\r\n  synonyms:['me', 'myself'],\r\n  examine: \"Just a regular guy.\",\r\n})\r\n\r\ncreateRoom(\"lounge\", {\r\n  desc:\"The lounge is boring, the author really needs to put stuff in it.\",\r\n})\r\n\r\ncreateItem(\"Lamp\", {\r\n    alias: \"Toggle Lamp\",\r\n    examine: \"\",\r\n    loc: \"lounge\",\r\n    hereVerbs: [\"Interact\"],\r\n    bLampIsOn: false,\r\n    interact: function () {\r\n        msg(\"<a href=\\\"javascript:void(0);\\\" onclick=\\\"ToggleLamp(w.Lamp)\\\">Toggle Lamp {if:w.Lamp.bLampOn:Off:On}</a>\")\r\n    },\r\n})\r\n\r\nfunction ToggleLamp(oLamp) {\r\n\r\n    if (oLamp.bLampIsOn) {\r\n        oLamp.bLampIsOn.false\r\n    }\r\n    else {\r\n        oLamp.bLampIsOn.true\r\n    }\r\n    msg(\"The lamp is now turned {if:oLamp.bLampOn:On:Off}\")\r\n}\r\n```\r\n\r\ncode.js\r\n```\r\n\"use strict\"\r\n\r\ncommands.unshift(new Cmd('interact', {\r\n    regex: /^(?:interact) (.+)$/,\r\n    objects: [{\r\n        scope: parser.isHere\r\n    },\r\n    ],\r\n    default:\r\n        function (item) {\r\n            msg(\"You can't do that...\")\r\n            return false\r\n        },\r\n}))\r\n```\r\n\r\n\r\nI get this error for the top line:\r\n```\r\nThe text process cannot handle attributes of attributes, so failed to deal with: w.Lamp.bLampOn\r\n_text.js:336 (3)Â ['w', 'Lamp', 'bLampOn']\r\n0: \"w\"\r\n1: \"Lamp\"\r\n2: \"bLampOn\"\r\nlength: 3[[Prototype]]: Array(0)\r\nERROR: Failed to find object 'w.Lamp.bLampOn' in text processor 'if/ifNot' (<a href=\"javascript:void(0);\" onclick=\"ToggleLamp(w.Lamp)\">Toggle Lamp {if:w.Lamp.bLampOn:Off:On}</a>)\r\n```\r\n\r\nand this error for the bottom line in the ToggleLamp() function\r\n\r\n```\r\nERROR: Failed to find object 'oLamp.bLampOn' in text processor 'if/ifNot' (The lamp is now turned {if:oLamp.bLampOn:Off:On})\r\n```\r\n\r\nAlso one last thing is also using the direct implant method, I know the below is just going to print true or false but this doesn't work either.\r\n\r\n```\r\nmsg(\"The lamp is now turned {oLamp:bLampOn}\")\r\n```\r\n\r\n```\r\nERROR: Attempting to use unknown text processor directive 'oLamp' (The lamp is now turned {oLamp:bLampOn})\r\n```\r\n\r\n Can anyone help me to figure out what I'm doing wrong with  these 3 methods please and how you fix/work around them?",
      "EditableFormat": "markdown",
      "HTML": "<p>I'm trying to understand how msg() works compared to how it used to in Quest 5.8 in regards the either{} equivalent code If/If Not{} and I'm struggling to understand why it doesn't work how I want it to, I tried to look at the Git Hub Wiki but there wasn't any clear answer there as far as I could see.</p>\n<p>Here's my example:</p>\n<p>data.js</p>\n<pre><code>\"use strict\"\n\ncreateItem(\"me\", PLAYER(), {\n  loc:\"lounge\",\n  synonyms:['me', 'myself'],\n  examine: \"Just a regular guy.\",\n})\n\ncreateRoom(\"lounge\", {\n  desc:\"The lounge is boring, the author really needs to put stuff in it.\",\n})\n\ncreateItem(\"Lamp\", {\n    alias: \"Toggle Lamp\",\n    examine: \"\",\n    loc: \"lounge\",\n    hereVerbs: [\"Interact\"],\n    bLampIsOn: false,\n    interact: function () {\n        msg(\"&lt;a href=\\\"javascript:void(0);\\\" onclick=\\\"ToggleLamp(w.Lamp)\\\"&gt;Toggle Lamp {if:w.Lamp.bLampOn:Off:On}&lt;/a&gt;\")\n    },\n})\n\nfunction ToggleLamp(oLamp) {\n\n    if (oLamp.bLampIsOn) {\n        oLamp.bLampIsOn.false\n    }\n    else {\n        oLamp.bLampIsOn.true\n    }\n    msg(\"The lamp is now turned {if:oLamp.bLampOn:On:Off}\")\n}\n</code></pre>\n<p>code.js</p>\n<pre><code>\"use strict\"\n\ncommands.unshift(new Cmd('interact', {\n    regex: /^(?:interact) (.+)$/,\n    objects: [{\n        scope: parser.isHere\n    },\n    ],\n    default:\n        function (item) {\n            msg(\"You can't do that...\")\n            return false\n        },\n}))\n</code></pre>\n<p>I get this error for the top line:</p>\n<pre><code>The text process cannot handle attributes of attributes, so failed to deal with: w.Lamp.bLampOn\n_text.js:336 (3)&nbsp;['w', 'Lamp', 'bLampOn']\n0: \"w\"\n1: \"Lamp\"\n2: \"bLampOn\"\nlength: 3[[Prototype]]: Array(0)\nERROR: Failed to find object 'w.Lamp.bLampOn' in text processor 'if/ifNot' (&lt;a href=\"javascript:void(0);\" onclick=\"ToggleLamp(w.Lamp)\"&gt;Toggle Lamp {if:w.Lamp.bLampOn:Off:On}&lt;/a&gt;)\n</code></pre>\n<p>and this error for the bottom line in the ToggleLamp() function</p>\n<pre><code>ERROR: Failed to find object 'oLamp.bLampOn' in text processor 'if/ifNot' (The lamp is now turned {if:oLamp.bLampOn:Off:On})\n</code></pre>\n<p>Also one last thing is also using the direct implant method, I know the below is just going to print true or false but this doesn't work either.</p>\n<pre><code>msg(\"The lamp is now turned {oLamp:bLampOn}\")\n</code></pre>\n<pre><code>ERROR: Attempting to use unknown text processor directive 'oLamp' (The lamp is now turned {oLamp:bLampOn})\n</code></pre>\n<p>Can anyone help me to figure out what I'm doing wrong with  these 3 methods please and how you fix/work around them?</p>\n\n",
      "PostDate": "2024-08-07T16:12:51.1943581Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "59bae64f-0756-475e-8e4c-f12ec2756c68",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I'm not familiar with this engine, but the first thing that jumps out at me is the line:\r\n* `oLamp.bLampIsOn.false`\r\n\r\nIf I understand JS handling of undefined values correctly, that would cause `oLamp.bLampIsOn` to become an object (if it doesn't already have a value), and then fetch the value of that object's `false` property. But then you never do anything with that value.\r\n\r\nIs it possible you meant:\r\n* <code style=\"color: green\">oLamp.bLampIsOn <b>=</b> false</code>",
      "EditableFormat": "markdown",
      "HTML": "<p>I'm not familiar with this engine, but the first thing that jumps out at me is the line:</p>\n<ul>\n<li><code>oLamp.bLampIsOn.false</code></li>\n</ul>\n<p>If I understand JS handling of undefined values correctly, that would cause <code>oLamp.bLampIsOn</code> to become an object (if it doesn't already have a value), and then fetch the value of that object's <code>false</code> property. But then you never do anything with that value.</p>\n<p>Is it possible you meant:</p>\n<ul>\n<li><code style=\"color: green\">oLamp.bLampIsOn <b>=</b> false</code></li>\n</ul>\n\n",
      "PostDate": "2024-08-07T18:07:31.8138826Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "ef2da2f9-ea2f-4582-b2c2-0159937d969f",
      "UserId": 587281,
      "Username": "PsychoVyse",
      "AvatarUrl": "https://secure.gravatar.com/avatar/f359107abf9dc8cfe62bba1e4a8e84a7?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Ah I meant to refer to bLampIsOn for all uses of the Lamp attribute. The engine is QuestJS v1.4 btw.",
      "EditableFormat": "markdown",
      "HTML": "<p>Ah I meant to refer to bLampIsOn for all uses of the Lamp attribute. The engine is QuestJS v1.4 btw.</p>\n\n",
      "PostDate": "2024-08-07T18:14:40.3723028Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "5edfdc1b-f9fe-4c02-97d6-ca46130e05c3",
      "UserId": 587281,
      "Username": "PsychoVyse",
      "AvatarUrl": "https://secure.gravatar.com/avatar/f359107abf9dc8cfe62bba1e4a8e84a7?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Okay I replaced everything and still get errors with the 2nd part:\r\n\r\n```\r\nfunction ToggleLamp(oLamp) {\r\n\r\n    if (oLamp.bLampIsOn) {\r\n        oLamp.bLampIsOn = false\r\n    }\r\n    else {\r\n        oLamp.bLampIsOn = true\r\n    }\r\n    msg(\"The lamp is now turned {if:oLamp.bLampIsOn:On:Off}\")\r\n}\r\n\r\nERROR: Failed to find object 'oLamp.bLampIsOn' in text processor 'if/ifNot' (The lamp is now turned (if:oLamp.bLampIsOn:On:Off})\r\n```\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Okay I replaced everything and still get errors with the 2nd part:</p>\n<pre><code>function ToggleLamp(oLamp) {\n\n    if (oLamp.bLampIsOn) {\n        oLamp.bLampIsOn = false\n    }\n    else {\n        oLamp.bLampIsOn = true\n    }\n    msg(\"The lamp is now turned {if:oLamp.bLampIsOn:On:Off}\")\n}\n\nERROR: Failed to find object 'oLamp.bLampIsOn' in text processor 'if/ifNot' (The lamp is now turned (if:oLamp.bLampIsOn:On:Off})\n</code></pre>\n\n",
      "PostDate": "2024-08-07T22:10:44.251318Z",
      "LastEditDate": "2024-08-07T22:15:01.3658921Z",
      "link": null
    },
    {
      "PostId": "5e3d7cb9-2925-4596-996e-f96d16f3e5a0",
      "UserId": 518866,
      "Username": "K.V.",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a97688aadc8152436180b511021e94a7?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "**EDITED THE CODE. The first code I posted was overcomplicated.**\r\n\r\ndata.js\r\n\r\n```\r\n\"use strict\"\r\n\r\ncreateItem(\"me\", PLAYER(), {\r\n  loc:\"lounge\",\r\n  synonyms:['me', 'myself'],\r\n  examine: \"Just a regular guy.\",\r\n})\r\n\r\ncreateRoom(\"lounge\", {\r\n  desc:\"The lounge is boring, the author really needs to put stuff in it.\",\r\n})\r\n\r\ncreateItem(\"Lamp\", {\r\n    alias: \"Toggle Lamp\",\r\n    examine: \"\",\r\n    loc: \"lounge\",\r\n    hereVerbs: [\"Interact\"],\r\n    bLampIsOn: false,\r\n    interact: function () {\r\n      msg(\"<a href=\\\"javascript:void(0);\\\" onclick=\\\"ToggleLamp(w.Lamp)\\\" id=\\\"lamptoggler\\\">Toggle Lamp {if:Lamp:bLampIsOn:true:Off:On}</a>\")\r\n    },\r\n})\r\n\r\nfunction ToggleLamp(oLamp) {\r\n  var onOff; // Added this\r\n  if (oLamp.bLampIsOn) {\r\n        //oLamp.bLampIsOn.false // <- this was causing an error\r\n        oLamp.bLampIsOn = false;\r\n        onOff = \"On\"; //Added this\r\n    }\r\n    else {\r\n        //oLamp.bLampIsOn.true // <- this was causing an error\r\n        oLamp.bLampIsOn = true;\r\n        onOff = \"Off\";\r\n    }\r\n    msg(\"The lamp is now turned \" + onOff + \".\"); // <- altered this\r\n\r\n    /*\r\n      Deactivate the link from the game text,because it will not change On to Off\r\n       in that on-screen text when the lamp is toggled.\r\n    */\r\n    var s = document.getElementById('lamptoggler').textContent;\r\n       document.getElementById('lamptoggler').parentElement.textContent = s;\r\n}\r\n\r\n```\r\n\r\n---\r\nHere's where I found half of that:\r\n\r\nhttps://github.com/ThePix/QuestJS/wiki/Controlling-text-with-the-text-processor#if-and-ifnot\r\n\r\nhttps://github.com/ThePix/QuestJS/wiki/Controlling-text-with-the-text-processor#ifis-and-ifnotis",
      "EditableFormat": "markdown",
      "HTML": "<p><strong>EDITED THE CODE. The first code I posted was overcomplicated.</strong></p>\n<p>data.js</p>\n<pre><code>\"use strict\"\n\ncreateItem(\"me\", PLAYER(), {\n  loc:\"lounge\",\n  synonyms:['me', 'myself'],\n  examine: \"Just a regular guy.\",\n})\n\ncreateRoom(\"lounge\", {\n  desc:\"The lounge is boring, the author really needs to put stuff in it.\",\n})\n\ncreateItem(\"Lamp\", {\n    alias: \"Toggle Lamp\",\n    examine: \"\",\n    loc: \"lounge\",\n    hereVerbs: [\"Interact\"],\n    bLampIsOn: false,\n    interact: function () {\n      msg(\"&lt;a href=\\\"javascript:void(0);\\\" onclick=\\\"ToggleLamp(w.Lamp)\\\" id=\\\"lamptoggler\\\"&gt;Toggle Lamp {if:Lamp:bLampIsOn:true:Off:On}&lt;/a&gt;\")\n    },\n})\n\nfunction ToggleLamp(oLamp) {\n  var onOff; // Added this\n  if (oLamp.bLampIsOn) {\n        //oLamp.bLampIsOn.false // &lt;- this was causing an error\n        oLamp.bLampIsOn = false;\n        onOff = \"On\"; //Added this\n    }\n    else {\n        //oLamp.bLampIsOn.true // &lt;- this was causing an error\n        oLamp.bLampIsOn = true;\n        onOff = \"Off\";\n    }\n    msg(\"The lamp is now turned \" + onOff + \".\"); // &lt;- altered this\n\n    /*\n      Deactivate the link from the game text,because it will not change On to Off\n       in that on-screen text when the lamp is toggled.\n    */\n    var s = document.getElementById('lamptoggler').textContent;\n       document.getElementById('lamptoggler').parentElement.textContent = s;\n}\n\n</code></pre>\n<hr>\n<p>Here's where I found half of that:</p>\n<p>https://github.com/ThePix/QuestJS/wiki/Controlling-text-with-the-text-processor#if-and-ifnot</p>\n<p>https://github.com/ThePix/QuestJS/wiki/Controlling-text-with-the-text-processor#ifis-and-ifnotis</p>\n\n",
      "PostDate": "2024-08-08T14:52:21.7823328Z",
      "LastEditDate": "2024-08-08T18:13:24.1535121Z",
      "link": null
    },
    {
      "PostId": "d32806cb-4589-43d2-a1bf-1d92cebade14",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "If you like concise code, you could reduce that a little:\r\n\r\n```\r\nfunction ToggleLamp(oLamp) {\r\n    msg(\"The lamp is now turned \" + ((oLamp.bLampIsOn = !oLamp.bLampIsOn) ? \"On\" : \"Off\") + \".\");\r\n\r\n    /*\r\n      Deactivate the link from the game text,because it will not change On to Off\r\n       in that on-screen text when the lamp is toggled.\r\n    */\r\n    var s = document.getElementById('lamptoggler').textContent;\r\n       document.getElementById('lamptoggler').parentElement.textContent = s;\r\n}\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p>If you like concise code, you could reduce that a little:</p>\n<pre><code>function ToggleLamp(oLamp) {\n    msg(\"The lamp is now turned \" + ((oLamp.bLampIsOn = !oLamp.bLampIsOn) ? \"On\" : \"Off\") + \".\");\n\n    /*\n      Deactivate the link from the game text,because it will not change On to Off\n       in that on-screen text when the lamp is toggled.\n    */\n    var s = document.getElementById('lamptoggler').textContent;\n       document.getElementById('lamptoggler').parentElement.textContent = s;\n}\n</code></pre>\n\n",
      "PostDate": "2024-08-09T15:08:18.7563624Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "32801348-b3e5-4bef-874a-79c041289378",
      "UserId": 518866,
      "Username": "K.V.",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a97688aadc8152436180b511021e94a7?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Yippee! I love to learn more concise ways to code.\r\n\r\nWhat about the bit when I disable the link?\r\n\r\nI bet you know a more eloquent way to do that, mrangel. (In fact, I think you've shown me before, but I can't find the old post.)",
      "EditableFormat": "markdown",
      "HTML": "<p>Yippee! I love to learn more concise ways to code.</p>\n<p>What about the bit when I disable the link?</p>\n<p>I bet you know a more eloquent way to do that, mrangel. (In fact, I think you've shown me before, but I can't find the old post.)</p>\n\n",
      "PostDate": "2024-08-10T00:38:49.8905569Z",
      "LastEditDate": "2024-08-24T22:10:32.1336616Z",
      "link": null
    },
    {
      "PostId": "76b27e84-3385-41dd-bbd3-01cfb220faba",
      "UserId": 587281,
      "Username": "PsychoVyse",
      "AvatarUrl": "https://secure.gravatar.com/avatar/f359107abf9dc8cfe62bba1e4a8e84a7?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Hey great stuff guys, thank you so much :) \r\nI still have a lot to learn about JS in general and how QuestJS uses it too.",
      "EditableFormat": "markdown",
      "HTML": "<p>Hey great stuff guys, thank you so much :)<br>\nI still have a lot to learn about JS in general and how QuestJS uses it too.</p>\n\n",
      "PostDate": "2024-08-11T18:42:04.7258043Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

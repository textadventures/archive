{
  "Topic": {
    "TopicId": "ro6ckh2gke2lostim5gz4w",
    "ForumId": "10",
    "Title": "Fictional Calendar System",
    "LastUpdated": "2023-09-08T05:34:42.7859565Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "7302be64-35c2-4386-bf7c-931e476ef6b0",
      "UserId": 553269,
      "Username": "TestTinynanami",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a66f5799a35388fc0406d30dcc969dfa?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I'm making a project that includes the passing of days, months and years with some events happening in certain days. However, these do not follow our 365 days-year with 12 months. It would be a much simplified system (probably something like Stardew Valley that has 4 months with 28 days each).\r\n\r\nIn my game, you would start a day in the morning. You would be able to do one or two main action (such as go on a date with X character) before it becomes dark. The only difference would be that you can't do anything when its dark other than sleep (which would progress to the next day).\r\n\r\nBecause I imagine players would play more than a few years, I'm unsure how to approach this the date system.\r\n\r\n---\r\nI do think I know how to implement the day-night part. It would probably be an attribute like \"day.activity = 2\" and doing a specific action would do day,activity = day.activity -1.\r\nA different script would set that if day.activity = 0 then its nightime. Then during the sleep action, I could set day.activity = 2 again.\r\n\r\nI think I would probably need to check pixies library on weather to show how the places react to being night/day.\r\n\r\nBut how would I make it to tracking the days/month/year + sleeping advacing the day?",
      "EditableFormat": "markdown",
      "HTML": "<p>I'm making a project that includes the passing of days, months and years with some events happening in certain days. However, these do not follow our 365 days-year with 12 months. It would be a much simplified system (probably something like Stardew Valley that has 4 months with 28 days each).</p>\n<p>In my game, you would start a day in the morning. You would be able to do one or two main action (such as go on a date with X character) before it becomes dark. The only difference would be that you can't do anything when its dark other than sleep (which would progress to the next day).</p>\n<p>Because I imagine players would play more than a few years, I'm unsure how to approach this the date system.</p>\n<hr>\n<p>I do think I know how to implement the day-night part. It would probably be an attribute like \"day.activity = 2\" and doing a specific action would do day,activity = day.activity -1.<br>\nA different script would set that if day.activity = 0 then its nightime. Then during the sleep action, I could set day.activity = 2 again.</p>\n<p>I think I would probably need to check pixies library on weather to show how the places react to being night/day.</p>\n<p>But how would I make it to tracking the days/month/year + sleeping advacing the day?</p>\n\n",
      "PostDate": "2023-09-08T05:34:42.7859565Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "b9663db7-8a0a-408b-b767-9c7dc955bb4d",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> But how would I make it to tracking the days/month/year + sleeping advacing the day?\r\n\r\nFor things like this, I would always recommend an epoch date. Basically, a variable holding the number of days since a fixed start point (usually the start of the year). You could put this number in an integer attribute, and then just put something like `game.date = game.date + 1` in your \"sleep\" script.\r\n\r\nIf you use `game.date`, you could create a script attribute `game.changeddate` and it will run automatically whenever the date changes; which makes it so much easier to handle other stuff.\r\nIf you have the same number of days in every week, you could make it something like:\r\n```\r\nstartyear = 1997\r\ndays_per_month = 29\r\nmonths = Split(\"January;March;Tricember;Grune;Spoon\")\r\nweekdays = Split (\"Mon;Tue;Wed;Fri;Sat\")\r\n\r\nthis.year = startyear + (this.date % (days_per_month * ListCount (months)))\r\nthis.month_number = (this.date / days_per_month) % ListCount (months)\r\nthis.month = ListItem (months, this.month_number)\r\nthis.day_of_month = this.date & days_per_month + 1\r\nswitch (this.day_of_month) {\r\n  case (1,21) {\r\n    this.day_ordinal = this.day_of_month + \"st\"\r\n  }\r\n  case (2,22) {\r\n    this.day_ordinal = this.day_of_month + \"nd\"\r\n  }\r\n  case (3,23) {\r\n    this.day_ordinal = this.day_of_month + \"rd\"\r\n  }\r\n  default {\r\n    this.day_ordinal = this.day_of_month + \"th\"\r\n  }\r\n}\r\nthis.weekday_number = this.date % ListCount (weekdays)\r\nthis.weekday = ListItem (weekdays, this.weekday_number)\r\nthis.fulldate = game.weekday + \"day, \" + game.month + \" \" + game.date_ordinal + \", \" + game.year\r\n```\r\nThis gives you a whole bunch of variables you can use to display different parts of the date. For example, you could include `{game.fulldate}` in some text you're printing and it could show \"Friday, June 18th, 2004\"\r\n\r\nIf you have different numbers of days in each month, it gets a little more complex; but it shouldn't be too hard.",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>But how would I make it to tracking the days/month/year + sleeping advacing the day?</p>\n</blockquote>\n<p>For things like this, I would always recommend an epoch date. Basically, a variable holding the number of days since a fixed start point (usually the start of the year). You could put this number in an integer attribute, and then just put something like <code>game.date = game.date + 1</code> in your \"sleep\" script.</p>\n<p>If you use <code>game.date</code>, you could create a script attribute <code>game.changeddate</code> and it will run automatically whenever the date changes; which makes it so much easier to handle other stuff.<br>\nIf you have the same number of days in every week, you could make it something like:</p>\n<pre><code>startyear = 1997\ndays_per_month = 29\nmonths = Split(\"January;March;Tricember;Grune;Spoon\")\nweekdays = Split (\"Mon;Tue;Wed;Fri;Sat\")\n\nthis.year = startyear + (this.date % (days_per_month * ListCount (months)))\nthis.month_number = (this.date / days_per_month) % ListCount (months)\nthis.month = ListItem (months, this.month_number)\nthis.day_of_month = this.date &amp; days_per_month + 1\nswitch (this.day_of_month) {\n  case (1,21) {\n    this.day_ordinal = this.day_of_month + \"st\"\n  }\n  case (2,22) {\n    this.day_ordinal = this.day_of_month + \"nd\"\n  }\n  case (3,23) {\n    this.day_ordinal = this.day_of_month + \"rd\"\n  }\n  default {\n    this.day_ordinal = this.day_of_month + \"th\"\n  }\n}\nthis.weekday_number = this.date % ListCount (weekdays)\nthis.weekday = ListItem (weekdays, this.weekday_number)\nthis.fulldate = game.weekday + \"day, \" + game.month + \" \" + game.date_ordinal + \", \" + game.year\n</code></pre>\n<p>This gives you a whole bunch of variables you can use to display different parts of the date. For example, you could include <code>{game.fulldate}</code> in some text you're printing and it could show \"Friday, June 18th, 2004\"</p>\n<p>If you have different numbers of days in each month, it gets a little more complex; but it shouldn't be too hard.</p>\n\n",
      "PostDate": "2023-09-08T09:33:37.9984061Z",
      "LastEditDate": "2023-09-09T11:15:46.1555335Z",
      "link": null
    },
    {
      "PostId": "293e1858-fd37-4ebc-ae01-85e7bb17b8c2",
      "UserId": 553269,
      "Username": "TestTinynanami",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a66f5799a35388fc0406d30dcc969dfa?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "First of all, thanks for the quick reply.\r\n\r\nNow walk with me because I'm more writer than coder.\r\n1- I assume I can just paste this at like, the beginning of the code?\r\n\r\n2- If I change the name of the  days or add extra week days (example from Friday to Fireday; or adding any other day) would this break anything?\r\n\r\n3- How would I check things for events? For example:\r\nI know how to check if it is the 28th of Spoon. Would I check this in the script of changing dates to activate events?",
      "EditableFormat": "markdown",
      "HTML": "<p>First of all, thanks for the quick reply.</p>\n<p>Now walk with me because I'm more writer than coder.<br>\n1- I assume I can just paste this at like, the beginning of the code?</p>\n<p>2- If I change the name of the  days or add extra week days (example from Friday to Fireday; or adding any other day) would this break anything?</p>\n<p>3- How would I check things for events? For example:<br>\nI know how to check if it is the 28th of Spoon. Would I check this in the script of changing dates to activate events?</p>\n\n",
      "PostDate": "2023-09-08T18:31:24.6251037Z",
      "LastEditDate": "2023-09-08T18:34:57.5396406Z",
      "link": null
    },
    {
      "PostId": "2cfde89f-5618-4e34-8600-267f0283aeec",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> 1- I assume I can just paste this at like, the beginning of the code?\r\n\r\nYou would need to create an attribute named `changeddate` on the same object that has the integer `date` attribute. (Or if you call it something different, just add \"changed\" to the beginning of the attribute name)\r\n\r\n> 2- If I change the name of the days or add extra week days (example from Friday to Fireday; or adding any other day) would this break anything?\r\n\r\nIt should work. I put all the stuff you'd be likely to change at the beginning of the script, to make it easier.\r\n\r\n> 3- How would I check things for events?\r\n\r\nIf you want to check the date, you can examine any of the variables in your code. For example, if you have an NPC who reacts differently on his birthday, you could write something like:\r\n```\r\nif (game.month_number = 4 and game.day_of_month = 28) {\r\n  msg (\"The old man grins and offers you a slice of birthday cake.\")\r\n}\r\nelse {\r\n  msg (\"The old man glares at you sullenly.\")\r\n}\r\n```\r\n\r\nYou could include checks like that anywhere.\r\nIf you want specific events to happen when the player wakes up on a certain day, you could check for that date at the end of the `changeddate` script; or you could do it as part of your sleep script after changing the date. If you have a lot of these, I'd recommend putting them together in a switch statement:\r\n```\r\nswitch (game.year + \"-\" + game.month + \"-\" + game.day_of_month) {\r\n  case (\"1998-January-7\") {\r\n    // do something that should happen on that day\r\n  }\r\n  case (\"1999-March-21\") {\r\n    // do something that should happen on that day\r\n  }\r\n}\r\n```\r\n\r\nAlternatively, if there's really a lot of them, you could use an object. For example, you could add this to the end of the changeddate script:\r\n```\r\nshortdate = \"event_\" + this.year + \"_\" + this.month + \"_\" + this.day_of_month\r\nif (HasScript (this, shortdate)) {\r\n  do (this, shortdate)\r\n}\r\n```\r\n\r\nThen, you can give the object script attributes named something like `event_2004_January_3`, and those events will automatically be run on the right day. This might be faster, if there's a lot of them.\r\n\r\nAlternatively, thinking about it even more, it wouldn't be too hard to make something like a cron system, so that you can make an event trigger every friday the 13th, or every 5th day in January, or something like that. But I suspect that would be overkill, unless there's something you would like a system like that for.",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>1- I assume I can just paste this at like, the beginning of the code?</p>\n</blockquote>\n<p>You would need to create an attribute named <code>changeddate</code> on the same object that has the integer <code>date</code> attribute. (Or if you call it something different, just add \"changed\" to the beginning of the attribute name)</p>\n<blockquote>\n<p>2- If I change the name of the days or add extra week days (example from Friday to Fireday; or adding any other day) would this break anything?</p>\n</blockquote>\n<p>It should work. I put all the stuff you'd be likely to change at the beginning of the script, to make it easier.</p>\n<blockquote>\n<p>3- How would I check things for events?</p>\n</blockquote>\n<p>If you want to check the date, you can examine any of the variables in your code. For example, if you have an NPC who reacts differently on his birthday, you could write something like:</p>\n<pre><code>if (game.month_number = 4 and game.day_of_month = 28) {\n  msg (\"The old man grins and offers you a slice of birthday cake.\")\n}\nelse {\n  msg (\"The old man glares at you sullenly.\")\n}\n</code></pre>\n<p>You could include checks like that anywhere.<br>\nIf you want specific events to happen when the player wakes up on a certain day, you could check for that date at the end of the <code>changeddate</code> script; or you could do it as part of your sleep script after changing the date. If you have a lot of these, I'd recommend putting them together in a switch statement:</p>\n<pre><code>switch (game.year + \"-\" + game.month + \"-\" + game.day_of_month) {\n  case (\"1998-January-7\") {\n    // do something that should happen on that day\n  }\n  case (\"1999-March-21\") {\n    // do something that should happen on that day\n  }\n}\n</code></pre>\n<p>Alternatively, if there's really a lot of them, you could use an object. For example, you could add this to the end of the changeddate script:</p>\n<pre><code>shortdate = \"event_\" + this.year + \"_\" + this.month + \"_\" + this.day_of_month\nif (HasScript (this, shortdate)) {\n  do (this, shortdate)\n}\n</code></pre>\n<p>Then, you can give the object script attributes named something like <code>event_2004_January_3</code>, and those events will automatically be run on the right day. This might be faster, if there's a lot of them.</p>\n<p>Alternatively, thinking about it even more, it wouldn't be too hard to make something like a cron system, so that you can make an event trigger every friday the 13th, or every 5th day in January, or something like that. But I suspect that would be overkill, unless there's something you would like a system like that for.</p>\n\n",
      "PostDate": "2023-09-08T19:09:01.1996017Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "831da0c6-d028-4dcd-ab7c-4f5873306ea8",
      "UserId": 553269,
      "Username": "TestTinynanami",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a66f5799a35388fc0406d30dcc969dfa?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Looks like something went awry. I tried to do.\r\n\r\n\" switch (result) {\r\n    case (\"Yes.\") {\r\n      msg (\"You sleep\")\r\n      wait {\r\n        do (game, \"changeddate\")\r\n        msg (\"It is\" + game.date + \".\")\r\n      }\r\n    }\r\n\"\r\nBut the game crashed.\r\n\r\nFor reference, game.date is 1\r\nand\r\ngame.changeddate is a script that says:  game.date = game.date + 1",
      "EditableFormat": "markdown",
      "HTML": "<p>Looks like something went awry. I tried to do.</p>\n<p>\" switch (result) {<br>\ncase (\"Yes.\") {<br>\nmsg (\"You sleep\")<br>\nwait {<br>\ndo (game, \"changeddate\")<br>\nmsg (\"It is\" + game.date + \".\")<br>\n}<br>\n}<br>\n\"<br>\nBut the game crashed.</p>\n<p>For reference, game.date is 1<br>\nand<br>\ngame.changeddate is a script that says:  game.date = game.date + 1</p>\n\n",
      "PostDate": "2023-09-09T00:16:56.4205549Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "e71fdac6-4ebc-4cd3-8255-781a9d56763b",
      "UserId": 553269,
      "Username": "TestTinynanami",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a66f5799a35388fc0406d30dcc969dfa?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Nevermind. Seems to be working now that I changed the names and the object (it's in a random room named days instead of under game)",
      "EditableFormat": "markdown",
      "HTML": "<p>Nevermind. Seems to be working now that I changed the names and the object (it's in a random room named days instead of under game)</p>\n\n",
      "PostDate": "2023-09-09T01:37:13.4048718Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "42f2456f-46a7-456f-8a73-5db1c3b753ed",
      "UserId": 553269,
      "Username": "TestTinynanami",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a66f5799a35388fc0406d30dcc969dfa?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Oof. Triple post in a row. Anyway, I tried pasting the initial code you posted on my start script. When running the game, it said \r\nError running script: Error compiling expression 'startyear + (this.date % (days_per_month * ListCount (months)))': ArithmeticElement: Operation 'Mod' is not defined for types 'Object' and 'Int32'",
      "EditableFormat": "markdown",
      "HTML": "<p>Oof. Triple post in a row. Anyway, I tried pasting the initial code you posted on my start script. When running the game, it said<br>\nError running script: Error compiling expression 'startyear + (this.date % (days_per_month * ListCount (months)))': ArithmeticElement: Operation 'Mod' is not defined for types 'Object' and 'Int32'</p>\n\n",
      "PostDate": "2023-09-09T02:43:29.6074559Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "5d2156c6-cea4-452f-8611-539d3a3ad6cf",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> I tried pasting the initial code you posted on my start script.\r\n\r\nNo. The script I posted is the `changeddate` script.\r\n\r\n`changeddate` is called automatically whenever the `date` attribute changes, so there is no need to use `do`.\r\n\r\nYour sleep script would look like:\r\n```\r\nAsk (\"Ready to sleep?\") {\r\n  if (result) {\r\n    msg (\"You sleep\")\r\n    wait {\r\n      game.date = game.date + 1\r\n      msg (\"It is\" + game.fulldate + \".\")\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n> `Error running script: Error compiling expression 'startyear + (this.date % (days_per_month * ListCount (months)))': ArithmeticElement: Operation 'Mod' is not defined for types 'Object' and 'Int32'`\r\n\r\nThis is caused by the numeric date attribute either not being named `date`, or not being on the same object as the `changeddate` script I gave you.",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>I tried pasting the initial code you posted on my start script.</p>\n</blockquote>\n<p>No. The script I posted is the <code>changeddate</code> script.</p>\n<p><code>changeddate</code> is called automatically whenever the <code>date</code> attribute changes, so there is no need to use <code>do</code>.</p>\n<p>Your sleep script would look like:</p>\n<pre><code>Ask (\"Ready to sleep?\") {\n  if (result) {\n    msg (\"You sleep\")\n    wait {\n      game.date = game.date + 1\n      msg (\"It is\" + game.fulldate + \".\")\n    }\n  }\n}\n</code></pre>\n<blockquote>\n<p><code>Error running script: Error compiling expression 'startyear + (this.date % (days_per_month * ListCount (months)))': ArithmeticElement: Operation 'Mod' is not defined for types 'Object' and 'Int32'</code></p>\n</blockquote>\n<p>This is caused by the numeric date attribute either not being named <code>date</code>, or not being on the same object as the <code>changeddate</code> script I gave you.</p>\n\n",
      "PostDate": "2023-09-09T11:13:47.401906Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "9243c926-06eb-4936-923a-1f32829318c7",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "(Also, I edited the previous code to fix a small error… The year no longer starts on January 0th. I'm typing this on my phone, so errors are always possible)",
      "EditableFormat": "markdown",
      "HTML": "<p>(Also, I edited the previous code to fix a small error… The year no longer starts on January 0th. I'm typing this on my phone, so errors are always possible)</p>\n\n",
      "PostDate": "2023-09-09T11:19:41.0439028Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "5d8f69f5-a48a-44f5-b866-d522f04bcc6b",
      "UserId": 587281,
      "Username": "PsychoVyse",
      "AvatarUrl": "https://secure.gravatar.com/avatar/f359107abf9dc8cfe62bba1e4a8e84a7?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Could you perhaps utilize the \"game\" object's Turn Script to increment a global time/date/year variable based on the actions of the player taking 5 minutes in-game time for every action such as moving from room to room, performing any action in said room that causes a \"turn\" to increment?\r\n\r\nI was thinking of this sort of system for a game where you have a time limit to complete it, a path of most efficiency to beat it with varying difficult settings to give extra overall time until gameover if they didn't finish before a specific number of actions (in-game time) taken.",
      "EditableFormat": "markdown",
      "HTML": "<p>Could you perhaps utilize the \"game\" object's Turn Script to increment a global time/date/year variable based on the actions of the player taking 5 minutes in-game time for every action such as moving from room to room, performing any action in said room that causes a \"turn\" to increment?</p>\n<p>I was thinking of this sort of system for a game where you have a time limit to complete it, a path of most efficiency to beat it with varying difficult settings to give extra overall time until gameover if they didn't finish before a specific number of actions (in-game time) taken.</p>\n\n",
      "PostDate": "2023-09-10T18:49:28.9335934Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "ae591e80-afbe-4f7b-80d2-13002650305b",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> Could you perhaps utilize the \"game\" object's Turn Script to increment a global time/date/year variable based on the actions of the player taking 5 minutes in-game time for every action such as moving from room to room, performing any action in said room that causes a \"turn\" to increment?\r\n\r\nYes, you could.\r\n\r\nIf you wanted to adapt this script to work with something like that, you would have the numeric datetime be the number of minutes from the start date, and have a turnscript to increment it.\r\n\r\n\r\nTo do something like that, your change script (`game.changeddatetime`) would look more like:\r\n```\r\nthis.time_minutes = this.datetime % 60\r\nthis.time_hours = (this.datetime / 60 - 1) % 12 + 1\r\nthis.pm = (this.datetime / 60 / 12) % 2 = 1\r\nif (this.pm) {\r\n  this.string_time = this.hours + \":\" + this.minutes + \" PM\"\r\n}\r\nelse {\r\n  this.string_time = this.hours + \":\" + this.minutes + \" AM\"\r\n}\r\nthis.date = this.datetime / 60 / 24\r\n```\r\nand then you could carry on with the rest of the code to calculate the date based on the time (or even have a separate `changeddate` script)",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>Could you perhaps utilize the \"game\" object's Turn Script to increment a global time/date/year variable based on the actions of the player taking 5 minutes in-game time for every action such as moving from room to room, performing any action in said room that causes a \"turn\" to increment?</p>\n</blockquote>\n<p>Yes, you could.</p>\n<p>If you wanted to adapt this script to work with something like that, you would have the numeric datetime be the number of minutes from the start date, and have a turnscript to increment it.</p>\n<p>To do something like that, your change script (<code>game.changeddatetime</code>) would look more like:</p>\n<pre><code>this.time_minutes = this.datetime % 60\nthis.time_hours = (this.datetime / 60 - 1) % 12 + 1\nthis.pm = (this.datetime / 60 / 12) % 2 = 1\nif (this.pm) {\n  this.string_time = this.hours + \":\" + this.minutes + \" PM\"\n}\nelse {\n  this.string_time = this.hours + \":\" + this.minutes + \" AM\"\n}\nthis.date = this.datetime / 60 / 24\n</code></pre>\n<p>and then you could carry on with the rest of the code to calculate the date based on the time (or even have a separate <code>changeddate</code> script)</p>\n\n",
      "PostDate": "2023-09-10T21:21:02.4256257Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

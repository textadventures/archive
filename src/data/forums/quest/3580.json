{
  "Topic": {
    "TopicId": "3580",
    "ForumId": "10",
    "Title": "Function Parameter Not Recognized",
    "LastUpdated": "2013-03-30T21:06:55+00:00",
    "ReplyCount": 11
  },
  "Posts": [
    {
      "PostId": "23742",
      "UserId": 0,
      "Username": "TriangleGames",
      "UserAvatar": null,
      "UserGravatar": "134d9e995777da65c5cf8efda551d579",
      "EditableText": "In my &quot;Experiments540&quot; game, where I try out new stuff I'm working with, I'm having trouble with a function, and I don't understand why.\nI have a function (combat) with one parameter (enemy). When the player says, &quot;attack crazy guy,&quot; it calls the function with [u:g261gh45]crazy guy[/u:g261gh45] as the parameter.\nInside the function is a menu handled by a switch.\nIn the first case (&quot;attack&quot;) it begins with printing a message (&quot;You attack the &quot; + enemy.alias + &quot;...&quot;)\n\nWhen I try to run it, I get this error:\nError running script&#058; Error compiling expression '&quot;You attack the &quot; + enemy.alias + &quot;...&quot;': Unknown object or variable 'enemy'\n\nShouldn't it recognize the parameter variable anywhere inside the function?\n\nThis is the script for the attack verb:\n[code:g261gh45]&lt;attack type=&quot;script&quot;&gt;\n        combat (crazy guy)\n      &lt;/attack&gt;[/code:g261gh45]\nThis is the code for the combat function:\n[code:g261gh45]&lt;function name=&quot;combat&quot; parameters=&quot;enemy&quot;&gt;\n    choices = NewStringList()\n    list add (choices, &quot;Attack&quot;)\n    list add (choices, &quot;Run&quot;)\n    ShowMenu (&quot;What will you do?&quot;, choices, false) {\n      switch (result) {\n        case (&quot;Attack&quot;) {\n          msg (&quot;You attack the &quot; + enemy&#46;alias + &quot;&#46;&#46;&#46;&quot;)\n          Pause (1)\n          msg (&quot;The &quot; + enemy&#46;alias + &quot; takes damage!&quot;)\n          set (enemy, &quot;health&quot;, health - player&#46;dmg)\n        }\n        case (&quot;Run&quot;) {\n          msg (&quot;You run away&#46;&quot;)\n        }\n      }\n    }\n  &lt;/function&gt;[/code:g261gh45]\nThis is the aslx file:\n[attachment=0:g261gh45]<!-- ia0 -->Experiments540.aslx<!-- ia0 -->[/attachment:g261gh45]",
      "EditableFormat": "bbcode",
      "HTML": "In my &quot;Experiments540&quot; game, where I try out new stuff I'm working with, I'm having trouble with a function, and I don't understand why.<br/>I have a function (combat) with one parameter (enemy). When the player says, &quot;attack crazy guy,&quot; it calls the function with <span style=\"text-decoration:underline;\">crazy guy</span> as the parameter.<br/>Inside the function is a menu handled by a switch.<br/>In the first case (&quot;attack&quot;) it begins with printing a message (&quot;You attack the &quot; + enemy.alias + &quot;...&quot;)<br/><br/>When I try to run it, I get this error:<br/>Error running script&#058; Error compiling expression '&quot;You attack the &quot; + enemy.alias + &quot;...&quot;': Unknown object or variable 'enemy'<br/><br/>Shouldn't it recognize the parameter variable anywhere inside the function?<br/><br/>This is the script for the attack verb:<br/><pre><code>&lt;attack type=&quot;script&quot;&gt;<br/>        combat (crazy guy)<br/>      &lt;/attack&gt;</code></pre><br/>This is the code for the combat function:<br/><pre><code>&lt;function name=&quot;combat&quot; parameters=&quot;enemy&quot;&gt;<br/>    choices = NewStringList()<br/>    list add (choices, &quot;Attack&quot;)<br/>    list add (choices, &quot;Run&quot;)<br/>    ShowMenu (&quot;What will you do?&quot;, choices, false) {<br/>      switch (result) {<br/>        case (&quot;Attack&quot;) {<br/>          msg (&quot;You attack the &quot; + enemy&#46;alias + &quot;&#46;&#46;&#46;&quot;)<br/>          Pause (1)<br/>          msg (&quot;The &quot; + enemy&#46;alias + &quot; takes damage!&quot;)<br/>          set (enemy, &quot;health&quot;, health - player&#46;dmg)<br/>        }<br/>        case (&quot;Run&quot;) {<br/>          msg (&quot;You run away&#46;&quot;)<br/>        }<br/>      }<br/>    }<br/>  &lt;/function&gt;</code></pre><br/>This is the aslx file:<br/><div><a href=\"/forumattachments/569/Experiments540.aslx\">Experiments540.aslx</a></div>",
      "PostDate": "2013-03-28T20:13:27+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "23745",
      "UserId": 0,
      "Username": "The Pixie",
      "UserAvatar": null,
      "UserGravatar": "cfa37e927f96177bcf6053ae8f108f77",
      "EditableText": "I have not run it or anything, but it looks to me like crazy guy is not defined, so Quest assumed this is a local variable with the value null, and passes that to the function, when it becomes enemy, and therefore you are trying to access the value of alias on null.\n\nIt might be that Quest has a problem with spaces in the name crazy guy, though in theory it should be okay (a habit I have from other languages to is replace spaces with underscores, so I would call it crazy_guy; might be worth trying that).",
      "EditableFormat": "bbcode",
      "HTML": "I have not run it or anything, but it looks to me like crazy guy is not defined, so Quest assumed this is a local variable with the value null, and passes that to the function, when it becomes enemy, and therefore you are trying to access the value of alias on null.<br/><br/>It might be that Quest has a problem with spaces in the name crazy guy, though in theory it should be okay (a habit I have from other languages to is replace spaces with underscores, so I would call it crazy_guy; might be worth trying that).",
      "PostDate": "2013-03-28T21:56:04+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "23746",
      "UserId": 0,
      "Username": "sonic102",
      "UserAvatar": null,
      "UserGravatar": "fd0d4fb0d4f66001ed8c262e48930d07",
      "EditableText": "Have you tried changing the parameter's name?",
      "EditableFormat": "bbcode",
      "HTML": "Have you tried changing the parameter's name?",
      "PostDate": "2013-03-28T22:39:03+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "23749",
      "UserId": 0,
      "Username": "jaynabonne",
      "UserAvatar": "6579_1344778256.jpg",
      "UserGravatar": "379859a7f1952a65399fc63997e68f0b",
      "EditableText": "The problem is that ShowMenu is implemented as a function, and scripts passed to functions like that don't preserve the context (arguments, local variables, etc). When the menu is excuted, it invokes the script wih &quot;invoke&quot;, and the only parameter passed to the script is the result. So &quot;enemy&quot; is indeed undefined at that point. The argument has been lost.",
      "EditableFormat": "bbcode",
      "HTML": "The problem is that ShowMenu is implemented as a function, and scripts passed to functions like that don't preserve the context (arguments, local variables, etc). When the menu is excuted, it invokes the script wih &quot;invoke&quot;, and the only parameter passed to the script is the result. So &quot;enemy&quot; is indeed undefined at that point. The argument has been lost.",
      "PostDate": "2013-03-28T23:47:23+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "23751",
      "UserId": 0,
      "Username": "sonic102",
      "UserAvatar": null,
      "UserGravatar": "fd0d4fb0d4f66001ed8c262e48930d07",
      "EditableText": "So instead of showing a menu, ask a question.",
      "EditableFormat": "bbcode",
      "HTML": "So instead of showing a menu, ask a question.",
      "PostDate": "2013-03-29T00:38:15+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "23754",
      "UserId": 0,
      "Username": "jaynabonne",
      "UserAvatar": "6579_1344778256.jpg",
      "UserGravatar": "379859a7f1952a65399fc63997e68f0b",
      "EditableText": "You can also store the argument somewhere (e.g. in the game object) and then reference it in the script.\n\ne.g. before ShowMenu,\ngame.combatEnemy = enemy\n\nAnd then in the script\n\nenemy = game.combatEnemy\n\nbefore you try to use it.",
      "EditableFormat": "bbcode",
      "HTML": "You can also store the argument somewhere (e.g. in the game object) and then reference it in the script.<br/><br/>e.g. before ShowMenu,<br/>game.combatEnemy = enemy<br/><br/>And then in the script<br/><br/>enemy = game.combatEnemy<br/><br/>before you try to use it.",
      "PostDate": "2013-03-29T00:50:53+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "23757",
      "UserId": 0,
      "Username": "HegemonKhan",
      "UserAvatar": null,
      "UserGravatar": "a96cf34d8d97c57de38f54ee22b1759b",
      "EditableText": "this is what you need (full credit to Pertex):\n\n(see the battle_system_function for the relevant code that you need, as you don't have to do it via a command, like I did)\n\n[code:p6uru59i]&lt;command name=&quot;fight_command&quot;&gt;\n  &lt;pattern&gt;fight #text#&lt;/pattern&gt;\n  &lt;script&gt;\n    battle_system_function (game&#46;pov,text)\n  &lt;/script&gt;\n&lt;/command&gt;\n\n&lt;function name=&quot;battle_system_function&quot; parameters=&quot;self,text&quot;&gt;\n  target = GetObject (text)\n  if (target = null) {\n    foreach (obj,GetAllChildObjects(game&#46;pov&#46;parent)) {\n      if (obj&#46;alias=text) {\n        target = obj\n      } else {\n        msg (&quot;There seemingly is no &quot; + text + &quot; here&#46;&quot;)\n      }\n    }\n  }\n  your etc code\n&lt;/function&gt;[/code:p6uru59i]\n\n--------------------------------------------------------\n\nPertex had further especially helped me out, with this fancy part of the above code by him:\n\n[code:p6uru59i]foreach (obj,GetAllChildObjects(game&#46;pov&#46;parent)) {\n      if (obj&#46;alias=text) {\n        target = obj[/code:p6uru59i]\n\nthe reason why I needed this is because the command uses what you type in, which is the object's ALIAS (ex. orc) as that is the label that the game player sees, however, the GetObject (object) function searches for an object that has that typed in label as it's NAME, and thus it can't find any object with that NAME (ex. orc). As the object's NAME is (ex. orc1), and not (ex.) &quot; orc &quot;.\n\nif you're not using~having ALIASES, then you don't need this coding, but if you're using~having ALIASES, then you need this coding.\n\n--------------------------------------------------------\n\nif you want to see more &quot;combat code&quot;, let me know, or you can just find it in the thread (&quot;Noob HK's Help Me Thread&quot;) that I made.\n\nactually, I'll post it here, so you can examine it, if you want to get some ideas and~or use it for your own code. Credit goes to Pertex, as I was basically make the same code structure as his combat library, with minor tweaks of my own to it, for making my code.\n\n(this code is really messy, as I haven't &quot;streamlined&quot; it yet, so it still has some code lines and~or structure that isn't needed)\n\n[code:p6uru59i]&lt;asl version=&quot;530&quot;&gt;\n  &lt;include ref=&quot;English&#46;aslx&quot; /&gt;\n  &lt;include ref=&quot;Core&#46;aslx&quot; /&gt;\n  &lt;game name=&quot;Testing Game Stuff&quot;&gt;\n    &lt;gameid&gt;d83ba5bb-2e3c-4f31-80c9-3e88a2dc082c&lt;/gameid&gt;\n    &lt;version&gt;1&#46;0&lt;/version&gt;\n    &lt;pov type=&quot;object&quot;&gt;player&lt;/pov&gt;\n    &lt;start type=&quot;script&quot;&gt;\n      cc\n    &lt;/start&gt;\n    &lt;turns type=&quot;int&quot;&gt;0&lt;/turns&gt;\n    &lt;statusattributes type=&quot;stringdictionary&quot;&gt;turns = &lt;/statusattributes&gt;\n  &lt;/game&gt;\n  &lt;object name=&quot;room&quot;&gt;\n    &lt;inherit name=&quot;editor_room&quot; /&gt;\n    &lt;object name=&quot;player&quot;&gt;\n      &lt;inherit name=&quot;defaultplayer&quot; /&gt;\n      &lt;inherit name=&quot;pc&quot; /&gt;\n      &lt;cur_hp type=&quot;int&quot;&gt;999&lt;/cur_hp&gt;\n      &lt;max_hp type=&quot;int&quot;&gt;999&lt;/max_hp&gt;\n      &lt;str type=&quot;int&quot;&gt;100&lt;/str&gt;\n      &lt;end type=&quot;int&quot;&gt;100&lt;/end&gt;\n      &lt;dex type=&quot;int&quot;&gt;100&lt;/dex&gt;\n      &lt;agi type=&quot;int&quot;&gt;100&lt;/agi&gt;\n      &lt;spd type=&quot;int&quot;&gt;100&lt;/spd&gt;\n      &lt;hc type=&quot;int&quot;&gt;100&lt;/hc&gt;\n      &lt;pd type=&quot;int&quot;&gt;100&lt;/pd&gt;\n      &lt;pr type=&quot;int&quot;&gt;100&lt;/pr&gt;\n    &lt;/object&gt;\n    &lt;object name=&quot;orc1&quot;&gt;\n      &lt;inherit name=&quot;editor_object&quot; /&gt;\n      &lt;inherit name=&quot;npc&quot; /&gt;\n      &lt;hostile type=&quot;boolean&quot;&gt;true&lt;/hostile&gt;\n      &lt;dead type=&quot;boolean&quot;&gt;false&lt;/dead&gt;\n      &lt;alias&gt;orc&lt;/alias&gt;\n      &lt;cur_hp type=&quot;int&quot;&gt;999&lt;/cur_hp&gt;\n      &lt;max_hp type=&quot;int&quot;&gt;999&lt;/max_hp&gt;\n      &lt;str type=&quot;int&quot;&gt;25&lt;/str&gt;\n      &lt;end type=&quot;int&quot;&gt;25&lt;/end&gt;\n      &lt;dex type=&quot;int&quot;&gt;25&lt;/dex&gt;\n      &lt;agi type=&quot;int&quot;&gt;25&lt;/agi&gt;\n      &lt;spd type=&quot;int&quot;&gt;25&lt;/spd&gt;\n      &lt;hc type=&quot;int&quot;&gt;25&lt;/hc&gt;\n      &lt;pd type=&quot;int&quot;&gt;25&lt;/pd&gt;\n      &lt;pr type=&quot;int&quot;&gt;25&lt;/pr&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n  &lt;turnscript name=&quot;game_turns&quot;&gt;\n    &lt;enabled /&gt;\n    &lt;script&gt;\n      sa\n      game&#46;turns = game&#46;turns + 1\n    &lt;/script&gt;\n  &lt;/turnscript&gt;\n  &lt;command name=&quot;fight&quot;&gt;\n    &lt;pattern&gt;fight #text#&lt;/pattern&gt;\n    &lt;script&gt;\n      battle_system (game&#46;pov,text)\n    &lt;/script&gt;\n  &lt;/command&gt;\n  &lt;type name=&quot;char&quot;&gt;\n    &lt;cur_hp type=&quot;int&quot;&gt;0&lt;/cur_hp&gt;\n    &lt;drop type=&quot;boolean&quot;&gt;false&lt;/drop&gt;\n    &lt;defending type=&quot;boolean&quot;&gt;false&lt;/defending&gt;\n    &lt;max_hp type=&quot;int&quot;&gt;0&lt;/max_hp&gt;\n    &lt;str type=&quot;int&quot;&gt;0&lt;/str&gt;\n    &lt;end type=&quot;int&quot;&gt;0&lt;/end&gt;\n    &lt;dex type=&quot;int&quot;&gt;0&lt;/dex&gt;\n    &lt;agi type=&quot;int&quot;&gt;0&lt;/agi&gt;\n    &lt;spd type=&quot;int&quot;&gt;0&lt;/spd&gt;\n    &lt;hp type=&quot;int&quot;&gt;0&lt;/hp&gt;\n    &lt;hc type=&quot;int&quot;&gt;0&lt;/hc&gt;\n    &lt;pd type=&quot;int&quot;&gt;0&lt;/pd&gt;\n    &lt;pr type=&quot;int&quot;&gt;0&lt;/pr&gt;\n  &lt;/type&gt;\n  &lt;type name=&quot;pc&quot;&gt;\n    &lt;inherit name=&quot;char&quot; /&gt;\n    &lt;statusattributes type=&quot;stringdictionary&quot;&gt;hp = ;str = ;end = ;dex = ;agi = ;spd = ;hc = ;pd = ;pr = &lt;/statusattributes&gt;\n  &lt;/type&gt;\n  &lt;type name=&quot;npc&quot;&gt;\n    &lt;inherit name=&quot;char&quot; /&gt;\n    &lt;dead type=&quot;boolean&quot;&gt;false&lt;/dead&gt;\n    &lt;hostile type=&quot;boolean&quot;&gt;false&lt;/hostile&gt;\n    &lt;displayverbs type=&quot;list&quot;&gt;Look at; Talk; Fight&lt;/displayverbs&gt;\n  &lt;/type&gt;\n  &lt;function name=&quot;cc&quot;&gt;\n    msg (&quot;What is your name?&quot;)\n    get input {\n      game&#46;pov&#46;alias = result\n      msg (&quot; - &quot; + game&#46;pov&#46;alias)\n      show menu (&quot;What is your gender?&quot;, split (&quot;male;female&quot; , &quot;;&quot;), false) {\n        game&#46;pov&#46;gender = result\n        show menu (&quot;What is your race?&quot;, split (&quot;human;dwarf;elf&quot; , &quot;;&quot;), false) {\n          game&#46;pov&#46;race = result\n          show menu (&quot;What is your class?&quot;, split (&quot;warrior;cleric;mage;thief&quot; , &quot;;&quot;), false) {\n            game&#46;pov&#46;class = result\n            msg (game&#46;pov&#46;alias + &quot; is a &quot; + game&#46;pov&#46;gender + &quot; &quot; + game&#46;pov&#46;race + &quot; &quot; + game&#46;pov&#46;class + &quot;&#46;&quot;)\n            wait {\n              ClearScreen\n            }\n          }\n        }\n      }\n    }\n  &lt;/function&gt;\n  &lt;function name=&quot;sa&quot;&gt;\n    game&#46;pov&#46;hp = game&#46;pov&#46;cur_hp + &quot; / &quot; + game&#46;pov&#46;max_hp\n  &lt;/function&gt;\n  &lt;function name=&quot;battle_system&quot; parameters=&quot;self,text&quot; type=&quot;boolean&quot;&gt;\n    first_value = false\n    enemy = GetObject (text)\n    if (enemy = null) {\n      foreach (obj,AllObjects()) {\n        if (obj&#46;alias=text) {\n          enemy = obj\n        }\n      }\n    }\n    if (enemy = null) {\n      msg (&quot;There is no &quot; + text + &quot; here&#46;&quot;)\n      first_value = false\n    }\n    else if (not Doesinherit (enemy,&quot;npc&quot;)) {\n      msg (&quot;You can not battle that!&quot;)\n      first_value = false\n    }\n    else if (not npc_reachable (enemy)) {\n      msg (&quot;There is no &quot; + enemy&#46;alias + &quot; in your vicinity&#46;&quot;)\n      first_value = false\n    }\n    else if (GetBoolean (enemy,&quot;dead&quot;) = true) {\n      msg (enemy&#46;alias + &quot; is already dead&#46;&quot;)\n      first_value = false\n    }\n    else if (GetBoolean (enemy,&quot;hostile&quot;) = false) {\n      msg (enemy&#46;alias + &quot; is not hostile&#46;&quot;)\n      first_value = false\n    }\n    else if (battle_sequence (self,enemy) = true) {\n      msg (&quot;The battle is over&#46;&quot;)\n      first_value = true\n    }\n    return (first_value)\n  &lt;/function&gt;\n  &lt;function name=&quot;battle_sequence&quot; parameters=&quot;self,enemy&quot; type=&quot;boolean&quot;&gt;&lt;!&#91;CDATA&#91;\n    second_value = false\n    if (enemy&#46;dead = false) {\n      if (GetInt (self,&quot;spd&quot;) &gt; GetInt (enemy,&quot;spd&quot;)) {\n        on ready {\n          msg (&quot;You get to go first for this round&quot;)\n          if (self_battle_turn (self,enemy) = true) {\n            battle_sequence (self,enemy)\n          }\n        }\n        on ready {\n          if (enemy&#46;dead = false) {\n            if (enemy_battle_turn (self,enemy) = true) {\n              msg (&quot;The round has ended&#46;&quot;)\n            }\n          }\n        }\n        on ready {\n          battle_sequence (self,enemy)\n        }\n      }\n      else if (GetInt (self,&quot;spd&quot;) &lt; GetInt (enemy,&quot;spd&quot;)) {\n        on ready {\n          msg (enemy&#46;alias + &quot; gets to go first for this round&#46;&quot;)\n          if (enemy_battle_turn (self,enemy) = true) {\n            msg (&quot;It is now your turn&#46;&quot;)\n          }\n        }\n        on ready {\n          if (self_battle_turn (self,enemy) = true) {\n            battle_sequence (self,enemy)\n          }\n          else {\n            msg (&quot;The round has ended&#46;&quot;)\n          }\n        }\n        on ready {\n          battle_sequence (self,enemy)\n        }\n      }\n      else if (GetInt (self,&quot;spd&quot;) = GetInt (enemy,&quot;spd&quot;)) {\n        if (RandomChance (50) = true) {\n          on ready {\n            msg (&quot;You get to go first for this round&quot;)\n            if (self_battle_turn (self,enemy) = true) {\n              battle_sequence (self,enemy)\n            }\n          }\n          on ready {\n            if (enemy_battle_turn (self,enemy) = true) {\n              msg (&quot;The round has ended&#46;&quot;)\n            }\n          }\n          on ready {\n            battle_sequence (self,enemy)\n          }\n        }\n        else {\n          on ready {\n            msg (enemy&#46;alias + &quot; gets to go first for this round&#46;&quot;)\n            if (enemy_battle_turn (self,enemy) = true) {\n              msg (&quot;It is now your turn&#46;&quot;)\n            }\n          }\n          on ready {\n            if (self_battle_turn (self,enemy) = true) {\n              battle_sequence (self,enemy)\n            }\n            else {\n              msg (&quot;The round has ended&#46;&quot;)\n            }\n          }\n          on ready {\n            battle_sequence (self,enemy)\n          }\n        }\n      }\n    }\n    else {\n      second_value = true\n    }\n    return (second_value)\n  &#93;&#93;&gt;&lt;/function&gt;\n  &lt;function name=&quot;self_battle_turn&quot; parameters=&quot;self,enemy&quot; type=&quot;boolean&quot;&gt;&lt;!&#91;CDATA&#91;\n    third_value = false\n    msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)\n    msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)\n    wait {\n      show menu (&quot;What is your battle choice?&quot;, split (&quot;Attack;Defend;Cast;Item;Run&quot;, &quot;;&quot;), false) {\n        switch (result) {\n          case (&quot;Attack&quot;) {\n            fourth_value = false\n            if (RandomChance (GetInt (enemy,&quot;agi&quot;) - GetInt (self,&quot;spd&quot;)) = true) {\n              msg (enemy&#46;alias + &quot;evaded your attack!&quot;)\n              fourth_value = true\n            }\n            else if (RandomChance (GetInt (enemy,&quot;Dex&quot;) - GetInt (self,&quot;agi&quot;)) = true) {\n              msg (enemy&#46;alias + &quot;parried your attack!&quot;)\n              fourth_value = true\n            }\n            else if (RandomChance (GetInt (enemy,&quot;agi&quot;) - GetInt (self,&quot;dex&quot;)) = true) {\n              msg (enemy&#46;alias + &quot;blocked your attack!&quot;)\n              fourth_value = true\n            }\n            else if (RandomChance (GetInt (self,&quot;dex&quot;) - GetInt (enemy,&quot;spd&quot;)) = false) {\n              msg (&quot;Your attack missed &quot; + enemy&#46;alias +&quot;!&quot;)\n              fourth_value = true\n            }\n            else if (RandomChance (GetInt (enemy,&quot;pr&quot;) - GetInt (self,&quot;hc&quot;)) = true) {\n              msg (&quot;Your attack got resisted by &quot; + enemy&#46;alias +&quot;!&quot;)\n              fourth_value = true\n            }\n            else if (fourth_value = false) {\n              if (self&#46;defending = true and enemy&#46;defending = true) {\n                enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * 2 * GetInt (self,&quot;pd&quot;) / 2 + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)\n                msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)\n                self&#46;defending = false\n              }\n              else if (self&#46;defending = true and enemy&#46;defending = false) {\n                enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * 2 * GetInt (self,&quot;pd&quot;) + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)\n                msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)\n                self&#46;defending = false\n              }\n              else if (self&#46;defending = false and enemy&#46;defending = true) {\n                enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * GetInt (self,&quot;pd&quot;) / 2 + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)\n                msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)\n              }\n              else if (self&#46;defending = false and enemy&#46;defending = false) {\n                enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * GetInt (self,&quot;pd&quot;) + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)\n                msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)\n              }\n            }\n          }\n          case (&quot;Defend&quot;) {\n            if (self&#46;defending = false) {\n              self&#46;defending = true\n            }\n          }\n          case (&quot;Cast&quot;) {\n            self&#46;defending = false\n          }\n          case (&quot;Item&quot;) {\n            self&#46;defending = false\n          }\n          case (&quot;Run&quot;) {\n            self&#46;defending = false\n          }\n        }\n        if (GetInt (enemy,&quot;cur_hp&quot;) &gt; 0) {\n          if (RandomChance (GetInt (self,&quot;spd&quot;) - GetInt (enemy,&quot;spd&quot;)) = true) {\n            msg (&quot;You get an extra battle turn!&quot;)\n            self_battle_turn (self,enemy)\n          }\n          else {\n            msg (&quot;Your battle turn is over&#46;&quot;)\n            third_value = false\n          }\n        }\n        else if (GetInt (enemy,&quot;cur_hp&quot;) &lt;= 0) {\n          msg (enemy&#46;alias + &quot; is dead&#46;&quot;)\n          msg (&quot;You have won the battle!&quot;)\n          enemy&#46;defending = false\n          enemy&#46;dead = true\n          third_value = true\n          wait {\n            ClearScreen\n          }\n        }\n      }\n    }\n    return (third_value)\n  &#93;&#93;&gt;&lt;/function&gt;\n  &lt;function name=&quot;enemy_battle_turn&quot; parameters=&quot;self,enemy&quot; type=&quot;boolean&quot;&gt;&lt;!&#91;CDATA&#91;\n    fifth_value = false\n    msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)\n    msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)\n    result = GetRandomInt (1,3)\n    switch (result) {\n      case (1) {\n        sixth_value = false\n        if (RandomChance (GetInt (self,&quot;agi&quot;) - GetInt (enemy,&quot;spd&quot;)) = true) {\n          msg (&quot;You have evaded the attack!&quot;)\n          sixth_value = true\n        }\n        else if (RandomChance (GetInt (self,&quot;dex&quot;) - GetInt (enemy,&quot;agi&quot;)) = true) {\n          msg (&quot;You have parried the attack!&quot;)\n          sixth_value = true\n        }\n        else if (RandomChance (GetInt (self,&quot;agi&quot;) - GetInt (enemy,&quot;dex&quot;)) = true) {\n          msg (&quot;You have blocked the attack!&quot;)\n          sixth_value = true\n        }\n        else if (RandomChance (GetInt (enemy,&quot;dex&quot;) - GetInt (self,&quot;spd&quot;)) = false) {\n          msg (enemy&#46;alias +&quot;'s attack missed!&quot;)\n          sixth_value = true\n        }\n        else if (RandomChance (GetInt (self,&quot;pr&quot;) - GetInt (enemy,&quot;hc&quot;)) = true) {\n          msg (&quot;You resisted the attack!&quot;)\n          sixth_value = true\n        }\n        else if (sixth_value = false) { \n          if (enemy&#46;defending = true and self&#46;defending = true) {\n            self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * 2 * GetInt (enemy,&quot;pd&quot;) / 2 + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)\n            msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)\n            enemy&#46;defending = false\n          }\n          else if (enemy&#46;defending = true and self&#46;defending = false) {\n            self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * 2 * GetInt (enemy,&quot;pd&quot;) + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)\n            msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)\n            enemy&#46;defending = false\n          }\n          else if (enemy&#46;defending = false and self&#46;defending = true) {\n            self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * GetInt (enemy,&quot;pd&quot;) / 2 + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)\n            msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)\n          }\n          else if (enemy&#46;defending = false and self&#46;defending = false) {\n            self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * GetInt (enemy,&quot;pd&quot;) + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)\n            msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)\n          }\n        }\n      }\n      case (2) {\n        if (enemy&#46;defending = false) {\n          msg (enemy&#46;alias + &quot; has choosen to defend itself&#46;&quot;)\n          enemy&#46;defending = true\n        }\n      }\n      case (3) {\n        enemy&#46;defending = false\n        msg (&quot;Cast&quot;)\n      }\n    }\n    if (GetInt (self,&quot;cur_hp&quot;) &gt; 0) {\n      if (RandomChance (GetInt (enemy,&quot;spd&quot;) - GetInt (self,&quot;spd&quot;)) = true) {\n        msg (enemy&#46;alias + &quot; gets an extra battle turn!&quot;)\n        wait {\n          enemy_battle_turn (self,enemy)\n        }\n      }\n      else {\n        msg (enemy&#46;alias + &quot; 's battle turn is over&#46;&quot;)\n        fifth_value = true\n      }\n    }\n    else if (GetInt (self,&quot;cur_hp&quot;) &lt;= 0) {\n      msg (self&#46;alias + &quot; has died&#46;&quot;)\n      msg (&quot;GAME OVER&quot;)\n      finish\n    }\n    return (fifth_value)\n  &#93;&#93;&gt;&lt;/function&gt;\n  &lt;function name=&quot;npc_reachable&quot; parameters=&quot;object&quot; type=&quot;boolean&quot;&gt;\n    value = false\n    foreach (x,ScopeReachableNotHeld ()) {\n      if (x=object) {\n        value = true\n      }\n    }\n    return (value)\n  &lt;/function&gt;\n  &lt;function name=&quot;crit_hit&quot; parameters=&quot;object&quot; type=&quot;int&quot;&gt;\n    if (RandomChance (GetInt (object,&quot;luck&quot;)) = true) {\n      value = 2\n    }\n    else {\n      value = 1\n    }\n    return (value)\n  &lt;/function&gt;\n&lt;/asl&gt;[/code:p6uru59i]\n\nand here's the key~legend for the terms and~or abreviations that I used for it:\n\n[code:p6uru59i]01&#46; cc = character creation function\n02&#46; sa = status attributes (mainly for implementing/displaying of ' cur / max ' stats) function\n03&#46; char = character object type (&quot;pcs&quot;, &quot;npcs&quot;, &quot;monsters&quot;, etc&#46;, so, not a room, item, equipment, spell, etc)\n04&#46; pc = playable character object type (&quot;player&quot; characters / game&#46;povs)\n05&#46; npc = non-playable character (&quot;people&quot;, &quot;monsters&quot;, and etc, so not a &quot;player&quot; character / not a game&#46;pov, I'm going to have a hostility system, so any npc can be friendly or hostile, instead of having an actual &quot;monster/enemy&quot; type set aside)\n06&#46; hp = hit points (life) stat attribute\n07&#46; mp = mana points (magic) stat attribute\n08&#46; str = strength (physical damage, carry weight / equipment requirement, etc) stat attribute\n09&#46; end = endurance (physical defense, and etc) stat attribute\n10&#46; dex = dexterity (weapon~attack skill, think of this as &quot;if your attack connects or not, do you 'whiff' or not&quot;, so not to gete confused with hc, and etc) stat attribute\n11&#46; agi = agility (dodging/evading, and etc) stat attribute\n12&#46; spd = speed (who goes first in battle, extra battle turns, escaping from battle, and etc) stat attribute\n13&#46; hc = hit chance (think of this more as piercing their armor or not, so not to get confused with dex, and etc) stat attribute\n14&#46; pd = physical damage stat attribute\n15&#46; fp = fire damage stat attribute\n16&#46; wp = water damage stat attribute\n17&#46; ap = air damage stat attribute\n18&#46; ed = earth damage stat attribute\n19&#46; ld = light damage stat attribute\n20&#46; dd = dark damage stat attribute\n21&#46; pr = physical resistance stat attribute\n22&#46; fr = fire resistance stat attribute\n23&#46; wr = water resistance stat attribute\n24&#46; ar = air resistance stat attribute\n25&#46; er = earth resistance stat attribute\n26&#46; lr = light resistance stat attribute\n27&#46; dr = dark resistance stat attribute\n28&#46; defending = boolean (reduces damage done for that character and increases the damage done by that character, if they chosoe to attack on the next turn)\n29&#46; escaped = boolean, run from battle (not completed/implemented yet)\n30&#46; hostile = boolean, any npc can be friendly or a(n) &quot;monster/enemy&quot;, based upon a hostility scale (0-100), but not completed\n31&#46; dead = boolean\n32&#46; crit_hit = critical hit (bonus damage based upon luck)\n33&#46; luck = luck stat attribute\n34&#46; lvl = level stat attribute\n35&#46; exp = experience stat attribute\n36&#46; cash = cash stat attribute (currency)\n37&#46; lvlup = level up function[/code:p6uru59i]\n\nbut here's Pertex' work in streamlining my code for me:\n\n[code:p6uru59i]    &lt;asl version=&quot;530&quot;&gt;\n      &lt;include ref=&quot;English&#46;aslx&quot; /&gt;\n      &lt;include ref=&quot;Core&#46;aslx&quot; /&gt;\n      &lt;game name=&quot;Test&quot;&gt;\n        &lt;gameid&gt;d83ba5bb-2e3c-4f31-80c9-3e88a2dc082c&lt;/gameid&gt;\n        &lt;version&gt;1&#46;0&lt;/version&gt;\n        &lt;pov type=&quot;object&quot;&gt;player&lt;/pov&gt;\n        &lt;start type=&quot;script&quot;&gt;\n          cc\n        &lt;/start&gt;\n        &lt;turns type=&quot;int&quot;&gt;0&lt;/turns&gt;\n        &lt;statusattributes type=&quot;stringdictionary&quot;&gt;turns = &lt;/statusattributes&gt;\n      &lt;/game&gt;\n      &lt;object name=&quot;room&quot;&gt;\n        &lt;inherit name=&quot;editor_room&quot; /&gt;\n        &lt;object name=&quot;player&quot;&gt;\n          &lt;inherit name=&quot;defaultplayer&quot; /&gt;\n          &lt;inherit name=&quot;pc&quot; /&gt;\n          &lt;cur_hp type=&quot;int&quot;&gt;999&lt;/cur_hp&gt;\n          &lt;max_hp type=&quot;int&quot;&gt;999&lt;/max_hp&gt;\n          &lt;str type=&quot;int&quot;&gt;100&lt;/str&gt;\n          &lt;end type=&quot;int&quot;&gt;100&lt;/end&gt;\n          &lt;dex type=&quot;int&quot;&gt;100&lt;/dex&gt;\n          &lt;agi type=&quot;int&quot;&gt;100&lt;/agi&gt;\n          &lt;spd type=&quot;int&quot;&gt;100&lt;/spd&gt;\n          &lt;hc type=&quot;int&quot;&gt;100&lt;/hc&gt;\n          &lt;pd type=&quot;int&quot;&gt;100&lt;/pd&gt;\n          &lt;pr type=&quot;int&quot;&gt;100&lt;/pr&gt;\n        &lt;/object&gt;\n        &lt;object name=&quot;orc1&quot;&gt;\n          &lt;inherit name=&quot;editor_object&quot; /&gt;\n          &lt;inherit name=&quot;npc&quot; /&gt;\n          &lt;hostile type=&quot;boolean&quot;&gt;true&lt;/hostile&gt;\n          &lt;dead type=&quot;boolean&quot;&gt;false&lt;/dead&gt;\n          &lt;alias&gt;orc&lt;/alias&gt;\n          &lt;cur_hp type=&quot;int&quot;&gt;999&lt;/cur_hp&gt;\n          &lt;max_hp type=&quot;int&quot;&gt;999&lt;/max_hp&gt;\n          &lt;str type=&quot;int&quot;&gt;25&lt;/str&gt;\n          &lt;end type=&quot;int&quot;&gt;25&lt;/end&gt;\n          &lt;dex type=&quot;int&quot;&gt;25&lt;/dex&gt;\n          &lt;agi type=&quot;int&quot;&gt;25&lt;/agi&gt;\n          &lt;spd type=&quot;int&quot;&gt;25&lt;/spd&gt;\n          &lt;hc type=&quot;int&quot;&gt;25&lt;/hc&gt;\n          &lt;pd type=&quot;int&quot;&gt;25&lt;/pd&gt;\n          &lt;pr type=&quot;int&quot;&gt;25&lt;/pr&gt;\n        &lt;/object&gt;\n      &lt;/object&gt;\n      &lt;turnscript name=&quot;game_turns&quot;&gt;\n        &lt;enabled /&gt;\n        &lt;script&gt;\n          sa\n          game&#46;turns = game&#46;turns + 1\n        &lt;/script&gt;\n      &lt;/turnscript&gt;\n      &lt;command name=&quot;fight&quot;&gt;\n        &lt;pattern&gt;fight #text#&lt;/pattern&gt;\n        &lt;script&gt;\n          battle_system (game&#46;pov,text)\n        &lt;/script&gt;\n      &lt;/command&gt;\n      &lt;type name=&quot;char&quot;&gt;\n        &lt;cur_hp type=&quot;int&quot;&gt;0&lt;/cur_hp&gt;\n        &lt;drop type=&quot;boolean&quot;&gt;false&lt;/drop&gt;\n        &lt;defending type=&quot;boolean&quot;&gt;false&lt;/defending&gt;\n        &lt;max_hp type=&quot;int&quot;&gt;0&lt;/max_hp&gt;\n        &lt;str type=&quot;int&quot;&gt;0&lt;/str&gt;\n        &lt;end type=&quot;int&quot;&gt;0&lt;/end&gt;\n        &lt;dex type=&quot;int&quot;&gt;0&lt;/dex&gt;\n        &lt;agi type=&quot;int&quot;&gt;0&lt;/agi&gt;\n        &lt;spd type=&quot;int&quot;&gt;0&lt;/spd&gt;\n        &lt;hp type=&quot;int&quot;&gt;0&lt;/hp&gt;\n        &lt;hc type=&quot;int&quot;&gt;0&lt;/hc&gt;\n        &lt;pd type=&quot;int&quot;&gt;0&lt;/pd&gt;\n        &lt;pr type=&quot;int&quot;&gt;0&lt;/pr&gt;\n      &lt;/type&gt;\n      &lt;type name=&quot;pc&quot;&gt;\n        &lt;inherit name=&quot;char&quot; /&gt;\n        &lt;statusattributes type=&quot;stringdictionary&quot;&gt;hp = ;str = ;end = ;dex = ;agi = ;spd = ;hc = ;pd = ;pr = &lt;/statusattributes&gt;\n      &lt;/type&gt;\n      &lt;type name=&quot;npc&quot;&gt;\n        &lt;inherit name=&quot;char&quot; /&gt;\n        &lt;dead type=&quot;boolean&quot;&gt;false&lt;/dead&gt;\n        &lt;hostile type=&quot;boolean&quot;&gt;false&lt;/hostile&gt;\n        &lt;displayverbs type=&quot;list&quot;&gt;Look at; Talk; Fight&lt;/displayverbs&gt;\n      &lt;/type&gt;\n      &lt;function name=&quot;cc&quot;&gt;\n        msg (&quot;What is your name?&quot;)\n        get input {\n          game&#46;pov&#46;alias = result\n          msg (&quot; - &quot; + game&#46;pov&#46;alias)\n          show menu (&quot;What is your gender?&quot;, split (&quot;male;female&quot; , &quot;;&quot;), false) {\n            game&#46;pov&#46;gender = result\n            show menu (&quot;What is your race?&quot;, split (&quot;human;dwarf;elf&quot; , &quot;;&quot;), false) {\n              game&#46;pov&#46;race = result\n              show menu (&quot;What is your class?&quot;, split (&quot;warrior;cleric;mage;thief&quot; , &quot;;&quot;), false) {\n                game&#46;pov&#46;class = result\n                msg (game&#46;pov&#46;alias + &quot; is a &quot; + game&#46;pov&#46;gender + &quot; &quot; + game&#46;pov&#46;race + &quot; &quot; + game&#46;pov&#46;class + &quot;&#46;&quot;)\n                wait {\n                  ClearScreen\n\t\t\t\t  \n                }\n              }\n            }\n          }\n        }\n      &lt;/function&gt;\n      &lt;function name=&quot;sa&quot;&gt;\n        game&#46;pov&#46;hp = game&#46;pov&#46;cur_hp + &quot; / &quot; + game&#46;pov&#46;max_hp\n      &lt;/function&gt;\n      &lt;function name=&quot;battle_system&quot; parameters=&quot;self,text&quot;&gt;\n        enemy = GetObject (text)\n        if (enemy = null) {\n          foreach (obj,AllObjects()) {\n            if (obj&#46;alias=text) {\n              enemy = obj\n            }\n          }\n        }\n        if (enemy = null) {\n          msg (&quot;There is no &quot; + text + &quot; here&#46;&quot;)\n        }\n        else if (not Doesinherit (enemy,&quot;npc&quot;)) {\n          msg (&quot;You can not battle that!&quot;)\n        }\n        else if (not npc_reachable (enemy)) {\n          msg (&quot;There is no &quot; + enemy&#46;alias + &quot; in your vicinity&#46;&quot;)\n        }\n        else if (GetBoolean (enemy,&quot;dead&quot;) = true) {\n          msg (enemy&#46;alias + &quot; is already dead&#46;&quot;)\n        }\n        else if (GetBoolean (enemy,&quot;hostile&quot;) = false) {\n          msg (enemy&#46;alias + &quot; is not hostile&#46;&quot;)\n        }\n        else {\n\t\t\tbattle_sequence (self,enemy)\n    \t} \n\n      &lt;/function&gt;\n      &lt;function name=&quot;battle_sequence&quot; parameters=&quot;self,enemy&quot;&gt;&lt;!&#91;CDATA&#91;\n\t\tif (enemy&#46;dead = false) {\n\t\t\tplayerfirst=false\n\t\t\tif (GetInt (self,&quot;spd&quot;) &gt; GetInt (enemy,&quot;spd&quot;)) {\n\t\t\t\tplayerfirst=true\n\t\t\t} else if (GetInt (self,&quot;spd&quot;) = GetInt (enemy,&quot;spd&quot;) and RandomChance (50)) {\n\t\t\t\tplayerfirst=true\n\t\t\t}   \t\t  \n\t\t\t\n\t\t\tif (playerfirst) {\n\t\t\t   msg (&quot;You get to go first for this round&quot;)\n\t\t\t   self_battle_turn (self,enemy) \n\t\t\t   on ready {\n\t\t\t\t if (not enemy&#46;dead){\n\t\t\t\t   enemy_battle_turn (self,enemy) \n\t\t\t\t }\n\t\t\t   }\n\t\t\t} else {\n\t\t\t   msg (enemy&#46;alias + &quot; gets to go first for this round&#46;&quot;)\n\t\t\t\tenemy_battle_turn (self,enemy) \n\t\t\t\tmsg (&quot;It is now your turn&#46;&quot;)\n\t\t\t\tself_battle_turn (self,enemy) \n\t\t\t}\n\t\t\ton ready {\n\t\t\t\tmsg (&quot;The round has ended&#46;&quot;)\n\t\t\t\tmsg(&quot;&quot;)  \n\t\t\t\tbattle_sequence (self,enemy)\t\n\t\t\t}\t\n        } \telse { \n\t\t\t\tmsg (&quot;The battle is over&#46;&quot;)\n        }\n      &#93;&#93;&gt;&lt;/function&gt;\n      &lt;function name=&quot;self_battle_turn&quot; parameters=&quot;self,enemy&quot;&gt;&lt;!&#91;CDATA&#91;\n\t\tmsg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)\n        msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)\n        wait {\n          show menu (&quot;What is your battle choice?&quot;, split (&quot;Attack;Defend;Cast;Item;Run&quot;, &quot;;&quot;), false) {\n            switch (result) {\n              case (&quot;Attack&quot;) {\n                fourth_value = false\n                if (RandomChance (GetInt (enemy,&quot;agi&quot;) - GetInt (self,&quot;spd&quot;)) = true) {\n                  msg (enemy&#46;alias + &quot;evaded your attack!&quot;)\n                  fourth_value = true\n                }\n                else if (RandomChance (GetInt (enemy,&quot;Dex&quot;) - GetInt (self,&quot;agi&quot;)) = true) {\n                  msg (enemy&#46;alias + &quot;parried your attack!&quot;)\n                  fourth_value = true\n                }\n                else if (RandomChance (GetInt (enemy,&quot;agi&quot;) - GetInt (self,&quot;dex&quot;)) = true) {\n                  msg (enemy&#46;alias + &quot;blocked your attack!&quot;)\n                  fourth_value = true\n                }\n                else if (RandomChance (GetInt (self,&quot;dex&quot;) - GetInt (enemy,&quot;spd&quot;)) = false) {\n                  msg (&quot;Your attack missed &quot; + enemy&#46;alias +&quot;!&quot;)\n                  fourth_value = true\n                }\n                else if (RandomChance (GetInt (enemy,&quot;pr&quot;) - GetInt (self,&quot;hc&quot;)) = true) {\n                  msg (&quot;Your attack got resisted by &quot; + enemy&#46;alias +&quot;!&quot;)\n                  fourth_value = true\n                }\n                else if (fourth_value = false) {\n                  if (self&#46;defending = true and enemy&#46;defending = true) {\n                    enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * 2 * GetInt (self,&quot;pd&quot;) / 2 + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)\n                    msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)\n                    self&#46;defending = false\n                  }\n                  else if (self&#46;defending = true and enemy&#46;defending = false) {\n                    enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * 2 * GetInt (self,&quot;pd&quot;) + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)\n                    msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)\n                    self&#46;defending = false\n                  }\n                  else if (self&#46;defending = false and enemy&#46;defending = true) {\n                    enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * GetInt (self,&quot;pd&quot;) / 2 + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)\n                    msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)\n                  }\n                  else if (self&#46;defending = false and enemy&#46;defending = false) {\n                    enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * GetInt (self,&quot;pd&quot;) + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)\n                    msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)\n                  }\n                }\n              }\n              case (&quot;Defend&quot;) {\n                if (self&#46;defending = false) {\n                  self&#46;defending = true\n                }\n              }\n              case (&quot;Cast&quot;) {\n                self&#46;defending = false\n              }\n              case (&quot;Item&quot;) {\n                self&#46;defending = false\n              }\n              case (&quot;Run&quot;) {\n                self&#46;defending = false\n              }\n            }\n            if (GetInt (enemy,&quot;cur_hp&quot;) &gt; 0) {\n\t\t\t  if ( RandomChance (GetInt (self,&quot;spd&quot;) - GetInt (enemy,&quot;spd&quot;))= true) {\n                msg (&quot;You get an extra battle turn!&quot;)\n                self_battle_turn (self,enemy)\n              }\n              else {\n                msg (&quot;Your battle turn is over&#46;&quot;)\n              }\n            }\n            else if (GetInt (enemy,&quot;cur_hp&quot;) &lt;= 0) {\n              msg (enemy&#46;alias + &quot; is dead&#46;&quot;)\n              msg (&quot;You have won the battle!&quot;)\n              enemy&#46;defending = false\n              enemy&#46;dead = true\n              }\n\n          }\n        }\n      &#93;&#93;&gt;&lt;/function&gt;\n      &lt;function name=&quot;enemy_battle_turn&quot; parameters=&quot;self,enemy&quot;&gt;&lt;!&#91;CDATA&#91;\n        msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)\n        msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)\n        result = GetRandomInt (1,3)\n        switch (result) {\n          case (1) {\n            sixth_value = false\n            if (RandomChance (GetInt (self,&quot;agi&quot;) - GetInt (enemy,&quot;spd&quot;)) = true) {\n              msg (&quot;You have evaded the attack!&quot;)\n              sixth_value = true\n            }\n            else if (RandomChance (GetInt (self,&quot;dex&quot;) - GetInt (enemy,&quot;agi&quot;)) = true) {\n              msg (&quot;You have parried the attack!&quot;)\n              sixth_value = true\n            }\n            else if (RandomChance (GetInt (self,&quot;agi&quot;) - GetInt (enemy,&quot;dex&quot;)) = true) {\n              msg (&quot;You have blocked the attack!&quot;)\n              sixth_value = true\n            }\n            else if (RandomChance (GetInt (enemy,&quot;dex&quot;) - GetInt (self,&quot;spd&quot;)) = false) {\n              msg (enemy&#46;alias +&quot;'s attack missed!&quot;)\n              sixth_value = true\n            }\n            else if (RandomChance (GetInt (self,&quot;pr&quot;) - GetInt (enemy,&quot;hc&quot;)) = true) {\n              msg (&quot;You resisted the attack!&quot;)\n              sixth_value = true\n            }\n            else if (sixth_value = false) {\n              if (enemy&#46;defending = true and self&#46;defending = true) {\n                self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * 2 * GetInt (enemy,&quot;pd&quot;) / 2 + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)\n                msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)\n                enemy&#46;defending = false\n              }\n              else if (enemy&#46;defending = true and self&#46;defending = false) {\n                self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * 2 * GetInt (enemy,&quot;pd&quot;) + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)\n                msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)\n                enemy&#46;defending = false\n              }\n              else if (enemy&#46;defending = false and self&#46;defending = true) {\n                self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * GetInt (enemy,&quot;pd&quot;) / 2 + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)\n                msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)\n              }\n              else if (enemy&#46;defending = false and self&#46;defending = false) {\n                self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * GetInt (enemy,&quot;pd&quot;) + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)\n                msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)\n              }\n            }\n          }\n          case (2) {\n            if (enemy&#46;defending = false) {\n              msg (enemy&#46;alias + &quot; has choosen to defend itself&#46;&quot;)\n              enemy&#46;defending = true\n            }\n          }\n          case (3) {\n            enemy&#46;defending = false\n            msg (&quot;Cast&quot;)\n          }\n        }\n        if (GetInt (self,&quot;cur_hp&quot;) &gt; 0) {\n          if (RandomChance (GetInt (enemy,&quot;spd&quot;) - GetInt (self,&quot;spd&quot;)) = true) {\n            msg (enemy&#46;alias + &quot; gets an extra battle turn!&quot;)\n            wait {\n              enemy_battle_turn (self,enemy)\n            }\n          }\n          else {\n            msg (enemy&#46;alias + &quot; 's battle turn is over&#46;&quot;)\n          }\n        }\n        else if (GetInt (self,&quot;cur_hp&quot;) &lt;= 0) {\n          msg (self&#46;alias + &quot; has died&#46;&quot;)\n          msg (&quot;GAME OVER&quot;)\n          finish\n        }\n      &#93;&#93;&gt;&lt;/function&gt;\n      &lt;function name=&quot;npc_reachable&quot; parameters=&quot;object&quot; type=&quot;boolean&quot;&gt;\n        value = false\n        foreach (x,ScopeReachableNotHeld ()) {\n          if (x=object) {\n            value = true\n          }\n        }\n        return (value)\n      &lt;/function&gt;\n      &lt;function name=&quot;crit_hit&quot; parameters=&quot;object&quot; type=&quot;int&quot;&gt;\n        if (RandomChance (GetInt (object,&quot;luck&quot;)) = true) {\n          value = 2\n        }\n        else {\n          value = 1\n        }\n        return (value)\n      &lt;/function&gt;\n    &lt;/asl&gt;[/code:p6uru59i]\n\n---------------------------\n\nP.S.\n\n(for v5.3 anyways)\n\ninstead of doing this:\n\n[code:p6uru59i]choices = NewStringList()\n    list add (choices, &quot;Attack&quot;)\n    list add (choices, &quot;Run&quot;)\n    ShowMenu (&quot;What will you do?&quot;, choices, false) {[/code:p6uru59i]\n\nyou can do this instead:\n\n(I added in a few more options, just for more of a visual of it)\n\n[code:p6uru59i]show menu (&quot;What will you do?&quot;, split (&quot;Attack;Defend;Cast;Item;Run&quot;,&quot;;&quot;), false) {[/code:p6uru59i]\n\n<!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/Split\">http://quest5.net/wiki/Split</a><!-- m -->\n\n.",
      "EditableFormat": "bbcode",
      "HTML": "this is what you need (full credit to Pertex):<br/><br/>(see the battle_system_function for the relevant code that you need, as you don't have to do it via a command, like I did)<br/><br/><pre><code>&lt;command name=&quot;fight_command&quot;&gt;<br/>  &lt;pattern&gt;fight #text#&lt;/pattern&gt;<br/>  &lt;script&gt;<br/>    battle_system_function (game&#46;pov,text)<br/>  &lt;/script&gt;<br/>&lt;/command&gt;<br/><br/>&lt;function name=&quot;battle_system_function&quot; parameters=&quot;self,text&quot;&gt;<br/>  target = GetObject (text)<br/>  if (target = null) {<br/>    foreach (obj,GetAllChildObjects(game&#46;pov&#46;parent)) {<br/>      if (obj&#46;alias=text) {<br/>        target = obj<br/>      } else {<br/>        msg (&quot;There seemingly is no &quot; + text + &quot; here&#46;&quot;)<br/>      }<br/>    }<br/>  }<br/>  your etc code<br/>&lt;/function&gt;</code></pre><br/><br/>--------------------------------------------------------<br/><br/>Pertex had further especially helped me out, with this fancy part of the above code by him:<br/><br/><pre><code>foreach (obj,GetAllChildObjects(game&#46;pov&#46;parent)) {<br/>      if (obj&#46;alias=text) {<br/>        target = obj</code></pre><br/><br/>the reason why I needed this is because the command uses what you type in, which is the object's ALIAS (ex. orc) as that is the label that the game player sees, however, the GetObject (object) function searches for an object that has that typed in label as it's NAME, and thus it can't find any object with that NAME (ex. orc). As the object's NAME is (ex. orc1), and not (ex.) &quot; orc &quot;.<br/><br/>if you're not using~having ALIASES, then you don't need this coding, but if you're using~having ALIASES, then you need this coding.<br/><br/>--------------------------------------------------------<br/><br/>if you want to see more &quot;combat code&quot;, let me know, or you can just find it in the thread (&quot;Noob HK's Help Me Thread&quot;) that I made.<br/><br/>actually, I'll post it here, so you can examine it, if you want to get some ideas and~or use it for your own code. Credit goes to Pertex, as I was basically make the same code structure as his combat library, with minor tweaks of my own to it, for making my code.<br/><br/>(this code is really messy, as I haven't &quot;streamlined&quot; it yet, so it still has some code lines and~or structure that isn't needed)<br/><br/><pre><code>&lt;asl version=&quot;530&quot;&gt;<br/>  &lt;include ref=&quot;English&#46;aslx&quot; /&gt;<br/>  &lt;include ref=&quot;Core&#46;aslx&quot; /&gt;<br/>  &lt;game name=&quot;Testing Game Stuff&quot;&gt;<br/>    &lt;gameid&gt;d83ba5bb-2e3c-4f31-80c9-3e88a2dc082c&lt;/gameid&gt;<br/>    &lt;version&gt;1&#46;0&lt;/version&gt;<br/>    &lt;pov type=&quot;object&quot;&gt;player&lt;/pov&gt;<br/>    &lt;start type=&quot;script&quot;&gt;<br/>      cc<br/>    &lt;/start&gt;<br/>    &lt;turns type=&quot;int&quot;&gt;0&lt;/turns&gt;<br/>    &lt;statusattributes type=&quot;stringdictionary&quot;&gt;turns = &lt;/statusattributes&gt;<br/>  &lt;/game&gt;<br/>  &lt;object name=&quot;room&quot;&gt;<br/>    &lt;inherit name=&quot;editor_room&quot; /&gt;<br/>    &lt;object name=&quot;player&quot;&gt;<br/>      &lt;inherit name=&quot;defaultplayer&quot; /&gt;<br/>      &lt;inherit name=&quot;pc&quot; /&gt;<br/>      &lt;cur_hp type=&quot;int&quot;&gt;999&lt;/cur_hp&gt;<br/>      &lt;max_hp type=&quot;int&quot;&gt;999&lt;/max_hp&gt;<br/>      &lt;str type=&quot;int&quot;&gt;100&lt;/str&gt;<br/>      &lt;end type=&quot;int&quot;&gt;100&lt;/end&gt;<br/>      &lt;dex type=&quot;int&quot;&gt;100&lt;/dex&gt;<br/>      &lt;agi type=&quot;int&quot;&gt;100&lt;/agi&gt;<br/>      &lt;spd type=&quot;int&quot;&gt;100&lt;/spd&gt;<br/>      &lt;hc type=&quot;int&quot;&gt;100&lt;/hc&gt;<br/>      &lt;pd type=&quot;int&quot;&gt;100&lt;/pd&gt;<br/>      &lt;pr type=&quot;int&quot;&gt;100&lt;/pr&gt;<br/>    &lt;/object&gt;<br/>    &lt;object name=&quot;orc1&quot;&gt;<br/>      &lt;inherit name=&quot;editor_object&quot; /&gt;<br/>      &lt;inherit name=&quot;npc&quot; /&gt;<br/>      &lt;hostile type=&quot;boolean&quot;&gt;true&lt;/hostile&gt;<br/>      &lt;dead type=&quot;boolean&quot;&gt;false&lt;/dead&gt;<br/>      &lt;alias&gt;orc&lt;/alias&gt;<br/>      &lt;cur_hp type=&quot;int&quot;&gt;999&lt;/cur_hp&gt;<br/>      &lt;max_hp type=&quot;int&quot;&gt;999&lt;/max_hp&gt;<br/>      &lt;str type=&quot;int&quot;&gt;25&lt;/str&gt;<br/>      &lt;end type=&quot;int&quot;&gt;25&lt;/end&gt;<br/>      &lt;dex type=&quot;int&quot;&gt;25&lt;/dex&gt;<br/>      &lt;agi type=&quot;int&quot;&gt;25&lt;/agi&gt;<br/>      &lt;spd type=&quot;int&quot;&gt;25&lt;/spd&gt;<br/>      &lt;hc type=&quot;int&quot;&gt;25&lt;/hc&gt;<br/>      &lt;pd type=&quot;int&quot;&gt;25&lt;/pd&gt;<br/>      &lt;pr type=&quot;int&quot;&gt;25&lt;/pr&gt;<br/>    &lt;/object&gt;<br/>  &lt;/object&gt;<br/>  &lt;turnscript name=&quot;game_turns&quot;&gt;<br/>    &lt;enabled /&gt;<br/>    &lt;script&gt;<br/>      sa<br/>      game&#46;turns = game&#46;turns + 1<br/>    &lt;/script&gt;<br/>  &lt;/turnscript&gt;<br/>  &lt;command name=&quot;fight&quot;&gt;<br/>    &lt;pattern&gt;fight #text#&lt;/pattern&gt;<br/>    &lt;script&gt;<br/>      battle_system (game&#46;pov,text)<br/>    &lt;/script&gt;<br/>  &lt;/command&gt;<br/>  &lt;type name=&quot;char&quot;&gt;<br/>    &lt;cur_hp type=&quot;int&quot;&gt;0&lt;/cur_hp&gt;<br/>    &lt;drop type=&quot;boolean&quot;&gt;false&lt;/drop&gt;<br/>    &lt;defending type=&quot;boolean&quot;&gt;false&lt;/defending&gt;<br/>    &lt;max_hp type=&quot;int&quot;&gt;0&lt;/max_hp&gt;<br/>    &lt;str type=&quot;int&quot;&gt;0&lt;/str&gt;<br/>    &lt;end type=&quot;int&quot;&gt;0&lt;/end&gt;<br/>    &lt;dex type=&quot;int&quot;&gt;0&lt;/dex&gt;<br/>    &lt;agi type=&quot;int&quot;&gt;0&lt;/agi&gt;<br/>    &lt;spd type=&quot;int&quot;&gt;0&lt;/spd&gt;<br/>    &lt;hp type=&quot;int&quot;&gt;0&lt;/hp&gt;<br/>    &lt;hc type=&quot;int&quot;&gt;0&lt;/hc&gt;<br/>    &lt;pd type=&quot;int&quot;&gt;0&lt;/pd&gt;<br/>    &lt;pr type=&quot;int&quot;&gt;0&lt;/pr&gt;<br/>  &lt;/type&gt;<br/>  &lt;type name=&quot;pc&quot;&gt;<br/>    &lt;inherit name=&quot;char&quot; /&gt;<br/>    &lt;statusattributes type=&quot;stringdictionary&quot;&gt;hp = ;str = ;end = ;dex = ;agi = ;spd = ;hc = ;pd = ;pr = &lt;/statusattributes&gt;<br/>  &lt;/type&gt;<br/>  &lt;type name=&quot;npc&quot;&gt;<br/>    &lt;inherit name=&quot;char&quot; /&gt;<br/>    &lt;dead type=&quot;boolean&quot;&gt;false&lt;/dead&gt;<br/>    &lt;hostile type=&quot;boolean&quot;&gt;false&lt;/hostile&gt;<br/>    &lt;displayverbs type=&quot;list&quot;&gt;Look at; Talk; Fight&lt;/displayverbs&gt;<br/>  &lt;/type&gt;<br/>  &lt;function name=&quot;cc&quot;&gt;<br/>    msg (&quot;What is your name?&quot;)<br/>    get input {<br/>      game&#46;pov&#46;alias = result<br/>      msg (&quot; - &quot; + game&#46;pov&#46;alias)<br/>      show menu (&quot;What is your gender?&quot;, split (&quot;male;female&quot; , &quot;;&quot;), false) {<br/>        game&#46;pov&#46;gender = result<br/>        show menu (&quot;What is your race?&quot;, split (&quot;human;dwarf;elf&quot; , &quot;;&quot;), false) {<br/>          game&#46;pov&#46;race = result<br/>          show menu (&quot;What is your class?&quot;, split (&quot;warrior;cleric;mage;thief&quot; , &quot;;&quot;), false) {<br/>            game&#46;pov&#46;class = result<br/>            msg (game&#46;pov&#46;alias + &quot; is a &quot; + game&#46;pov&#46;gender + &quot; &quot; + game&#46;pov&#46;race + &quot; &quot; + game&#46;pov&#46;class + &quot;&#46;&quot;)<br/>            wait {<br/>              ClearScreen<br/>            }<br/>          }<br/>        }<br/>      }<br/>    }<br/>  &lt;/function&gt;<br/>  &lt;function name=&quot;sa&quot;&gt;<br/>    game&#46;pov&#46;hp = game&#46;pov&#46;cur_hp + &quot; / &quot; + game&#46;pov&#46;max_hp<br/>  &lt;/function&gt;<br/>  &lt;function name=&quot;battle_system&quot; parameters=&quot;self,text&quot; type=&quot;boolean&quot;&gt;<br/>    first_value = false<br/>    enemy = GetObject (text)<br/>    if (enemy = null) {<br/>      foreach (obj,AllObjects()) {<br/>        if (obj&#46;alias=text) {<br/>          enemy = obj<br/>        }<br/>      }<br/>    }<br/>    if (enemy = null) {<br/>      msg (&quot;There is no &quot; + text + &quot; here&#46;&quot;)<br/>      first_value = false<br/>    }<br/>    else if (not Doesinherit (enemy,&quot;npc&quot;)) {<br/>      msg (&quot;You can not battle that!&quot;)<br/>      first_value = false<br/>    }<br/>    else if (not npc_reachable (enemy)) {<br/>      msg (&quot;There is no &quot; + enemy&#46;alias + &quot; in your vicinity&#46;&quot;)<br/>      first_value = false<br/>    }<br/>    else if (GetBoolean (enemy,&quot;dead&quot;) = true) {<br/>      msg (enemy&#46;alias + &quot; is already dead&#46;&quot;)<br/>      first_value = false<br/>    }<br/>    else if (GetBoolean (enemy,&quot;hostile&quot;) = false) {<br/>      msg (enemy&#46;alias + &quot; is not hostile&#46;&quot;)<br/>      first_value = false<br/>    }<br/>    else if (battle_sequence (self,enemy) = true) {<br/>      msg (&quot;The battle is over&#46;&quot;)<br/>      first_value = true<br/>    }<br/>    return (first_value)<br/>  &lt;/function&gt;<br/>  &lt;function name=&quot;battle_sequence&quot; parameters=&quot;self,enemy&quot; type=&quot;boolean&quot;&gt;&lt;!&#91;CDATA&#91;<br/>    second_value = false<br/>    if (enemy&#46;dead = false) {<br/>      if (GetInt (self,&quot;spd&quot;) &gt; GetInt (enemy,&quot;spd&quot;)) {<br/>        on ready {<br/>          msg (&quot;You get to go first for this round&quot;)<br/>          if (self_battle_turn (self,enemy) = true) {<br/>            battle_sequence (self,enemy)<br/>          }<br/>        }<br/>        on ready {<br/>          if (enemy&#46;dead = false) {<br/>            if (enemy_battle_turn (self,enemy) = true) {<br/>              msg (&quot;The round has ended&#46;&quot;)<br/>            }<br/>          }<br/>        }<br/>        on ready {<br/>          battle_sequence (self,enemy)<br/>        }<br/>      }<br/>      else if (GetInt (self,&quot;spd&quot;) &lt; GetInt (enemy,&quot;spd&quot;)) {<br/>        on ready {<br/>          msg (enemy&#46;alias + &quot; gets to go first for this round&#46;&quot;)<br/>          if (enemy_battle_turn (self,enemy) = true) {<br/>            msg (&quot;It is now your turn&#46;&quot;)<br/>          }<br/>        }<br/>        on ready {<br/>          if (self_battle_turn (self,enemy) = true) {<br/>            battle_sequence (self,enemy)<br/>          }<br/>          else {<br/>            msg (&quot;The round has ended&#46;&quot;)<br/>          }<br/>        }<br/>        on ready {<br/>          battle_sequence (self,enemy)<br/>        }<br/>      }<br/>      else if (GetInt (self,&quot;spd&quot;) = GetInt (enemy,&quot;spd&quot;)) {<br/>        if (RandomChance (50) = true) {<br/>          on ready {<br/>            msg (&quot;You get to go first for this round&quot;)<br/>            if (self_battle_turn (self,enemy) = true) {<br/>              battle_sequence (self,enemy)<br/>            }<br/>          }<br/>          on ready {<br/>            if (enemy_battle_turn (self,enemy) = true) {<br/>              msg (&quot;The round has ended&#46;&quot;)<br/>            }<br/>          }<br/>          on ready {<br/>            battle_sequence (self,enemy)<br/>          }<br/>        }<br/>        else {<br/>          on ready {<br/>            msg (enemy&#46;alias + &quot; gets to go first for this round&#46;&quot;)<br/>            if (enemy_battle_turn (self,enemy) = true) {<br/>              msg (&quot;It is now your turn&#46;&quot;)<br/>            }<br/>          }<br/>          on ready {<br/>            if (self_battle_turn (self,enemy) = true) {<br/>              battle_sequence (self,enemy)<br/>            }<br/>            else {<br/>              msg (&quot;The round has ended&#46;&quot;)<br/>            }<br/>          }<br/>          on ready {<br/>            battle_sequence (self,enemy)<br/>          }<br/>        }<br/>      }<br/>    }<br/>    else {<br/>      second_value = true<br/>    }<br/>    return (second_value)<br/>  &#93;&#93;&gt;&lt;/function&gt;<br/>  &lt;function name=&quot;self_battle_turn&quot; parameters=&quot;self,enemy&quot; type=&quot;boolean&quot;&gt;&lt;!&#91;CDATA&#91;<br/>    third_value = false<br/>    msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>    msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>    wait {<br/>      show menu (&quot;What is your battle choice?&quot;, split (&quot;Attack;Defend;Cast;Item;Run&quot;, &quot;;&quot;), false) {<br/>        switch (result) {<br/>          case (&quot;Attack&quot;) {<br/>            fourth_value = false<br/>            if (RandomChance (GetInt (enemy,&quot;agi&quot;) - GetInt (self,&quot;spd&quot;)) = true) {<br/>              msg (enemy&#46;alias + &quot;evaded your attack!&quot;)<br/>              fourth_value = true<br/>            }<br/>            else if (RandomChance (GetInt (enemy,&quot;Dex&quot;) - GetInt (self,&quot;agi&quot;)) = true) {<br/>              msg (enemy&#46;alias + &quot;parried your attack!&quot;)<br/>              fourth_value = true<br/>            }<br/>            else if (RandomChance (GetInt (enemy,&quot;agi&quot;) - GetInt (self,&quot;dex&quot;)) = true) {<br/>              msg (enemy&#46;alias + &quot;blocked your attack!&quot;)<br/>              fourth_value = true<br/>            }<br/>            else if (RandomChance (GetInt (self,&quot;dex&quot;) - GetInt (enemy,&quot;spd&quot;)) = false) {<br/>              msg (&quot;Your attack missed &quot; + enemy&#46;alias +&quot;!&quot;)<br/>              fourth_value = true<br/>            }<br/>            else if (RandomChance (GetInt (enemy,&quot;pr&quot;) - GetInt (self,&quot;hc&quot;)) = true) {<br/>              msg (&quot;Your attack got resisted by &quot; + enemy&#46;alias +&quot;!&quot;)<br/>              fourth_value = true<br/>            }<br/>            else if (fourth_value = false) {<br/>              if (self&#46;defending = true and enemy&#46;defending = true) {<br/>                enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * 2 * GetInt (self,&quot;pd&quot;) / 2 + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)<br/>                msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>                self&#46;defending = false<br/>              }<br/>              else if (self&#46;defending = true and enemy&#46;defending = false) {<br/>                enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * 2 * GetInt (self,&quot;pd&quot;) + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)<br/>                msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>                self&#46;defending = false<br/>              }<br/>              else if (self&#46;defending = false and enemy&#46;defending = true) {<br/>                enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * GetInt (self,&quot;pd&quot;) / 2 + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)<br/>                msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>              }<br/>              else if (self&#46;defending = false and enemy&#46;defending = false) {<br/>                enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * GetInt (self,&quot;pd&quot;) + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)<br/>                msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>              }<br/>            }<br/>          }<br/>          case (&quot;Defend&quot;) {<br/>            if (self&#46;defending = false) {<br/>              self&#46;defending = true<br/>            }<br/>          }<br/>          case (&quot;Cast&quot;) {<br/>            self&#46;defending = false<br/>          }<br/>          case (&quot;Item&quot;) {<br/>            self&#46;defending = false<br/>          }<br/>          case (&quot;Run&quot;) {<br/>            self&#46;defending = false<br/>          }<br/>        }<br/>        if (GetInt (enemy,&quot;cur_hp&quot;) &gt; 0) {<br/>          if (RandomChance (GetInt (self,&quot;spd&quot;) - GetInt (enemy,&quot;spd&quot;)) = true) {<br/>            msg (&quot;You get an extra battle turn!&quot;)<br/>            self_battle_turn (self,enemy)<br/>          }<br/>          else {<br/>            msg (&quot;Your battle turn is over&#46;&quot;)<br/>            third_value = false<br/>          }<br/>        }<br/>        else if (GetInt (enemy,&quot;cur_hp&quot;) &lt;= 0) {<br/>          msg (enemy&#46;alias + &quot; is dead&#46;&quot;)<br/>          msg (&quot;You have won the battle!&quot;)<br/>          enemy&#46;defending = false<br/>          enemy&#46;dead = true<br/>          third_value = true<br/>          wait {<br/>            ClearScreen<br/>          }<br/>        }<br/>      }<br/>    }<br/>    return (third_value)<br/>  &#93;&#93;&gt;&lt;/function&gt;<br/>  &lt;function name=&quot;enemy_battle_turn&quot; parameters=&quot;self,enemy&quot; type=&quot;boolean&quot;&gt;&lt;!&#91;CDATA&#91;<br/>    fifth_value = false<br/>    msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>    msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>    result = GetRandomInt (1,3)<br/>    switch (result) {<br/>      case (1) {<br/>        sixth_value = false<br/>        if (RandomChance (GetInt (self,&quot;agi&quot;) - GetInt (enemy,&quot;spd&quot;)) = true) {<br/>          msg (&quot;You have evaded the attack!&quot;)<br/>          sixth_value = true<br/>        }<br/>        else if (RandomChance (GetInt (self,&quot;dex&quot;) - GetInt (enemy,&quot;agi&quot;)) = true) {<br/>          msg (&quot;You have parried the attack!&quot;)<br/>          sixth_value = true<br/>        }<br/>        else if (RandomChance (GetInt (self,&quot;agi&quot;) - GetInt (enemy,&quot;dex&quot;)) = true) {<br/>          msg (&quot;You have blocked the attack!&quot;)<br/>          sixth_value = true<br/>        }<br/>        else if (RandomChance (GetInt (enemy,&quot;dex&quot;) - GetInt (self,&quot;spd&quot;)) = false) {<br/>          msg (enemy&#46;alias +&quot;'s attack missed!&quot;)<br/>          sixth_value = true<br/>        }<br/>        else if (RandomChance (GetInt (self,&quot;pr&quot;) - GetInt (enemy,&quot;hc&quot;)) = true) {<br/>          msg (&quot;You resisted the attack!&quot;)<br/>          sixth_value = true<br/>        }<br/>        else if (sixth_value = false) { <br/>          if (enemy&#46;defending = true and self&#46;defending = true) {<br/>            self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * 2 * GetInt (enemy,&quot;pd&quot;) / 2 + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)<br/>            msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>            enemy&#46;defending = false<br/>          }<br/>          else if (enemy&#46;defending = true and self&#46;defending = false) {<br/>            self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * 2 * GetInt (enemy,&quot;pd&quot;) + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)<br/>            msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>            enemy&#46;defending = false<br/>          }<br/>          else if (enemy&#46;defending = false and self&#46;defending = true) {<br/>            self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * GetInt (enemy,&quot;pd&quot;) / 2 + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)<br/>            msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>          }<br/>          else if (enemy&#46;defending = false and self&#46;defending = false) {<br/>            self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * GetInt (enemy,&quot;pd&quot;) + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)<br/>            msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>          }<br/>        }<br/>      }<br/>      case (2) {<br/>        if (enemy&#46;defending = false) {<br/>          msg (enemy&#46;alias + &quot; has choosen to defend itself&#46;&quot;)<br/>          enemy&#46;defending = true<br/>        }<br/>      }<br/>      case (3) {<br/>        enemy&#46;defending = false<br/>        msg (&quot;Cast&quot;)<br/>      }<br/>    }<br/>    if (GetInt (self,&quot;cur_hp&quot;) &gt; 0) {<br/>      if (RandomChance (GetInt (enemy,&quot;spd&quot;) - GetInt (self,&quot;spd&quot;)) = true) {<br/>        msg (enemy&#46;alias + &quot; gets an extra battle turn!&quot;)<br/>        wait {<br/>          enemy_battle_turn (self,enemy)<br/>        }<br/>      }<br/>      else {<br/>        msg (enemy&#46;alias + &quot; 's battle turn is over&#46;&quot;)<br/>        fifth_value = true<br/>      }<br/>    }<br/>    else if (GetInt (self,&quot;cur_hp&quot;) &lt;= 0) {<br/>      msg (self&#46;alias + &quot; has died&#46;&quot;)<br/>      msg (&quot;GAME OVER&quot;)<br/>      finish<br/>    }<br/>    return (fifth_value)<br/>  &#93;&#93;&gt;&lt;/function&gt;<br/>  &lt;function name=&quot;npc_reachable&quot; parameters=&quot;object&quot; type=&quot;boolean&quot;&gt;<br/>    value = false<br/>    foreach (x,ScopeReachableNotHeld ()) {<br/>      if (x=object) {<br/>        value = true<br/>      }<br/>    }<br/>    return (value)<br/>  &lt;/function&gt;<br/>  &lt;function name=&quot;crit_hit&quot; parameters=&quot;object&quot; type=&quot;int&quot;&gt;<br/>    if (RandomChance (GetInt (object,&quot;luck&quot;)) = true) {<br/>      value = 2<br/>    }<br/>    else {<br/>      value = 1<br/>    }<br/>    return (value)<br/>  &lt;/function&gt;<br/>&lt;/asl&gt;</code></pre><br/><br/>and here's the key~legend for the terms and~or abreviations that I used for it:<br/><br/><pre><code>01&#46; cc = character creation function<br/>02&#46; sa = status attributes (mainly for implementing/displaying of ' cur / max ' stats) function<br/>03&#46; char = character object type (&quot;pcs&quot;, &quot;npcs&quot;, &quot;monsters&quot;, etc&#46;, so, not a room, item, equipment, spell, etc)<br/>04&#46; pc = playable character object type (&quot;player&quot; characters / game&#46;povs)<br/>05&#46; npc = non-playable character (&quot;people&quot;, &quot;monsters&quot;, and etc, so not a &quot;player&quot; character / not a game&#46;pov, I'm going to have a hostility system, so any npc can be friendly or hostile, instead of having an actual &quot;monster/enemy&quot; type set aside)<br/>06&#46; hp = hit points (life) stat attribute<br/>07&#46; mp = mana points (magic) stat attribute<br/>08&#46; str = strength (physical damage, carry weight / equipment requirement, etc) stat attribute<br/>09&#46; end = endurance (physical defense, and etc) stat attribute<br/>10&#46; dex = dexterity (weapon~attack skill, think of this as &quot;if your attack connects or not, do you 'whiff' or not&quot;, so not to gete confused with hc, and etc) stat attribute<br/>11&#46; agi = agility (dodging/evading, and etc) stat attribute<br/>12&#46; spd = speed (who goes first in battle, extra battle turns, escaping from battle, and etc) stat attribute<br/>13&#46; hc = hit chance (think of this more as piercing their armor or not, so not to get confused with dex, and etc) stat attribute<br/>14&#46; pd = physical damage stat attribute<br/>15&#46; fp = fire damage stat attribute<br/>16&#46; wp = water damage stat attribute<br/>17&#46; ap = air damage stat attribute<br/>18&#46; ed = earth damage stat attribute<br/>19&#46; ld = light damage stat attribute<br/>20&#46; dd = dark damage stat attribute<br/>21&#46; pr = physical resistance stat attribute<br/>22&#46; fr = fire resistance stat attribute<br/>23&#46; wr = water resistance stat attribute<br/>24&#46; ar = air resistance stat attribute<br/>25&#46; er = earth resistance stat attribute<br/>26&#46; lr = light resistance stat attribute<br/>27&#46; dr = dark resistance stat attribute<br/>28&#46; defending = boolean (reduces damage done for that character and increases the damage done by that character, if they chosoe to attack on the next turn)<br/>29&#46; escaped = boolean, run from battle (not completed/implemented yet)<br/>30&#46; hostile = boolean, any npc can be friendly or a(n) &quot;monster/enemy&quot;, based upon a hostility scale (0-100), but not completed<br/>31&#46; dead = boolean<br/>32&#46; crit_hit = critical hit (bonus damage based upon luck)<br/>33&#46; luck = luck stat attribute<br/>34&#46; lvl = level stat attribute<br/>35&#46; exp = experience stat attribute<br/>36&#46; cash = cash stat attribute (currency)<br/>37&#46; lvlup = level up function</code></pre><br/><br/>but here's Pertex' work in streamlining my code for me:<br/><br/><pre><code>    &lt;asl version=&quot;530&quot;&gt;<br/>      &lt;include ref=&quot;English&#46;aslx&quot; /&gt;<br/>      &lt;include ref=&quot;Core&#46;aslx&quot; /&gt;<br/>      &lt;game name=&quot;Test&quot;&gt;<br/>        &lt;gameid&gt;d83ba5bb-2e3c-4f31-80c9-3e88a2dc082c&lt;/gameid&gt;<br/>        &lt;version&gt;1&#46;0&lt;/version&gt;<br/>        &lt;pov type=&quot;object&quot;&gt;player&lt;/pov&gt;<br/>        &lt;start type=&quot;script&quot;&gt;<br/>          cc<br/>        &lt;/start&gt;<br/>        &lt;turns type=&quot;int&quot;&gt;0&lt;/turns&gt;<br/>        &lt;statusattributes type=&quot;stringdictionary&quot;&gt;turns = &lt;/statusattributes&gt;<br/>      &lt;/game&gt;<br/>      &lt;object name=&quot;room&quot;&gt;<br/>        &lt;inherit name=&quot;editor_room&quot; /&gt;<br/>        &lt;object name=&quot;player&quot;&gt;<br/>          &lt;inherit name=&quot;defaultplayer&quot; /&gt;<br/>          &lt;inherit name=&quot;pc&quot; /&gt;<br/>          &lt;cur_hp type=&quot;int&quot;&gt;999&lt;/cur_hp&gt;<br/>          &lt;max_hp type=&quot;int&quot;&gt;999&lt;/max_hp&gt;<br/>          &lt;str type=&quot;int&quot;&gt;100&lt;/str&gt;<br/>          &lt;end type=&quot;int&quot;&gt;100&lt;/end&gt;<br/>          &lt;dex type=&quot;int&quot;&gt;100&lt;/dex&gt;<br/>          &lt;agi type=&quot;int&quot;&gt;100&lt;/agi&gt;<br/>          &lt;spd type=&quot;int&quot;&gt;100&lt;/spd&gt;<br/>          &lt;hc type=&quot;int&quot;&gt;100&lt;/hc&gt;<br/>          &lt;pd type=&quot;int&quot;&gt;100&lt;/pd&gt;<br/>          &lt;pr type=&quot;int&quot;&gt;100&lt;/pr&gt;<br/>        &lt;/object&gt;<br/>        &lt;object name=&quot;orc1&quot;&gt;<br/>          &lt;inherit name=&quot;editor_object&quot; /&gt;<br/>          &lt;inherit name=&quot;npc&quot; /&gt;<br/>          &lt;hostile type=&quot;boolean&quot;&gt;true&lt;/hostile&gt;<br/>          &lt;dead type=&quot;boolean&quot;&gt;false&lt;/dead&gt;<br/>          &lt;alias&gt;orc&lt;/alias&gt;<br/>          &lt;cur_hp type=&quot;int&quot;&gt;999&lt;/cur_hp&gt;<br/>          &lt;max_hp type=&quot;int&quot;&gt;999&lt;/max_hp&gt;<br/>          &lt;str type=&quot;int&quot;&gt;25&lt;/str&gt;<br/>          &lt;end type=&quot;int&quot;&gt;25&lt;/end&gt;<br/>          &lt;dex type=&quot;int&quot;&gt;25&lt;/dex&gt;<br/>          &lt;agi type=&quot;int&quot;&gt;25&lt;/agi&gt;<br/>          &lt;spd type=&quot;int&quot;&gt;25&lt;/spd&gt;<br/>          &lt;hc type=&quot;int&quot;&gt;25&lt;/hc&gt;<br/>          &lt;pd type=&quot;int&quot;&gt;25&lt;/pd&gt;<br/>          &lt;pr type=&quot;int&quot;&gt;25&lt;/pr&gt;<br/>        &lt;/object&gt;<br/>      &lt;/object&gt;<br/>      &lt;turnscript name=&quot;game_turns&quot;&gt;<br/>        &lt;enabled /&gt;<br/>        &lt;script&gt;<br/>          sa<br/>          game&#46;turns = game&#46;turns + 1<br/>        &lt;/script&gt;<br/>      &lt;/turnscript&gt;<br/>      &lt;command name=&quot;fight&quot;&gt;<br/>        &lt;pattern&gt;fight #text#&lt;/pattern&gt;<br/>        &lt;script&gt;<br/>          battle_system (game&#46;pov,text)<br/>        &lt;/script&gt;<br/>      &lt;/command&gt;<br/>      &lt;type name=&quot;char&quot;&gt;<br/>        &lt;cur_hp type=&quot;int&quot;&gt;0&lt;/cur_hp&gt;<br/>        &lt;drop type=&quot;boolean&quot;&gt;false&lt;/drop&gt;<br/>        &lt;defending type=&quot;boolean&quot;&gt;false&lt;/defending&gt;<br/>        &lt;max_hp type=&quot;int&quot;&gt;0&lt;/max_hp&gt;<br/>        &lt;str type=&quot;int&quot;&gt;0&lt;/str&gt;<br/>        &lt;end type=&quot;int&quot;&gt;0&lt;/end&gt;<br/>        &lt;dex type=&quot;int&quot;&gt;0&lt;/dex&gt;<br/>        &lt;agi type=&quot;int&quot;&gt;0&lt;/agi&gt;<br/>        &lt;spd type=&quot;int&quot;&gt;0&lt;/spd&gt;<br/>        &lt;hp type=&quot;int&quot;&gt;0&lt;/hp&gt;<br/>        &lt;hc type=&quot;int&quot;&gt;0&lt;/hc&gt;<br/>        &lt;pd type=&quot;int&quot;&gt;0&lt;/pd&gt;<br/>        &lt;pr type=&quot;int&quot;&gt;0&lt;/pr&gt;<br/>      &lt;/type&gt;<br/>      &lt;type name=&quot;pc&quot;&gt;<br/>        &lt;inherit name=&quot;char&quot; /&gt;<br/>        &lt;statusattributes type=&quot;stringdictionary&quot;&gt;hp = ;str = ;end = ;dex = ;agi = ;spd = ;hc = ;pd = ;pr = &lt;/statusattributes&gt;<br/>      &lt;/type&gt;<br/>      &lt;type name=&quot;npc&quot;&gt;<br/>        &lt;inherit name=&quot;char&quot; /&gt;<br/>        &lt;dead type=&quot;boolean&quot;&gt;false&lt;/dead&gt;<br/>        &lt;hostile type=&quot;boolean&quot;&gt;false&lt;/hostile&gt;<br/>        &lt;displayverbs type=&quot;list&quot;&gt;Look at; Talk; Fight&lt;/displayverbs&gt;<br/>      &lt;/type&gt;<br/>      &lt;function name=&quot;cc&quot;&gt;<br/>        msg (&quot;What is your name?&quot;)<br/>        get input {<br/>          game&#46;pov&#46;alias = result<br/>          msg (&quot; - &quot; + game&#46;pov&#46;alias)<br/>          show menu (&quot;What is your gender?&quot;, split (&quot;male;female&quot; , &quot;;&quot;), false) {<br/>            game&#46;pov&#46;gender = result<br/>            show menu (&quot;What is your race?&quot;, split (&quot;human;dwarf;elf&quot; , &quot;;&quot;), false) {<br/>              game&#46;pov&#46;race = result<br/>              show menu (&quot;What is your class?&quot;, split (&quot;warrior;cleric;mage;thief&quot; , &quot;;&quot;), false) {<br/>                game&#46;pov&#46;class = result<br/>                msg (game&#46;pov&#46;alias + &quot; is a &quot; + game&#46;pov&#46;gender + &quot; &quot; + game&#46;pov&#46;race + &quot; &quot; + game&#46;pov&#46;class + &quot;&#46;&quot;)<br/>                wait {<br/>                  ClearScreen<br/>\t\t\t\t  <br/>                }<br/>              }<br/>            }<br/>          }<br/>        }<br/>      &lt;/function&gt;<br/>      &lt;function name=&quot;sa&quot;&gt;<br/>        game&#46;pov&#46;hp = game&#46;pov&#46;cur_hp + &quot; / &quot; + game&#46;pov&#46;max_hp<br/>      &lt;/function&gt;<br/>      &lt;function name=&quot;battle_system&quot; parameters=&quot;self,text&quot;&gt;<br/>        enemy = GetObject (text)<br/>        if (enemy = null) {<br/>          foreach (obj,AllObjects()) {<br/>            if (obj&#46;alias=text) {<br/>              enemy = obj<br/>            }<br/>          }<br/>        }<br/>        if (enemy = null) {<br/>          msg (&quot;There is no &quot; + text + &quot; here&#46;&quot;)<br/>        }<br/>        else if (not Doesinherit (enemy,&quot;npc&quot;)) {<br/>          msg (&quot;You can not battle that!&quot;)<br/>        }<br/>        else if (not npc_reachable (enemy)) {<br/>          msg (&quot;There is no &quot; + enemy&#46;alias + &quot; in your vicinity&#46;&quot;)<br/>        }<br/>        else if (GetBoolean (enemy,&quot;dead&quot;) = true) {<br/>          msg (enemy&#46;alias + &quot; is already dead&#46;&quot;)<br/>        }<br/>        else if (GetBoolean (enemy,&quot;hostile&quot;) = false) {<br/>          msg (enemy&#46;alias + &quot; is not hostile&#46;&quot;)<br/>        }<br/>        else {<br/>\t\t\tbattle_sequence (self,enemy)<br/>    \t} <br/><br/>      &lt;/function&gt;<br/>      &lt;function name=&quot;battle_sequence&quot; parameters=&quot;self,enemy&quot;&gt;&lt;!&#91;CDATA&#91;<br/>\t\tif (enemy&#46;dead = false) {<br/>\t\t\tplayerfirst=false<br/>\t\t\tif (GetInt (self,&quot;spd&quot;) &gt; GetInt (enemy,&quot;spd&quot;)) {<br/>\t\t\t\tplayerfirst=true<br/>\t\t\t} else if (GetInt (self,&quot;spd&quot;) = GetInt (enemy,&quot;spd&quot;) and RandomChance (50)) {<br/>\t\t\t\tplayerfirst=true<br/>\t\t\t}   \t\t  <br/>\t\t\t<br/>\t\t\tif (playerfirst) {<br/>\t\t\t   msg (&quot;You get to go first for this round&quot;)<br/>\t\t\t   self_battle_turn (self,enemy) <br/>\t\t\t   on ready {<br/>\t\t\t\t if (not enemy&#46;dead){<br/>\t\t\t\t   enemy_battle_turn (self,enemy) <br/>\t\t\t\t }<br/>\t\t\t   }<br/>\t\t\t} else {<br/>\t\t\t   msg (enemy&#46;alias + &quot; gets to go first for this round&#46;&quot;)<br/>\t\t\t\tenemy_battle_turn (self,enemy) <br/>\t\t\t\tmsg (&quot;It is now your turn&#46;&quot;)<br/>\t\t\t\tself_battle_turn (self,enemy) <br/>\t\t\t}<br/>\t\t\ton ready {<br/>\t\t\t\tmsg (&quot;The round has ended&#46;&quot;)<br/>\t\t\t\tmsg(&quot;&quot;)  <br/>\t\t\t\tbattle_sequence (self,enemy)\t<br/>\t\t\t}\t<br/>        } \telse { <br/>\t\t\t\tmsg (&quot;The battle is over&#46;&quot;)<br/>        }<br/>      &#93;&#93;&gt;&lt;/function&gt;<br/>      &lt;function name=&quot;self_battle_turn&quot; parameters=&quot;self,enemy&quot;&gt;&lt;!&#91;CDATA&#91;<br/>\t\tmsg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>        msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>        wait {<br/>          show menu (&quot;What is your battle choice?&quot;, split (&quot;Attack;Defend;Cast;Item;Run&quot;, &quot;;&quot;), false) {<br/>            switch (result) {<br/>              case (&quot;Attack&quot;) {<br/>                fourth_value = false<br/>                if (RandomChance (GetInt (enemy,&quot;agi&quot;) - GetInt (self,&quot;spd&quot;)) = true) {<br/>                  msg (enemy&#46;alias + &quot;evaded your attack!&quot;)<br/>                  fourth_value = true<br/>                }<br/>                else if (RandomChance (GetInt (enemy,&quot;Dex&quot;) - GetInt (self,&quot;agi&quot;)) = true) {<br/>                  msg (enemy&#46;alias + &quot;parried your attack!&quot;)<br/>                  fourth_value = true<br/>                }<br/>                else if (RandomChance (GetInt (enemy,&quot;agi&quot;) - GetInt (self,&quot;dex&quot;)) = true) {<br/>                  msg (enemy&#46;alias + &quot;blocked your attack!&quot;)<br/>                  fourth_value = true<br/>                }<br/>                else if (RandomChance (GetInt (self,&quot;dex&quot;) - GetInt (enemy,&quot;spd&quot;)) = false) {<br/>                  msg (&quot;Your attack missed &quot; + enemy&#46;alias +&quot;!&quot;)<br/>                  fourth_value = true<br/>                }<br/>                else if (RandomChance (GetInt (enemy,&quot;pr&quot;) - GetInt (self,&quot;hc&quot;)) = true) {<br/>                  msg (&quot;Your attack got resisted by &quot; + enemy&#46;alias +&quot;!&quot;)<br/>                  fourth_value = true<br/>                }<br/>                else if (fourth_value = false) {<br/>                  if (self&#46;defending = true and enemy&#46;defending = true) {<br/>                    enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * 2 * GetInt (self,&quot;pd&quot;) / 2 + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)<br/>                    msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>                    self&#46;defending = false<br/>                  }<br/>                  else if (self&#46;defending = true and enemy&#46;defending = false) {<br/>                    enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * 2 * GetInt (self,&quot;pd&quot;) + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)<br/>                    msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>                    self&#46;defending = false<br/>                  }<br/>                  else if (self&#46;defending = false and enemy&#46;defending = true) {<br/>                    enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * GetInt (self,&quot;pd&quot;) / 2 + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)<br/>                    msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>                  }<br/>                  else if (self&#46;defending = false and enemy&#46;defending = false) {<br/>                    enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * GetInt (self,&quot;pd&quot;) + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)<br/>                    msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>                  }<br/>                }<br/>              }<br/>              case (&quot;Defend&quot;) {<br/>                if (self&#46;defending = false) {<br/>                  self&#46;defending = true<br/>                }<br/>              }<br/>              case (&quot;Cast&quot;) {<br/>                self&#46;defending = false<br/>              }<br/>              case (&quot;Item&quot;) {<br/>                self&#46;defending = false<br/>              }<br/>              case (&quot;Run&quot;) {<br/>                self&#46;defending = false<br/>              }<br/>            }<br/>            if (GetInt (enemy,&quot;cur_hp&quot;) &gt; 0) {<br/>\t\t\t  if ( RandomChance (GetInt (self,&quot;spd&quot;) - GetInt (enemy,&quot;spd&quot;))= true) {<br/>                msg (&quot;You get an extra battle turn!&quot;)<br/>                self_battle_turn (self,enemy)<br/>              }<br/>              else {<br/>                msg (&quot;Your battle turn is over&#46;&quot;)<br/>              }<br/>            }<br/>            else if (GetInt (enemy,&quot;cur_hp&quot;) &lt;= 0) {<br/>              msg (enemy&#46;alias + &quot; is dead&#46;&quot;)<br/>              msg (&quot;You have won the battle!&quot;)<br/>              enemy&#46;defending = false<br/>              enemy&#46;dead = true<br/>              }<br/><br/>          }<br/>        }<br/>      &#93;&#93;&gt;&lt;/function&gt;<br/>      &lt;function name=&quot;enemy_battle_turn&quot; parameters=&quot;self,enemy&quot;&gt;&lt;!&#91;CDATA&#91;<br/>        msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>        msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>        result = GetRandomInt (1,3)<br/>        switch (result) {<br/>          case (1) {<br/>            sixth_value = false<br/>            if (RandomChance (GetInt (self,&quot;agi&quot;) - GetInt (enemy,&quot;spd&quot;)) = true) {<br/>              msg (&quot;You have evaded the attack!&quot;)<br/>              sixth_value = true<br/>            }<br/>            else if (RandomChance (GetInt (self,&quot;dex&quot;) - GetInt (enemy,&quot;agi&quot;)) = true) {<br/>              msg (&quot;You have parried the attack!&quot;)<br/>              sixth_value = true<br/>            }<br/>            else if (RandomChance (GetInt (self,&quot;agi&quot;) - GetInt (enemy,&quot;dex&quot;)) = true) {<br/>              msg (&quot;You have blocked the attack!&quot;)<br/>              sixth_value = true<br/>            }<br/>            else if (RandomChance (GetInt (enemy,&quot;dex&quot;) - GetInt (self,&quot;spd&quot;)) = false) {<br/>              msg (enemy&#46;alias +&quot;'s attack missed!&quot;)<br/>              sixth_value = true<br/>            }<br/>            else if (RandomChance (GetInt (self,&quot;pr&quot;) - GetInt (enemy,&quot;hc&quot;)) = true) {<br/>              msg (&quot;You resisted the attack!&quot;)<br/>              sixth_value = true<br/>            }<br/>            else if (sixth_value = false) {<br/>              if (enemy&#46;defending = true and self&#46;defending = true) {<br/>                self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * 2 * GetInt (enemy,&quot;pd&quot;) / 2 + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)<br/>                msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>                enemy&#46;defending = false<br/>              }<br/>              else if (enemy&#46;defending = true and self&#46;defending = false) {<br/>                self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * 2 * GetInt (enemy,&quot;pd&quot;) + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)<br/>                msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>                enemy&#46;defending = false<br/>              }<br/>              else if (enemy&#46;defending = false and self&#46;defending = true) {<br/>                self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * GetInt (enemy,&quot;pd&quot;) / 2 + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)<br/>                msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>              }<br/>              else if (enemy&#46;defending = false and self&#46;defending = false) {<br/>                self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * GetInt (enemy,&quot;pd&quot;) + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)<br/>                msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>              }<br/>            }<br/>          }<br/>          case (2) {<br/>            if (enemy&#46;defending = false) {<br/>              msg (enemy&#46;alias + &quot; has choosen to defend itself&#46;&quot;)<br/>              enemy&#46;defending = true<br/>            }<br/>          }<br/>          case (3) {<br/>            enemy&#46;defending = false<br/>            msg (&quot;Cast&quot;)<br/>          }<br/>        }<br/>        if (GetInt (self,&quot;cur_hp&quot;) &gt; 0) {<br/>          if (RandomChance (GetInt (enemy,&quot;spd&quot;) - GetInt (self,&quot;spd&quot;)) = true) {<br/>            msg (enemy&#46;alias + &quot; gets an extra battle turn!&quot;)<br/>            wait {<br/>              enemy_battle_turn (self,enemy)<br/>            }<br/>          }<br/>          else {<br/>            msg (enemy&#46;alias + &quot; 's battle turn is over&#46;&quot;)<br/>          }<br/>        }<br/>        else if (GetInt (self,&quot;cur_hp&quot;) &lt;= 0) {<br/>          msg (self&#46;alias + &quot; has died&#46;&quot;)<br/>          msg (&quot;GAME OVER&quot;)<br/>          finish<br/>        }<br/>      &#93;&#93;&gt;&lt;/function&gt;<br/>      &lt;function name=&quot;npc_reachable&quot; parameters=&quot;object&quot; type=&quot;boolean&quot;&gt;<br/>        value = false<br/>        foreach (x,ScopeReachableNotHeld ()) {<br/>          if (x=object) {<br/>            value = true<br/>          }<br/>        }<br/>        return (value)<br/>      &lt;/function&gt;<br/>      &lt;function name=&quot;crit_hit&quot; parameters=&quot;object&quot; type=&quot;int&quot;&gt;<br/>        if (RandomChance (GetInt (object,&quot;luck&quot;)) = true) {<br/>          value = 2<br/>        }<br/>        else {<br/>          value = 1<br/>        }<br/>        return (value)<br/>      &lt;/function&gt;<br/>    &lt;/asl&gt;</code></pre><br/><br/>---------------------------<br/><br/>P.S.<br/><br/>(for v5.3 anyways)<br/><br/>instead of doing this:<br/><br/><pre><code>choices = NewStringList()<br/>    list add (choices, &quot;Attack&quot;)<br/>    list add (choices, &quot;Run&quot;)<br/>    ShowMenu (&quot;What will you do?&quot;, choices, false) {</code></pre><br/><br/>you can do this instead:<br/><br/>(I added in a few more options, just for more of a visual of it)<br/><br/><pre><code>show menu (&quot;What will you do?&quot;, split (&quot;Attack;Defend;Cast;Item;Run&quot;,&quot;;&quot;), false) {</code></pre><br/><br/><!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/Split\">http://quest5.net/wiki/Split</a><!-- m --><br/><br/>",
      "PostDate": "2013-03-29T02:20:16+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "23758",
      "UserId": 0,
      "Username": "HegemonKhan",
      "UserAvatar": null,
      "UserGravatar": "a96cf34d8d97c57de38f54ee22b1759b",
      "EditableText": "@Jaynebonne,\n\nif you use ' verb_name #object# ' for a command's pattern, would that get and apply the object all by itself into the functions' parameters or is it still no ???\n\nI was just wondering, because the ' #text# ' merely puts a string into the parameters, and thus you got to actually get the object of that string name, for use in the functions.",
      "EditableFormat": "bbcode",
      "HTML": "@Jaynebonne,<br/><br/>if you use ' verb_name #object# ' for a command's pattern, would that get and apply the object all by itself into the functions' parameters or is it still no ???<br/><br/>I was just wondering, because the ' #text# ' merely puts a string into the parameters, and thus you got to actually get the object of that string name, for use in the functions.",
      "PostDate": "2013-03-29T02:43:16+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "23762",
      "UserId": 0,
      "Username": "TriangleGames",
      "UserAvatar": null,
      "UserGravatar": "134d9e995777da65c5cf8efda551d579",
      "EditableText": "The problem with my original plan does seem to be the menu inside a function not recognizing the function's parameter. I tried having the menu set a global variable, and then putting the switch after the menu (instead of inside it) using the variable, but that makes the switch run before the selection is made by the player, even if I use &quot;on ready.&quot; I could use &quot;wait,&quot; but then the player would have to make a selection AND press &quot;continue&quot; every round, which is pretty awkward. I was really hoping to keep combat relatively simple. Since I'm not doing a full-scale RPG,  I wasn't planning on a long list of attributes like strength, intelligence, agility, etc. That's why I've not been working the existing combat library. I might use it for a bigger game in the future, but for this game I only picture there being three or four real &quot;battles&quot; any way. It sort of looks like the menu idea is out for now, for me anyway. I may just handle combat from a different approach all together, unless anyone has more advice on the menu concept.",
      "EditableFormat": "bbcode",
      "HTML": "The problem with my original plan does seem to be the menu inside a function not recognizing the function's parameter. I tried having the menu set a global variable, and then putting the switch after the menu (instead of inside it) using the variable, but that makes the switch run before the selection is made by the player, even if I use &quot;on ready.&quot; I could use &quot;wait,&quot; but then the player would have to make a selection AND press &quot;continue&quot; every round, which is pretty awkward. I was really hoping to keep combat relatively simple. Since I'm not doing a full-scale RPG,  I wasn't planning on a long list of attributes like strength, intelligence, agility, etc. That's why I've not been working the existing combat library. I might use it for a bigger game in the future, but for this game I only picture there being three or four real &quot;battles&quot; any way. It sort of looks like the menu idea is out for now, for me anyway. I may just handle combat from a different approach all together, unless anyone has more advice on the menu concept.",
      "PostDate": "2013-03-29T20:53:32+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "23766",
      "UserId": 0,
      "Username": "jaynabonne",
      "UserAvatar": "6579_1344778256.jpg",
      "UserGravatar": "379859a7f1952a65399fc63997e68f0b",
      "EditableText": "I think you had the right idea - use a global variable. Just don't move the switch outside the menu response script&#058;\n\n[code:uq7hn1bg]&lt;function name=&quot;combat&quot; parameters=&quot;enemy&quot;&gt;\n    game&#46;enemy = enemy // add this line\n    choices = NewStringList()\n    list add (choices, &quot;Attack&quot;)\n    list add (choices, &quot;Run&quot;)\n    ShowMenu (&quot;What will you do?&quot;, choices, false) {\n      enemy = game&#46;enemy    // add this line\n      switch (result) {\n        case (&quot;Attack&quot;) {\n          msg (&quot;You attack the &quot; + enemy&#46;alias + &quot;&#46;&#46;&#46;&quot;)\n          Pause (1)\n          msg (&quot;The &quot; + enemy&#46;alias + &quot; takes damage!&quot;)\n          set (enemy, &quot;health&quot;, health - player&#46;dmg)\n        }\n        case (&quot;Run&quot;) {\n          msg (&quot;You run away&#46;&quot;)\n        }\n      }\n    }\n  &lt;/function&gt;[/code:uq7hn1bg]",
      "EditableFormat": "bbcode",
      "HTML": "I think you had the right idea - use a global variable. Just don't move the switch outside the menu response script&#058;<br/><br/><pre><code>&lt;function name=&quot;combat&quot; parameters=&quot;enemy&quot;&gt;<br/>    game&#46;enemy = enemy // add this line<br/>    choices = NewStringList()<br/>    list add (choices, &quot;Attack&quot;)<br/>    list add (choices, &quot;Run&quot;)<br/>    ShowMenu (&quot;What will you do?&quot;, choices, false) {<br/>      enemy = game&#46;enemy    // add this line<br/>      switch (result) {<br/>        case (&quot;Attack&quot;) {<br/>          msg (&quot;You attack the &quot; + enemy&#46;alias + &quot;&#46;&#46;&#46;&quot;)<br/>          Pause (1)<br/>          msg (&quot;The &quot; + enemy&#46;alias + &quot; takes damage!&quot;)<br/>          set (enemy, &quot;health&quot;, health - player&#46;dmg)<br/>        }<br/>        case (&quot;Run&quot;) {<br/>          msg (&quot;You run away&#46;&quot;)<br/>        }<br/>      }<br/>    }<br/>  &lt;/function&gt;</code></pre>",
      "PostDate": "2013-03-29T22:32:46+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "23785",
      "UserId": 0,
      "Username": "TriangleGames",
      "UserAvatar": null,
      "UserGravatar": "134d9e995777da65c5cf8efda551d579",
      "EditableText": "SWEET! It's working. Thanks guys, that was all very helpful! I didn't get it at first, but I think I understand how it works now.\nIs &quot;game.enemy&quot; working as a sort of &quot;reference&quot; variable to the location of an existing object? I haven't reviewed my C++ in a while, but I seem to recall a distinction between &quot;reference variables&quot; and some other term I can't remember. Maybe in a discussion about &quot;the stack&quot; ...",
      "EditableFormat": "bbcode",
      "HTML": "SWEET! It's working. Thanks guys, that was all very helpful! I didn't get it at first, but I think I understand how it works now.<br/>Is &quot;game.enemy&quot; working as a sort of &quot;reference&quot; variable to the location of an existing object? I haven't reviewed my C++ in a while, but I seem to recall a distinction between &quot;reference variables&quot; and some other term I can't remember. Maybe in a discussion about &quot;the stack&quot; ...",
      "PostDate": "2013-03-30T20:25:23+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "23786",
      "UserId": 0,
      "Username": "jaynabonne",
      "UserAvatar": "6579_1344778256.jpg",
      "UserGravatar": "379859a7f1952a65399fc63997e68f0b",
      "EditableText": "I suppose it could be considered a reference to the object. It's definitely not like a C++ pointer. Of course, even the original &quot;enemy&quot; pararmeter is such a reference to whatever object you pass in. You're just saving it in the game object for later use.\n\nGlad it's working. <!-- s:) --><img src=\"{SMILIES_PATH}/icon_smile.gif\" alt=\":)\" title=\"Smile\" /><!-- s:) -->",
      "EditableFormat": "bbcode",
      "HTML": "I suppose it could be considered a reference to the object. It's definitely not like a C++ pointer. Of course, even the original &quot;enemy&quot; pararmeter is such a reference to whatever object you pass in. You're just saving it in the game object for later use.<br/><br/>Glad it's working. <!-- s:) --><img src=\"{SMILIES_PATH}/icon_smile.gif\" alt=\":)\" title=\"Smile\" /><!-- s:) -->",
      "PostDate": "2013-03-30T21:06:55+00:00",
      "LastEditDate": null
    }
  ]
}
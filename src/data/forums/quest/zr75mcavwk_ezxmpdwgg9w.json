{
  "Topic": {
    "TopicId": "zr75mcavwk_ezxmpdwgg9w",
    "ForumId": "10",
    "Title": "Detecting Device or Screen Size",
    "LastUpdated": "2016-08-12T07:20:49.5479356Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "483cd026-f853-453b-9dc8-f715c0199520",
      "UserId": 131284,
      "Username": "Watcher55",
      "AvatarUrl": "https://graph.facebook.com/1478919533/picture?width=80&height=80",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "In order to make the game look better on a large screen I have a fairly large bottom margin, but I've noticed that when playing on an iPhone this causes an infinite dance up and down when the on-screen keyboard is visible, making it nearly unplayable.\r\n\r\nI figure I can fix that if I remove the bottom margin if the game knows it is being played on a phone. Any of you experts know if this is possible?",
      "EditableFormat": "markdown",
      "HTML": "<p>In order to make the game look better on a large screen I have a fairly large bottom margin, but I've noticed that when playing on an iPhone this causes an infinite dance up and down when the on-screen keyboard is visible, making it nearly unplayable.</p>\n<p>I figure I can fix that if I remove the bottom margin if the game knows it is being played on a phone. Any of you experts know if this is possible?</p>\n\n",
      "PostDate": "2016-08-12T07:20:49.5479356Z",
      "LastEditDate": null
    },
    {
      "PostId": "f7be5299-48e5-4c03-99ce-6776c1bfe899",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "The simple way would be to add a command that lets the play toggle between the two.\r\n\r\nThe difficult way would be though JavaScript. Have a string attribute that a JavaScript function. Output the string in game.start, then invoke the function. The JavaScript function could (I think) get the screen size, and change the display accordingly. How confident are you in JavaScript?",
      "EditableFormat": "markdown",
      "HTML": "<p>The simple way would be to add a command that lets the play toggle between the two.</p>\n<p>The difficult way would be though JavaScript. Have a string attribute that a JavaScript function. Output the string in game.start, then invoke the function. The JavaScript function could (I think) get the screen size, and change the display accordingly. How confident are you in JavaScript?</p>\n\n",
      "PostDate": "2016-08-12T14:04:38.685131Z",
      "LastEditDate": null
    },
    {
      "PostId": "dc632c2e-09b6-4c81-9d1e-8676f52402f2",
      "UserId": 251577,
      "Username": "tvisarl",
      "AvatarUrl": "https://secure.gravatar.com/avatar/dd4d3ca1b00054d0f534c5a12491d74c?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "How can you play a Quest game on an iPhone?\r\nThierry",
      "EditableFormat": "markdown",
      "HTML": "<p>How can you play a Quest game on an iPhone?<br>\nThierry</p>\n\n",
      "PostDate": "2016-08-12T17:41:19.9160873Z",
      "LastEditDate": null
    },
    {
      "PostId": "42a38fc0-1e65-46f3-9351-269a5c2635b3",
      "UserId": 131284,
      "Username": "Watcher55",
      "AvatarUrl": "https://graph.facebook.com/1478919533/picture?width=80&height=80",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thanks Pixie, I am very confident in Javascript when I copy and paste the code and it works first time ;-)\r\nIn this case unless it's a general problem more than one other person cares about (probably only a problem for format-obsessed people who want big bottom margins...), and given how many people probably try to play on a phone, I might stick to the \"ask the user\" method!\r\n\r\nThierry, playing online seems to work on phones the same as anywhere else, though personally I've only tried an Android phone.",
      "EditableFormat": "markdown",
      "HTML": "<p>Thanks Pixie, I am very confident in Javascript when I copy and paste the code and it works first time ;-)<br>\nIn this case unless it's a general problem more than one other person cares about (probably only a problem for format-obsessed people who want big bottom margins...), and given how many people probably try to play on a phone, I might stick to the \"ask the user\" method!</p>\n<p>Thierry, playing online seems to work on phones the same as anywhere else, though personally I've only tried an Android phone.</p>\n\n",
      "PostDate": "2016-08-12T22:08:48.2737242Z",
      "LastEditDate": null
    },
    {
      "PostId": "48264727-c008-45bf-aa5a-640793d70fe1",
      "UserId": 131284,
      "Username": "Watcher55",
      "AvatarUrl": "https://graph.facebook.com/1478919533/picture?width=80&height=80",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Hmmm, I thought setting game.setcustompadding = False would work, however no combination of these has any effect on the user interface -- whatever it is set to in game: interface seems immune to changing in the game script. Unless I'm doing something dense.\r\n```\r\ngame.setcustompadding = False\r\ngame.custompaddingbottom = 20\r\nInitUserInterface\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p>Hmmm, I thought setting game.setcustompadding = False would work, however no combination of these has any effect on the user interface -- whatever it is set to in game: interface seems immune to changing in the game script. Unless I'm doing something dense.</p>\n<pre><code>game.setcustompadding = False\ngame.custompaddingbottom = 20\nInitUserInterface\n</code></pre>\n\n",
      "PostDate": "2016-08-13T02:31:52.9654653Z",
      "LastEditDate": null
    },
    {
      "PostId": "8fde7ffe-c026-47fb-9cf4-b7a7bc6131c5",
      "UserId": 251577,
      "Username": "tvisarl",
      "AvatarUrl": "https://secure.gravatar.com/avatar/dd4d3ca1b00054d0f534c5a12491d74c?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Does that mean that you just connect to textadventures.co.uk via the Internet ?\r\nThierry\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Does that mean that you just connect to textadventures.co.uk via the Internet ?<br>\nThierry</p>\n\n",
      "PostDate": "2016-08-13T06:17:20.6208018Z",
      "LastEditDate": null
    },
    {
      "PostId": "3ba69786-eb3f-49f6-bc02-829da18a0224",
      "UserId": 131284,
      "Username": "Watcher55",
      "AvatarUrl": "https://graph.facebook.com/1478919533/picture?width=80&height=80",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Yes, and play online. Doesn't seem to work too well for long games though, because they slow down a lot as you progress (I think the ever-growing map is the cause).",
      "EditableFormat": "markdown",
      "HTML": "<p>Yes, and play online. Doesn't seem to work too well for long games though, because they slow down a lot as you progress (I think the ever-growing map is the cause).</p>\n\n",
      "PostDate": "2016-08-13T11:23:11.85616Z",
      "LastEditDate": null
    },
    {
      "PostId": "35bdcdda-996a-40b9-abec-2b5068fbba0b",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "`InitUserInterface` is a blank function that you can override (if editing offline) to do all your custom formating. Calling `InitInterface`should work - that is where the width is set. Alternatively:\r\n`\r\nJS.setGameWidth (game.customwidth)\r\n`",
      "EditableFormat": "markdown",
      "HTML": "<p><code>InitUserInterface</code> is a blank function that you can override (if editing offline) to do all your custom formating. Calling <code>InitInterface</code>should work - that is where the width is set. Alternatively:<br>\n<code>JS.setGameWidth (game.customwidth)</code></p>\n\n",
      "PostDate": "2016-08-15T06:59:53.3484475Z",
      "LastEditDate": null
    },
    {
      "PostId": "1b7e8fb6-8ac1-4e90-be57-f91309252050",
      "UserId": 131284,
      "Username": "Watcher55",
      "AvatarUrl": "https://graph.facebook.com/1478919533/picture?width=80&height=80",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Now that's plain weird.\r\nIf I set the design interface to use custom padding with a bottom margin of 200 and do this:\r\n```\r\nif (isphone>0) {\r\n  // Set small screen\r\n  mysex = Left(mysex, isphone-1)\r\n  game.setcustompadding = False\r\n  game.custompaddingbottom = 20\r\n  InitInterface\r\n}\r\n```\r\n\r\nThen it has no effect on the format, which stays \"big bottom margin\" no matter what. But if in the design interface I set it to **not** use custom padding and do it the other way round:\r\n```\r\nif (isphone>0) {\r\n  mysex = Left(mysex, isphone-1)\r\n}\r\nelse {\r\n  game.setcustompadding = True\r\n  game.custompaddingbottom = 200\r\n  InitInterface\r\n}\r\n```\r\nThen it works as desired, with no big bottom margin only if the user specifies small screen.\r\nOf course doing that exact test with InitInterface instead of InitUserInterface is the only thing I didn't try before!",
      "EditableFormat": "markdown",
      "HTML": "<p>Now that's plain weird.<br>\nIf I set the design interface to use custom padding with a bottom margin of 200 and do this:</p>\n<pre><code>if (isphone&gt;0) {\n  // Set small screen\n  mysex = Left(mysex, isphone-1)\n  game.setcustompadding = False\n  game.custompaddingbottom = 20\n  InitInterface\n}\n</code></pre>\n<p>Then it has no effect on the format, which stays \"big bottom margin\" no matter what. But if in the design interface I set it to <strong>not</strong> use custom padding and do it the other way round:</p>\n<pre><code>if (isphone&gt;0) {\n  mysex = Left(mysex, isphone-1)\n}\nelse {\n  game.setcustompadding = True\n  game.custompaddingbottom = 200\n  InitInterface\n}\n</code></pre>\n<p>Then it works as desired, with no big bottom margin only if the user specifies small screen.<br>\nOf course doing that exact test with InitInterface instead of InitUserInterface is the only thing I didn't try before!</p>\n\n",
      "PostDate": "2016-08-15T07:19:38.7401485Z",
      "LastEditDate": null
    },
    {
      "PostId": "8fca175d-a4ec-477d-b952-8f68654e6956",
      "UserId": 924,
      "Username": "Pertex",
      "AvatarUrl": "https://secure.gravatar.com/avatar/4cc1e52f99452e841ecf4cbee9eadde9?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Quest uses two tempates, one for \"normal\" browsers and one for mobile devices.  Which one do you see in your iphone? Is there a + next to the command bar?",
      "EditableFormat": "markdown",
      "HTML": "<p>Quest uses two tempates, one for \"normal\" browsers and one for mobile devices.  Which one do you see in your iphone? Is there a + next to the command bar?</p>\n\n",
      "PostDate": "2016-08-15T13:55:17.93775Z",
      "LastEditDate": null
    },
    {
      "PostId": "264e8067-5001-4f31-ae18-06cd79683404",
      "UserId": 131284,
      "Username": "Watcher55",
      "AvatarUrl": "https://graph.facebook.com/1478919533/picture?width=80&height=80",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Yes (shows how observant I am).\r\nThat implies Quest knows... so do you know how we can extract that knowledge?",
      "EditableFormat": "markdown",
      "HTML": "<p>Yes (shows how observant I am).<br>\nThat implies Quest knows... so do you know how we can extract that knowledge?</p>\n\n",
      "PostDate": "2016-08-16T07:14:26.3360617Z",
      "LastEditDate": null
    },
    {
      "PostId": "cd6553b3-2a56-4f25-a0e3-f5b44b15c4f5",
      "UserId": 924,
      "Username": "Pertex",
      "AvatarUrl": "https://secure.gravatar.com/avatar/4cc1e52f99452e841ecf4cbee9eadde9?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Alex told me how this works, but I forgot, sorry. But you can check with Javascript  if the element tabButton exists. Then it is mobile",
      "EditableFormat": "markdown",
      "HTML": "<p>Alex told me how this works, but I forgot, sorry. But you can check with Javascript  if the element tabButton exists. Then it is mobile</p>\n\n",
      "PostDate": "2016-08-16T08:33:46.5275229Z",
      "LastEditDate": null
    },
    {
      "PostId": "e4e585a5-79fb-48db-b494-bfc4868788f8",
      "UserId": 131284,
      "Username": "Watcher55",
      "AvatarUrl": "https://graph.facebook.com/1478919533/picture?width=80&height=80",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "OK I give up. I found this useful discussion:\r\nhttp://textadventures.co.uk/forum/quest/topic/4995/is-there-a-way-for-the-game-to-check-whether-its-being-played-online-or-not\r\nwhich has this relevant piece of javascript:\r\n```\r\nvar elem = document.getElementById('tabButton');\r\n    if (elem!=null){\r\n      mobile=true;\r\n    } \r\n```\r\nLooks good, except I can't for the life of me find how to return the value of \"mobile\" from the javascript to my Quest script itself. All the examples I've found in the forum on request (RunScript, ...), the script just does stuff, never returns a value.",
      "EditableFormat": "markdown",
      "HTML": "<p>OK I give up. I found this useful discussion:<br>\nhttp://textadventures.co.uk/forum/quest/topic/4995/is-there-a-way-for-the-game-to-check-whether-its-being-played-online-or-not<br>\nwhich has this relevant piece of javascript:</p>\n<pre><code>var elem = document.getElementById('tabButton');\n    if (elem!=null){\n      mobile=true;\n    } \n</code></pre>\n<p>Looks good, except I can't for the life of me find how to return the value of \"mobile\" from the javascript to my Quest script itself. All the examples I've found in the forum on request (RunScript, ...), the script just does stuff, never returns a value.</p>\n\n",
      "PostDate": "2016-08-17T00:25:11.8214198Z",
      "LastEditDate": null
    },
    {
      "PostId": "f962c0ec-f4fd-477d-a6c4-24d9b7518e35",
      "UserId": 924,
      "Username": "Pertex",
      "AvatarUrl": "https://secure.gravatar.com/avatar/4cc1e52f99452e841ecf4cbee9eadde9?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "This JS-function calls the Quest function checkMobile after checking mobile devices\r\n```\r\nfunction testMobile() {\r\n    var check = false;\r\n    var elem = document.getElementById('tabButton');\r\n    if (elem!=null){\r\n      check=true;\r\n    }\r\n    ASLEvent(\"checkMobile\", check); \r\n    return false;\r\n}\r\n```\r\n\r\n```\r\n<function name=\"checkMobile\" parameters=\"answer\">\r\n...\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p>This JS-function calls the Quest function checkMobile after checking mobile devices</p>\n<pre><code>function testMobile() {\n    var check = false;\n    var elem = document.getElementById('tabButton');\n    if (elem!=null){\n      check=true;\n    }\n    ASLEvent(\"checkMobile\", check); \n    return false;\n}\n</code></pre>\n<pre><code>&lt;function name=\"checkMobile\" parameters=\"answer\"&gt;\n...\n</code></pre>\n\n",
      "PostDate": "2016-08-17T05:30:19.8592985Z",
      "LastEditDate": null
    },
    {
      "PostId": "c3ef8cab-0c1e-4f2a-8867-2879a848a0d0",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": ">Looks good, except I can't for the life of me find how to return the value of \"mobile\" from the javascript to my Quest script itself. All the examples I've found in the forum on request (RunScript, ...), the script just does stuff, never returns a value.\r\n\r\nIt is not trivial...\r\nhttp://docs.textadventures.co.uk/quest/guides/javascript.html",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>Looks good, except I can't for the life of me find how to return the value of \"mobile\" from the javascript to my Quest script itself. All the examples I've found in the forum on request (RunScript, ...), the script just does stuff, never returns a value.</p>\n</blockquote>\n<p>It is not trivial...<br>\nhttp://docs.textadventures.co.uk/quest/guides/javascript.html</p>\n\n",
      "PostDate": "2016-08-17T07:34:57.3768248Z",
      "LastEditDate": null
    },
    {
      "PostId": "57181be0-ab8d-4231-87a3-ab2ccacfe2dd",
      "UserId": 131284,
      "Username": "Watcher55",
      "AvatarUrl": "https://graph.facebook.com/1478919533/picture?width=80&height=80",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thanks for all your help.\r\nNot trivial, indeed. I'd seen that page and not understood the solution...\r\nHaving implemented the phone-detector, however, it doesn't actually make much difference. Playing on a phone, at least one with a small screen, is difficult. So much for my OCD.\r\n\r\nAnyway, for anyone who cares here is the solution I used, so something analogous will work:\r\n\r\n1. To your Javascripts (under the Advanced tab) add this javascript:\r\n```\r\nfunction detectDevice() {\r\n    var elem = document.getElementById('tabButton');\r\n    if (elem!=null){\r\n       ASLEvent(\"DeviceCallback\", \"Phone\");\r\n    } else {\r\n       ASLEvent(\"DeviceCallback\", \"PC\");\r\n    }    \r\n}\r\n```\r\n2. To your functions in your Quest game add this function (note this assumes setcustompadding is not true in your Game: Interface setup):\r\n```\r\n  <function name=\"DeviceCallback\" parameters=\"devicekind\">\r\n    if (devicekind=\"PC\") {\r\n      game.setcustompadding = True\r\n      game.custompaddingbottom = 200\r\n      JS.setGamePadding (game.custompaddingtop, game.custompaddingbottom, game.custompaddingleft, game.custompaddingright)\r\n    }\r\n    else {\r\n      game.isOnPhone = true\r\n    }\r\n  </function>\r\n```\r\nYou can then use the game.isOnPhone (defined as a boolean attribute) in your game to tell what the user is on, e.g. if you want to change the way you do things on different device types.\r\n\r\n3. Finally, to InitUserInterface add this fragment:\r\n```\r\n request (RunScript, \"detectDevice\")\r\n```\r\n(Note: if InitUserInterface exists in Core.aslx, either edit it there, or delete from there before adding to your own functions in Quest: it won't allow both).",
      "EditableFormat": "markdown",
      "HTML": "<p>Thanks for all your help.<br>\nNot trivial, indeed. I'd seen that page and not understood the solution...<br>\nHaving implemented the phone-detector, however, it doesn't actually make much difference. Playing on a phone, at least one with a small screen, is difficult. So much for my OCD.</p>\n<p>Anyway, for anyone who cares here is the solution I used, so something analogous will work:</p>\n<ol>\n<li>To your Javascripts (under the Advanced tab) add this javascript:</li>\n</ol>\n<pre><code>function detectDevice() {\n    var elem = document.getElementById('tabButton');\n    if (elem!=null){\n       ASLEvent(\"DeviceCallback\", \"Phone\");\n    } else {\n       ASLEvent(\"DeviceCallback\", \"PC\");\n    }    \n}\n</code></pre>\n<ol start=\"2\">\n<li>To your functions in your Quest game add this function (note this assumes setcustompadding is not true in your Game: Interface setup):</li>\n</ol>\n<pre><code>  &lt;function name=\"DeviceCallback\" parameters=\"devicekind\"&gt;\n    if (devicekind=\"PC\") {\n      game.setcustompadding = True\n      game.custompaddingbottom = 200\n      JS.setGamePadding (game.custompaddingtop, game.custompaddingbottom, game.custompaddingleft, game.custompaddingright)\n    }\n    else {\n      game.isOnPhone = true\n    }\n  &lt;/function&gt;\n</code></pre>\n<p>You can then use the game.isOnPhone (defined as a boolean attribute) in your game to tell what the user is on, e.g. if you want to change the way you do things on different device types.</p>\n<ol start=\"3\">\n<li>Finally, to InitUserInterface add this fragment:</li>\n</ol>\n<pre><code> request (RunScript, \"detectDevice\")\n</code></pre>\n<p>(Note: if InitUserInterface exists in Core.aslx, either edit it there, or delete from there before adding to your own functions in Quest: it won't allow both).</p>\n\n",
      "PostDate": "2016-08-18T08:23:40.1980044Z",
      "LastEditDate": "2016-08-18T08:25:37.2156324Z"
    }
  ]
}

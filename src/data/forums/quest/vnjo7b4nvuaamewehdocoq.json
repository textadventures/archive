{
  "Topic": {
    "TopicId": "vnjo7b4nvuaamewehdocoq",
    "ForumId": "10",
    "Title": "Quest 5.7.2 released",
    "LastUpdated": "2018-02-02T08:32:37.5798534Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "dc925ee7-dd25-4ca7-82ed-44f5edd6dd51",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Well, sort of.\r\n\r\nThe desktop version is here:\r\nhttps://github.com/textadventures/quest/releases\r\n\r\nI have asked Luis to upload to the web site, and the web version will not be updated until that happens. \r\n\r\nChanges are listed at the bottom of [this page](https://github.com/textadventures/quest/blob/master/docs/quest5_7.md).",
      "EditableFormat": "markdown",
      "HTML": "<p>Well, sort of.</p>\n<p>The desktop version is here:<br>\nhttps://github.com/textadventures/quest/releases</p>\n<p>I have asked Luis to upload to the web site, and the web version will not be updated until that happens.</p>\n<p>Changes are listed at the bottom of <a href=\"https://github.com/textadventures/quest/blob/master/docs/quest5_7.md\">this page</a>.</p>\n\n",
      "PostDate": "2018-02-02T08:32:37.5798534Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "774dcc23-81c7-4b54-807f-e3db924f5ce4",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "It is just possible you will see an error like this when you try pick up an object or drop it. If this is an issue then it will happen ever time, so if you are worried, go into your game, pick something up, and drop it; if it works, this does not apply to you).\r\n\r\nThis is the error:\r\n```\r\nError running script: Cannot foreach over 'Object: [object]' as it is not a list\r\n```\r\n<details>\r\nThis is because Quest handles ALL a bit differently now, and you have your own version of either the TAKE or DROP command in your game, and it is still trying to use the old system (or you are using CombatLib, which has its own version).\r\n\r\nYour command will have a strange script called \"multiple\" that returns a list, perhaps like this:\r\n```\r\n    <multiple>\r\n      return (ListExclude(ScopeVisibleNotHeldNotScenery(), game.pov))\r\n    </multiple>\r\n```\r\nYou need to replace that with a script called \"multipleobjects\" that sets `game.pov.currentcommandpendingobjectscope`, and also to set the \"scope\" attribute. The above would be replaced with this:\r\n  ```\r\n    <multipleobjects type=\"script\">\r\n      game.pov.currentcommandpendingobjectscope = ListExclude(ScopeVisibleNotHeldNotScenery(), game.pov)\r\n    </multipleobjects>\r\n    <scope>notheld</scope>\r\n```\r\nIf you are using CombatLib, I have just put up a new version with this issue fixed, so downloads that and replace the old version in your game.\r\n\r\nIf you have modified the library a lot you may prefer to update your version. Go to the \"commands.xml\" file, and replace the TAKE command with this:\r\n```\r\n  <command name=\"take\">\r\n    <pattern>take #object#; get #object#; pick up #object#</pattern>\r\n    <multiple>\r\n      takeList = NewObjectList()\r\n      foreach (obj, ListExclude(ScopeVisibleNotHeldNotScenery(), game.pov)) {\r\n        if (obj.parent = game.pov.parent) {\r\n          list add (takeList, obj)\r\n        }\r\n      }\r\n      return (takeList)\r\n    </multiple>\r\n    <scope>notheld</scope>\r\n    <multipleobjects type=\"script\">\r\n      game.pov.currentcommandpendingobjectscope = NewObjectList()\r\n      foreach (obj, ListExclude(ScopeVisibleNotHeldNotScenery(), game.pov)) {\r\n        if (obj.parent = game.pov.parent and not DoesInherit(obj, \"npc_type\")) {\r\n          list add (game.pov.currentcommandpendingobjectscope, obj)\r\n        }\r\n      }\r\n    </multipleobjects>\r\n    <script><![CDATA[\r\n      if (IsUnableToHold()) {\r\n        msg (\"You cannot pick anything up with <i>\" + GetDisplayAlias(game.pov.currentspell) + \"</i> active.\")\r\n      }\r\n      else if (multiple and ListCount(object) = 0) {\r\n        msg (\"Nothing here to take.\")\r\n      }\r\n      else {\r\n        foreach (obj, object) {\r\n          DoTake (obj, multiple)\r\n        }\r\n      }\r\n    ]]></script>\r\n  </command>\r\n```\r\n</details>",
      "EditableFormat": "markdown",
      "HTML": "<p>It is just possible you will see an error like this when you try pick up an object or drop it. If this is an issue then it will happen ever time, so if you are worried, go into your game, pick something up, and drop it; if it works, this does not apply to you).</p>\n<p>This is the error:</p>\n<pre><code>Error running script: Cannot foreach over 'Object: [object]' as it is not a list\n</code></pre>\n<details>\nThis is because Quest handles ALL a bit differently now, and you have your own version of either the TAKE or DROP command in your game, and it is still trying to use the old system (or you are using CombatLib, which has its own version).\n<p>Your command will have a strange script called \"multiple\" that returns a list, perhaps like this:</p>\n<pre><code>    &lt;multiple&gt;\n      return (ListExclude(ScopeVisibleNotHeldNotScenery(), game.pov))\n    &lt;/multiple&gt;\n</code></pre>\n<p>You need to replace that with a script called \"multipleobjects\" that sets <code>game.pov.currentcommandpendingobjectscope</code>, and also to set the \"scope\" attribute. The above would be replaced with this:</p>\n<pre><code>  &lt;multipleobjects type=\"script\"&gt;\n    game.pov.currentcommandpendingobjectscope = ListExclude(ScopeVisibleNotHeldNotScenery(), game.pov)\n  &lt;/multipleobjects&gt;\n  &lt;scope&gt;notheld&lt;/scope&gt;\n</code></pre>\n<p>If you are using CombatLib, I have just put up a new version with this issue fixed, so downloads that and replace the old version in your game.</p>\n<p>If you have modified the library a lot you may prefer to update your version. Go to the \"commands.xml\" file, and replace the TAKE command with this:</p>\n<pre><code>  &lt;command name=\"take\"&gt;\n    &lt;pattern&gt;take #object#; get #object#; pick up #object#&lt;/pattern&gt;\n    &lt;multiple&gt;\n      takeList = NewObjectList()\n      foreach (obj, ListExclude(ScopeVisibleNotHeldNotScenery(), game.pov)) {\n        if (obj.parent = game.pov.parent) {\n          list add (takeList, obj)\n        }\n      }\n      return (takeList)\n    &lt;/multiple&gt;\n    &lt;scope&gt;notheld&lt;/scope&gt;\n    &lt;multipleobjects type=\"script\"&gt;\n      game.pov.currentcommandpendingobjectscope = NewObjectList()\n      foreach (obj, ListExclude(ScopeVisibleNotHeldNotScenery(), game.pov)) {\n        if (obj.parent = game.pov.parent and not DoesInherit(obj, \"npc_type\")) {\n          list add (game.pov.currentcommandpendingobjectscope, obj)\n        }\n      }\n    &lt;/multipleobjects&gt;\n    &lt;script&gt;&lt;![CDATA[\n      if (IsUnableToHold()) {\n        msg (\"You cannot pick anything up with &lt;i&gt;\" + GetDisplayAlias(game.pov.currentspell) + \"&lt;/i&gt; active.\")\n      }\n      else if (multiple and ListCount(object) = 0) {\n        msg (\"Nothing here to take.\")\n      }\n      else {\n        foreach (obj, object) {\n          DoTake (obj, multiple)\n        }\n      }\n    ]]&gt;&lt;/script&gt;\n  &lt;/command&gt;\n</code></pre>\n</details>\n\n",
      "PostDate": "2018-02-02T08:54:38.8107439Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "fd00d19d-603c-4d7e-918d-86379093a68e",
      "UserId": 286504,
      "Username": "manowar",
      "AvatarUrl": "http://i.imgur.com/mpaalk0b.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "The new versión is on the website.\r\n\r\nAny problem, comment.\r\n\r\n:)",
      "EditableFormat": "markdown",
      "HTML": "<p>The new versión is on the website.</p>\n<p>Any problem, comment.</p>\n<p>:)</p>\n\n",
      "PostDate": "2018-02-02T22:04:32.1406438Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "1eea75cb-3861-4286-b90d-0772ffe59096",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thanks. Only done a quick test, but looks good!",
      "EditableFormat": "markdown",
      "HTML": "<p>Thanks. Only done a quick test, but looks good!</p>\n\n",
      "PostDate": "2018-02-03T11:18:32.7505735Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "b687908a-53f1-4267-a236-7943668725ba",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "This is pretty cool!\r\n\r\nEspecially the change to the Split() function!\r\n\r\nI just tested that out with this:\r\n\r\n```\r\nlist = Split(\"Fred;Barney;Wilma;Betty\")\r\nthis = PickOneString(list)\r\ncreate (this, \"npc_type\")\r\nthis = GetObject(this)\r\nthis.parent = game.pov.parent\r\nif ((this.name = \"Fred\") or this.name = \"Barney\") {\r\n  this.article = \"him\"\r\n  this.gender = \"he\" \r\n  this.possessive = \"his\"\r\n}\r\nelse {\r\n  this.article = \"her\"\r\n  this.gender = \"she\"\r\n  this.possessive = \"hers\"\r\n}\r\nthis.look = CapFirst(this.gender)+\" looks just like the character from The Flinstones!\"\r\nthis.takemsg = \"You can't take \"+this.article+\".\"\r\nthis.speak => {\r\n  msg (CapFirst(this.gender)+\" ignores you.\")\r\n}\r\n```\r\n\r\n---\r\n...and it works!\r\n\r\nWhoo-hoo!",
      "EditableFormat": "markdown",
      "HTML": "<p>This is pretty cool!</p>\n<p>Especially the change to the Split() function!</p>\n<p>I just tested that out with this:</p>\n<pre><code>list = Split(\"Fred;Barney;Wilma;Betty\")\nthis = PickOneString(list)\ncreate (this, \"npc_type\")\nthis = GetObject(this)\nthis.parent = game.pov.parent\nif ((this.name = \"Fred\") or this.name = \"Barney\") {\n  this.article = \"him\"\n  this.gender = \"he\" \n  this.possessive = \"his\"\n}\nelse {\n  this.article = \"her\"\n  this.gender = \"she\"\n  this.possessive = \"hers\"\n}\nthis.look = CapFirst(this.gender)+\" looks just like the character from The Flinstones!\"\nthis.takemsg = \"You can't take \"+this.article+\".\"\nthis.speak =&gt; {\n  msg (CapFirst(this.gender)+\" ignores you.\")\n}\n</code></pre>\n<hr>\n<p>...and it works!</p>\n<p>Whoo-hoo!</p>\n\n",
      "PostDate": "2018-02-03T12:12:09.3468789Z",
      "LastEditDate": "2018-02-03T12:12:38.027262Z",
      "link": null
    },
    {
      "PostId": "2517cbee-ca13-4292-afc6-94784a1d21cf",
      "UserId": 924,
      "Username": "Pertex",
      "AvatarUrl": "https://secure.gravatar.com/avatar/4cc1e52f99452e841ecf4cbee9eadde9?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Great! My function ist working. Now I can do the write function",
      "EditableFormat": "markdown",
      "HTML": "<p>Great! My function ist working. Now I can do the write function</p>\n\n",
      "PostDate": "2018-02-03T19:43:01.5131204Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "8620e2d1-3eb6-4b26-aafb-3f65f23f373c",
      "UserId": 199273,
      "Username": "DavyB",
      "AvatarUrl": "http://i.imgur.com/8BcaZCyb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Congratulations Andy (The Pixie). You have made a large number of valuable changes to the Quest engine in the latest release, despite it being described as a “minor update”, and don’t seem to have broken anything in the process. I’ve played through the three games with which I’ve been involved, and despite two of them using Internal Core.aslx Functions (for drawing purposes) all work as before, without any problems. I’ve only started looking at the new features in detail and will probably only appreciate them fully in my next project. Though perhaps minor to you, I like the ability to control the response to faulty commands and the more intelligent take and drop. Can this idea be extended to examine and give? \r\n\r\nI did find a couple of oddities but these my be connected with my understanding so I’ll put them into a PM. Again, well done!",
      "EditableFormat": "markdown",
      "HTML": "<p>Congratulations Andy (The Pixie). You have made a large number of valuable changes to the Quest engine in the latest release, despite it being described as a “minor update”, and don’t seem to have broken anything in the process. I’ve played through the three games with which I’ve been involved, and despite two of them using Internal Core.aslx Functions (for drawing purposes) all work as before, without any problems. I’ve only started looking at the new features in detail and will probably only appreciate them fully in my next project. Though perhaps minor to you, I like the ability to control the response to faulty commands and the more intelligent take and drop. Can this idea be extended to examine and give?</p>\n<p>I did find a couple of oddities but these my be connected with my understanding so I’ll put them into a PM. Again, well done!</p>\n\n",
      "PostDate": "2018-02-06T15:58:59.0197712Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "33691610-53f7-4b01-809f-ca4d20a361fd",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> Though perhaps minor to you, I like the ability to control the response to faulty commands and the more intelligent take and drop. Can this idea be extended to examine and give?\r\n\r\nGIVE, yes. All should apply to things you have. I will look at that. I tried to think of what else it should apply to and forgot that one.\r\n\r\nEXAMINE should do everything though, I would have thought?",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>Though perhaps minor to you, I like the ability to control the response to faulty commands and the more intelligent take and drop. Can this idea be extended to examine and give?</p>\n</blockquote>\n<p>GIVE, yes. All should apply to things you have. I will look at that. I tried to think of what else it should apply to and forgot that one.</p>\n<p>EXAMINE should do everything though, I would have thought?</p>\n\n",
      "PostDate": "2018-02-06T16:08:37.3323581Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "2ebdc7c2-b316-4d27-9782-6c6551482d41",
      "UserId": 199273,
      "Username": "DavyB",
      "AvatarUrl": "http://i.imgur.com/8BcaZCyb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Here is an example . I am in a room containing a first aid box, holding a box of matches, and try to examine 'box'.  The response is as follows. I was expecting the one I was holding to be taken by default?\r\n> x box\r\nPlease choose which 'box' you mean:\r\n1: first aid box\r\n2: box of matches",
      "EditableFormat": "markdown",
      "HTML": "<p>Here is an example . I am in a room containing a first aid box, holding a box of matches, and try to examine 'box'.  The response is as follows. I was expecting the one I was holding to be taken by default?</p>\n<blockquote>\n<p>x box<br>\nPlease choose which 'box' you mean:<br>\n1: first aid box<br>\n2: box of matches</p>\n</blockquote>\n\n",
      "PostDate": "2018-02-06T16:56:19.4352987Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "67ccd446-9cf3-4e1a-9081-4acbc0d189fa",
      "UserId": 341771,
      "Username": "JenniferCampbell",
      "AvatarUrl": "https://secure.gravatar.com/avatar/8b9a63b5bbacc531368953df3a1709ec?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Does the popup command work in gamebooks?\r\n\r\nIn 5.7.1 it didn't work, but it didn't throw errors, either.  It's the first thing I've tried out in 5.7.2 and I got the following error:\r\n\r\nError running script: Error compiling expression 'JSSafe(s1) + GetRandomInt(0, 999999999)': FunctionCallElement: Could find not function 'JSSafe(String)'\r\nError running script: Error compiling expression 'Instr(text, \"{\")': FunctionCallElement: Could find not function 'Instr(Object, String)'\r\n\r\nAlso, it throws this error with one or more words in the link text field.",
      "EditableFormat": "markdown",
      "HTML": "<p>Does the popup command work in gamebooks?</p>\n<p>In 5.7.1 it didn't work, but it didn't throw errors, either.  It's the first thing I've tried out in 5.7.2 and I got the following error:</p>\n<p>Error running script: Error compiling expression 'JSSafe(s1) + GetRandomInt(0, 999999999)': FunctionCallElement: Could find not function 'JSSafe(String)'<br>\nError running script: Error compiling expression 'Instr(text, \"{\")': FunctionCallElement: Could find not function 'Instr(Object, String)'</p>\n<p>Also, it throws this error with one or more words in the link text field.</p>\n\n",
      "PostDate": "2018-02-06T16:58:40.8088323Z",
      "LastEditDate": "2018-02-06T16:59:48.5317324Z",
      "link": null
    },
    {
      "PostId": "c0e64fa5-4612-4d7c-b47c-c8e74d969320",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I've added a ```timesexamined``` integer attribute to objects and had the ```lookat``` script increase that by 1 (when it wasn't dark and the object wasn't a light source).\r\n\r\n(If you kept putting your eyeballs on one of my NPCs, he'd get a little more perturbed each time.  In fact, he'd eventually kill you for it.)",
      "EditableFormat": "markdown",
      "HTML": "<p>I've added a <code>timesexamined</code> integer attribute to objects and had the <code>lookat</code> script increase that by 1 (when it wasn't dark and the object wasn't a light source).</p>\n<p>(If you kept putting your eyeballs on one of my NPCs, he'd get a little more perturbed each time.  In fact, he'd eventually kill you for it.)</p>\n\n",
      "PostDate": "2018-02-06T17:03:37.7144435Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "7ac578e3-dead-4779-8e89-f708b4d38a5b",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "What if I was holding a box of matches, which I acquired 50 turns ago, no longer need, and have also completely forgotten about.  Then, I enter the room, and it says:\r\n\r\nYou are in a room with medical supplies.\r\n\r\nYou can see a first aid box.\r\n\r\n\\>x box\r\nThere are 2 matches in it.\r\n\r\n---\r\nYou mean you want me to type out X FIRST AID BOX?\r\n\r\nAre you insane?!?  (Insert maniacal laugh here.)\r\n\r\nI'm actually just kidding.  \r\n\r\nI've wanted to do away with that disambiguation menu before, but I was convinced that it's the best way to fly.",
      "EditableFormat": "markdown",
      "HTML": "<p>What if I was holding a box of matches, which I acquired 50 turns ago, no longer need, and have also completely forgotten about.  Then, I enter the room, and it says:</p>\n<p>You are in a room with medical supplies.</p>\n<p>You can see a first aid box.</p>\n<p>&gt;x box<br>\nThere are 2 matches in it.</p>\n<hr>\n<p>You mean you want me to type out X FIRST AID BOX?</p>\n<p>Are you insane?!?  (Insert maniacal laugh here.)</p>\n<p>I'm actually just kidding.</p>\n<p>I've wanted to do away with that disambiguation menu before, but I was convinced that it's the best way to fly.</p>\n\n",
      "PostDate": "2018-02-06T17:07:26.534263Z",
      "LastEditDate": "2018-02-06T17:50:57.4829259Z",
      "link": null
    },
    {
      "PostId": "972e48a4-9490-4d11-a80b-dd622e0cd883",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Hello, Jennifer.\r\n\r\nAdd this to your game in full code view.   (I try to put the functions just before the last line, which is ```</asl>```.)\r\n\r\n```\r\n  <function name=\"JSSafe\" parameters=\"s\" type=\"string\"><![CDATA[\r\n    s = Replace(s, \"\\\"\", \"\")\r\n    s = Replace(s, \"\\'\", \"\")\r\n    s = Replace(s, \" \", \"\")\r\n    s = Replace(s, \".\", \"\")\r\n    s = Replace(s, \",\", \"\")\r\n    s = Replace(s, \"!\", \"\")\r\n    s = Replace(s, \"?\", \"\")\r\n    s = Replace(s, \"-\", \"\")\r\n    s = Replace(s, \"/\", \"\")\r\n    s = Replace(s, \"(\", \"\")\r\n    s = Replace(s, \")\", \"\")\r\n    s = Replace(s, \"$\", \"\")\r\n    s = Replace(s, \"%\", \"\")\r\n    s = Replace(s, \"&\", \"\")\r\n    s = Replace(s, \"*\", \"\")\r\n    s = Replace(s, \"@\", \"\")\r\n    return (s)\r\n  ]]></function>\r\n```\r\n\r\n---\r\n\r\nHere is a very small example game:\r\n\r\n<details>\r\n\r\n```\r\n<!--Saved by Quest 5.7.6606.27193-->\r\n<asl version=\"550\">\r\n  <include ref=\"GamebookCore.aslx\" />\r\n  <game name=\"Gamebook572\">\r\n    <gameid>e1ea9a0c-e2d1-45ba-9ae3-5e3dacb9f69e</gameid>\r\n    <version>1.0</version>\r\n    <firstpublished>2018</firstpublished>\r\n  </game>\r\n  <object name=\"Page1\">\r\n    <description>You can see a {popup:message:Hello, Jennifer!} here!</description>\r\n    <options type=\"stringdictionary\" />\r\n    <script type=\"script\">\r\n      msg (\"\")\r\n    </script>\r\n    <object name=\"player\">\r\n      <inherit name=\"defaultplayer\" />\r\n    </object>\r\n  </object>\r\n  <function name=\"JSSafe\" parameters=\"s\" type=\"string\"><![CDATA[\r\n    s = Replace(s, \"\\\"\", \"\")\r\n    s = Replace(s, \"\\'\", \"\")\r\n    s = Replace(s, \" \", \"\")\r\n    s = Replace(s, \".\", \"\")\r\n    s = Replace(s, \",\", \"\")\r\n    s = Replace(s, \"!\", \"\")\r\n    s = Replace(s, \"?\", \"\")\r\n    s = Replace(s, \"-\", \"\")\r\n    s = Replace(s, \"/\", \"\")\r\n    s = Replace(s, \"(\", \"\")\r\n    s = Replace(s, \")\", \"\")\r\n    s = Replace(s, \"$\", \"\")\r\n    s = Replace(s, \"%\", \"\")\r\n    s = Replace(s, \"&\", \"\")\r\n    s = Replace(s, \"*\", \"\")\r\n    s = Replace(s, \"@\", \"\")\r\n    return (s)\r\n  ]]></function>\r\n</asl>\r\n```\r\n\r\n<img src='https://user-images.githubusercontent.com/30656341/35873715-21ba7304-0b30-11e8-94a1-d396ea14fcfe.png' width='80%'/>\r\n\r\n</details>",
      "EditableFormat": "markdown",
      "HTML": "<p>Hello, Jennifer.</p>\n<p>Add this to your game in full code view.   (I try to put the functions just before the last line, which is <code>&lt;/asl&gt;</code>.)</p>\n<pre><code>  &lt;function name=\"JSSafe\" parameters=\"s\" type=\"string\"&gt;&lt;![CDATA[\n    s = Replace(s, \"\\\"\", \"\")\n    s = Replace(s, \"\\'\", \"\")\n    s = Replace(s, \" \", \"\")\n    s = Replace(s, \".\", \"\")\n    s = Replace(s, \",\", \"\")\n    s = Replace(s, \"!\", \"\")\n    s = Replace(s, \"?\", \"\")\n    s = Replace(s, \"-\", \"\")\n    s = Replace(s, \"/\", \"\")\n    s = Replace(s, \"(\", \"\")\n    s = Replace(s, \")\", \"\")\n    s = Replace(s, \"$\", \"\")\n    s = Replace(s, \"%\", \"\")\n    s = Replace(s, \"&amp;\", \"\")\n    s = Replace(s, \"*\", \"\")\n    s = Replace(s, \"@\", \"\")\n    return (s)\n  ]]&gt;&lt;/function&gt;\n</code></pre>\n<hr>\n<p>Here is a very small example game:</p>\n<details>\n<pre><code>&lt;!--Saved by Quest 5.7.6606.27193--&gt;\n&lt;asl version=\"550\"&gt;\n  &lt;include ref=\"GamebookCore.aslx\" /&gt;\n  &lt;game name=\"Gamebook572\"&gt;\n    &lt;gameid&gt;e1ea9a0c-e2d1-45ba-9ae3-5e3dacb9f69e&lt;/gameid&gt;\n    &lt;version&gt;1.0&lt;/version&gt;\n    &lt;firstpublished&gt;2018&lt;/firstpublished&gt;\n  &lt;/game&gt;\n  &lt;object name=\"Page1\"&gt;\n    &lt;description&gt;You can see a {popup:message:Hello, Jennifer!} here!&lt;/description&gt;\n    &lt;options type=\"stringdictionary\" /&gt;\n    &lt;script type=\"script\"&gt;\n      msg (\"\")\n    &lt;/script&gt;\n    &lt;object name=\"player\"&gt;\n      &lt;inherit name=\"defaultplayer\" /&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n  &lt;function name=\"JSSafe\" parameters=\"s\" type=\"string\"&gt;&lt;![CDATA[\n    s = Replace(s, \"\\\"\", \"\")\n    s = Replace(s, \"\\'\", \"\")\n    s = Replace(s, \" \", \"\")\n    s = Replace(s, \".\", \"\")\n    s = Replace(s, \",\", \"\")\n    s = Replace(s, \"!\", \"\")\n    s = Replace(s, \"?\", \"\")\n    s = Replace(s, \"-\", \"\")\n    s = Replace(s, \"/\", \"\")\n    s = Replace(s, \"(\", \"\")\n    s = Replace(s, \")\", \"\")\n    s = Replace(s, \"$\", \"\")\n    s = Replace(s, \"%\", \"\")\n    s = Replace(s, \"&amp;\", \"\")\n    s = Replace(s, \"*\", \"\")\n    s = Replace(s, \"@\", \"\")\n    return (s)\n  ]]&gt;&lt;/function&gt;\n&lt;/asl&gt;\n</code></pre>\n<img src=\"https://user-images.githubusercontent.com/30656341/35873715-21ba7304-0b30-11e8-94a1-d396ea14fcfe.png\" width=\"80%\">\n</details>\n\n",
      "PostDate": "2018-02-06T17:24:30.9377137Z",
      "LastEditDate": "2018-02-06T17:28:17.9862601Z",
      "link": null
    },
    {
      "PostId": "8f71edfa-0563-41c6-b3aa-3c05d0c1265e",
      "UserId": 341771,
      "Username": "JenniferCampbell",
      "AvatarUrl": "https://secure.gravatar.com/avatar/8b9a63b5bbacc531368953df3a1709ec?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thanks, K.V., I'll try that... after I re-install 5.7.2.\r\nThe good news is that popups now work in 5.7.1.  Which suggests a permanent registry change after uninstalling 572 and re-installing 571.  Not sure I'm comfy with that, LOL.\r\n\r\nI'll let you know how your fix works...\r\n\r\nJenn\r\n\r\nUPDATE:\r\nThanks, K.V.,\r\n\r\nThat worked very well.  But, am I going to have to put that into every game I make?\r\nShould I consider editing the gamebook core?",
      "EditableFormat": "markdown",
      "HTML": "<p>Thanks, K.V., I'll try that... after I re-install 5.7.2.<br>\nThe good news is that popups now work in 5.7.1.  Which suggests a permanent registry change after uninstalling 572 and re-installing 571.  Not sure I'm comfy with that, LOL.</p>\n<p>I'll let you know how your fix works...</p>\n<p>Jenn</p>\n<p>UPDATE:<br>\nThanks, K.V.,</p>\n<p>That worked very well.  But, am I going to have to put that into every game I make?<br>\nShould I consider editing the gamebook core?</p>\n\n",
      "PostDate": "2018-02-06T17:38:37.4392935Z",
      "LastEditDate": "2018-02-06T18:15:59.5830778Z",
      "link": null
    },
    {
      "PostId": "b08f16d3-66ba-4c09-9563-a1327b14f42e",
      "UserId": 199273,
      "Username": "DavyB",
      "AvatarUrl": "http://i.imgur.com/8BcaZCyb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": ">You can see a first aid box.\r\n>>x box\r\nThere are 2 matches in it.\r\n\r\nWith each verb there is likely to be a different preference. For 'take' there is an implication that the player doesn't have the item. For 'give', the opposite is true. For 'examine', more often than not something  would be examined before it is taken or some operation performed on it. So in the box case above, the default would be the first aid box not the box of matches. When developing a game I try to avoid these conflicts so perhaps the best solution is to use 'medicine cabinet' in place of first aid box! ...except that there is a filing cabinet in the same room :)",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>You can see a first aid box.</p>\n<blockquote>\n<p>x box<br>\nThere are 2 matches in it.</p>\n</blockquote>\n</blockquote>\n<p>With each verb there is likely to be a different preference. For 'take' there is an implication that the player doesn't have the item. For 'give', the opposite is true. For 'examine', more often than not something  would be examined before it is taken or some operation performed on it. So in the box case above, the default would be the first aid box not the box of matches. When developing a game I try to avoid these conflicts so perhaps the best solution is to use 'medicine cabinet' in place of first aid box! ...except that there is a filing cabinet in the same room :)</p>\n\n",
      "PostDate": "2018-02-06T20:41:35.9853708Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "ac6a338f-aaa7-4fd4-8006-e4bd04a1677d",
      "UserId": 199273,
      "Username": "DavyB",
      "AvatarUrl": "http://i.imgur.com/8BcaZCyb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Andy, I can't send an email to you? So, in reply to your question about reversing the user defined error command response:\r\n\r\n Nothing comes out when if I delete the code at user level. To go back I have to delete the following in the underlying code:\r\n\r\n     <unresolvedcommandhandler type=\"script\">\r\n     </unresolvedcommandhandler>\r\n\r\n\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Andy, I can't send an email to you? So, in reply to your question about reversing the user defined error command response:</p>\n<p>Nothing comes out when if I delete the code at user level. To go back I have to delete the following in the underlying code:</p>\n<pre><code> &lt;unresolvedcommandhandler type=\"script\"&gt;\n &lt;/unresolvedcommandhandler&gt;\n</code></pre>\n\n",
      "PostDate": "2018-02-06T20:59:44.5599579Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "4e825c4e-87e2-454c-ae79-21f790c836cb",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "..and you might have some medicine in the medicine cabinet...\r\n\r\n---\r\nYou are in a room.\r\n\r\nYou can see a medicine cabinet.\r\n\r\n\\>x me\r\nYou are terminally ill.\r\n\r\nIf you don't take some medicine within 3 turns, you will die!\r\n\r\n(Luckily for you, there's a medicine cabinet here!)\r\n\r\n\\>open cabinet\r\nWhich one?\r\n1\\. [Filing cabinet]()\r\n2\\. [Medicine cabinet]()\r\n\r\n-2-\r\nYou open it.\r\nIt contains a [medicine]().\r\n\r\n\\>take medicine\r\nWhich one?\r\n1\\. [Medicine]()\r\n2\\. [Medicine cabinet]()\r\n\r\n-1-\r\nYou pick it up.\r\n\r\n\\>take the medicine\r\nWhich one?\r\n1\\. [Medicine]()\r\n2\\. [Medicine cabinet]()\r\n\r\n-1-\r\nYou're already carrying it.\r\n\r\nYOU HAVE DIED.\r\n\r\n\r\n---\r\nPS\r\n\r\nYou needed to USE THE MEDICINE!!!",
      "EditableFormat": "markdown",
      "HTML": "<p>..and you might have some medicine in the medicine cabinet...</p>\n<hr>\n<p>You are in a room.</p>\n<p>You can see a medicine cabinet.</p>\n<p>&gt;x me<br>\nYou are terminally ill.</p>\n<p>If you don't take some medicine within 3 turns, you will die!</p>\n<p>(Luckily for you, there's a medicine cabinet here!)</p>\n<p>&gt;open cabinet<br>\nWhich one?<br>\n1. <a href=\"\">Filing cabinet</a><br>\n2. <a href=\"\">Medicine cabinet</a></p>\n<p>-2-<br>\nYou open it.<br>\nIt contains a <a href=\"\">medicine</a>.</p>\n<p>&gt;take medicine<br>\nWhich one?<br>\n1. <a href=\"\">Medicine</a><br>\n2. <a href=\"\">Medicine cabinet</a></p>\n<p>-1-<br>\nYou pick it up.</p>\n<p>&gt;take the medicine<br>\nWhich one?<br>\n1. <a href=\"\">Medicine</a><br>\n2. <a href=\"\">Medicine cabinet</a></p>\n<p>-1-<br>\nYou're already carrying it.</p>\n<p>YOU HAVE DIED.</p>\n<hr>\n<p>PS</p>\n<p>You needed to USE THE MEDICINE!!!</p>\n\n",
      "PostDate": "2018-02-06T21:09:07.0822045Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "6051cfa5-710d-4e75-a76a-5b986f519c0c",
      "UserId": 199273,
      "Username": "DavyB",
      "AvatarUrl": "http://i.imgur.com/8BcaZCyb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Okay KV, I'm convinced that (a) 'examine' should use the disambiguation menu rather than guess; and (b) I should call the 'first aid box' a cupboard to avoid the problem!",
      "EditableFormat": "markdown",
      "HTML": "<p>Okay KV, I'm convinced that (a) 'examine' should use the disambiguation menu rather than guess; and (b) I should call the 'first aid box' a cupboard to avoid the problem!</p>\n\n",
      "PostDate": "2018-02-07T08:12:45.0963412Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "9c3e2f72-aeb7-4d7f-b79f-3b4503e681f9",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> Nothing comes out when if I delete the code at user level. To go back I have to delete the following in the underlying code:\r\n\r\nRight, I see what you mean. You could delete the `unresolvedcommandhandler` attribute from the _Attributes_ tab.",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>Nothing comes out when if I delete the code at user level. To go back I have to delete the following in the underlying code:</p>\n</blockquote>\n<p>Right, I see what you mean. You could delete the <code>unresolvedcommandhandler</code> attribute from the <em>Attributes</em> tab.</p>\n\n",
      "PostDate": "2018-02-07T09:07:14.8598084Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "18b68fd6-cd49-49ba-8286-2851f8e3dbac",
      "UserId": 199273,
      "Username": "DavyB",
      "AvatarUrl": "http://i.imgur.com/8BcaZCyb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": ">Right, I see what you mean. You could delete the unresolvedcommandhandler attribute from the Attributes tab.\r\n\r\nI only brought this up as a user might expect to revert to the original by deleting the code or de-selecting advanced scripts. Can the attribute be deleted automatically when these conditions are detected?",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>Right, I see what you mean. You could delete the unresolvedcommandhandler attribute from the Attributes tab.</p>\n</blockquote>\n<p>I only brought this up as a user might expect to revert to the original by deleting the code or de-selecting advanced scripts. Can the attribute be deleted automatically when these conditions are detected?</p>\n\n",
      "PostDate": "2018-02-07T15:56:14.6233064Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "a57a3bf6-b623-4426-ab04-5db529132c33",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "For the record, DavyB,\r\n\r\nI was just trying to make you laugh.\r\n\r\nI'll play a game with \"tomato juice\" in a \"can of tomato juice\" as long as said game is fun.",
      "EditableFormat": "markdown",
      "HTML": "<p>For the record, DavyB,</p>\n<p>I was just trying to make you laugh.</p>\n<p>I'll play a game with \"tomato juice\" in a \"can of tomato juice\" as long as said game is fun.</p>\n\n",
      "PostDate": "2018-02-07T18:25:56.6344162Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "9c7099d4-d375-40ae-bef0-067c90679803",
      "UserId": 199273,
      "Username": "DavyB",
      "AvatarUrl": "http://i.imgur.com/8BcaZCyb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Don't worry, I'm smiling!",
      "EditableFormat": "markdown",
      "HTML": "<p>Don't worry, I'm smiling!</p>\n\n",
      "PostDate": "2018-02-07T19:24:36.019965Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "4e84d994-5b74-46ff-a3d9-3275ddbe06fb",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> Can the attribute be deleted automatically when these conditions are detected?\r\n\r\nI do not think Quest has a way to test if a script attribute is empty, so not in a simple way, no, unfortunately.",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>Can the attribute be deleted automatically when these conditions are detected?</p>\n</blockquote>\n<p>I do not think Quest has a way to test if a script attribute is empty, so not in a simple way, no, unfortunately.</p>\n\n",
      "PostDate": "2018-02-08T08:12:03.8154555Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "d5f72435-cfbc-400a-8d80-139fb4c1bd8d",
      "UserId": 199273,
      "Username": "DavyB",
      "AvatarUrl": "http://i.imgur.com/8BcaZCyb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": ">I do not think Quest has a way to test if a script attribute is empty, so not in a simple way, no, unfortunately.\r\n\r\nThanks, I'm sure this won't cause anyone a problem in practice...it just feels untidy!",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>I do not think Quest has a way to test if a script attribute is empty, so not in a simple way, no, unfortunately.</p>\n</blockquote>\n<p>Thanks, I'm sure this won't cause anyone a problem in practice...it just feels untidy!</p>\n\n",
      "PostDate": "2018-02-08T12:19:31.093708Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

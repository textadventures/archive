{
  "Topic": {
    "TopicId": "cvtzi26yt0eqlom1t5ikxq",
    "ForumId": "10",
    "Title": "Object Type and Object Not Recognizing THIS (Help Please) [Almost Solved]",
    "LastUpdated": "2019-11-17T10:15:07.5313916Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "17956186-63f5-46f9-8ad0-6ab3fddb56de",
      "UserId": 248029,
      "Username": "Anonynn",
      "AvatarUrl": "https://i.imgur.com/HEtnsWqb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "So, I'm honestly not sure what's happening with my game's combat atm because all sorts of very strange things are happening. But that's another bag of apples we can get into after this... \r\n\r\nI have an OBJECT TYPE\r\n```\r\nMonster\r\n```\r\nand another OBJECT TYPE that inherits it called\r\n```\r\nFemale Zombie Type \r\n```\r\nOn the **Monster Type** I have an ATTRIBUTE\r\n*Distract*  (which runs a script on the **Female Zombie Type** called *distractscript* (script)\r\n\r\nOn the **Female Zombie Type**,  *distractscript* --- I have several...\r\n```\r\nif (this.distraction<=9) {\r\nyada yada ((and yes distraction is an integer))\r\n}\r\n```\r\nBut on the ENEMY OBJECTS, female_zombie, the creature's *distraction* isn't rising when the script is called and neither does the Player's (which is referred to as *player* so *player.distraction* etc). I even have a ```\"+ this.distraction +\"``` as an expression on the script. But no matter what the creature's *distraction* isn't rising. \r\n____\r\nI also have a weird problem where the *player's health* keeps getting fully recharged every turn and their *distraction* drops back down to zero instead of rising. But no where in ANY of the combat scripts or the turn-scripts do I have such a command/script prompting this. \r\n\r\nI really, really need help with this cause I've been trying to fix these for about a week or two. Can anyone please help?\r\n\r\nAnonynn. ",
      "EditableFormat": "markdown",
      "HTML": "<p>So, I'm honestly not sure what's happening with my game's combat atm because all sorts of very strange things are happening. But that's another bag of apples we can get into after this...</p>\n<p>I have an OBJECT TYPE</p>\n<pre><code>Monster\n</code></pre>\n<p>and another OBJECT TYPE that inherits it called</p>\n<pre><code>Female Zombie Type \n</code></pre>\n<p>On the <strong>Monster Type</strong> I have an ATTRIBUTE<br>\n<em>Distract</em>  (which runs a script on the <strong>Female Zombie Type</strong> called <em>distractscript</em> (script)</p>\n<p>On the <strong>Female Zombie Type</strong>,  <em>distractscript</em> --- I have several...</p>\n<pre><code>if (this.distraction&lt;=9) {\nyada yada ((and yes distraction is an integer))\n}\n</code></pre>\n<p>But on the ENEMY OBJECTS, female_zombie, the creature's <em>distraction</em> isn't rising when the script is called and neither does the Player's (which is referred to as <em>player</em> so <em>player.distraction</em> etc). I even have a <code>\"+ this.distraction +\"</code> as an expression on the script. But no matter what the creature's <em>distraction</em> isn't rising.</p>\n<hr>\n<p>I also have a weird problem where the <em>player's health</em> keeps getting fully recharged every turn and their <em>distraction</em> drops back down to zero instead of rising. But no where in ANY of the combat scripts or the turn-scripts do I have such a command/script prompting this.</p>\n<p>I really, really need help with this cause I've been trying to fix these for about a week or two. Can anyone please help?</p>\n<p>Anonynn.</p>\n\n",
      "PostDate": "2019-11-17T10:15:07.5313916Z",
      "LastEditDate": "2019-11-23T21:49:08.0650737Z",
      "link": null
    },
    {
      "PostId": "a9a814e2-88f0-480e-bf35-1bde3a10ae61",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Are there any error messages?\r\n\r\nThis is the kind of problem that's hard to approach without seeing the code. The first thing to check would be that the 'distract' script is definitely being called. Do 'distract' and 'distractscript' both output a message which lets you know they are running?",
      "EditableFormat": "markdown",
      "HTML": "<p>Are there any error messages?</p>\n<p>This is the kind of problem that's hard to approach without seeing the code. The first thing to check would be that the 'distract' script is definitely being called. Do 'distract' and 'distractscript' both output a message which lets you know they are running?</p>\n\n",
      "PostDate": "2019-11-17T10:48:54.8503793Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "8f6cc2e8-2563-44a5-858b-94d6ada8a8d3",
      "UserId": 248029,
      "Username": "Anonynn",
      "AvatarUrl": "https://i.imgur.com/HEtnsWqb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "No error messages. They just aren't showing up or getting tallied. I feel like there is an underlying problem that is causing \"this\" and the \"distract\" not to get added or subtracted. It's like they don't exist in game.\r\nHere's some of the code. Now the **Monster Type** recognizes \"this\" just fine. \r\n```\r\nMONSTER TYPE\r\nATTRIBUTE distract\r\nClearScreen\r\nif (this.health > 0) {\r\n  if (GetBoolean (this, \"hasbeenattacked\")) {\r\n    msg (\"<br/>After attacking this particular {if this.gender=male:guy}{if this.gender=female:girl}{if this.gender=other:creature} in self-defense or aggression, {if this.gender=male:he}{if this.gender=female:she}{if this.gender=other:it} can no longer be distracted.\")\r\n  }\r\n  else {\r\n        game.showmenuobject = this\r\n        do (game.showmenuobject, \"distractscript\")\r\n    }\r\n\t}\r\nelse {\r\n  msg (\"<br/>You cannot distract something dead... \")\r\n}\r\n```\r\n^ this all works perfectly. But this script I've tried putting directly on the ENEMY OBJECT and on the FEMALE/MALE ZOMBIE TYPES as well but it's just not working at all. The scripts themselves work but anything regarding \"this\" referring to the ENEMY OBJECT does not.\r\n```\r\nFEMALE ZOMBIE TYPE\r\nATTRIBUTE distractscript\r\ngame.text_processor_this = this\r\nif (this.distract<=9) {\r\nif (RandomChance(50)) {\r\n}\r\nelse if (RandomChance(33)) {\r\n}\r\nelse if (RandomChance(25)) {\r\n}\r\n else {\r\n}\r\n msg (\"<br/>{color:ivory:You've managed to increase her distraction!}\")\r\n    this.distraction= GetRandomInt (1,3)\r\n    msg (\"<br/>{color:ivory:The female zombie has gained \"+ this.distraction +\" distraction!}\")\r\n    switch (player.charmskill) {\r\n      case (4,5,6, 7) {\r\n        if (RandomChance(50)) {\r\n             msg (\"<br/>Yyour distraction has caused {if this.gender=female:her}{if this.gender=male:him} to falter...\")\r\n           this.distract= this.distract + 1\r\n        }\r\n      }\r\n      case (8,9,10) {\r\n        if (RandomChance(50)) {\r\n             msg (\"<br/>Yyour distraction has caused {if this.gender=female:her}{if this.gender=male:him} to falter even more...\")\r\n           this.distract= this.distract + 2\r\n        }\r\n      }\r\n    }\r\n    if (RandomChance(50)) {\r\n      if (player.resist>=1) {\r\n        msg (\"<br/>{color:ivory:You've resisted getting distracted yourself. -1 Resist!}\")\r\n        player.resist = player.resist - 1\r\n      }\r\n      else {\r\n        msg (\"<br/>{color:ivory:Her reaction to all this has gotten you a little hot and bothered...}\")\r\n        player.lust = GetRandomInt (1,3)\r\n        msg (\"<br/>You've gained \"+ player.distract +\" distract!\")\r\n      }\r\n    }\r\n}\r\nelse {\r\n  menulist = Split(\"Don't Attack;Attack Her\", \";\")\r\n  ShowMenu (\"\", menulist, false) {\r\n    if (result = \"Don't Attack\") {\r\n      ClearScreen\r\n      DontAttackEnemy\r\n    }\r\n    else if (result = \"Attack Her\") {\r\n      ClearScreen\r\n      if (player.equipped = null) {\r\n        bonus = - this.defense\r\n        damage = player.strength * 3\r\n      }\r\n      else {\r\n        bonus = player.equipped.damagebonus - this.defense\r\n        if (HasString(player.equipped, \"damage\")) {\r\n          damage = DiceRoll(player.equipped.damage)\r\n        }\r\n        else {\r\n          damage = player.equipped.damage * 2\r\n        }\r\n      }\r\n      if (RandomChance(45 + 5 * bonus)) {\r\n        this.health = this.health - damage\r\n        if (this.health > 0) {\r\n          PrintOrRun (this, \"attackhit\")\r\n          msg (\"[\" + damage + \" damage done, \" + this.health + \" health remaining]\")\r\n        }\r\n        else {\r\n          PrintOrRun (this, \"attackkill\")\r\n          msg (\"[\" + damage + \" damage done]\")\r\n          this.listalias = \"<span style=\\\"color: red;\\\">\" + this.alias + \"</span>\"\r\n        }\r\n      }\r\n      else {\r\n        PrintOrRun (this, \"attackmissed\")\r\n      }\r\n    }\r\n  }\r\n}\r\nmsg (\"\")\r\n```\r\nLike I said though, the Player's health is mysteriously regenerating instantly too. So I wonder if there is a more underlying problem.\r\n\r\nAnonynn",
      "EditableFormat": "markdown",
      "HTML": "<p>No error messages. They just aren't showing up or getting tallied. I feel like there is an underlying problem that is causing \"this\" and the \"distract\" not to get added or subtracted. It's like they don't exist in game.<br>\nHere's some of the code. Now the <strong>Monster Type</strong> recognizes \"this\" just fine.</p>\n<pre><code>MONSTER TYPE\nATTRIBUTE distract\nClearScreen\nif (this.health &gt; 0) {\n  if (GetBoolean (this, \"hasbeenattacked\")) {\n    msg (\"&lt;br/&gt;After attacking this particular {if this.gender=male:guy}{if this.gender=female:girl}{if this.gender=other:creature} in self-defense or aggression, {if this.gender=male:he}{if this.gender=female:she}{if this.gender=other:it} can no longer be distracted.\")\n  }\n  else {\n        game.showmenuobject = this\n        do (game.showmenuobject, \"distractscript\")\n    }\n\t}\nelse {\n  msg (\"&lt;br/&gt;You cannot distract something dead... \")\n}\n</code></pre>\n<p>^ this all works perfectly. But this script I've tried putting directly on the ENEMY OBJECT and on the FEMALE/MALE ZOMBIE TYPES as well but it's just not working at all. The scripts themselves work but anything regarding \"this\" referring to the ENEMY OBJECT does not.</p>\n<pre><code>FEMALE ZOMBIE TYPE\nATTRIBUTE distractscript\ngame.text_processor_this = this\nif (this.distract&lt;=9) {\nif (RandomChance(50)) {\n}\nelse if (RandomChance(33)) {\n}\nelse if (RandomChance(25)) {\n}\n else {\n}\n msg (\"&lt;br/&gt;{color:ivory:You've managed to increase her distraction!}\")\n    this.distraction= GetRandomInt (1,3)\n    msg (\"&lt;br/&gt;{color:ivory:The female zombie has gained \"+ this.distraction +\" distraction!}\")\n    switch (player.charmskill) {\n      case (4,5,6, 7) {\n        if (RandomChance(50)) {\n             msg (\"&lt;br/&gt;Yyour distraction has caused {if this.gender=female:her}{if this.gender=male:him} to falter...\")\n           this.distract= this.distract + 1\n        }\n      }\n      case (8,9,10) {\n        if (RandomChance(50)) {\n             msg (\"&lt;br/&gt;Yyour distraction has caused {if this.gender=female:her}{if this.gender=male:him} to falter even more...\")\n           this.distract= this.distract + 2\n        }\n      }\n    }\n    if (RandomChance(50)) {\n      if (player.resist&gt;=1) {\n        msg (\"&lt;br/&gt;{color:ivory:You've resisted getting distracted yourself. -1 Resist!}\")\n        player.resist = player.resist - 1\n      }\n      else {\n        msg (\"&lt;br/&gt;{color:ivory:Her reaction to all this has gotten you a little hot and bothered...}\")\n        player.lust = GetRandomInt (1,3)\n        msg (\"&lt;br/&gt;You've gained \"+ player.distract +\" distract!\")\n      }\n    }\n}\nelse {\n  menulist = Split(\"Don't Attack;Attack Her\", \";\")\n  ShowMenu (\"\", menulist, false) {\n    if (result = \"Don't Attack\") {\n      ClearScreen\n      DontAttackEnemy\n    }\n    else if (result = \"Attack Her\") {\n      ClearScreen\n      if (player.equipped = null) {\n        bonus = - this.defense\n        damage = player.strength * 3\n      }\n      else {\n        bonus = player.equipped.damagebonus - this.defense\n        if (HasString(player.equipped, \"damage\")) {\n          damage = DiceRoll(player.equipped.damage)\n        }\n        else {\n          damage = player.equipped.damage * 2\n        }\n      }\n      if (RandomChance(45 + 5 * bonus)) {\n        this.health = this.health - damage\n        if (this.health &gt; 0) {\n          PrintOrRun (this, \"attackhit\")\n          msg (\"[\" + damage + \" damage done, \" + this.health + \" health remaining]\")\n        }\n        else {\n          PrintOrRun (this, \"attackkill\")\n          msg (\"[\" + damage + \" damage done]\")\n          this.listalias = \"&lt;span style=\\\"color: red;\\\"&gt;\" + this.alias + \"&lt;/span&gt;\"\n        }\n      }\n      else {\n        PrintOrRun (this, \"attackmissed\")\n      }\n    }\n  }\n}\nmsg (\"\")\n</code></pre>\n<p>Like I said though, the Player's health is mysteriously regenerating instantly too. So I wonder if there is a more underlying problem.</p>\n<p>Anonynn</p>\n\n",
      "PostDate": "2019-11-17T21:34:35.9602781Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "5eac5a1b-b977-4796-b200-f16ca98cc50b",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I notice your `distractscript` treats both `this.distraction` and `this.distract` as numbers.\r\nAs `this.distract` appears to be a script, can I assume that you've renamed the attributes for the purpose of sharing here, and that you already double-checked you have it spelled consistently throughout?",
      "EditableFormat": "markdown",
      "HTML": "<p>I notice your <code>distractscript</code> treats both <code>this.distraction</code> and <code>this.distract</code> as numbers.<br>\nAs <code>this.distract</code> appears to be a script, can I assume that you've renamed the attributes for the purpose of sharing here, and that you already double-checked you have it spelled consistently throughout?</p>\n\n",
      "PostDate": "2019-11-17T22:19:28.3251172Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "fddbb0d0-af6b-4f5e-b5ee-2f71cae49449",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "So…\r\n\r\nWhen run, the distractscript does the following:\r\n\r\n* `If (this.distraction <= 9) {`\r\n   * Set `this.distraction` to a number between 1 and 3, and then increase it by 1 or 2 depending on the player's charmskill\r\n* else\r\n    * this code will never run unless some other script raises `this.distraction` to 9\r\n\r\nWhen your script outputs the message \"The female zombie has gained 3 distraction.\", it means that her distraction is now 3. This might be more than it was before, or it might be less.\r\n\r\n\r\nIf I understand the intended effect correctly, you want this script to increase `this.distraction` each time it is run, until it reaches 9, and then run the 'else' clause. Is that what you're after?\r\n\r\nIf so, you might want to change\r\n`this.distraction= GetRandomInt (1,3)`\r\nto\r\n<code style=\"color: green\">this.distraction = this.distraction + GetRandomInt (1,3)</code>\r\n\r\nOr if you want to display the number it was increased by,\r\n<pre><code>    msg (\"&lt;br/>{color:ivory:You've managed to increase her distraction!}\")\r\n<b style=\"color: green\">    increase = GetRandomInt (1,3)\r\n    this.distraction = this.distraction + increase</b>\r\n    msg (\"&lt;br/>{color:ivory:The female zombie has gained \"+ <b style=\"color: green\">increase</b> +\" distraction!}\")\r\n    switch (player.charmskill) {\r\n</code></pre>",
      "EditableFormat": "markdown",
      "HTML": "<p>So…</p>\n<p>When run, the distractscript does the following:</p>\n<ul>\n<li><code>If (this.distraction &lt;= 9) {</code>\n<ul>\n<li>Set <code>this.distraction</code> to a number between 1 and 3, and then increase it by 1 or 2 depending on the player's charmskill</li>\n</ul>\n</li>\n<li>else\n<ul>\n<li>this code will never run unless some other script raises <code>this.distraction</code> to 9</li>\n</ul>\n</li>\n</ul>\n<p>When your script outputs the message \"The female zombie has gained 3 distraction.\", it means that her distraction is now 3. This might be more than it was before, or it might be less.</p>\n<p>If I understand the intended effect correctly, you want this script to increase <code>this.distraction</code> each time it is run, until it reaches 9, and then run the 'else' clause. Is that what you're after?</p>\n<p>If so, you might want to change<br>\n<code>this.distraction= GetRandomInt (1,3)</code><br>\nto<br>\n<code style=\"color: green\">this.distraction = this.distraction + GetRandomInt (1,3)</code></p>\n<p>Or if you want to display the number it was increased by,</p>\n<pre><code>    msg (\"&lt;br/&gt;{color:ivory:You've managed to increase her distraction!}\")\n<b style=\"color: green\">    increase = GetRandomInt (1,3)\n    this.distraction = this.distraction + increase</b>\n    msg (\"&lt;br/&gt;{color:ivory:The female zombie has gained \"+ <b style=\"color: green\">increase</b> +\" distraction!}\")\n    switch (player.charmskill) {\n</code></pre>\n\n",
      "PostDate": "2019-11-17T22:35:37.4462013Z",
      "LastEditDate": "2019-11-17T22:39:35.2126646Z",
      "link": null
    },
    {
      "PostId": "5a80259b-6f4d-4bfe-854d-45c895683987",
      "UserId": 248029,
      "Username": "Anonynn",
      "AvatarUrl": "https://i.imgur.com/HEtnsWqb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "*If I understand the intended effect correctly, you want this script to increase this.distraction each time it is run, until it reaches 9, and then run the 'else' clause. Is that what you're after?*\r\n\r\nYup! \r\n\r\nAnd the script fix worked perfectly on the expression portion but the game still isn't recognizing the rest of the \"this\" in the scripts, like, for example, ```{if this.gender=male:}{if this.gender=female:}``` (despite defining it) and in the *Choice Menu* with the ELSE. \r\n\r\nAlso yes, I've changed some of the variables because they are more adult in nature. I don't have a lot of adult elements in my game since it's mostly focused on RPG/Fantasy but there are some adult themes sprinkled far and between. \r\n\r\nBTW thank you so much so far for all your help! I really appreciate your time.\r\n___\r\nThe choice in the *ELSE* menu is throwing this error (see below) when choosing **ATTACK** (even though I'm using the exact attack scripts in regular combat with minor tweaks to the amount of damage done)...\r\n```\r\nError running script: Error compiling expression '- this.defense': Unknown object or variable 'this'\r\n```\r\nand the Function called from the **DONTATTACK** choice is throwing this...\r\n```\r\nError running script: No parameters passed to DistractEnemy function - expected 1 parameters\r\n```\r\nParameter is *target*\r\n\r\nAnonynn.\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p><em>If I understand the intended effect correctly, you want this script to increase this.distraction each time it is run, until it reaches 9, and then run the 'else' clause. Is that what you're after?</em></p>\n<p>Yup!</p>\n<p>And the script fix worked perfectly on the expression portion but the game still isn't recognizing the rest of the \"this\" in the scripts, like, for example, <code>{if this.gender=male:}{if this.gender=female:}</code> (despite defining it) and in the <em>Choice Menu</em> with the ELSE.</p>\n<p>Also yes, I've changed some of the variables because they are more adult in nature. I don't have a lot of adult elements in my game since it's mostly focused on RPG/Fantasy but there are some adult themes sprinkled far and between.</p>\n<p>BTW thank you so much so far for all your help! I really appreciate your time.</p>\n<hr>\n<p>The choice in the <em>ELSE</em> menu is throwing this error (see below) when choosing <strong>ATTACK</strong> (even though I'm using the exact attack scripts in regular combat with minor tweaks to the amount of damage done)...</p>\n<pre><code>Error running script: Error compiling expression '- this.defense': Unknown object or variable 'this'\n</code></pre>\n<p>and the Function called from the <strong>DONTATTACK</strong> choice is throwing this...</p>\n<pre><code>Error running script: No parameters passed to DistractEnemy function - expected 1 parameters\n</code></pre>\n<p>Parameter is <em>target</em></p>\n<p>Anonynn.</p>\n\n",
      "PostDate": "2019-11-18T05:48:31.5902752Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "1eea2052-9301-44cb-bd64-e09e7802079e",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> The choice in the ELSE menu is throwing this error (see below) \r\n\r\nYou're using `this` inside the script passed to `ShowMenu`. Remember, when the player clicks a menu choice it's now the next turn as far as the engine is concerned; all local variables and parameters have gone away.\r\n\r\nBut while you already saved it in an attribute, you could do:\r\n```\r\n  menulist = Split(\"Don't Attack;Attack Her\", \";\")\r\n  ShowMenu (\"\", menulist, false) {\r\n    this = game.text_processor_this\r\n    if (result = \"Don't Attack\") {\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>The choice in the ELSE menu is throwing this error (see below)</p>\n</blockquote>\n<p>You're using <code>this</code> inside the script passed to <code>ShowMenu</code>. Remember, when the player clicks a menu choice it's now the next turn as far as the engine is concerned; all local variables and parameters have gone away.</p>\n<p>But while you already saved it in an attribute, you could do:</p>\n<pre><code>  menulist = Split(\"Don't Attack;Attack Her\", \";\")\n  ShowMenu (\"\", menulist, false) {\n    this = game.text_processor_this\n    if (result = \"Don't Attack\") {\n</code></pre>\n\n",
      "PostDate": "2019-11-18T08:58:36.6147Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "e02d2d40-148e-456c-9e6b-a6cfbf400858",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> for example, `{if this.gender=male:}{if this.gender=female:}` (despite defining it) and in the \r\n\r\nThat should work. (Aside from the \"After attacking this particular {if …\" line, which I think is called before you set `text_processor_this`).\r\n\r\nI just checked your latest public version of the game. It looks like the `gender` attribute is a stringlist containing the single value `female\"`. So the condition on your `{if` statement boils down to `if (ToString(Split(\"female\")) = \"female\")` in Quest code. I'm not sure if running `ToString` on a single element list would give a string that's equal to its element, but I wouldn't expect it to.\r\n\r\nMaybe I'm wrong, in which case ignore me.\r\n\r\nIf `this.gender` is going to be a list, I think you probably want `{either ListContains(this.gender,\"male\"):him:{either ListContains(this.gender,\"female\"):her:it}}`. (Using `either` rather than `if` because it allows you to call functions in the condition).\r\n\r\n<hr style=\"border-top: 1px solid grey\">\r\n\r\n> and the Function called from the DONTATTACK choice is throwing this...\r\n>\r\n>     Error running script: No parameters passed to DistractEnemy function - expected 1 parameters\r\n\r\nIn the code you posted above, \"Don't attack\" calls the function `DontAttackEnemy`. Is that what you mean by \"DistractEnemy function\"?\r\n\r\nI know you're editing the script to make it more family-friendly, but I can't tell if the problem here is that you've changed a nsfw function name to 2 different things; or if the error is coming from a part of the code you haven't shown.\r\n\r\nIf \"DistractEnemy function\" is the one that's `DontAttackEnemy` in your code sample, and it expects a target parameter, then maybe\r\n<pre><code style=\"color:brown\">    DontAttackEnemy</code></pre>\r\nshould be\r\n<pre><code>    DontAttackEnemy (this)</code></pre>",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>for example, <code>{if this.gender=male:}{if this.gender=female:}</code> (despite defining it) and in the</p>\n</blockquote>\n<p>That should work. (Aside from the \"After attacking this particular {if …\" line, which I think is called before you set <code>text_processor_this</code>).</p>\n<p>I just checked your latest public version of the game. It looks like the <code>gender</code> attribute is a stringlist containing the single value <code>female\"</code>. So the condition on your <code>{if</code> statement boils down to <code>if (ToString(Split(\"female\")) = \"female\")</code> in Quest code. I'm not sure if running <code>ToString</code> on a single element list would give a string that's equal to its element, but I wouldn't expect it to.</p>\n<p>Maybe I'm wrong, in which case ignore me.</p>\n<p>If <code>this.gender</code> is going to be a list, I think you probably want <code>{either ListContains(this.gender,\"male\"):him:{either ListContains(this.gender,\"female\"):her:it}}</code>. (Using <code>either</code> rather than <code>if</code> because it allows you to call functions in the condition).</p>\n<hr style=\"border-top: 1px solid grey\">\n<blockquote>\n<p>and the Function called from the DONTATTACK choice is throwing this...</p>\n<pre><code>Error running script: No parameters passed to DistractEnemy function - expected 1 parameters\n</code></pre>\n</blockquote>\n<p>In the code you posted above, \"Don't attack\" calls the function <code>DontAttackEnemy</code>. Is that what you mean by \"DistractEnemy function\"?</p>\n<p>I know you're editing the script to make it more family-friendly, but I can't tell if the problem here is that you've changed a nsfw function name to 2 different things; or if the error is coming from a part of the code you haven't shown.</p>\n<p>If \"DistractEnemy function\" is the one that's <code>DontAttackEnemy</code> in your code sample, and it expects a target parameter, then maybe</p>\n<pre><code style=\"color: brown\">    DontAttackEnemy</code></pre>\n<p>should be</p>\n<pre><code>    DontAttackEnemy (this)</code></pre>\n\n",
      "PostDate": "2019-11-18T09:30:05.4425047Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "fb005286-c7dc-4dd6-a772-47015f58bdb5",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Also, the male/female thing shows up a lot. That particular bit of text-processor code appears 704 times in your latest public release, so it could well be worth moving it into a function.\r\n\r\nI'd suggest modifying the scriptdictionary `game.textprocessorcommands` to add an element with key \"gender\":\r\n```\r\nparts = Split (LTrim(Mid(section,7)), \":\")\r\nif (parts[0] = \"\") {\r\n  if (HasObject (game, \"text_processor_this)) {\r\n    object = game.text_processor_this\r\n  }\r\n  else {\r\n    object = game.pov\r\n  }\r\n}\r\nelse {\r\n  object = ObjectForTextProcessor (parts[0])\r\n}\r\ngender = object.gender\r\nif (TypeOf (gender) = \"stringlist\") {\r\n  gender = gender[0]\r\n}\r\nelse if (not TypeOf (gender) = \"string\") {\r\n  gender = ToString (gender)\r\n}\r\nif (gender = \"you\" and HasString (object, \"external_gender\")) {\r\n  // Not necessary for your game, but in case someone else decides to copy this code\r\n  // makes the code work correctly for the player object\r\n  gender = object.external_gender\r\n}\r\nswitch (LCase(gender)) {\r\n  case (\"male\", \"him\") {\r\n    result = parts[1]\r\n  }\r\n  case (\"female\", \"her\") {\r\n    result = parts[2]\r\n  }\r\n  default {\r\n    result = parts[3]\r\n  }\r\n}\r\ngame.textprocessorcommandresult = ProcessTextSection (result, data)\r\n```\r\n\r\nIt's a smallish chunk of code, which should mean you can write `{gender this:he:she:it}` or `{gender enemy:guy:girl:creature}`. Moving this into a dedicated text processor command would make your strings shorter and easier to read/debug, as well as reducing the size of your game file.\r\n\r\nAs your game includes a truly impressive amount of text, I think something like this might also ease the workload when adding new bits.",
      "EditableFormat": "markdown",
      "HTML": "<p>Also, the male/female thing shows up a lot. That particular bit of text-processor code appears 704 times in your latest public release, so it could well be worth moving it into a function.</p>\n<p>I'd suggest modifying the scriptdictionary <code>game.textprocessorcommands</code> to add an element with key \"gender\":</p>\n<pre><code>parts = Split (LTrim(Mid(section,7)), \":\")\nif (parts[0] = \"\") {\n  if (HasObject (game, \"text_processor_this)) {\n    object = game.text_processor_this\n  }\n  else {\n    object = game.pov\n  }\n}\nelse {\n  object = ObjectForTextProcessor (parts[0])\n}\ngender = object.gender\nif (TypeOf (gender) = \"stringlist\") {\n  gender = gender[0]\n}\nelse if (not TypeOf (gender) = \"string\") {\n  gender = ToString (gender)\n}\nif (gender = \"you\" and HasString (object, \"external_gender\")) {\n  // Not necessary for your game, but in case someone else decides to copy this code\n  // makes the code work correctly for the player object\n  gender = object.external_gender\n}\nswitch (LCase(gender)) {\n  case (\"male\", \"him\") {\n    result = parts[1]\n  }\n  case (\"female\", \"her\") {\n    result = parts[2]\n  }\n  default {\n    result = parts[3]\n  }\n}\ngame.textprocessorcommandresult = ProcessTextSection (result, data)\n</code></pre>\n<p>It's a smallish chunk of code, which should mean you can write <code>{gender this:he:she:it}</code> or <code>{gender enemy:guy:girl:creature}</code>. Moving this into a dedicated text processor command would make your strings shorter and easier to read/debug, as well as reducing the size of your game file.</p>\n<p>As your game includes a truly impressive amount of text, I think something like this might also ease the workload when adding new bits.</p>\n\n",
      "PostDate": "2019-11-18T09:59:33.4514629Z",
      "LastEditDate": "2019-11-24T14:55:29.4369366Z",
      "link": null
    },
    {
      "PostId": "43f61c41-3b69-4394-a9dd-67ab7320e9f0",
      "UserId": 248029,
      "Username": "Anonynn",
      "AvatarUrl": "https://i.imgur.com/HEtnsWqb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Sorry about the delay in the response --- busy couple of days >.< \r\n```\r\n    DontAttackEnemy\r\n\r\nshould be\r\n\r\n    DontAttackEnemy (this)\r\n```\r\nWell, this was a simple fix that made me feel really dumb. I believe it worked perfectly. Thank you!\r\n\r\nAlso, I added that text processor code...\r\n```\r\nparts = Split (LTrim(Mid(section,7)), \":\")\r\nif (parts[0] = \"\") {\r\n  object = game.text_processor_this\r\n}\r\nelse {\r\n  object = ObjectForTextProcessor (parts[0])\r\n}\r\ngender = object.gender\r\nif (TypeOf (gender) = \"stringlist\") {\r\n  gender = gender[0]\r\n}\r\nelse if (not TypeOf (gender) = \"string\") {\r\n  gender = ToString (gender)\r\n}\r\nswitch (LCase(gender)) {\r\n  case (\"male\", \"him\") {\r\n    result = parts[1]\r\n  }\r\n  case (\"female\", \"her\") {\r\n    result = parts[2]\r\n  }\r\n  default {\r\n    result = parts[3]\r\n  }\r\n}\r\ngame.textprocessorcommandresult = ProcessTextSection (result, data)\r\n```\r\nTo the text processor code in the GAME.OBJECT scripts and added this ```{gender this:he:she:it}``` to all of the \"Distract\" code but it's being printed like that in game. For example...\r\n\r\nBlah blah blah {gender this:he:she:it} blah blah blah. So I'm not sure why that isn't working. \r\n________\r\nAlso, a curious little quirk I found is that...your text processor command...\r\n```\r\n  this = game.text_processor_this\r\n```\r\nand this one that I use now and then...\r\n```\r\ngame.text_processor_this = this\r\n```\r\nDon't seem to be interchangeable for some reason. I tried to use yours in replacement to the one I've been using and it was having trouble finding \"this\" but in the menu section, yours worked and the other one I normally use didn't. Weird, huh xD?\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Sorry about the delay in the response --- busy couple of days &gt;.&lt;</p>\n<pre><code>    DontAttackEnemy\n\nshould be\n\n    DontAttackEnemy (this)\n</code></pre>\n<p>Well, this was a simple fix that made me feel really dumb. I believe it worked perfectly. Thank you!</p>\n<p>Also, I added that text processor code...</p>\n<pre><code>parts = Split (LTrim(Mid(section,7)), \":\")\nif (parts[0] = \"\") {\n  object = game.text_processor_this\n}\nelse {\n  object = ObjectForTextProcessor (parts[0])\n}\ngender = object.gender\nif (TypeOf (gender) = \"stringlist\") {\n  gender = gender[0]\n}\nelse if (not TypeOf (gender) = \"string\") {\n  gender = ToString (gender)\n}\nswitch (LCase(gender)) {\n  case (\"male\", \"him\") {\n    result = parts[1]\n  }\n  case (\"female\", \"her\") {\n    result = parts[2]\n  }\n  default {\n    result = parts[3]\n  }\n}\ngame.textprocessorcommandresult = ProcessTextSection (result, data)\n</code></pre>\n<p>To the text processor code in the GAME.OBJECT scripts and added this <code>{gender this:he:she:it}</code> to all of the \"Distract\" code but it's being printed like that in game. For example...</p>\n<p>Blah blah blah {gender this:he:she:it} blah blah blah. So I'm not sure why that isn't working.</p>\n<hr>\n<p>Also, a curious little quirk I found is that...your text processor command...</p>\n<pre><code>  this = game.text_processor_this\n</code></pre>\n<p>and this one that I use now and then...</p>\n<pre><code>game.text_processor_this = this\n</code></pre>\n<p>Don't seem to be interchangeable for some reason. I tried to use yours in replacement to the one I've been using and it was having trouble finding \"this\" but in the menu section, yours worked and the other one I normally use didn't. Weird, huh xD?</p>\n\n",
      "PostDate": "2019-11-20T22:27:08.0565093Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "8f6169dc-88ad-4d78-8fb1-7b959097c168",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> To the text processor code in the GAME.OBJECT scripts \r\n\r\nDid you set it with the key \"gender\"?\r\nThat's the only issue I can think of off the top of my head.\r\n\r\nI wrote that code in the forum without testing it, but I think if there was a mistake in it you'd see an error message.\r\n\r\nIf you changed the name \"gender\" to something else, note that the 7 in the first line is the length of the command including the following space.\r\n\r\nOtherwise, might be worth temporarily adding debugging statements to that script to see what the value of `parts` and `object` are.\r\n\r\n<hr style=\"border-top: 1px solid grey\">\r\n\r\n> Don't seem to be interchangeable for some reason.\r\n\r\n`this` is a local variable. It only exists until the end of the script it's used in.\r\n\r\n`game.text_processor_this` is an attribute of the `game` object, so continues to have the same value until you change it to something else. It's used to tell the text processor functions what the value of `this` was in the script that generated the text.\r\n\r\nI noticed that you already had `game.text_processor_this` before the call to `ShowMenu`. So after `ShowMenu` results in `this` becoming unavailable, you can reverse that and do `this = game.text_processor_this` to set `this` back to what it was before.",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>To the text processor code in the GAME.OBJECT scripts</p>\n</blockquote>\n<p>Did you set it with the key \"gender\"?<br>\nThat's the only issue I can think of off the top of my head.</p>\n<p>I wrote that code in the forum without testing it, but I think if there was a mistake in it you'd see an error message.</p>\n<p>If you changed the name \"gender\" to something else, note that the 7 in the first line is the length of the command including the following space.</p>\n<p>Otherwise, might be worth temporarily adding debugging statements to that script to see what the value of <code>parts</code> and <code>object</code> are.</p>\n<hr style=\"border-top: 1px solid grey\">\n<blockquote>\n<p>Don't seem to be interchangeable for some reason.</p>\n</blockquote>\n<p><code>this</code> is a local variable. It only exists until the end of the script it's used in.</p>\n<p><code>game.text_processor_this</code> is an attribute of the <code>game</code> object, so continues to have the same value until you change it to something else. It's used to tell the text processor functions what the value of <code>this</code> was in the script that generated the text.</p>\n<p>I noticed that you already had <code>game.text_processor_this</code> before the call to <code>ShowMenu</code>. So after <code>ShowMenu</code> results in <code>this</code> becoming unavailable, you can reverse that and do <code>this = game.text_processor_this</code> to set <code>this</code> back to what it was before.</p>\n\n",
      "PostDate": "2019-11-21T11:41:17.5673991Z",
      "LastEditDate": "2019-11-21T11:47:08.8796444Z",
      "link": null
    },
    {
      "PostId": "851ac748-6e1b-4833-abc0-dae6af300538",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "(Just to add: I've now tested the text processor script in my own game, and it works as intended. For games with a large volume of text, I'd say that making your own text processor commands is likely to be a saving in both memory and development time)",
      "EditableFormat": "markdown",
      "HTML": "<p>(Just to add: I've now tested the text processor script in my own game, and it works as intended. For games with a large volume of text, I'd say that making your own text processor commands is likely to be a saving in both memory and development time)</p>\n\n",
      "PostDate": "2019-11-21T22:57:40.5763942Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "d8cce817-b4b5-4d6a-af26-0db2ace70e40",
      "UserId": 248029,
      "Username": "Anonynn",
      "AvatarUrl": "https://i.imgur.com/HEtnsWqb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "So I just went back through and re-added (because I guess it didn't save when I did the play-through) the text processor script and then changed all the scripting over again. I haven't test it out but I have a quick question before I change the last few lines.\r\n\r\nIn the command we have ```{gender:him:her:it}``` etc but how will the text processor recognize when I'm referring to a male or female gender of an enemy if I have something other than ```{if gender.this=male:him}{if gender.this=female:her}```?  \r\n```\r\nFor example, {if gender.this=male:his big masculine body}{if gender.this=female:her slim feminine body}\r\n```\r\nDo I do this..?....\r\n```\r\n{gender this:his big masculine body:her slim feminine body:its strange body}\r\n```\r\nand if so, how will the game recognize the gender?",
      "EditableFormat": "markdown",
      "HTML": "<p>So I just went back through and re-added (because I guess it didn't save when I did the play-through) the text processor script and then changed all the scripting over again. I haven't test it out but I have a quick question before I change the last few lines.</p>\n<p>In the command we have <code>{gender:him:her:it}</code> etc but how will the text processor recognize when I'm referring to a male or female gender of an enemy if I have something other than <code>{if gender.this=male:him}{if gender.this=female:her}</code>?</p>\n<pre><code>For example, {if gender.this=male:his big masculine body}{if gender.this=female:her slim feminine body}\n</code></pre>\n<p>Do I do this..?....</p>\n<pre><code>{gender this:his big masculine body:her slim feminine body:its strange body}\n</code></pre>\n<p>and if so, how will the game recognize the gender?</p>\n\n",
      "PostDate": "2019-11-23T21:45:25.2460908Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "b14ba077-40a7-48ec-a342-79adc74d7eca",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> Do I do this..?....\r\n\r\nLooks right to me. The syntax is:\r\n`{gender object:response if male:response if female:response if other}`\r\n\r\n\r\nThe script compares the gender to \"male\" or \"female\" (as in your types), or \"him\" or \"her\" (in case of the default Quest types); and selects the parameters appropriately.\r\n\r\nAs you're likely to compare an object's gender to the same constants every time you use it, it makes sense for them to be specified once (in the script).\r\nIt's basically replacing 3 text-processor `{if`s with a single Quest `switch`, which reduces both the amount of code and the time taken to run it.\r\n\r\nI realised after posting that it might be a little neater if the same command could be used for the player (whose gender is stored differently in most games; Quest uses the 4th gender \"you\")",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>Do I do this..?....</p>\n</blockquote>\n<p>Looks right to me. The syntax is:<br>\n<code>{gender object:response if male:response if female:response if other}</code></p>\n<p>The script compares the gender to \"male\" or \"female\" (as in your types), or \"him\" or \"her\" (in case of the default Quest types); and selects the parameters appropriately.</p>\n<p>As you're likely to compare an object's gender to the same constants every time you use it, it makes sense for them to be specified once (in the script).<br>\nIt's basically replacing 3 text-processor <code>{if</code>s with a single Quest <code>switch</code>, which reduces both the amount of code and the time taken to run it.</p>\n<p>I realised after posting that it might be a little neater if the same command could be used for the player (whose gender is stored differently in most games; Quest uses the 4th gender \"you\")</p>\n\n",
      "PostDate": "2019-11-23T22:10:28.1591324Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "4ddb77c9-20ef-4aa9-8100-eadbd17f7a6b",
      "UserId": 248029,
      "Username": "Anonynn",
      "AvatarUrl": "https://i.imgur.com/HEtnsWqb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "```{gender object:response if male:response if female:response if other}```\r\n\r\nSo the order doesn't matter? It just finds the 'he;him;his' pronouns and picks male?\r\n\r\nI could have...```{gender object:response if female:response if male:response if other} etc```\r\n\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p><code>{gender object:response if male:response if female:response if other}</code></p>\n<p>So the order doesn't matter? It just finds the 'he;him;his' pronouns and picks male?</p>\n<p>I could have...<code>{gender object:response if female:response if male:response if other} etc</code></p>\n\n",
      "PostDate": "2019-11-23T22:18:52.4496702Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "a2be978c-33e4-4338-b651-324d20cf504c",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "The responses are male, female, and other, in that order.\r\nHaving them in the same order each time is a lot quicker to process than taking the string apart to work out which bit is the condition and which bit is the output.",
      "EditableFormat": "markdown",
      "HTML": "<p>The responses are male, female, and other, in that order.<br>\nHaving them in the same order each time is a lot quicker to process than taking the string apart to work out which bit is the condition and which bit is the output.</p>\n\n",
      "PostDate": "2019-11-23T22:51:06.3120796Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

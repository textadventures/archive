{
  "Topic": {
    "TopicId": "0fqi5sm8t0spqgevofeusq",
    "ForumId": "10",
    "Title": "[SOLVED] Critical rate?",
    "LastUpdated": "2020-12-21T05:21:19.5901205Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "d3730c8d-6851-43e2-8541-dd97addd9cdc",
      "UserId": 445604,
      "Username": "Y4T5UR0",
      "AvatarUrl": "https://i.imgur.com/HJN9Gwwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Basically I'm trying to implement the use of critical hits. Their damage is random, lying between critical damage and 2x critical damage. Meanwhile, normal attack lies between half of the normal attack and normal attack\r\n\r\nSo there are roughly 4 attributes involved: (player attributes, the names aren't exactly these)\r\n**- temporary attack** = integer, used in battle, total damage player has, affected by both critical rate and normal attack\r\n**- critical rate** = integer, used in battle, the likelihood of critical hits happening\r\n**- normal attack** = integer, used in battle, the base damage player has\r\n**- critical damage** = integer, used in battle\r\n\r\nMy initial attempt to do this is to use _if random chance_ using expression instead of numbers (prob that's why it doesn't work, but idk of another way)\r\n\r\n```if (RandomChance(this.citical_rate)) {\r\n  this.temporary_attack = GetRandomInt(this.critical damage,this.critical_damage*2)\r\n}\r\n// In (critical rate)% chance, you get a random number that's between critical damage and 2x critical damage\r\n\r\nelse {\r\n  this.temporary_attack = GetRandomInt(this.normal_attack/2,this.normal_attack)\r\n}\r\n// If not, then you get a random number between 1/2 normal attack and normal attack",
      "EditableFormat": "markdown",
      "HTML": "<p>Basically I'm trying to implement the use of critical hits. Their damage is random, lying between critical damage and 2x critical damage. Meanwhile, normal attack lies between half of the normal attack and normal attack</p>\n<p>So there are roughly 4 attributes involved: (player attributes, the names aren't exactly these)<br>\n<strong>- temporary attack</strong> = integer, used in battle, total damage player has, affected by both critical rate and normal attack<br>\n<strong>- critical rate</strong> = integer, used in battle, the likelihood of critical hits happening<br>\n<strong>- normal attack</strong> = integer, used in battle, the base damage player has<br>\n<strong>- critical damage</strong> = integer, used in battle</p>\n<p>My initial attempt to do this is to use <em>if random chance</em> using expression instead of numbers (prob that's why it doesn't work, but idk of another way)</p>\n<pre><code>  this.temporary_attack = GetRandomInt(this.critical damage,this.critical_damage*2)\n}\n// In (critical rate)% chance, you get a random number that's between critical damage and 2x critical damage\n\nelse {\n  this.temporary_attack = GetRandomInt(this.normal_attack/2,this.normal_attack)\n}\n// If not, then you get a random number between 1/2 normal attack and normal attack\n</code></pre>\n\n",
      "PostDate": "2020-12-21T05:21:19.5901205Z",
      "LastEditDate": "2020-12-23T12:26:20.7183724Z",
      "link": null
    },
    {
      "PostId": "a422aa26-df76-44d1-a65d-77225283160b",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> My initial attempt to do this is to use if random chance using expression instead of numbers (prob that's why it doesn't work, but idk of another way)\r\n\r\nThat should work fine.\r\n\r\nThe if statement is missing from the code you pasted, but what I can see looks like it should be fine. Although I notice you're using both `this.critical damage` and `this.critical_damage`; is the space a typo?\r\n\r\nIf it doesn't work, it would be helpful to share what it does. Are you getting an error message from this code? Does it give an incorrect result?",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>My initial attempt to do this is to use if random chance using expression instead of numbers (prob that's why it doesn't work, but idk of another way)</p>\n</blockquote>\n<p>That should work fine.</p>\n<p>The if statement is missing from the code you pasted, but what I can see looks like it should be fine. Although I notice you're using both <code>this.critical damage</code> and <code>this.critical_damage</code>; is the space a typo?</p>\n<p>If it doesn't work, it would be helpful to share what it does. Are you getting an error message from this code? Does it give an incorrect result?</p>\n\n",
      "PostDate": "2020-12-21T10:22:16.7073928Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "e834a95b-9fd9-442a-9a9f-5ce225d3e9eb",
      "UserId": 445604,
      "Username": "Y4T5UR0",
      "AvatarUrl": "https://i.imgur.com/HJN9Gwwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "```Are you getting an error message from this code? Does it give an incorrect result?```\r\nThere isn't any error message as far as I'm concerned. However, whenever I try to print out the temporary attack, I get 0\r\n\r\n```The if statement is missing from the code you pasted, but what I can see looks like it should be fine. Although I notice you're using both this.critical damage and this.critical_damage; is the space a typo?```\r\nAh, yeah. I forgot the space, but I used a different variable so I think it shouldn't be...\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p><code>Are you getting an error message from this code? Does it give an incorrect result?</code><br>\nThere isn't any error message as far as I'm concerned. However, whenever I try to print out the temporary attack, I get 0</p>\n<p><code>The if statement is missing from the code you pasted, but what I can see looks like it should be fine. Although I notice you're using both this.critical damage and this.critical_damage; is the space a typo?</code><br>\nAh, yeah. I forgot the space, but I used a different variable so I think it shouldn't be...</p>\n\n",
      "PostDate": "2020-12-21T14:14:05.3885798Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "9c894eea-9fb3-4224-9b2c-30fdc4599d8c",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> There isn't any error message as far as I'm concerned. However, whenever I try to print out the temporary attack, I get 0\r\n\r\nOK.\r\nNeither of those statements should give a zero unless your attack is zero.\r\n\r\nSo, 3 more things to check:\r\n1. Is this code actually running? Are you sure there's not some block that prevents it getting here?\r\n2. Are you sure that `this` is the right object?\r\n3. Are you sure that you're printing out the value of the variable after this code is run?\r\n\r\nI'd probably try to narrow down the problem by temporarily changing it to something like:\r\n```\r\nmsg (\"About to calculate temporary_attack\")\r\nforeach (attr, Split(\"critical_damage;critical_rate;normal_attack;temporary_attack\")) {\r\n  msg (attr+\" = \"+GetAttribute(this, attr))\r\n}\r\nif (RandomChance (this.critical_rate)) {\r\n  msg (\"Critical\")\r\n  this.temporary_attack = GetRandomInt(this.critical damage,this.critical_damage*2)\r\n}\r\nelse {\r\n  msg (\"Not critical\")\r\n  this.temporary_attack = GetRandomInt(this.normal_attack/2,this.normal_attack)\r\n}\r\nmsg (\"Temporary attack determined as: \" + this.temporary_attack)\r\n```\r\n\r\nThen you have a whole bunch of messages that should give you a better idea of where the problem lies. Once you've fixed it, you can remove all the extra messages.",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>There isn't any error message as far as I'm concerned. However, whenever I try to print out the temporary attack, I get 0</p>\n</blockquote>\n<p>OK.<br>\nNeither of those statements should give a zero unless your attack is zero.</p>\n<p>So, 3 more things to check:</p>\n<ol>\n<li>Is this code actually running? Are you sure there's not some block that prevents it getting here?</li>\n<li>Are you sure that <code>this</code> is the right object?</li>\n<li>Are you sure that you're printing out the value of the variable after this code is run?</li>\n</ol>\n<p>I'd probably try to narrow down the problem by temporarily changing it to something like:</p>\n<pre><code>msg (\"About to calculate temporary_attack\")\nforeach (attr, Split(\"critical_damage;critical_rate;normal_attack;temporary_attack\")) {\n  msg (attr+\" = \"+GetAttribute(this, attr))\n}\nif (RandomChance (this.critical_rate)) {\n  msg (\"Critical\")\n  this.temporary_attack = GetRandomInt(this.critical damage,this.critical_damage*2)\n}\nelse {\n  msg (\"Not critical\")\n  this.temporary_attack = GetRandomInt(this.normal_attack/2,this.normal_attack)\n}\nmsg (\"Temporary attack determined as: \" + this.temporary_attack)\n</code></pre>\n<p>Then you have a whole bunch of messages that should give you a better idea of where the problem lies. Once you've fixed it, you can remove all the extra messages.</p>\n\n",
      "PostDate": "2020-12-21T15:51:59.0385539Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "075384ba-731a-4cb8-b7eb-48219b001d42",
      "UserId": 445604,
      "Username": "Y4T5UR0",
      "AvatarUrl": "https://i.imgur.com/HJN9Gwwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I tried copying it but as soon as I run it, Quest closes itself. Is it because I used a command to print the temporary attack? And the code I mentioned before was actually from the changedcritical_rate script... I copied the message code to the command script, changed ```this``` to the proper object name",
      "EditableFormat": "markdown",
      "HTML": "<p>I tried copying it but as soon as I run it, Quest closes itself. Is it because I used a command to print the temporary attack? And the code I mentioned before was actually from the changedcritical_rate script... I copied the message code to the command script, changed <code>this</code> to the proper object name</p>\n\n",
      "PostDate": "2020-12-22T05:37:09.6759338Z",
      "LastEditDate": "2020-12-22T05:37:31.1123083Z",
      "link": null
    },
    {
      "PostId": "3e91ea02-285e-4ae9-aa53-df9bec6f9913",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> I tried copying it but as soon as I run it, Quest closes itself.\r\n\r\nThat's really strange, and I can't see how it could happen. I'll see if I can figure it out.\r\n\r\n> And the code I mentioned before was actually from the changedcritical_rate script\r\n\r\nDoes this mean that the critical_rate changes every time you attack?",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>I tried copying it but as soon as I run it, Quest closes itself.</p>\n</blockquote>\n<p>That's really strange, and I can't see how it could happen. I'll see if I can figure it out.</p>\n<blockquote>\n<p>And the code I mentioned before was actually from the changedcritical_rate script</p>\n</blockquote>\n<p>Does this mean that the critical_rate changes every time you attack?</p>\n\n",
      "PostDate": "2020-12-22T09:01:29.5357891Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "d1035dfb-6973-4902-82fb-1a83f3510a6b",
      "UserId": 445604,
      "Username": "Y4T5UR0",
      "AvatarUrl": "https://i.imgur.com/HJN9Gwwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": ">Does this mean that the critical_rate changes every time you attack?\r\n\r\nMy bad. I mean changedtemporary_attack*",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>Does this mean that the critical_rate changes every time you attack?</p>\n</blockquote>\n<p>My bad. I mean changedtemporary_attack*</p>\n\n",
      "PostDate": "2020-12-22T11:05:33.8145224Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "b5bba6dc-fd91-486b-9e31-984b4179da18",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Ah… so what else changes the temporary attack?",
      "EditableFormat": "markdown",
      "HTML": "<p>Ah… so what else changes the temporary attack?</p>\n\n",
      "PostDate": "2020-12-22T11:14:35.5225803Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "0bd16dca-6a4e-49b8-8ad2-90b5da9d3e05",
      "UserId": 445604,
      "Username": "Y4T5UR0",
      "AvatarUrl": "https://i.imgur.com/HJN9Gwwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Only critical_damage, normal_attack, and critical_rate for % \r\nI can give you the complete code too through message if you want. In case the problem actually lies somewhere else",
      "EditableFormat": "markdown",
      "HTML": "<p>Only critical_damage, normal_attack, and critical_rate for %<br>\nI can give you the complete code too through message if you want. In case the problem actually lies somewhere else</p>\n\n",
      "PostDate": "2020-12-22T11:28:19.9139229Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "d5d5ec0d-6769-4367-9dfd-9d083ec758ed",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "OK, now that makes sense.\r\n\r\nI think you misunderstand what a changescript is for.\r\n\r\nThe script `changedtemporary_attack` will be automatically run every time `temporary_attack` is changed. As the attribute is staying at zero, I assume that you're not changing temporary_attack somewhere else, so that script is never run.\r\n\r\nAt some point when testing, you added a line to some other function or command that changes `temporary_attack`. Now, it runs that script, which immediately calculates a new value for `temporary_attack`. This causes the script `changedtemporary_attack` to be run. Which causes the value of `temporary_attack` to change again, which causes the script to run again.\r\n\r\nIt keeps on running that script over and over until it generates the same value twice in a row (so there's no change); or until it runs out of memory and crashes.",
      "EditableFormat": "markdown",
      "HTML": "<p>OK, now that makes sense.</p>\n<p>I think you misunderstand what a changescript is for.</p>\n<p>The script <code>changedtemporary_attack</code> will be automatically run every time <code>temporary_attack</code> is changed. As the attribute is staying at zero, I assume that you're not changing temporary_attack somewhere else, so that script is never run.</p>\n<p>At some point when testing, you added a line to some other function or command that changes <code>temporary_attack</code>. Now, it runs that script, which immediately calculates a new value for <code>temporary_attack</code>. This causes the script <code>changedtemporary_attack</code> to be run. Which causes the value of <code>temporary_attack</code> to change again, which causes the script to run again.</p>\n<p>It keeps on running that script over and over until it generates the same value twice in a row (so there's no change); or until it runs out of memory and crashes.</p>\n\n",
      "PostDate": "2020-12-22T11:49:17.5026591Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "3d81809c-03be-4a14-8e0e-5111b780f609",
      "UserId": 445604,
      "Username": "Y4T5UR0",
      "AvatarUrl": "https://i.imgur.com/HJN9Gwwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Ohh I see...\r\nYeah, it's working now\r\n\r\nThanks a lot :DD",
      "EditableFormat": "markdown",
      "HTML": "<p>Ohh I see...<br>\nYeah, it's working now</p>\n<p>Thanks a lot :DD</p>\n\n",
      "PostDate": "2020-12-22T12:26:41.5994635Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "6bf3383c-4e37-4edd-a1c7-37f1a67b9ed9",
      "UserId": 207026,
      "Username": "Pykrete",
      "AvatarUrl": "https://i.imgur.com/1bNzUShb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Personally, I based my combat system off of old D20 rules. A dice roll of 1d20 is applied to the player's hit roll, which is then modified with the player's buffs/penalties. However, after the accuracy roll is calculated against the enemy's dodge (which sets an integer I can sum up as 'did it hit?' with 0 being fail and 1 being hit), I then check that dice roll (and subtract or add to it if the player has any critical/keen buffs). \r\n\r\nIf it's 1 or below, I change the hit check to a fail. If it's 2-19 no change is made. If it's 20 or above, I change the hit check to a 2 instead. Finally, an if script checks it; 0 misses, 1 hits, and 2 hits with some different more exciting flavour text and multiplies the damage (either by 2 or 1.5, in the latter case of which I round the resulting damage.)\r\n\r\nQuest offers so many ways of handling random chance that there's no wrong way to do it, imo! If it works for you, it works. :)",
      "EditableFormat": "markdown",
      "HTML": "<p>Personally, I based my combat system off of old D20 rules. A dice roll of 1d20 is applied to the player's hit roll, which is then modified with the player's buffs/penalties. However, after the accuracy roll is calculated against the enemy's dodge (which sets an integer I can sum up as 'did it hit?' with 0 being fail and 1 being hit), I then check that dice roll (and subtract or add to it if the player has any critical/keen buffs).</p>\n<p>If it's 1 or below, I change the hit check to a fail. If it's 2-19 no change is made. If it's 20 or above, I change the hit check to a 2 instead. Finally, an if script checks it; 0 misses, 1 hits, and 2 hits with some different more exciting flavour text and multiplies the damage (either by 2 or 1.5, in the latter case of which I round the resulting damage.)</p>\n<p>Quest offers so many ways of handling random chance that there's no wrong way to do it, imo! If it works for you, it works. :)</p>\n\n",
      "PostDate": "2020-12-24T13:06:11.5893386Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

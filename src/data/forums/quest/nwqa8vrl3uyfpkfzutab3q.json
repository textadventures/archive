{
  "Topic": {
    "TopicId": "nwqa8vrl3uyfpkfzutab3q",
    "ForumId": "10",
    "Title": "A weird error with wereables",
    "LastUpdated": "2018-12-28T11:41:03.4960244Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "a1eca74a-c12d-4908-b3d9-5bf2f4d15bc2",
      "UserId": 393010,
      "Username": "Keisser",
      "AvatarUrl": "https://i.imgur.com/ZPplnIJb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Sorry for my bad English in advance.\r\nAfter creating a first wereable (I am using a default library) item and starting a game I tried to wear it and ran into a strange exception. It says \"Error running script: Error compiling expression 'player': Unknown object or variable 'player'\". This is definitely due to the fact I have my player object renamed but it looks like that the library tries to refer to player object using a default name hidden somewhere in the depths of library code. Renaming player object back to \"player\" works, but I would like to avoid it because there are a lot of references to the player object using it's \"new\" name. How do I bypass that exception?\r\nP.S. I use a standard editor and I don't really work with the game code in code view because I am still a profane to Quest.",
      "EditableFormat": "markdown",
      "HTML": "<p>Sorry for my bad English in advance.<br>\nAfter creating a first wereable (I am using a default library) item and starting a game I tried to wear it and ran into a strange exception. It says \"Error running script: Error compiling expression 'player': Unknown object or variable 'player'\". This is definitely due to the fact I have my player object renamed but it looks like that the library tries to refer to player object using a default name hidden somewhere in the depths of library code. Renaming player object back to \"player\" works, but I would like to avoid it because there are a lot of references to the player object using it's \"new\" name. How do I bypass that exception?<br>\nP.S. I use a standard editor and I don't really work with the game code in code view because I am still a profane to Quest.</p>\n\n",
      "PostDate": "2018-12-28T11:41:03.4960244Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "221684af-bca4-4d27-9f87-5d3263031919",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "What do you mean by \"I am using a default library\"? There are libraries for wearable out there, but they got incorporated into Quest itself, so you do not need to add a library yourself.",
      "EditableFormat": "markdown",
      "HTML": "<p>What do you mean by \"I am using a default library\"? There are libraries for wearable out there, but they got incorporated into Quest itself, so you do not need to add a library yourself.</p>\n\n",
      "PostDate": "2018-12-28T13:17:30.8409256Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "ca4fbce1-9eca-4d8c-aed3-d01be8443a83",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "@pixie I took that to mean \"I am using the default library\"; meaning the default wearables system.\r\n\r\nThe function `SetBonuses` contains a single reference to the object name `player`.\r\n\r\n@Keisser\r\nDo you know how to override the default functions? If I'm understanding you correctly, then you may need to modify the function `SetBonuses`.\r\nOpen the function in code view. Towards the end you will find the line `set (player, att, n)`. You should change this to `set (game.pov, att, n)`\r\n\r\nIf you need any help with this, I'm sure there will be plenty of people more able to help you.",
      "EditableFormat": "markdown",
      "HTML": "<p>@pixie I took that to mean \"I am using the default library\"; meaning the default wearables system.</p>\n<p>The function <code>SetBonuses</code> contains a single reference to the object name <code>player</code>.</p>\n<p>@Keisser<br>\nDo you know how to override the default functions? If I'm understanding you correctly, then you may need to modify the function <code>SetBonuses</code>.<br>\nOpen the function in code view. Towards the end you will find the line <code>set (player, att, n)</code>. You should change this to <code>set (game.pov, att, n)</code></p>\n<p>If you need any help with this, I'm sure there will be plenty of people more able to help you.</p>\n\n",
      "PostDate": "2018-12-28T16:21:26.9068022Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "2914b7b4-88fc-43a9-87ae-4cabbb7010bb",
      "UserId": 393010,
      "Username": "Keisser",
      "AvatarUrl": "https://i.imgur.com/ZPplnIJb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thank you @mrangel, your solution worked perfectly.\r\nNow I faced another minor problem:  for some reason, there is a \"Drop\" verb being displayed in inventory and I see no way to get rid of it. \"Object can be dropped\" checkbox in editor is disabled and there is no \"Drop\" verb in verb list but somehow the \"Drop\" action still appears. This is probably due to the way ```SetVerbs``` function works.",
      "EditableFormat": "markdown",
      "HTML": "<p>Thank you @mrangel, your solution worked perfectly.<br>\nNow I faced another minor problem:  for some reason, there is a \"Drop\" verb being displayed in inventory and I see no way to get rid of it. \"Object can be dropped\" checkbox in editor is disabled and there is no \"Drop\" verb in verb list but somehow the \"Drop\" action still appears. This is probably due to the way <code>SetVerbs</code> function works.</p>\n\n",
      "PostDate": "2018-12-29T11:14:50.8405566Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "55b437c7-1a05-4c90-bd66-38d6126add8f",
      "UserId": 393010,
      "Username": "Keisser",
      "AvatarUrl": "https://i.imgur.com/ZPplnIJb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I looked at ```SetVerbs``` but I did not found out how it really works so I decided to not to touch anything for now.",
      "EditableFormat": "markdown",
      "HTML": "<p>I looked at <code>SetVerbs</code> but I did not found out how it really works so I decided to not to touch anything for now.</p>\n\n",
      "PostDate": "2018-12-29T11:23:11.7415894Z",
      "LastEditDate": "2018-12-29T11:50:43.8425231Z",
      "link": null
    },
    {
      "PostId": "fd659966-a987-4a4f-9fed-9dfecfe9493a",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "(EDITed: one more typo fix)\r\n\r\nI'm looking at the function `_SetVerbsForGarment`, and it looks a bit odd to me.\r\n\r\nI'd probably have it something more like…\r\n\r\n```\r\nautomaticverbs = NewStringList()\r\nlist add (automaticverbs, Template(\"LookAt\"))\r\nouter = _GetOuterForGarment(game.pov, garment)\r\nif (garment.worn) {\r\n  garmentverbs = GetString (garment, \"wornverbs\")\r\n  if (outer = null and GetBoolean (garment, \"removeable\")) {\r\n    list add (automaticverbs, Template(\"Remove\"))\r\n  }\r\n}\r\nelse {\r\n  garmentverbs = GetString (garment, \"invverbs\")\r\n  if (HasScript (garment, \"drop\") or GetBoolean (garment, \"drop\")) {\r\n    list add (automaticverbs, Template(\"Drop\"))\r\n  }\r\n  if (not outer = null) {\r\n    outer_layer = outer.wear_layer\r\n  }\r\n  else {\r\n    outer_layer = garment.wear_layer - 1\r\n  }\r\n  if (outer_layer < garment.wear_layer) {\r\n    list add (automaticverbs, Template(\"Wear\"))\r\n  }\r\n}\r\nif (garmentverbs = null or garmentverbs = \"\") {\r\n  garment.inventoryverbs = automaticverbs\r\n}\r\nelse {\r\n  garment.inventoryverbs = ListCompact (ListCombine (automaticverbs, Split(garmentverbs)))\r\n}\r\n```\r\n\r\nI figured that rewriting the function was easier than modifying it, because of the way the existing function uses static lists.\r\nThis version should behave the same, except that it only includes the \"Drop\" verb for garments which are dropable.\r\n\r\n(Sorry if there's any errors, I haven't tested it)",
      "EditableFormat": "markdown",
      "HTML": "<p>(EDITed: one more typo fix)</p>\n<p>I'm looking at the function <code>_SetVerbsForGarment</code>, and it looks a bit odd to me.</p>\n<p>I'd probably have it something more like…</p>\n<pre><code>automaticverbs = NewStringList()\nlist add (automaticverbs, Template(\"LookAt\"))\nouter = _GetOuterForGarment(game.pov, garment)\nif (garment.worn) {\n  garmentverbs = GetString (garment, \"wornverbs\")\n  if (outer = null and GetBoolean (garment, \"removeable\")) {\n    list add (automaticverbs, Template(\"Remove\"))\n  }\n}\nelse {\n  garmentverbs = GetString (garment, \"invverbs\")\n  if (HasScript (garment, \"drop\") or GetBoolean (garment, \"drop\")) {\n    list add (automaticverbs, Template(\"Drop\"))\n  }\n  if (not outer = null) {\n    outer_layer = outer.wear_layer\n  }\n  else {\n    outer_layer = garment.wear_layer - 1\n  }\n  if (outer_layer &lt; garment.wear_layer) {\n    list add (automaticverbs, Template(\"Wear\"))\n  }\n}\nif (garmentverbs = null or garmentverbs = \"\") {\n  garment.inventoryverbs = automaticverbs\n}\nelse {\n  garment.inventoryverbs = ListCompact (ListCombine (automaticverbs, Split(garmentverbs)))\n}\n</code></pre>\n<p>I figured that rewriting the function was easier than modifying it, because of the way the existing function uses static lists.<br>\nThis version should behave the same, except that it only includes the \"Drop\" verb for garments which are dropable.</p>\n<p>(Sorry if there's any errors, I haven't tested it)</p>\n\n",
      "PostDate": "2018-12-29T12:35:54.7018005Z",
      "LastEditDate": "2019-01-10T08:33:23.502499Z",
      "link": null
    },
    {
      "PostId": "175909e2-367d-4d5d-96be-68c7f983773b",
      "UserId": 393010,
      "Username": "Keisser",
      "AvatarUrl": "https://i.imgur.com/ZPplnIJb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "@mrangel thank you for the solution, the \"Drop\" verb disappeared... Among with the \"Wear\" verb.\r\n\"Wear\" can still be added via \"Object\" tab, but it does not disappear after a wereable is worn.",
      "EditableFormat": "markdown",
      "HTML": "<p>@mrangel thank you for the solution, the \"Drop\" verb disappeared... Among with the \"Wear\" verb.<br>\n\"Wear\" can still be added via \"Object\" tab, but it does not disappear after a wereable is worn.</p>\n\n",
      "PostDate": "2019-01-02T00:09:45.7285281Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "83868b0a-ce72-4263-8824-5c0c33231c13",
      "UserId": 277074,
      "Username": "Dcoder",
      "AvatarUrl": "http://i.imgur.com/d9UrZ6lb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "wereables = those able to assume lycanthropic form",
      "EditableFormat": "markdown",
      "HTML": "<p>wereables = those able to assume lycanthropic form</p>\n\n",
      "PostDate": "2019-01-02T00:25:40.5018642Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "22841a79-d533-4d00-a85a-f7dba1ef59ba",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> @mrangel thank you for the solution, the \"Drop\" verb disappeared... Among with the \"Wear\" verb.\r\n\r\nOops, I was careless. It hides the 'Wear' command if you're already wearing a garment on a higher layer, just like the default one. But I messed up the case where you're not wearing anything.\r\n\r\nShould be fixed now",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>@mrangel thank you for the solution, the \"Drop\" verb disappeared... Among with the \"Wear\" verb.</p>\n</blockquote>\n<p>Oops, I was careless. It hides the 'Wear' command if you're already wearing a garment on a higher layer, just like the default one. But I messed up the case where you're not wearing anything.</p>\n<p>Should be fixed now</p>\n\n",
      "PostDate": "2019-01-02T09:08:11.388779Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "d121acd7-ecbc-4473-bda6-881c83585221",
      "UserId": 393010,
      "Username": "Keisser",
      "AvatarUrl": "https://i.imgur.com/ZPplnIJb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "@mrangel\r\n```\r\nError running script: Error compiling expression 'ListCompact (ListCombine (automaticverbs, garmentverbs))': FunctionCallElement: Could find not function 'ListCombine(QuestList`1; String)'\r\n```\r\nI am starting to think that this library is cursed.",
      "EditableFormat": "markdown",
      "HTML": "<p>@mrangel</p>\n<pre><code>Error running script: Error compiling expression 'ListCompact (ListCombine (automaticverbs, garmentverbs))': FunctionCallElement: Could find not function 'ListCombine(QuestList`1; String)'\n</code></pre>\n<p>I am starting to think that this library is cursed.</p>\n\n",
      "PostDate": "2019-01-03T17:40:13.663601Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "19fb213b-6ebb-432c-81d5-50b63ebfb5fb",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Ooops; last line\r\n`garment.inventoryverbs = ListCompact (ListCombine (automaticverbs, garmentverbs))`\r\nshould be\r\n`garment.inventoryverbs = ListCompact (ListCombine (automaticverbs, Split(garmentverbs)))`\r\n\r\nSorry, I wasn't paying enough attention. Code in the post above changed; hoping I haven't made any more mistakes.",
      "EditableFormat": "markdown",
      "HTML": "<p>Ooops; last line<br>\n<code>garment.inventoryverbs = ListCompact (ListCombine (automaticverbs, garmentverbs))</code><br>\nshould be<br>\n<code>garment.inventoryverbs = ListCompact (ListCombine (automaticverbs, Split(garmentverbs)))</code></p>\n<p>Sorry, I wasn't paying enough attention. Code in the post above changed; hoping I haven't made any more mistakes.</p>\n\n",
      "PostDate": "2019-01-03T22:54:24.1735892Z",
      "LastEditDate": "2019-01-03T22:56:53.501895Z",
      "link": null
    },
    {
      "PostId": "acc03982-745e-4e96-bd49-1ac47b2ae642",
      "UserId": 393010,
      "Username": "Keisser",
      "AvatarUrl": "https://i.imgur.com/ZPplnIJb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "@mrangel Thank you, everything is working perfectly now.\r\nThere is a minor misspelling in the code:\r\n```\r\nif (garnentverbs = null or garmentverbs = \"\") {\r\n```\r\nshould be gar**m**entverbs",
      "EditableFormat": "markdown",
      "HTML": "<p>@mrangel Thank you, everything is working perfectly now.<br>\nThere is a minor misspelling in the code:</p>\n<pre><code>if (garnentverbs = null or garmentverbs = \"\") {\n</code></pre>\n<p>should be gar<strong>m</strong>entverbs</p>\n\n",
      "PostDate": "2019-01-09T19:31:18.4085632Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "eace2d47-0a34-4873-b098-211cab795d1a",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "That's the downside of typing code in the forum, on my phone. Hard to spot stuff like that on a tiny screen :)\r\nGood to see it working.",
      "EditableFormat": "markdown",
      "HTML": "<p>That's the downside of typing code in the forum, on my phone. Hard to spot stuff like that on a tiny screen :)<br>\nGood to see it working.</p>\n\n",
      "PostDate": "2019-01-10T08:32:40.5458298Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

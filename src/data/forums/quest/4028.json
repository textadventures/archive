{
  "Topic": {
    "TopicId": "4028",
    "ForumId": "10",
    "Title": "Regular Expressions",
    "LastUpdated": "2013-12-04T03:49:47+00:00",
    "ReplyCount": 13
  },
  "Posts": [
    {
      "PostId": "26963",
      "UserId": 0,
      "Username": "Avantar",
      "UserAvatar": "7009_1418309433.jpg",
      "UserGravatar": "86de2b95c147252a1c38b8d3996da855",
      "EditableText": "Me again...stuck\n\nIf I have a word, let's say 'Hellfire' and I want to change the name to only 'fire' or 'hell' via regular expressions - how would I do it.\n\nThe best I could come up with is:\n\n[code:1oynhyeg]object&#46;name=msg ^\\w{4}(?&lt;this&#46;name&gt;)$[/code:1oynhyeg]\n\nThis,of course, does not work.\n\nAny help would be appreciated.\n\nPs: I guess what best describes what I want to do, is to remove the first 4 letters of the word to create the object's new name.",
      "EditableFormat": "bbcode",
      "HTML": "Me again...stuck<br/><br/>If I have a word, let's say 'Hellfire' and I want to change the name to only 'fire' or 'hell' via regular expressions - how would I do it.<br/><br/>The best I could come up with is:<br/><br/><pre><code>object&#46;name=msg ^\\w{4}(?&lt;this&#46;name&gt;)$</code></pre><br/><br/>This,of course, does not work.<br/><br/>Any help would be appreciated.<br/><br/>Ps: I guess what best describes what I want to do, is to remove the first 4 letters of the word to create the object's new name.",
      "PostDate": "2013-11-30T14:39:02+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "26964",
      "UserId": 0,
      "Username": "The Pixie",
      "UserAvatar": null,
      "UserGravatar": "cfa37e927f96177bcf6053ae8f108f77",
      "EditableText": "Does it have to be with RegEx? I would use the Left or Right functions.\n\n<!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/Category:String_Functions\">http://quest5.net/wiki/Category:String_Functions</a><!-- m -->",
      "EditableFormat": "bbcode",
      "HTML": "Does it have to be with RegEx? I would use the Left or Right functions.<br/><br/><!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/Category:String_Functions\">http://quest5.net/wiki/Category:String_Functions</a><!-- m -->",
      "PostDate": "2013-11-30T16:59:04+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "26965",
      "UserId": 0,
      "Username": "Avantar",
      "UserAvatar": "7009_1418309433.jpg",
      "UserGravatar": "86de2b95c147252a1c38b8d3996da855",
      "EditableText": "Thank you again Pixie!\n\nNope, it does not have to be regex. I didn't know there was a left$ and right$ function.\n\nI must say, my game template wouldn't have been a 1/4 done if it wasn't for your and Pertex's scripts that you have posted.\nAlso just want to mention HK and Jaynabonne for their tremendous effort in helping me with the weapon equiping.\n\nThanks again guys/ladies! (not sure)",
      "EditableFormat": "bbcode",
      "HTML": "Thank you again Pixie!<br/><br/>Nope, it does not have to be regex. I didn't know there was a left$ and right$ function.<br/><br/>I must say, my game template wouldn't have been a 1/4 done if it wasn't for your and Pertex's scripts that you have posted.<br/>Also just want to mention HK and Jaynabonne for their tremendous effort in helping me with the weapon equiping.<br/><br/>Thanks again guys/ladies! (not sure)",
      "PostDate": "2013-11-30T18:16:46+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "26966",
      "UserId": 0,
      "Username": "Avantar",
      "UserAvatar": "7009_1418309433.jpg",
      "UserGravatar": "86de2b95c147252a1c38b8d3996da855",
      "EditableText": "Well, Pixie.\n\nSince it is your script I am busy with, maybe you can help; since the idea I had does not work.\nThe script I am using from you is the 'Shop'.\nSo with the shop, you are able to buy, but not sell. I added the selling part, but if the shop sells shoes and you buy some shoes, it clones it obviously and create the name shoes1,2,3....\nIf I want to sell shoes I have bought from the shop, it will ask me which shoes I want to sell  - it also includes the shoes in the shop; since it is visible too.\n\nThat is why I wanted to actually change the actual name of the shoes in the shop and the cloned shoes (but not shoes1) - but you are not allowed to do that outside editor mode. Come to think of it, it still wouldn't have worked anyway - it would end up trying to make duplicate names.\n\nWould there be a way around this?",
      "EditableFormat": "bbcode",
      "HTML": "Well, Pixie.<br/><br/>Since it is your script I am busy with, maybe you can help; since the idea I had does not work.<br/>The script I am using from you is the 'Shop'.<br/>So with the shop, you are able to buy, but not sell. I added the selling part, but if the shop sells shoes and you buy some shoes, it clones it obviously and create the name shoes1,2,3....<br/>If I want to sell shoes I have bought from the shop, it will ask me which shoes I want to sell  - it also includes the shoes in the shop; since it is visible too.<br/><br/>That is why I wanted to actually change the actual name of the shoes in the shop and the cloned shoes (but not shoes1) - but you are not allowed to do that outside editor mode. Come to think of it, it still wouldn't have worked anyway - it would end up trying to make duplicate names.<br/><br/>Would there be a way around this?",
      "PostDate": "2013-11-30T18:41:03+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "26967",
      "UserId": 0,
      "Username": "george",
      "UserAvatar": null,
      "UserGravatar": "dc6fe8e6172303d85249a13c9a49c1ff",
      "EditableText": "It sounds like all of your items should have unique names, but then also an alias (that may not be unique). Then you could exclude the shop shoes (by unique name) in your script that checks for what is sellable.\n\nWhen you clone items for your shop, what you could do is create the unique name by adding a number ID to the item name. Keep the last number ID in a separate game attribute, and when you use it, increase it by 1.",
      "EditableFormat": "bbcode",
      "HTML": "It sounds like all of your items should have unique names, but then also an alias (that may not be unique). Then you could exclude the shop shoes (by unique name) in your script that checks for what is sellable.<br/><br/>When you clone items for your shop, what you could do is create the unique name by adding a number ID to the item name. Keep the last number ID in a separate game attribute, and when you use it, increase it by 1.",
      "PostDate": "2013-11-30T19:20:57+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "26968",
      "UserId": 0,
      "Username": "HegemonKhan",
      "UserAvatar": null,
      "UserGravatar": "a96cf34d8d97c57de38f54ee22b1759b",
      "EditableText": "Pixie and George can help you much better than I, as they're skilled coders, but maybe I can help you with your &quot;hellfire&quot; question (if this is what you wanted):\n\ncan't you just use the &quot;split&quot; and &quot;join&quot; functions?\n\n<!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/Split\">http://quest5.net/wiki/Split</a><!-- m -->\n<!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/Join\">http://quest5.net/wiki/Join</a><!-- m -->\n\n--------------\n\nSplit:\n\nsplit (&quot;male;female&quot;,&quot;;&quot;) -&gt; (1) male (2) female\n\nshow menu (&quot;What is your gender?&quot;, split (&quot;male;female&quot;,&quot;;&quot;), false) {\n-&gt; player.gender_string = result\n}\n\nP.S.\n\nwhen I do:\n\n&lt;start type=&quot;script&quot;&gt;\n-&gt; hellfire_string_list = split (&quot;hell;fire&quot;,&quot;;&quot;)\n-&gt; msg (hellfire_string_list)\n&lt;/start&gt;\n\nReturning Value: List: hell; fire; \n\nwhy do I get the last semicolon after fire? (I know this is the coded value return, but the un-needed semicolon is annoying)\n\nThis doesn't occur when using &quot;split&quot; within the &quot;show menu&quot; function.\n\n-------------\n\nJoin:\n\nCan someone show me what the syntax would look like, as I can't figure it out from the wiki link ???\n\nI understand (hopefully this is correct) that what &quot;join&quot; does is this (similiar to or same as concatenation):\n\n(1) &quot;hellfire&quot; -&gt; split -&gt; (1) &quot;hell&quot;, and (2) &quot;fire&quot;\n\nand join is the inverse...\n\n(1) &quot;hell&quot;, and (2) &quot;fire&quot; -&gt; join -&gt; (1) &quot;hellfire&quot;\n\nor is this not what the join does?\n\nbut I can't figure out what the syntax is for the &quot;Join&quot; function,\n\nso, I'd be very appreciative if someone could show me an example of how to do the syntax for the &quot;join&quot; function.\n\nI've tried:\n\n1. join (&quot;hell;fire&quot;,&quot;;&quot;)\n\n&lt;game name=&quot;blah&quot;&gt;\n-&gt; &lt;hellfire_string_list type=&quot;simplestringlist&quot;&gt;hell;fire&lt;/hellfire_string_list&gt;\n&lt;/game&gt;\n\n2. join (game.hellfire_string_list)\n\n3. join (game.hellfire_string_list, &quot;hell;fire&quot;, &quot;;&quot;)\n\nis this below the correct syntax? (I haven't tried this yet...)\n\njoin (&quot;game.hellfire_string_list.hell;fire&quot;,&quot;;&quot;)\n~OR~\njoin (&quot;game.hellfire_string_list.hell;game.hellfire_string_list.fire&quot;,&quot;;&quot;)",
      "EditableFormat": "bbcode",
      "HTML": "Pixie and George can help you much better than I, as they're skilled coders, but maybe I can help you with your &quot;hellfire&quot; question (if this is what you wanted):<br/><br/>can't you just use the &quot;split&quot; and &quot;join&quot; functions?<br/><br/><!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/Split\">http://quest5.net/wiki/Split</a><!-- m --><br/><!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/Join\">http://quest5.net/wiki/Join</a><!-- m --><br/><br/>--------------<br/><br/>Split:<br/><br/>split (&quot;male;female&quot;,&quot;;&quot;) -&gt; (1) male (2) female<br/><br/>show menu (&quot;What is your gender?&quot;, split (&quot;male;female&quot;,&quot;;&quot;), false) {<br/>-&gt; player.gender_string = result<br/>}<br/><br/>P.S.<br/><br/>when I do:<br/><br/>&lt;start type=&quot;script&quot;&gt;<br/>-&gt; hellfire_string_list = split (&quot;hell;fire&quot;,&quot;;&quot;)<br/>-&gt; msg (hellfire_string_list)<br/>&lt;/start&gt;<br/><br/>Returning Value: List: hell; fire; <br/><br/>why do I get the last semicolon after fire? (I know this is the coded value return, but the un-needed semicolon is annoying)<br/><br/>This doesn't occur when using &quot;split&quot; within the &quot;show menu&quot; function.<br/><br/>-------------<br/><br/>Join:<br/><br/>Can someone show me what the syntax would look like, as I can't figure it out from the wiki link ???<br/><br/>I understand (hopefully this is correct) that what &quot;join&quot; does is this (similiar to or same as concatenation):<br/><br/>(1) &quot;hellfire&quot; -&gt; split -&gt; (1) &quot;hell&quot;, and (2) &quot;fire&quot;<br/><br/>and join is the inverse...<br/><br/>(1) &quot;hell&quot;, and (2) &quot;fire&quot; -&gt; join -&gt; (1) &quot;hellfire&quot;<br/><br/>or is this not what the join does?<br/><br/>but I can't figure out what the syntax is for the &quot;Join&quot; function,<br/><br/>so, I'd be very appreciative if someone could show me an example of how to do the syntax for the &quot;join&quot; function.<br/><br/>I've tried:<br/><br/>1. join (&quot;hell;fire&quot;,&quot;;&quot;)<br/><br/>&lt;game name=&quot;blah&quot;&gt;<br/>-&gt; &lt;hellfire_string_list type=&quot;simplestringlist&quot;&gt;hell;fire&lt;/hellfire_string_list&gt;<br/>&lt;/game&gt;<br/><br/>2. join (game.hellfire_string_list)<br/><br/>3. join (game.hellfire_string_list, &quot;hell;fire&quot;, &quot;;&quot;)<br/><br/>is this below the correct syntax? (I haven't tried this yet...)<br/><br/>join (&quot;game.hellfire_string_list.hell;fire&quot;,&quot;;&quot;)<br/>~OR~<br/>join (&quot;game.hellfire_string_list.hell;game.hellfire_string_list.fire&quot;,&quot;;&quot;)",
      "PostDate": "2013-12-01T01:27:06+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "26969",
      "UserId": 0,
      "Username": "Liam315",
      "UserAvatar": null,
      "UserGravatar": "ded290a24d340d761d42c897d08111aa",
      "EditableText": "[quote=&quot;HegemonKhan&quot;:3slztvdh]Can someone show me what the syntax would look like, as I can't figure it out from the wiki link ???[/quote:3slztvdh]\njoin(game.hellfire_string_list,&quot;;&quot;) would output a string &quot;hell;fire&quot;.\n\nThe first parameter can only be a stringlist. It cannot be two or more strings, nor can it be only selective strings from a list. If you want to do either of those two things, you will have to create a new stringlist via a script before using the output of that with the join function. \n\nIt will work on the entirety of a stringlist, placing the second character (in the example a colon) in between each string. So another example join(game.hellfire_string_list,&quot; and &quot;) would output a string &quot;hell and fire&quot;",
      "EditableFormat": "bbcode",
      "HTML": "<blockquote><cite>HegemonKhan wrote:</cite>Can someone show me what the syntax would look like, as I can't figure it out from the wiki link ???</blockquote><br/>join(game.hellfire_string_list,&quot;;&quot;) would output a string &quot;hell;fire&quot;.<br/><br/>The first parameter can only be a stringlist. It cannot be two or more strings, nor can it be only selective strings from a list. If you want to do either of those two things, you will have to create a new stringlist via a script before using the output of that with the join function. <br/><br/>It will work on the entirety of a stringlist, placing the second character (in the example a colon) in between each string. So another example join(game.hellfire_string_list,&quot; and &quot;) would output a string &quot;hell and fire&quot;",
      "PostDate": "2013-12-01T02:22:31+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "26970",
      "UserId": 0,
      "Username": "HegemonKhan",
      "UserAvatar": null,
      "UserGravatar": "a96cf34d8d97c57de38f54ee22b1759b",
      "EditableText": "ah, thank you very much, Liam! the &quot;separator character&quot; is applied to the return value (the output) itself (what I didn't realize), so there's only one input (discounting what you choose for your &quot;separator&quot;) to the &quot;join&quot; function: your stringlist only (and NOT the individual strings~options of your string list)\n\n---------\n\nso, if this is what you wanted, Avantar, you can indeed use the &quot;split&quot; and &quot;join&quot; functions:\n\n&lt;object name &quot;OBJECT&quot;&gt;\n-&gt; &lt;inherit name=&quot;editor_object&quot; /&gt; // remove this line if you're using the &quot;game&quot; Game Object\n-&gt; &lt;hellfire_string_list type=&quot;simplestringlist&quot;&gt;hell;fire&lt;/hellfire_string_list&gt;\n&lt;/object&gt;\n~OR~\nOBJECT.hellfire_string_list = NewStringList ()\nlist add (OBJECT.hellfire_string_list, &quot;hell&quot;)\nlist add (OBJECT.hellfire_string_list, &quot;fire&quot;)\n~OR~\nhellfire_string_list = split (&quot;hell;fire&quot;,&quot; and &quot;) // = hell and fire\nhellfire_string_list = split (&quot;hell;fire&quot;,&quot; or &quot;) // = hell or fire\n~OR~\n&lt;object name &quot;OBJECT&quot;&gt;\n-&gt; &lt;inherit name=&quot;editor_object&quot; /&gt; // remove this line if you're using the &quot;game&quot; Game Object\n-&gt; &lt;hellfire_string_list type=&quot;simplestringlist&quot;&gt;&lt;/hellfire_string_list&gt;\n&lt;/object&gt;\nOBJECT.hellfire_string_list = split (&quot;hell;fire&quot;,&quot; and &quot;) // = hell and fire\nOBJECT.hellfire_string_list = split (&quot;hell;fire&quot;,&quot; or &quot;) // = hell or fire\n~~~~\nOBJECT.hellfire_string = join (OBJECT.hellfire_string_list,&quot;&quot;) // = hellfire\n\nhowever, separating~converting &quot;hellfire&quot; (OBJECT.hellfire_string) into &quot;hell&quot; + &quot;fire&quot; is a bit more tricky... lol",
      "EditableFormat": "bbcode",
      "HTML": "ah, thank you very much, Liam! the &quot;separator character&quot; is applied to the return value (the output) itself (what I didn't realize), so there's only one input (discounting what you choose for your &quot;separator&quot;) to the &quot;join&quot; function: your stringlist only (and NOT the individual strings~options of your string list)<br/><br/>---------<br/><br/>so, if this is what you wanted, Avantar, you can indeed use the &quot;split&quot; and &quot;join&quot; functions:<br/><br/>&lt;object name &quot;OBJECT&quot;&gt;<br/>-&gt; &lt;inherit name=&quot;editor_object&quot; /&gt; // remove this line if you're using the &quot;game&quot; Game Object<br/>-&gt; &lt;hellfire_string_list type=&quot;simplestringlist&quot;&gt;hell;fire&lt;/hellfire_string_list&gt;<br/>&lt;/object&gt;<br/>~OR~<br/>OBJECT.hellfire_string_list = NewStringList ()<br/>list add (OBJECT.hellfire_string_list, &quot;hell&quot;)<br/>list add (OBJECT.hellfire_string_list, &quot;fire&quot;)<br/>~OR~<br/>hellfire_string_list = split (&quot;hell;fire&quot;,&quot; and &quot;) // = hell and fire<br/>hellfire_string_list = split (&quot;hell;fire&quot;,&quot; or &quot;) // = hell or fire<br/>~OR~<br/>&lt;object name &quot;OBJECT&quot;&gt;<br/>-&gt; &lt;inherit name=&quot;editor_object&quot; /&gt; // remove this line if you're using the &quot;game&quot; Game Object<br/>-&gt; &lt;hellfire_string_list type=&quot;simplestringlist&quot;&gt;&lt;/hellfire_string_list&gt;<br/>&lt;/object&gt;<br/>OBJECT.hellfire_string_list = split (&quot;hell;fire&quot;,&quot; and &quot;) // = hell and fire<br/>OBJECT.hellfire_string_list = split (&quot;hell;fire&quot;,&quot; or &quot;) // = hell or fire<br/>~~~~<br/>OBJECT.hellfire_string = join (OBJECT.hellfire_string_list,&quot;&quot;) // = hellfire<br/><br/>however, separating~converting &quot;hellfire&quot; (OBJECT.hellfire_string) into &quot;hell&quot; + &quot;fire&quot; is a bit more tricky... lol",
      "PostDate": "2013-12-01T03:15:00+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "26971",
      "UserId": 0,
      "Username": "The Pixie",
      "UserAvatar": null,
      "UserGravatar": "cfa37e927f96177bcf6053ae8f108f77",
      "EditableText": "[quote=&quot;Avantar&quot;:355bq4li]Well, Pixie.\n\nSince it is your script I am busy with, maybe you can help; since the idea I had does not work.\nThe script I am using from you is the 'Shop'.\nSo with the shop, you are able to buy, but not sell. I added the selling part, but if the shop sells shoes and you buy some shoes, it clones it obviously and create the name shoes1,2,3....\nIf I want to sell shoes I have bought from the shop, it will ask me which shoes I want to sell  - it also includes the shoes in the shop; since it is visible too.\n\nThat is why I wanted to actually change the actual name of the shoes in the shop and the cloned shoes (but not shoes1) - but you are not allowed to do that outside editor mode. Come to think of it, it still wouldn't have worked anyway - it would end up trying to make duplicate names.\n\nWould there be a way around this?[/quote:355bq4li]\nYour sell command needs to capture the text, rather than the object, so &quot;sell #text#&quot; rather than &quot;sell #object#&quot;, then match the text yourself to find an object, but only against objects in the inventory (with ScopeInventory ()).\n\nThis thread might help:\n<!-- l --><a class=\"postlink-local\" href=\"http://forum.textadventures.co.uk/viewtopic.php?f=18&amp;t=3807\">viewtopic.php?f=18&amp;t=3807</a><!-- l -->",
      "EditableFormat": "bbcode",
      "HTML": "<blockquote><cite>Avantar wrote:</cite>Well, Pixie.<br/><br/>Since it is your script I am busy with, maybe you can help; since the idea I had does not work.<br/>The script I am using from you is the 'Shop'.<br/>So with the shop, you are able to buy, but not sell. I added the selling part, but if the shop sells shoes and you buy some shoes, it clones it obviously and create the name shoes1,2,3....<br/>If I want to sell shoes I have bought from the shop, it will ask me which shoes I want to sell  - it also includes the shoes in the shop; since it is visible too.<br/><br/>That is why I wanted to actually change the actual name of the shoes in the shop and the cloned shoes (but not shoes1) - but you are not allowed to do that outside editor mode. Come to think of it, it still wouldn't have worked anyway - it would end up trying to make duplicate names.<br/><br/>Would there be a way around this?</blockquote><br/>Your sell command needs to capture the text, rather than the object, so &quot;sell #text#&quot; rather than &quot;sell #object#&quot;, then match the text yourself to find an object, but only against objects in the inventory (with ScopeInventory ()).<br/><br/>This thread might help:<br/><!-- l --><a class=\"postlink-local\" href=\"http://forum.textadventures.co.uk/viewtopic.php?f=18&amp;t=3807\">viewtopic.php?f=18&amp;t=3807</a><!-- l -->",
      "PostDate": "2013-12-01T12:13:34+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "26972",
      "UserId": 0,
      "Username": "Avantar",
      "UserAvatar": "7009_1418309433.jpg",
      "UserGravatar": "86de2b95c147252a1c38b8d3996da855",
      "EditableText": "Thank you so much for all the replies guys!\n\nAnd thank you, thank you, thank you to you Pixie - it works a treat!",
      "EditableFormat": "bbcode",
      "HTML": "Thank you so much for all the replies guys!<br/><br/>And thank you, thank you, thank you to you Pixie - it works a treat!",
      "PostDate": "2013-12-01T17:16:50+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "26977",
      "UserId": 0,
      "Username": "HegemonKhan",
      "UserAvatar": null,
      "UserGravatar": "a96cf34d8d97c57de38f54ee22b1759b",
      "EditableText": "You don't have to use a Command, you just need to use (include) the Command's Script lines, along with the function call, to use~activate~do the &quot;sell_function&quot; function. Well, depending on what~how you want to do it, will require more stuff than just this above, ask me or others if you need any help with it.\n\n[code:26v54gua]&lt;command name=&quot;sell_command&quot;&gt;\n  &lt;pattern&gt;sell #text#&lt;/pattern&gt;\n  &lt;script&gt;\n    if (GetBoolean (game&#46;pov&#46;parent, &quot;shop&quot;) {\n      sell_function (text)\n    } else {\n      msg (&quot;This is not a shop, you must be at a shop to sell your items&#46;&quot;)\n    } \n  &lt;/script&gt;\n&lt;/command&gt;\n\n&lt;function name=&quot;sell_function&quot; parameters=&quot;text&quot;&gt;&lt;!&#91;CDATA&#91;\n  equipment_x = GetObject (text)\n  if (equipment_x = null) {\n    foreach (item_x, ScopeInventory ()) {\n      if (item_x&#46;alias = text) {\n        equipment_x = item_x\n      } else {\n        msg (&quot;You don't possess this item, so you can't sell what you don't have!&quot;)\n      }\n    }\n  }\n  if (equipment_x &lt;&gt; null) {\n    if (game&#46;pov&#46;parent&#46;cash &gt;= equipment_x&#46;cash) {\n      game&#46;pov&#46;parent&#46;cash = game&#46;pov&#46;parent&#46;cash - equipment_x&#46;cash\n      game&#46;pov&#46;cash = game&#46;pov&#46;cash + equipment_x&#46;cash\n      equipment_x&#46;parent = game&#46;pov&#46;parent\n    } else {\n      msg (&quot;The shop owner unfortunately can't afford the item that you're trying to sell to him&#46;&quot;)\n    }\n  }\n&#93;&#93;&gt;&lt;/function&gt;[/code:26v54gua]\n\nyou can of course add in further (or remove too) conditions, such as if the shop owner even wants to buy the item that you're trying to sell to him.\n\none way to do this is to use a stringlist or object list for the items that the shop owner wants (or for what he doesn't want), and just add in the scripting &quot;checking&quot; for this (I can help with this if you need help).\n\nAnd~or, you might want to add in scripting to make some items non-sellable (&quot;key~quest&quot; type of items, and~or &quot;cursed&quot; type of items, that no one wants to buy off of from you).",
      "EditableFormat": "bbcode",
      "HTML": "You don't have to use a Command, you just need to use (include) the Command's Script lines, along with the function call, to use~activate~do the &quot;sell_function&quot; function. Well, depending on what~how you want to do it, will require more stuff than just this above, ask me or others if you need any help with it.<br/><br/><pre><code>&lt;command name=&quot;sell_command&quot;&gt;<br/>  &lt;pattern&gt;sell #text#&lt;/pattern&gt;<br/>  &lt;script&gt;<br/>    if (GetBoolean (game&#46;pov&#46;parent, &quot;shop&quot;) {<br/>      sell_function (text)<br/>    } else {<br/>      msg (&quot;This is not a shop, you must be at a shop to sell your items&#46;&quot;)<br/>    } <br/>  &lt;/script&gt;<br/>&lt;/command&gt;<br/><br/>&lt;function name=&quot;sell_function&quot; parameters=&quot;text&quot;&gt;&lt;!&#91;CDATA&#91;<br/>  equipment_x = GetObject (text)<br/>  if (equipment_x = null) {<br/>    foreach (item_x, ScopeInventory ()) {<br/>      if (item_x&#46;alias = text) {<br/>        equipment_x = item_x<br/>      } else {<br/>        msg (&quot;You don't possess this item, so you can't sell what you don't have!&quot;)<br/>      }<br/>    }<br/>  }<br/>  if (equipment_x &lt;&gt; null) {<br/>    if (game&#46;pov&#46;parent&#46;cash &gt;= equipment_x&#46;cash) {<br/>      game&#46;pov&#46;parent&#46;cash = game&#46;pov&#46;parent&#46;cash - equipment_x&#46;cash<br/>      game&#46;pov&#46;cash = game&#46;pov&#46;cash + equipment_x&#46;cash<br/>      equipment_x&#46;parent = game&#46;pov&#46;parent<br/>    } else {<br/>      msg (&quot;The shop owner unfortunately can't afford the item that you're trying to sell to him&#46;&quot;)<br/>    }<br/>  }<br/>&#93;&#93;&gt;&lt;/function&gt;</code></pre><br/><br/>you can of course add in further (or remove too) conditions, such as if the shop owner even wants to buy the item that you're trying to sell to him.<br/><br/>one way to do this is to use a stringlist or object list for the items that the shop owner wants (or for what he doesn't want), and just add in the scripting &quot;checking&quot; for this (I can help with this if you need help).<br/><br/>And~or, you might want to add in scripting to make some items non-sellable (&quot;key~quest&quot; type of items, and~or &quot;cursed&quot; type of items, that no one wants to buy off of from you).",
      "PostDate": "2013-12-02T00:39:43+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "26994",
      "UserId": 0,
      "Username": "Avantar",
      "UserAvatar": "7009_1418309433.jpg",
      "UserGravatar": "86de2b95c147252a1c38b8d3996da855",
      "EditableText": "Thank you HK - that realy goes into detail (even the shopkeeper has limited money - wow)  \n\nHere is what I wanted to accomplish for buy and sell:\n1) I wanted to buy anything the shop offers (more than once -so cloning the objects works great)\n2) I also wanted to re-buy stuff I have sold.\n3)The equipment that I sell that is not in the shop, should not be cloned again when I buy it back.\n   (Else I can sell a weapon and buy it back twice for dual wield  <!-- s:D --><img src=\"{SMILIES_PATH}/icon_biggrin.gif\" alt=\":D\" title=\"Very Happy\" /><!-- s:D --> )\n4) Selling an item should only recognize the sold item from my inventory. \n\nSo here is the shop library that worked for me with all your help:\n[code:1g6o22np]\n&lt;library&gt;\n&lt;command name=&quot;buy_stuff&quot;&gt;\n&lt;pattern&gt;buy #text#; purchase #text#&lt;/pattern&gt;\n    \n&lt;script&gt;&lt;!&#91;CDATA&#91;\nobject_x = GetObject (text)\nforeach (i, AllObjects()) {\n\tif (i&#46;alias=text){\n\ttext = i&#46;name\n\tobject_x=GetObject (text)\n\t}\n}\nif (object_x = null) {\n  foreach (obj, AllObjects()) {\n    if (obj&#46;alias=text or obj&#46;name=text) {\n      object_x = obj\n    }\n  }\n}\nif (object_x=null){\nmsg (&quot;There is no such item!&quot;)\n}\nelse {\n    if (GetBoolean(player&#46;parent, &quot;shop&quot;)) {\n\tif (HasInt(object_x, &quot;price&quot;)) {\n\t\n\t\tif (player&#46;money &lt; object_x&#46;price) {\n\t\tmsg (&quot;You can not afford it&#46;&quot;)\n\t\t}\n\t\telse if (not GetAttribute (object_x,&quot;parent&quot;)=SoldItems and not object_x&#46;parent = player&#46;parent){\n\t\tmsg (&quot;There is no such item here!&quot;)\n\t\t}\n\t\telse if (GetAttribute (object_x,&quot;parent&quot;)=SoldItems){\n\t\t\tmsg (&quot;You buy a &quot; + object_x&#46;name + &quot; for &quot; + object_x&#46;price + &quot; coins&#46;&quot;)\n\t\t\tobject_x&#46;parent = game&#46;pov\n\t\t\tplayer&#46;money = player&#46;money - object_x&#46;price\n\t\t\t\n\t\t}\n\t\telse {\n\t\t\tmsg (&quot;You buy a &quot; + object_x&#46;name + &quot; for &quot; + object_x&#46;price + &quot; coins&#46;&quot;)\n\t                b = Clone(object_x)\n\t\t       MoveObject (b, player)\n\t               player&#46;money = player&#46;money - object_x&#46;price\n\t\t       b&#46;take = True\n\t               b&#46;scenery = False\n\t\t       \n\t\t}\n\t}\n\t\telse {\n\tmsg (&quot;That item is not for sale&#46;&quot;)\n\t}\n}\nelse{\nmsg (&quot;You are not in a shop&#46;&quot;)\n}\n}\n\t\n\n    &#93;&#93;&gt;&lt;/script&gt;\n  &lt;/command&gt;\n     &lt;command name=&quot;sell_stuff&quot;&gt;\n    &lt;pattern&gt;sell #text#&lt;/pattern&gt;\n     &lt;script&gt;&lt;!&#91;CDATA&#91;\n      if (GetBoolean(player&#46;parent, &quot;shop&quot;)) {\n\tProcessScopeCommand (&quot;sell_object&quot;, ScopeInventory(), text, &quot;You do not have this item in your inventory&#46;&quot;, &quot;You can not sell this item&#46;&quot;)\n\t\n}\nelse {\n\tmsg (&quot;&#91;NotAShop&#93;&quot;)\n}\n    &#93;&#93;&gt;&lt;/script&gt;\n  &lt;/command&gt;[/code:1g6o22np]\n\nSorry it looks a bit messy (might be some debugging stuff left in there) and the selling part makes use of Pixie's Scopelib.aslx - been a bit lazy and probably made extra work for myself(since each object needs a selling script), but this is good enough for me.\nI found an interesting problem: Say you have an item with an alias and a name, should you use 'buy item.alias', it will buy it once, but it won't be able to clone it and therefore when you buy it again - the object is missing if you buy it again with the alias name - like it moved to the player rather than cloning.\nSo it seems that cloning only works with the object name - Therefore my first FOR loop - to make sure you always use the object's name.\n\nA sell-able item also needs a 'sell_object' script - selling my equipment will move it to another room called 'SoldItems' and selling stuff that belongs to a shop will simply remove them.\n\nThen in my room description I have as an example:\n[code:1g6o22np]a = 0\nmsg (&quot;You can buy a hat for 6 gold coins or a coat for 11&#46;&quot;)\nforeach (i, AllObjects()) {\n  if (GetAttribute (i,&quot;parent&quot;)=SoldItems) {\n    a = a + 1\n    if (a&gt;0) {\n      msg (&quot;You can re-buy your sold items&#58; &quot; + i&#46;name + &quot; for &quot; + i&#46;price + &quot; coins&#46;&quot;)\n    }\n  }\n}[/code:1g6o22np]\n\nAt the top, you would list all the stuff you have in the shop and the second message will show only if it finds 1 or more items in the room 'SoldItems'\nI have a few other attribute checks in my room description, but this is the general idea.\n\nThanks for all the help!!",
      "EditableFormat": "bbcode",
      "HTML": "Thank you HK - that realy goes into detail (even the shopkeeper has limited money - wow)  <br/><br/>Here is what I wanted to accomplish for buy and sell:<br/>1) I wanted to buy anything the shop offers (more than once -so cloning the objects works great)<br/>2) I also wanted to re-buy stuff I have sold.<br/>3)The equipment that I sell that is not in the shop, should not be cloned again when I buy it back.<br/>   (Else I can sell a weapon and buy it back twice for dual wield  <!-- s:D --><img src=\"{SMILIES_PATH}/icon_biggrin.gif\" alt=\":D\" title=\"Very Happy\" /><!-- s:D --> )<br/>4) Selling an item should only recognize the sold item from my inventory. <br/><br/>So here is the shop library that worked for me with all your help:<br/><pre><code><br/>&lt;library&gt;<br/>&lt;command name=&quot;buy_stuff&quot;&gt;<br/>&lt;pattern&gt;buy #text#; purchase #text#&lt;/pattern&gt;<br/>    <br/>&lt;script&gt;&lt;!&#91;CDATA&#91;<br/>object_x = GetObject (text)<br/>foreach (i, AllObjects()) {<br/>\tif (i&#46;alias=text){<br/>\ttext = i&#46;name<br/>\tobject_x=GetObject (text)<br/>\t}<br/>}<br/>if (object_x = null) {<br/>  foreach (obj, AllObjects()) {<br/>    if (obj&#46;alias=text or obj&#46;name=text) {<br/>      object_x = obj<br/>    }<br/>  }<br/>}<br/>if (object_x=null){<br/>msg (&quot;There is no such item!&quot;)<br/>}<br/>else {<br/>    if (GetBoolean(player&#46;parent, &quot;shop&quot;)) {<br/>\tif (HasInt(object_x, &quot;price&quot;)) {<br/>\t<br/>\t\tif (player&#46;money &lt; object_x&#46;price) {<br/>\t\tmsg (&quot;You can not afford it&#46;&quot;)<br/>\t\t}<br/>\t\telse if (not GetAttribute (object_x,&quot;parent&quot;)=SoldItems and not object_x&#46;parent = player&#46;parent){<br/>\t\tmsg (&quot;There is no such item here!&quot;)<br/>\t\t}<br/>\t\telse if (GetAttribute (object_x,&quot;parent&quot;)=SoldItems){<br/>\t\t\tmsg (&quot;You buy a &quot; + object_x&#46;name + &quot; for &quot; + object_x&#46;price + &quot; coins&#46;&quot;)<br/>\t\t\tobject_x&#46;parent = game&#46;pov<br/>\t\t\tplayer&#46;money = player&#46;money - object_x&#46;price<br/>\t\t\t<br/>\t\t}<br/>\t\telse {<br/>\t\t\tmsg (&quot;You buy a &quot; + object_x&#46;name + &quot; for &quot; + object_x&#46;price + &quot; coins&#46;&quot;)<br/>\t                b = Clone(object_x)<br/>\t\t       MoveObject (b, player)<br/>\t               player&#46;money = player&#46;money - object_x&#46;price<br/>\t\t       b&#46;take = True<br/>\t               b&#46;scenery = False<br/>\t\t       <br/>\t\t}<br/>\t}<br/>\t\telse {<br/>\tmsg (&quot;That item is not for sale&#46;&quot;)<br/>\t}<br/>}<br/>else{<br/>msg (&quot;You are not in a shop&#46;&quot;)<br/>}<br/>}<br/>\t<br/><br/>    &#93;&#93;&gt;&lt;/script&gt;<br/>  &lt;/command&gt;<br/>     &lt;command name=&quot;sell_stuff&quot;&gt;<br/>    &lt;pattern&gt;sell #text#&lt;/pattern&gt;<br/>     &lt;script&gt;&lt;!&#91;CDATA&#91;<br/>      if (GetBoolean(player&#46;parent, &quot;shop&quot;)) {<br/>\tProcessScopeCommand (&quot;sell_object&quot;, ScopeInventory(), text, &quot;You do not have this item in your inventory&#46;&quot;, &quot;You can not sell this item&#46;&quot;)<br/>\t<br/>}<br/>else {<br/>\tmsg (&quot;&#91;NotAShop&#93;&quot;)<br/>}<br/>    &#93;&#93;&gt;&lt;/script&gt;<br/>  &lt;/command&gt;</code></pre><br/><br/>Sorry it looks a bit messy (might be some debugging stuff left in there) and the selling part makes use of Pixie's Scopelib.aslx - been a bit lazy and probably made extra work for myself(since each object needs a selling script), but this is good enough for me.<br/>I found an interesting problem: Say you have an item with an alias and a name, should you use 'buy item.alias', it will buy it once, but it won't be able to clone it and therefore when you buy it again - the object is missing if you buy it again with the alias name - like it moved to the player rather than cloning.<br/>So it seems that cloning only works with the object name - Therefore my first FOR loop - to make sure you always use the object's name.<br/><br/>A sell-able item also needs a 'sell_object' script - selling my equipment will move it to another room called 'SoldItems' and selling stuff that belongs to a shop will simply remove them.<br/><br/>Then in my room description I have as an example:<br/><pre><code>a = 0<br/>msg (&quot;You can buy a hat for 6 gold coins or a coat for 11&#46;&quot;)<br/>foreach (i, AllObjects()) {<br/>  if (GetAttribute (i,&quot;parent&quot;)=SoldItems) {<br/>    a = a + 1<br/>    if (a&gt;0) {<br/>      msg (&quot;You can re-buy your sold items&#58; &quot; + i&#46;name + &quot; for &quot; + i&#46;price + &quot; coins&#46;&quot;)<br/>    }<br/>  }<br/>}</code></pre><br/><br/>At the top, you would list all the stuff you have in the shop and the second message will show only if it finds 1 or more items in the room 'SoldItems'<br/>I have a few other attribute checks in my room description, but this is the general idea.<br/><br/>Thanks for all the help!!",
      "PostDate": "2013-12-03T21:08:31+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "26995",
      "UserId": 0,
      "Username": "The Pixie",
      "UserAvatar": null,
      "UserGravatar": "cfa37e927f96177bcf6053ae8f108f77",
      "EditableText": "You should really be able to match against alias, name and alt names too.\n\nI would set a flag on objects in the inventory. When the player wants to buy, if the item is flagged as in the inventory, clone it, otherwise give the original.\n\nWhen the player is selling, if the object is flagged, you know it is just a clone, so should be destroyed. Otherwise put it in stock.",
      "EditableFormat": "bbcode",
      "HTML": "You should really be able to match against alias, name and alt names too.<br/><br/>I would set a flag on objects in the inventory. When the player wants to buy, if the item is flagged as in the inventory, clone it, otherwise give the original.<br/><br/>When the player is selling, if the object is flagged, you know it is just a clone, so should be destroyed. Otherwise put it in stock.",
      "PostDate": "2013-12-03T22:09:06+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "27001",
      "UserId": 0,
      "Username": "Avantar",
      "UserAvatar": "7009_1418309433.jpg",
      "UserGravatar": "86de2b95c147252a1c38b8d3996da855",
      "EditableText": "I have tested it and it seems to work fine....\n\nYou can sell gloves and re-buy it or buy stuff in the shop and re-sell them.\nI have created an exit to the room 'SoldItems' fo testing purposes to see that the gloves do move there.",
      "EditableFormat": "bbcode",
      "HTML": "I have tested it and it seems to work fine....<br/><br/>You can sell gloves and re-buy it or buy stuff in the shop and re-sell them.<br/>I have created an exit to the room 'SoldItems' fo testing purposes to see that the gloves do move there.<div><a href=\"/forumattachments/784/Shopping_sell_test_lib2.aslx\">Shopping_sell_test_lib2.aslx</a></div><div><a href=\"/forumattachments/783/ScopeLib.aslx\">ScopeLib.aslx</a></div><div><a href=\"/forumattachments/782/Shopping.aslx\">Shopping.aslx</a></div>",
      "PostDate": "2013-12-04T03:49:47+00:00",
      "LastEditDate": null
    }
  ]
}
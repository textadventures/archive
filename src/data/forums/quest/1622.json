{
  "Topic": {
    "TopicId": "1622",
    "ForumId": "10",
    "Title": "beforeturn override bug?",
    "LastUpdated": "2007-03-01T17:50:10+00:00",
    "ReplyCount": 15
  },
  "Posts": [
    {
      "PostId": "12871",
      "UserId": 0,
      "Username": "Freak",
      "UserAvatar": null,
      "UserGravatar": "325ed9ac125e00c9937be0d3aea0916d",
      "EditableText": "I was using a test case, and discovered that &quot;beforeturn override msg &lt;in beforeturn&gt;&quot; in a room gives an error.  Is that just Quest 4 or was that the behavior in prior versions?",
      "EditableFormat": "bbcode",
      "HTML": "I was using a test case, and discovered that &quot;beforeturn override msg &lt;in beforeturn&gt;&quot; in a room gives an error.  Is that just Quest 4 or was that the behavior in prior versions?",
      "PostDate": "2007-02-28T01:02:47+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "12876",
      "UserId": 0,
      "Username": "Alex",
      "UserAvatar": null,
      "UserGravatar": "188b72c5e13327f4fde3989dca7d7d53",
      "EditableText": "What error do you get?\r\n\r\nIt works for me:\r\n\r\n[code:3b3z5wjq]\ndefine game &lt;test&gt;\n\tasl-version &lt;400&gt;\n\tstart &lt;room&gt;\n\tbeforeturn msg &lt;global beforeturn&gt;\nend define\n\ndefine room &lt;room&gt;\n\tnorth &lt;room2&gt;\n\tbeforeturn override msg &lt;in beforeturn&gt;\nend define\n\ndefine room &lt;room2&gt;\n\tsouth &lt;room&gt;\nend define\n[/code:3b3z5wjq]\n\ngives:\n\n[code:3b3z5wjq]\nYou are in room&#46;\nYou can go north&#46;\n\n&gt; look\nin beforeturn\nYou are in room&#46;\nYou can go north&#46;\n\n&gt; north\nin beforeturn\nYou are in room2&#46;\nYou can go south&#46;\n\n&gt; look\nglobal beforeturn\nYou are in room2&#46;\nYou can go south&#46;\n\n&gt; south\nglobal beforeturn\nYou are in room&#46;\nYou can go north&#46;\n[/code:3b3z5wjq]",
      "EditableFormat": "bbcode",
      "HTML": "What error do you get?<br/><br/>It works for me:<br/><br/><pre><code><br/>define game &lt;test&gt;<br/>\tasl-version &lt;400&gt;<br/>\tstart &lt;room&gt;<br/>\tbeforeturn msg &lt;global beforeturn&gt;<br/>end define<br/><br/>define room &lt;room&gt;<br/>\tnorth &lt;room2&gt;<br/>\tbeforeturn override msg &lt;in beforeturn&gt;<br/>end define<br/><br/>define room &lt;room2&gt;<br/>\tsouth &lt;room&gt;<br/>end define<br/></code></pre><br/><br/>gives:<br/><br/><pre><code><br/>You are in room&#46;<br/>You can go north&#46;<br/><br/>&gt; look<br/>in beforeturn<br/>You are in room&#46;<br/>You can go north&#46;<br/><br/>&gt; north<br/>in beforeturn<br/>You are in room2&#46;<br/>You can go south&#46;<br/><br/>&gt; look<br/>global beforeturn<br/>You are in room2&#46;<br/>You can go south&#46;<br/><br/>&gt; south<br/>global beforeturn<br/>You are in room&#46;<br/>You can go north&#46;<br/></code></pre>",
      "PostDate": "2007-02-28T11:53:38+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "12881",
      "UserId": 0,
      "Username": "Freak",
      "UserAvatar": null,
      "UserGravatar": "325ed9ac125e00c9937be0d3aea0916d",
      "EditableText": "Ah.  &quot;beforeturn override&quot; only works if in the first &quot;beforeturn&quot; line.  That's annoying.",
      "EditableFormat": "bbcode",
      "HTML": "Ah.  &quot;beforeturn override&quot; only works if in the first &quot;beforeturn&quot; line.  That's annoying.",
      "PostDate": "2007-02-28T13:09:43+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "12883",
      "UserId": 0,
      "Username": "Alex",
      "UserAvatar": null,
      "UserGravatar": "188b72c5e13327f4fde3989dca7d7d53",
      "EditableText": "What do you mean by the first beforeturn line?",
      "EditableFormat": "bbcode",
      "HTML": "What do you mean by the first beforeturn line?",
      "PostDate": "2007-02-28T13:57:12+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "12887",
      "UserId": 0,
      "Username": "Freak",
      "UserAvatar": null,
      "UserGravatar": "325ed9ac125e00c9937be0d3aea0916d",
      "EditableText": "[code:2a88bn5n]define game &lt;test&gt;\n   asl-version &lt;390&gt;\n   start &lt;room&gt;\n   beforeturn msg &lt;global beforeturn&gt;\nend define\n\ndefine room &lt;room&gt;\n   north &lt;room2&gt;\n   beforeturn msg &lt;in beforeturn 1&gt;\n   beforeturn override msg &lt;in beforeturn override 2&gt;\n   beforeturn msg &lt;in beforeturn 3&gt;\nend define\n\ndefine room &lt;room2&gt;\n   south &lt;room&gt;\nend define \n[/code:2a88bn5n]\n\n[code:2a88bn5n]You can go north&#46;\n\n&gt; l\nin beforeturn 1\nin beforeturn 3\nglobal beforeturn\nYou are in room&#46;\nYou can go north&#46;\n\n&gt; n\nin beforeturn 1\nin beforeturn 3\nglobal beforeturn\nYou are in room2&#46;\nYou can go south&#46;\n\n&gt; l\nglobal beforeturn\nYou are in room2&#46;\nYou can go south&#46;\n\n&gt; s\nglobal beforeturn\nYou are in room&#46;\nYou can go north&#46;\n\n[/code:2a88bn5n]\n\n[code:2a88bn5n]INIT&#58; Quest 4&#46;0 Beta 3 &#40;build 4&#46;0&#46;51&#41;\nINIT&#58; Opening file C&#58;\\Documents and Settings\\Home\\My Documents\\rmworld2&#46;asl on 2/28/2007 at 8&#58;06&#58;27 AM\nINIT&#58; Finished loading file&#46;\nERROR&#58; Unrecognized keyword&#46; Line reads&#58; 'override msg &lt;in beforeturn override 2&gt;'\nERROR&#58; Unrecognized keyword&#46; Line reads&#58; 'override msg &lt;in beforeturn override 2&gt;'\n[/code:2a88bn5n]\r\n\r\nComment out beforeturn 1 and it works fine.  (I was using an older version of Quest, so I had to lower the asl-version.)",
      "EditableFormat": "bbcode",
      "HTML": "<pre><code>define game &lt;test&gt;<br/>   asl-version &lt;390&gt;<br/>   start &lt;room&gt;<br/>   beforeturn msg &lt;global beforeturn&gt;<br/>end define<br/><br/>define room &lt;room&gt;<br/>   north &lt;room2&gt;<br/>   beforeturn msg &lt;in beforeturn 1&gt;<br/>   beforeturn override msg &lt;in beforeturn override 2&gt;<br/>   beforeturn msg &lt;in beforeturn 3&gt;<br/>end define<br/><br/>define room &lt;room2&gt;<br/>   south &lt;room&gt;<br/>end define <br/></code></pre><br/><br/><pre><code>You can go north&#46;<br/><br/>&gt; l<br/>in beforeturn 1<br/>in beforeturn 3<br/>global beforeturn<br/>You are in room&#46;<br/>You can go north&#46;<br/><br/>&gt; n<br/>in beforeturn 1<br/>in beforeturn 3<br/>global beforeturn<br/>You are in room2&#46;<br/>You can go south&#46;<br/><br/>&gt; l<br/>global beforeturn<br/>You are in room2&#46;<br/>You can go south&#46;<br/><br/>&gt; s<br/>global beforeturn<br/>You are in room&#46;<br/>You can go north&#46;<br/><br/></code></pre><br/><br/><pre><code>INIT&#58; Quest 4&#46;0 Beta 3 &#40;build 4&#46;0&#46;51&#41;<br/>INIT&#58; Opening file C&#58;\\Documents and Settings\\Home\\My Documents\\rmworld2&#46;asl on 2/28/2007 at 8&#58;06&#58;27 AM<br/>INIT&#58; Finished loading file&#46;<br/>ERROR&#58; Unrecognized keyword&#46; Line reads&#58; 'override msg &lt;in beforeturn override 2&gt;'<br/>ERROR&#58; Unrecognized keyword&#46; Line reads&#58; 'override msg &lt;in beforeturn override 2&gt;'<br/></code></pre><br/><br/>Comment out beforeturn 1 and it works fine.  (I was using an older version of Quest, so I had to lower the asl-version.)",
      "PostDate": "2007-02-28T14:14:52+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "12888",
      "UserId": 0,
      "Username": "paul_one",
      "UserAvatar": null,
      "UserGravatar": "fef8a1875028f4300bb683f29c432894",
      "EditableText": "try:\r\n[code:2xht0a7k]beforeturn override &#123;\nmsg &lt;code goes here&gt;\nmsg &lt;and here&gt;\nmsg &lt;and also here!&gt;\n&#125;[/code:2xht0a7k]",
      "EditableFormat": "bbcode",
      "HTML": "try:<br/><pre><code>beforeturn override &#123;<br/>msg &lt;code goes here&gt;<br/>msg &lt;and here&gt;<br/>msg &lt;and also here!&gt;<br/>&#125;</code></pre>",
      "PostDate": "2007-02-28T14:17:01+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "12891",
      "UserId": 0,
      "Username": "Freak",
      "UserAvatar": null,
      "UserGravatar": "325ed9ac125e00c9937be0d3aea0916d",
      "EditableText": "I'm not interested in writing Quest games.  I'm trying to write a program that runs them, and to do that, I need to know exactly what the correct behavior is.",
      "EditableFormat": "bbcode",
      "HTML": "I'm not interested in writing Quest games.  I'm trying to write a program that runs them, and to do that, I need to know exactly what the correct behavior is.",
      "PostDate": "2007-02-28T14:32:56+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "12894",
      "UserId": 0,
      "Username": "Alex",
      "UserAvatar": null,
      "UserGravatar": "188b72c5e13327f4fde3989dca7d7d53",
      "EditableText": "Generally there shouldn't be multiple &quot;beforeturn&quot; tags in a room.\r\n\r\nAlso I notice that you're still using 4.0 Beta 3 - I'd recommend upgrading to the final release, especially as I think Beta 3 expires today!",
      "EditableFormat": "bbcode",
      "HTML": "Generally there shouldn't be multiple &quot;beforeturn&quot; tags in a room.<br/><br/>Also I notice that you're still using 4.0 Beta 3 - I'd recommend upgrading to the final release, especially as I think Beta 3 expires today!",
      "PostDate": "2007-02-28T14:52:10+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "12896",
      "UserId": 0,
      "Username": "Freak",
      "UserAvatar": null,
      "UserGravatar": "325ed9ac125e00c9937be0d3aea0916d",
      "EditableText": "It doesn't matter whether there &quot;should be X&quot; or &quot;shouldn't be X&quot;; in the absence of a formal specification, Quest is defined by its implementation, so what matters is &quot;X is legal&quot;, &quot;X is illegal&quot;, and &quot;behavior of legal behavior X&quot;.\r\n\r\nSince having multiple beforeturn tags is legal, I need to know what the correct behavior of that case is.",
      "EditableFormat": "bbcode",
      "HTML": "It doesn't matter whether there &quot;should be X&quot; or &quot;shouldn't be X&quot;; in the absence of a formal specification, Quest is defined by its implementation, so what matters is &quot;X is legal&quot;, &quot;X is illegal&quot;, and &quot;behavior of legal behavior X&quot;.<br/><br/>Since having multiple beforeturn tags is legal, I need to know what the correct behavior of that case is.",
      "PostDate": "2007-02-28T15:10:49+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "12900",
      "UserId": 0,
      "Username": "Freak",
      "UserAvatar": null,
      "UserGravatar": "325ed9ac125e00c9937be0d3aea0916d",
      "EditableText": "I'm curious:  How is the beforeturn script stored internally?  I can see plenty of ways to implement it, but none match the behaviors of:\r\n\r\n1)  If multiple beforeturn tags are listed, all are run.\r\n2)  &quot;beforeturn override&quot; only works with the first tag.\r\n3)  It was not explicitly designed to allow multiple tags.",
      "EditableFormat": "bbcode",
      "HTML": "I'm curious:  How is the beforeturn script stored internally?  I can see plenty of ways to implement it, but none match the behaviors of:<br/><br/>1)  If multiple beforeturn tags are listed, all are run.<br/>2)  &quot;beforeturn override&quot; only works with the first tag.<br/>3)  It was not explicitly designed to allow multiple tags.",
      "PostDate": "2007-03-01T02:11:03+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "12918",
      "UserId": 0,
      "Username": "Alex",
      "UserAvatar": null,
      "UserGravatar": "188b72c5e13327f4fde3989dca7d7d53",
      "EditableText": "Each room has one &quot;beforeturn&quot; script stored. When multiple &quot;beforeturn&quot; tags are specified, they are added to the room's &quot;beforeturn&quot; script.\r\n\r\nIf &quot;override&quot; is the first keyword in the script, Quest knows not to run the game's &quot;beforeturn&quot; script.\r\n\r\nBecause Quest only looks for &quot;override&quot; in the first keyword of the script, if you specify multiple &quot;beforeturn&quot; tags in a room, the &quot;override&quot; must be in the first tag if you want to use it.",
      "EditableFormat": "bbcode",
      "HTML": "Each room has one &quot;beforeturn&quot; script stored. When multiple &quot;beforeturn&quot; tags are specified, they are added to the room's &quot;beforeturn&quot; script.<br/><br/>If &quot;override&quot; is the first keyword in the script, Quest knows not to run the game's &quot;beforeturn&quot; script.<br/><br/>Because Quest only looks for &quot;override&quot; in the first keyword of the script, if you specify multiple &quot;beforeturn&quot; tags in a room, the &quot;override&quot; must be in the first tag if you want to use it.",
      "PostDate": "2007-03-01T14:23:06+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "12920",
      "UserId": 0,
      "Username": "Freak",
      "UserAvatar": null,
      "UserGravatar": "325ed9ac125e00c9937be0d3aea0916d",
      "EditableText": "So if you had code that adds multiple lines to the beforeturn script (instead of replacing it), why were you surprised by my mention of &quot;first beforeturn line&quot;?",
      "EditableFormat": "bbcode",
      "HTML": "So if you had code that adds multiple lines to the beforeturn script (instead of replacing it), why were you surprised by my mention of &quot;first beforeturn line&quot;?",
      "PostDate": "2007-03-01T14:52:06+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "12924",
      "UserId": 0,
      "Username": "Alex",
      "UserAvatar": null,
      "UserGravatar": "188b72c5e13327f4fde3989dca7d7d53",
      "EditableText": "I was just clarifying what you meant, since I'm not aware of any games actually using multiple &quot;beforeturn&quot; lines (since most games are created in QDK). Additionally I didn't check how it was handled until your question about how it is stored prompted me to look at the code.",
      "EditableFormat": "bbcode",
      "HTML": "I was just clarifying what you meant, since I'm not aware of any games actually using multiple &quot;beforeturn&quot; lines (since most games are created in QDK). Additionally I didn't check how it was handled until your question about how it is stored prompted me to look at the code.",
      "PostDate": "2007-03-01T15:59:32+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "12925",
      "UserId": 0,
      "Username": "Freak",
      "UserAvatar": null,
      "UserGravatar": "325ed9ac125e00c9937be0d3aea0916d",
      "EditableText": "Would multiple beforeturns be handled internally as a single newline separated string (as are functions / procedures), and that the various &quot;run script&quot; routine will handle such a string as a multiline script?\r\n\r\nI'd been assuming (considering the way Quest deinlines braces) that &quot;script properties&quot; had to be a single line string, and that functions / procedures were handled as an array of single line strings.\r\n\r\n(Also, this forum keeps accusing me of being a spambot whenever I post.)",
      "EditableFormat": "bbcode",
      "HTML": "Would multiple beforeturns be handled internally as a single newline separated string (as are functions / procedures), and that the various &quot;run script&quot; routine will handle such a string as a multiline script?<br/><br/>I'd been assuming (considering the way Quest deinlines braces) that &quot;script properties&quot; had to be a single line string, and that functions / procedures were handled as an array of single line strings.<br/><br/>(Also, this forum keeps accusing me of being a spambot whenever I post.)",
      "PostDate": "2007-03-01T16:37:01+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "12926",
      "UserId": 0,
      "Username": "Alex",
      "UserAvatar": null,
      "UserGravatar": "188b72c5e13327f4fde3989dca7d7d53",
      "EditableText": "Yes, multiple beforeturns are handled internally as a single newline separated string.\r\n\r\nThe &quot;run script&quot; routine handles multiline scripts - it just runs each script line in turn (it doesn't need to worry about there potentially being nested script blocks as these will have been taken care of when Quest initially loaded the file and they were converted into intprocs).",
      "EditableFormat": "bbcode",
      "HTML": "Yes, multiple beforeturns are handled internally as a single newline separated string.<br/><br/>The &quot;run script&quot; routine handles multiline scripts - it just runs each script line in turn (it doesn't need to worry about there potentially being nested script blocks as these will have been taken care of when Quest initially loaded the file and they were converted into intprocs).",
      "PostDate": "2007-03-01T17:35:15+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "12927",
      "UserId": 0,
      "Username": "Freak",
      "UserAvatar": null,
      "UserGravatar": "325ed9ac125e00c9937be0d3aea0916d",
      "EditableText": "The conversion to intprocs is what I meant by deinlining.",
      "EditableFormat": "bbcode",
      "HTML": "The conversion to intprocs is what I meant by deinlining.",
      "PostDate": "2007-03-01T17:50:10+00:00",
      "LastEditDate": null
    }
  ]
}

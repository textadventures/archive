{
  "Topic": {
    "TopicId": "ek5beopywuqur_qnhhoigg",
    "ForumId": "24",
    "Title": "Going back to previous sections (back link, history)",
    "LastUpdated": "2016-09-09T13:13:08.3471995Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "95d318f3-c9e2-4c76-bb1b-78e7a5263afe",
      "UserId": 263285,
      "Username": "jhlagado",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I looked around but I couldn't see a way of going back to a previous section so I implemented something myself that adds a Go Back link to every page (except the first). This is more of an issue for people who want each page to be separate (using @clear) instead of scrolling.\r\n\r\nAll feedback is welcome, especially if someone knows an easier way to do the same thing.\r\n\r\n```\r\n@title New Game\r\n\r\nHere is the beginning.\r\n\r\n[[page1]]\r\n\r\n[[]]:\r\n@clear\r\n\r\n    //some useful code we put in functions\r\n    //so we can reuse it when we need it\r\n    \r\n    //return the history list from storage\r\n    function getHistory(){\r\n\r\n        //load history list from storage\r\n        var history = squiffy.get('history');\r\n        if (!history) {\r\n\r\n            //if there isn't one already, create it\r\n            history = [];\r\n\r\n            //save history to storage\r\n            squiffy.set('history', history);\r\n        }\r\n        return history;\r\n    }\r\n\r\n    //go to the previous place in our history list\r\n    function goBack() {\r\n\r\n        //get history\r\n        var history = getHistory();\r\n\r\n        //remove the current section from history \r\n        history.pop();\r\n\r\n        //remove the previous section from history \r\n        //and put it in a variable\r\n        var sectionid = history.pop();\r\n\r\n        //save history to storage\r\n        squiffy.set('history', history);\r\n\r\n        //go to previous section\r\n        squiffy.story.go(sectionid)\r\n    }\r\n\r\n    //make this function visible to \"onlick\" links\r\n    window.goBack = goBack;\r\n\r\n    // get history list from storage\r\n    var history = getHistory();\r\n    \r\n    if (history.length > 0) {\r\n        //if the history list is longer than one section\r\n        //then show the \"go back\" link\r\n        squiffy.ui.write(\r\n        '<a href=\"#\" onclick=\"window.goBack()\">Go back</a>');\r\n    }    \r\n    //add the current section in the history list\r\n    history.push(get('_section'));\r\n    \r\n    //save the history list in storage\r\n    squiffy.set('history', history);\r\n\r\nThis is section {_section}\r\n\r\n[[inventory]]\r\n\r\n[[page1]]:\r\nGo to [[page2]]\r\n\r\n[[page2]]:\r\nGo to [[page3]]\r\n\r\n[[page3]]:\r\nGo to [[page4]]\r\n\r\n[[page4]]:\r\n\r\n[[inventory]]:\r\nInventory\r\n\r\n```\r\n\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>I looked around but I couldn't see a way of going back to a previous section so I implemented something myself that adds a Go Back link to every page (except the first). This is more of an issue for people who want each page to be separate (using @clear) instead of scrolling.</p>\n<p>All feedback is welcome, especially if someone knows an easier way to do the same thing.</p>\n<pre><code>@title New Game\n\nHere is the beginning.\n\n[[page1]]\n\n[[]]:\n@clear\n\n    //some useful code we put in functions\n    //so we can reuse it when we need it\n    \n    //return the history list from storage\n    function getHistory(){\n\n        //load history list from storage\n        var history = squiffy.get('history');\n        if (!history) {\n\n            //if there isn't one already, create it\n            history = [];\n\n            //save history to storage\n            squiffy.set('history', history);\n        }\n        return history;\n    }\n\n    //go to the previous place in our history list\n    function goBack() {\n\n        //get history\n        var history = getHistory();\n\n        //remove the current section from history \n        history.pop();\n\n        //remove the previous section from history \n        //and put it in a variable\n        var sectionid = history.pop();\n\n        //save history to storage\n        squiffy.set('history', history);\n\n        //go to previous section\n        squiffy.story.go(sectionid)\n    }\n\n    //make this function visible to \"onlick\" links\n    window.goBack = goBack;\n\n    // get history list from storage\n    var history = getHistory();\n    \n    if (history.length &gt; 0) {\n        //if the history list is longer than one section\n        //then show the \"go back\" link\n        squiffy.ui.write(\n        '&lt;a href=\"#\" onclick=\"window.goBack()\"&gt;Go back&lt;/a&gt;');\n    }    \n    //add the current section in the history list\n    history.push(get('_section'));\n    \n    //save the history list in storage\n    squiffy.set('history', history);\n\nThis is section {_section}\n\n[[inventory]]\n\n[[page1]]:\nGo to [[page2]]\n\n[[page2]]:\nGo to [[page3]]\n\n[[page3]]:\nGo to [[page4]]\n\n[[page4]]:\n\n[[inventory]]:\nInventory\n\n</code></pre>\n\n",
      "PostDate": "2016-09-09T13:13:08.3471995Z",
      "LastEditDate": "2016-09-09T13:17:55.8295506Z"
    },
    {
      "PostId": "1ba46e4d-f3db-4a5f-b4f6-2631819cb2de",
      "UserId": 262022,
      "Username": "thetruespin",
      "AvatarUrl": "https://secure.gravatar.com/avatar/dc591017d34e833aceb21f01abe265e1?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Good solution. Don't need it personally but thanks for sharing. ",
      "EditableFormat": "markdown",
      "HTML": "<p>Good solution. Don't need it personally but thanks for sharing.</p>\n\n",
      "PostDate": "2016-09-10T06:56:56.4086705Z",
      "LastEditDate": null
    },
    {
      "PostId": "e966c895-a2cd-4132-90ca-8bb30b10342e",
      "UserId": 263285,
      "Username": "jhlagado",
      "AvatarUrl": "http://i.imgur.com/kSzQy7cb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thanks. Hopefully it's useful just to show working code for those that want to do more JavaScript. \r\nThe documentation is very, uh, brief.\r\n\r\nHere's a slightly different approach. In this case you don't want to have a goBack available on every page. Only those that need it. But say you had an inventory page that you wanted to be able to access from anywhere. Furthermore that inventory links to a map section that you can also read. In that case it would be useful to be able to return from the map back to the inventory and from the inventory back to the page you were originally on. \r\n\r\n```\r\n@title New Game\r\n\r\nHere is the beginning.\r\n\r\n[[page1]]\r\n\r\n[[]]:\r\n@clear\r\n\r\n    //some useful code we put in functions\r\n    //so we can reuse it when we need it\r\n\r\n    //return the history list from storage\r\n    function getHistory(){\r\n\r\n        //load history list from storage\r\n        var history = squiffy.get('history');\r\n        if (!history) {\r\n\r\n            //if there isn't one already, create it\r\n            history = [];\r\n\r\n            //save history to storage\r\n            squiffy.set('history', history);\r\n        }\r\n        return history;\r\n    }\r\n\r\n    //go to the previous place in our history list\r\n    function goBack() {\r\n\r\n        var history = getHistory();\r\n\r\n        //remove the current section from history\r\n        history.pop();\r\n\r\n        //remove the previous section from history\r\n        //and put it in a variable\r\n        var sectionid = history.pop();\r\n\r\n        //save history to storage\r\n        squiffy.set('history', history);\r\n\r\n        //go to previous section\r\n        squiffy.story.go(sectionid)\r\n    }\r\n\r\n    function sectionLink(sectionid, linkname) {\r\n\r\n        var history = getHistory();\r\n        \r\n        //look in history list for sectionid\r\n        //if not found, indeOf function returns -1\r\n        if (history.indexOf(sectionid) == -1) {\r\n        \r\n           //sectionid not in history\r\n           squiffy.ui.write(\r\n               '<a href=\"#\" onclick=\"squiffy.story.go(\\'' +\r\n               sectionid +\r\n               '\\')\">' +\r\n               linkname +\r\n               '</a>'\r\n           );\r\n        }\r\n    }\r\n\r\n\r\n    //make squiffy visible to onclick links\r\n    window.squiffy = squiffy;\r\n\r\n    //make this function visible to \"onlick\" links\r\n    window.goBack = goBack;\r\n\r\n    // get history list from storage\r\n    var history = getHistory();\r\n\r\n    var section = get('_section');\r\n    //add the current section in the history list\r\n    history.push(section);\r\n\r\n    //save the history list in storage\r\n    squiffy.set('history', history);\r\n\r\n    sectionLink('inventory', 'Inventory');\r\n\r\n\r\n[[page1]]:\r\nGo to [[page2]]\r\n\r\n[[page2]]:\r\nGo to [[page3]]\r\n\r\n[[page3]]:\r\nGo to [[page4]]\r\n\r\n[[page4]]:\r\n\r\n[[inventory]]:\r\nInventory\r\n\r\n[[map]]\r\n\r\nSunglasses<br>{if seen ch1.detectivefiles1: [[Case file: Simon Bresic]](ch1.readFile)}\r\n<br><br>\r\n<a href=\"#\" onclick=\"window.goBack()\">Go back!</a><br>\r\n\r\n[[map]]:\r\nReading the map\r\n<br><br>\r\n<a href=\"#\" onclick=\"window.goBack()\">Go back!</a><br>\r\n``` ",
      "EditableFormat": "markdown",
      "HTML": "<p>Thanks. Hopefully it's useful just to show working code for those that want to do more JavaScript.<br>\nThe documentation is very, uh, brief.</p>\n<p>Here's a slightly different approach. In this case you don't want to have a goBack available on every page. Only those that need it. But say you had an inventory page that you wanted to be able to access from anywhere. Furthermore that inventory links to a map section that you can also read. In that case it would be useful to be able to return from the map back to the inventory and from the inventory back to the page you were originally on.</p>\n<pre><code>@title New Game\n\nHere is the beginning.\n\n[[page1]]\n\n[[]]:\n@clear\n\n    //some useful code we put in functions\n    //so we can reuse it when we need it\n\n    //return the history list from storage\n    function getHistory(){\n\n        //load history list from storage\n        var history = squiffy.get('history');\n        if (!history) {\n\n            //if there isn't one already, create it\n            history = [];\n\n            //save history to storage\n            squiffy.set('history', history);\n        }\n        return history;\n    }\n\n    //go to the previous place in our history list\n    function goBack() {\n\n        var history = getHistory();\n\n        //remove the current section from history\n        history.pop();\n\n        //remove the previous section from history\n        //and put it in a variable\n        var sectionid = history.pop();\n\n        //save history to storage\n        squiffy.set('history', history);\n\n        //go to previous section\n        squiffy.story.go(sectionid)\n    }\n\n    function sectionLink(sectionid, linkname) {\n\n        var history = getHistory();\n        \n        //look in history list for sectionid\n        //if not found, indeOf function returns -1\n        if (history.indexOf(sectionid) == -1) {\n        \n           //sectionid not in history\n           squiffy.ui.write(\n               '&lt;a href=\"#\" onclick=\"squiffy.story.go(\\'' +\n               sectionid +\n               '\\')\"&gt;' +\n               linkname +\n               '&lt;/a&gt;'\n           );\n        }\n    }\n\n\n    //make squiffy visible to onclick links\n    window.squiffy = squiffy;\n\n    //make this function visible to \"onlick\" links\n    window.goBack = goBack;\n\n    // get history list from storage\n    var history = getHistory();\n\n    var section = get('_section');\n    //add the current section in the history list\n    history.push(section);\n\n    //save the history list in storage\n    squiffy.set('history', history);\n\n    sectionLink('inventory', 'Inventory');\n\n\n[[page1]]:\nGo to [[page2]]\n\n[[page2]]:\nGo to [[page3]]\n\n[[page3]]:\nGo to [[page4]]\n\n[[page4]]:\n\n[[inventory]]:\nInventory\n\n[[map]]\n\nSunglasses&lt;br&gt;{if seen ch1.detectivefiles1: [[Case file: Simon Bresic]](ch1.readFile)}\n&lt;br&gt;&lt;br&gt;\n&lt;a href=\"#\" onclick=\"window.goBack()\"&gt;Go back!&lt;/a&gt;&lt;br&gt;\n\n[[map]]:\nReading the map\n&lt;br&gt;&lt;br&gt;\n&lt;a href=\"#\" onclick=\"window.goBack()\"&gt;Go back!&lt;/a&gt;&lt;br&gt;\n</code></pre>\n\n",
      "PostDate": "2016-09-10T12:56:13.2279092Z",
      "LastEditDate": null
    }
  ]
}

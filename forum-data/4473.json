{
  "Topic": {
    "TopicId": "4473",
    "ForumId": "10",
    "Title": "Losign sight of the #object#",
    "LastUpdated": "2014-07-13T10:05:35+01:00",
    "ReplyCount": 13
  },
  "Posts": [
    {
      "PostId": "29483",
      "UserId": 0,
      "Username": "Espera",
      "UserAvatar": null,
      "UserGravatar": "04bdffe31cdc4e1c0d61f05a2f5a7532",
      "EditableText": "I thought I'd gotten commands down, but when it came to the most complex and most important command of my game, I can't seem to get it to work. When it comes time to do the calculations, the game tells me it doesn't know what object I'm referring to anymore.  Here is the code for the script&#058; \n\nif (HasAttribute(object, &quot;enemy&quot;)) {\n  SetObjectFlagOn (object, &quot;incombat&quot;)\n  ShowMenu (&quot;What will you do? &quot;, player.movelist, false) {\n    switch (result) {\n      case (&quot;kick&quot;) {\n        player.damage = player.Fight - object.fightres\n        if (GetInt(player, &quot;damage&quot;) = 0) {\n          player.damage = 0\n        }\n        object.hp = object.hp - player.damage\n        msg (&quot;You kick &quot;+object.prefix+&quot; &quot;+object.name+&quot; for &quot;+player.damage+&quot; damage!&quot;)\n      }\n      case (&quot;Magic Bolt&quot;) {\n        player.damage = player.Magic - object.magicres\n        if (GetInt(player, &quot;damage&quot;) = 0) {\n          player.damage = 0\n        }\n        object.hp = object.hp - player.damage\n        msg (&quot;You focus your magic at your horn and fire a Magic Bolt at &quot;+object.prefix+&quot; &quot;+object.name+&quot; for &quot;+player.damage+&quot; damage!&quot;)\n      }\n    }\n  }\n}\n\n\nWhat am I doing wrong?",
      "EditableFormat": "bbcode",
      "HTML": "I thought I'd gotten commands down, but when it came to the most complex and most important command of my game, I can't seem to get it to work. When it comes time to do the calculations, the game tells me it doesn't know what object I'm referring to anymore.  Here is the code for the script&#058; <br/><br/>if (HasAttribute(object, &quot;enemy&quot;)) {<br/>  SetObjectFlagOn (object, &quot;incombat&quot;)<br/>  ShowMenu (&quot;What will you do? &quot;, player.movelist, false) {<br/>    switch (result) {<br/>      case (&quot;kick&quot;) {<br/>        player.damage = player.Fight - object.fightres<br/>        if (GetInt(player, &quot;damage&quot;) = 0) {<br/>          player.damage = 0<br/>        }<br/>        object.hp = object.hp - player.damage<br/>        msg (&quot;You kick &quot;+object.prefix+&quot; &quot;+object.name+&quot; for &quot;+player.damage+&quot; damage!&quot;)<br/>      }<br/>      case (&quot;Magic Bolt&quot;) {<br/>        player.damage = player.Magic - object.magicres<br/>        if (GetInt(player, &quot;damage&quot;) = 0) {<br/>          player.damage = 0<br/>        }<br/>        object.hp = object.hp - player.damage<br/>        msg (&quot;You focus your magic at your horn and fire a Magic Bolt at &quot;+object.prefix+&quot; &quot;+object.name+&quot; for &quot;+player.damage+&quot; damage!&quot;)<br/>      }<br/>    }<br/>  }<br/>}<br/><br/><br/>What am I doing wrong?",
      "PostDate": "2014-07-13T01:57:46+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "29484",
      "UserId": 0,
      "Username": "HegemonKhan",
      "UserAvatar": null,
      "UserGravatar": "a96cf34d8d97c57de38f54ee22b1759b",
      "EditableText": ".\n\nwe really need to see your entire game code, to identify the problem, as we can't find the problem from just this code you provided.\n\n------------------------\n\nI presume that this is scripting for a Command:\n\n[code:ksd8qi3b]&lt;command name=&quot;blah&quot;&gt;\n  &lt;pattern&gt;blah #object#&lt;/pattern&gt;\n  &lt;script&gt;\n    // blah_function or direct scripting here\n  &lt;/script&gt;\n&lt;/command&gt;[/code:ksd8qi3b]\n\nin other words, in your scripting, your 'object' is connected to your command's pattern: blah #object#\n\nalso your command and~or function parameters need to be right too.\n\n----\n\none possible problem with this method is that, if you gave your objects ALIASES, than you'll need to code for this, as quest searches for the objects' NAME when you type in 'blah object' during game play, so if you type in the object's alias, it can't get the object, as it is looking for an object with the NAME of what you typed in (its ALIAS). you'll need code to address this, if this is the issue.\n\n-----\n\njust a small (unrelated to your post's problem) mistake I noticed as well:\n\nif (GetInt(player, &quot;damage&quot;) = 0) {\nplayer.damage = 0\n}\n\nyou probably wanted it to be this:\n\nif (GetInt(player, &quot;damage&quot;) &lt; 0) {\nplayer.damage = 0\n}",
      "EditableFormat": "bbcode",
      "HTML": ".<br/><br/>we really need to see your entire game code, to identify the problem, as we can't find the problem from just this code you provided.<br/><br/>------------------------<br/><br/>I presume that this is scripting for a Command:<br/><br/><pre><code>&lt;command name=&quot;blah&quot;&gt;<br/>  &lt;pattern&gt;blah #object#&lt;/pattern&gt;<br/>  &lt;script&gt;<br/>    // blah_function or direct scripting here<br/>  &lt;/script&gt;<br/>&lt;/command&gt;</code></pre><br/><br/>in other words, in your scripting, your 'object' is connected to your command's pattern: blah #object#<br/><br/>also your command and~or function parameters need to be right too.<br/><br/>----<br/><br/>one possible problem with this method is that, if you gave your objects ALIASES, than you'll need to code for this, as quest searches for the objects' NAME when you type in 'blah object' during game play, so if you type in the object's alias, it can't get the object, as it is looking for an object with the NAME of what you typed in (its ALIAS). you'll need code to address this, if this is the issue.<br/><br/>-----<br/><br/>just a small (unrelated to your post's problem) mistake I noticed as well:<br/><br/>if (GetInt(player, &quot;damage&quot;) = 0) {<br/>player.damage = 0<br/>}<br/><br/>you probably wanted it to be this:<br/><br/>if (GetInt(player, &quot;damage&quot;) &lt; 0) {<br/>player.damage = 0<br/>",
      "PostDate": "2014-07-13T03:44:08+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "29485",
      "UserId": 0,
      "Username": "Espera",
      "UserAvatar": null,
      "UserGravatar": "04bdffe31cdc4e1c0d61f05a2f5a7532",
      "EditableText": "That is the command that isn't working. The rest of my game is working fine. What more do you need to know?  It could very well be an issue with aliases, but if it is, what would I need to do in order to fix it?",
      "EditableFormat": "bbcode",
      "HTML": "That is the command that isn't working. The rest of my game is working fine. What more do you need to know?  It could very well be an issue with aliases, but if it is, what would I need to do in order to fix it?",
      "PostDate": "2014-07-13T04:10:33+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "29487",
      "UserId": 0,
      "Username": "Espera",
      "UserAvatar": null,
      "UserGravatar": "04bdffe31cdc4e1c0d61f05a2f5a7532",
      "EditableText": "To clarify, it is a command with the command pattern 'fight #object#'.  The code I posted is for the script that command runs.",
      "EditableFormat": "bbcode",
      "HTML": "To clarify, it is a command with the command pattern 'fight #object#'.  The code I posted is for the script that command runs.",
      "PostDate": "2014-07-13T04:31:52+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "29489",
      "UserId": 0,
      "Username": "HegemonKhan",
      "UserAvatar": null,
      "UserGravatar": "a96cf34d8d97c57de38f54ee22b1759b",
      "EditableText": "the reason that we need to see full game codes, is that individual parts of code are connected to other parts of code, so while the individual part of code that you post, might not have any error, the other segment(s) of code that use or are used by your posted part of code, can have the error, so that's why we often can't identify the problem, as the small part of code you post, doesn't have any error in it, but some other part of your game code, does. We need to make sure EVERYTHING matches up as it should, because your entire game code is one giant dependant interconnected web, and it ALL must be correct for it to work.\n\n---------\n\nsee if this can help you, possibly see what the issue might be:\n\n(using #object# for this, to make it clearer)\n\n[code:1mnamifm]&lt;command name=&quot;fight_command&quot;&gt;\n    &lt;pattern&gt;fight #object#&lt;/pattern&gt;\n    &lt;script&gt;\n      battle_system (game&#46;pov,object)\n    &lt;/script&gt;\n  &lt;/command&gt;\n\n&lt;function name=&quot;battle_system&quot; parameters=&quot;game&#46;pov,object&quot;&gt;\n    enemy = object\n    if (enemy = null) {\n      foreach (object_x,AllObjects()) {\n        if (object_x&#46;alias=object) {\n          enemy = object_x\n        }\n      }\n    }\n    if (enemy = null) {\n      // scripts\n    } else {\n      // scripts\n    }[/code:1mnamifm]\n\nhere's where you'd put this into your code (just a pseudo example):\n\n[code:1mnamifm]&lt;command name=&quot;fight_command&quot;&gt;\n    &lt;pattern&gt;fight #object#&lt;/pattern&gt;\n    &lt;script&gt;\n      battle_system (game&#46;pov,object)\n    &lt;/script&gt;\n  &lt;/command&gt;\n\n&lt;function name=&quot;battle_system&quot; parameters=&quot;game&#46;pov,object&quot;&gt;\n    enemy = object\n    if (enemy = null) {\n      foreach (object_x,AllObjects()) {\n        if (object_x&#46;alias=object) {\n          enemy = object_x\n        }\n      }\n    }\n    if (enemy = null) {\n      // scripts\n    } else {\n      if (HasAttribute(object, &quot;enemy&quot;)) {\n        SetObjectFlagOn (object, &quot;incombat&quot;)\n        ShowMenu (&quot;What will you do? &quot;, player&#46;movelist, false) {\n          switch (result) {\n            case (&quot;kick&quot;) {\n              player&#46;damage = player&#46;Fight - object&#46;fightres\n              if (GetInt(player, &quot;damage&quot;) = 0) {\n                player&#46;damage = 0\n               }\n               object&#46;hp = object&#46;hp - player&#46;damage\n               msg (&quot;You kick &quot;+object&#46;prefix+&quot; &quot;+object&#46;name+&quot; for &quot;+player&#46;damage+&quot; damage!&quot;)\n             }\n             case (&quot;Magic Bolt&quot;) {\n               player&#46;damage = player&#46;Magic - object&#46;magicres\n               if (GetInt(player, &quot;damage&quot;) = 0) {\n                 player&#46;damage = 0\n               }\n               object&#46;hp = object&#46;hp - player&#46;damage\n               msg (&quot;You focus your magic at your horn and fire a Magic Bolt at &quot;+object&#46;prefix+&quot; &quot;+object&#46;name+&quot; for &quot;+player&#46;damage+&quot; damage!&quot;)\n           }\n     }\n  }\n}[/code:1mnamifm]\n\n-----------------\n\n(I use #text# for this, however)\n\n[code:1mnamifm]&lt;asl version=&quot;530&quot;&gt;\n  &lt;include ref=&quot;English&#46;aslx&quot; /&gt;\n  &lt;include ref=&quot;Core&#46;aslx&quot; /&gt;\n  &lt;game name=&quot;Testing Game Stuff&quot;&gt;\n    &lt;gameid&gt;d83ba5bb-2e3c-4f31-80c9-3e88a2dc082c&lt;/gameid&gt;\n    &lt;version&gt;1&#46;0&lt;/version&gt;\n    &lt;pov type=&quot;object&quot;&gt;player&lt;/pov&gt;\n    &lt;start type=&quot;script&quot;&gt;\n      cc\n    &lt;/start&gt;\n    &lt;turns type=&quot;int&quot;&gt;0&lt;/turns&gt;\n    &lt;statusattributes type=&quot;stringdictionary&quot;&gt;turns = &lt;/statusattributes&gt;\n  &lt;/game&gt;\n  &lt;object name=&quot;room&quot;&gt;\n    &lt;inherit name=&quot;editor_room&quot; /&gt;\n    &lt;object name=&quot;player&quot;&gt;\n      &lt;inherit name=&quot;defaultplayer&quot; /&gt;\n      &lt;inherit name=&quot;pc&quot; /&gt;\n      &lt;cur_hp type=&quot;int&quot;&gt;999&lt;/cur_hp&gt;\n      &lt;max_hp type=&quot;int&quot;&gt;999&lt;/max_hp&gt;\n      &lt;str type=&quot;int&quot;&gt;100&lt;/str&gt;\n      &lt;end type=&quot;int&quot;&gt;100&lt;/end&gt;\n      &lt;dex type=&quot;int&quot;&gt;100&lt;/dex&gt;\n      &lt;agi type=&quot;int&quot;&gt;100&lt;/agi&gt;\n      &lt;spd type=&quot;int&quot;&gt;100&lt;/spd&gt;\n      &lt;hc type=&quot;int&quot;&gt;100&lt;/hc&gt;\n      &lt;pd type=&quot;int&quot;&gt;100&lt;/pd&gt;\n      &lt;pr type=&quot;int&quot;&gt;100&lt;/pr&gt;\n    &lt;/object&gt;\n    &lt;object name=&quot;orc1&quot;&gt;\n      &lt;inherit name=&quot;editor_object&quot; /&gt;\n      &lt;inherit name=&quot;npc&quot; /&gt;\n      &lt;hostile type=&quot;boolean&quot;&gt;true&lt;/hostile&gt;\n      &lt;dead type=&quot;boolean&quot;&gt;false&lt;/dead&gt;\n      &lt;alias&gt;orc&lt;/alias&gt;\n      &lt;cur_hp type=&quot;int&quot;&gt;999&lt;/cur_hp&gt;\n      &lt;max_hp type=&quot;int&quot;&gt;999&lt;/max_hp&gt;\n      &lt;str type=&quot;int&quot;&gt;25&lt;/str&gt;\n      &lt;end type=&quot;int&quot;&gt;25&lt;/end&gt;\n      &lt;dex type=&quot;int&quot;&gt;25&lt;/dex&gt;\n      &lt;agi type=&quot;int&quot;&gt;25&lt;/agi&gt;\n      &lt;spd type=&quot;int&quot;&gt;25&lt;/spd&gt;\n      &lt;hc type=&quot;int&quot;&gt;25&lt;/hc&gt;\n      &lt;pd type=&quot;int&quot;&gt;25&lt;/pd&gt;\n      &lt;pr type=&quot;int&quot;&gt;25&lt;/pr&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n  &lt;turnscript name=&quot;game_turns&quot;&gt;\n    &lt;enabled /&gt;\n    &lt;script&gt;\n      sa\n      game&#46;turns = game&#46;turns + 1\n    &lt;/script&gt;\n  &lt;/turnscript&gt;\n  &lt;command name=&quot;fight&quot;&gt;\n    &lt;pattern&gt;fight #text#&lt;/pattern&gt;\n    &lt;script&gt;\n      battle_system (game&#46;pov,text)\n    &lt;/script&gt;\n  &lt;/command&gt;\n  &lt;type name=&quot;char&quot;&gt;\n    &lt;cur_hp type=&quot;int&quot;&gt;0&lt;/cur_hp&gt;\n    &lt;drop type=&quot;boolean&quot;&gt;false&lt;/drop&gt;\n    &lt;defending type=&quot;boolean&quot;&gt;false&lt;/defending&gt;\n    &lt;max_hp type=&quot;int&quot;&gt;0&lt;/max_hp&gt;\n    &lt;str type=&quot;int&quot;&gt;0&lt;/str&gt;\n    &lt;end type=&quot;int&quot;&gt;0&lt;/end&gt;\n    &lt;dex type=&quot;int&quot;&gt;0&lt;/dex&gt;\n    &lt;agi type=&quot;int&quot;&gt;0&lt;/agi&gt;\n    &lt;spd type=&quot;int&quot;&gt;0&lt;/spd&gt;\n    &lt;hp type=&quot;int&quot;&gt;0&lt;/hp&gt;\n    &lt;hc type=&quot;int&quot;&gt;0&lt;/hc&gt;\n    &lt;pd type=&quot;int&quot;&gt;0&lt;/pd&gt;\n    &lt;pr type=&quot;int&quot;&gt;0&lt;/pr&gt;\n  &lt;/type&gt;\n  &lt;type name=&quot;pc&quot;&gt;\n    &lt;inherit name=&quot;char&quot; /&gt;\n    &lt;statusattributes type=&quot;stringdictionary&quot;&gt;hp = ;str = ;end = ;dex = ;agi = ;spd = ;hc = ;pd = ;pr = &lt;/statusattributes&gt;\n  &lt;/type&gt;\n  &lt;type name=&quot;npc&quot;&gt;\n    &lt;inherit name=&quot;char&quot; /&gt;\n    &lt;dead type=&quot;boolean&quot;&gt;false&lt;/dead&gt;\n    &lt;hostile type=&quot;boolean&quot;&gt;false&lt;/hostile&gt;\n    &lt;displayverbs type=&quot;list&quot;&gt;Look at; Talk; Fight&lt;/displayverbs&gt;\n  &lt;/type&gt;\n  &lt;function name=&quot;cc&quot;&gt;\n    msg (&quot;What is your name?&quot;)\n    get input {\n      game&#46;pov&#46;alias = result\n      msg (&quot; - &quot; + game&#46;pov&#46;alias)\n      show menu (&quot;What is your gender?&quot;, split (&quot;male;female&quot; , &quot;;&quot;), false) {\n        game&#46;pov&#46;gender = result\n        show menu (&quot;What is your race?&quot;, split (&quot;human;dwarf;elf&quot; , &quot;;&quot;), false) {\n          game&#46;pov&#46;race = result\n          show menu (&quot;What is your class?&quot;, split (&quot;warrior;cleric;mage;thief&quot; , &quot;;&quot;), false) {\n            game&#46;pov&#46;class = result\n            msg (game&#46;pov&#46;alias + &quot; is a &quot; + game&#46;pov&#46;gender + &quot; &quot; + game&#46;pov&#46;race + &quot; &quot; + game&#46;pov&#46;class + &quot;&#46;&quot;)\n            wait {\n              ClearScreen\n            }\n          }\n        }\n      }\n    }\n  &lt;/function&gt;\n  &lt;function name=&quot;sa&quot;&gt;\n    game&#46;pov&#46;hp = game&#46;pov&#46;cur_hp + &quot; / &quot; + game&#46;pov&#46;max_hp\n  &lt;/function&gt;\n  &lt;function name=&quot;battle_system&quot; parameters=&quot;self,text&quot; type=&quot;boolean&quot;&gt;\n    first_value = false\n    enemy = GetObject (text)\n    if (enemy = null) {\n      foreach (obj,AllObjects()) {\n        if (obj&#46;alias=text) {\n          enemy = obj\n        }\n      }\n    }\n    if (enemy = null) {\n      msg (&quot;There is no &quot; + text + &quot; here&#46;&quot;)\n      first_value = false\n    }\n    else if (not Doesinherit (enemy,&quot;npc&quot;)) {\n      msg (&quot;You can not battle that!&quot;)\n      first_value = false\n    }\n    else if (not npc_reachable (enemy)) {\n      msg (&quot;There is no &quot; + enemy&#46;alias + &quot; in your vicinity&#46;&quot;)\n      first_value = false\n    }\n    else if (GetBoolean (enemy,&quot;dead&quot;) = true) {\n      msg (enemy&#46;alias + &quot; is already dead&#46;&quot;)\n      first_value = false\n    }\n    else if (GetBoolean (enemy,&quot;hostile&quot;) = false) {\n      msg (enemy&#46;alias + &quot; is not hostile&#46;&quot;)\n      first_value = false\n    }\n    else if (battle_sequence (self,enemy) = true) {\n      msg (&quot;The battle is over&#46;&quot;)\n      first_value = true\n    }\n    return (first_value)\n  &lt;/function&gt;\n  &lt;function name=&quot;battle_sequence&quot; parameters=&quot;self,enemy&quot; type=&quot;boolean&quot;&gt;&lt;!&#91;CDATA&#91;\n    second_value = false\n    if (enemy&#46;dead = false) {\n      if (GetInt (self,&quot;spd&quot;) &gt; GetInt (enemy,&quot;spd&quot;)) {\n        on ready {\n          msg (&quot;You get to go first for this round&quot;)\n          if (self_battle_turn (self,enemy) = true) {\n            battle_sequence (self,enemy)\n          }\n        }\n        on ready {\n          if (enemy&#46;dead = false) {\n            if (enemy_battle_turn (self,enemy) = true) {\n              msg (&quot;The round has ended&#46;&quot;)\n            }\n          }\n        }\n        on ready {\n          battle_sequence (self,enemy)\n        }\n      }\n      else if (GetInt (self,&quot;spd&quot;) &lt; GetInt (enemy,&quot;spd&quot;)) {\n        on ready {\n          msg (enemy&#46;alias + &quot; gets to go first for this round&#46;&quot;)\n          if (enemy_battle_turn (self,enemy) = true) {\n            msg (&quot;It is now your turn&#46;&quot;)\n          }\n        }\n        on ready {\n          if (self_battle_turn (self,enemy) = true) {\n            battle_sequence (self,enemy)\n          }\n          else {\n            msg (&quot;The round has ended&#46;&quot;)\n          }\n        }\n        on ready {\n          battle_sequence (self,enemy)\n        }\n      }\n      else if (GetInt (self,&quot;spd&quot;) = GetInt (enemy,&quot;spd&quot;)) {\n        if (RandomChance (50) = true) {\n          on ready {\n            msg (&quot;You get to go first for this round&quot;)\n            if (self_battle_turn (self,enemy) = true) {\n              battle_sequence (self,enemy)\n            }\n          }\n          on ready {\n            if (enemy_battle_turn (self,enemy) = true) {\n              msg (&quot;The round has ended&#46;&quot;)\n            }\n          }\n          on ready {\n            battle_sequence (self,enemy)\n          }\n        }\n        else {\n          on ready {\n            msg (enemy&#46;alias + &quot; gets to go first for this round&#46;&quot;)\n            if (enemy_battle_turn (self,enemy) = true) {\n              msg (&quot;It is now your turn&#46;&quot;)\n            }\n          }\n          on ready {\n            if (self_battle_turn (self,enemy) = true) {\n              battle_sequence (self,enemy)\n            }\n            else {\n              msg (&quot;The round has ended&#46;&quot;)\n            }\n          }\n          on ready {\n            battle_sequence (self,enemy)\n          }\n        }\n      }\n    }\n    else {\n      second_value = true\n    }\n    return (second_value)\n  &#93;&#93;&gt;&lt;/function&gt;\n  &lt;function name=&quot;self_battle_turn&quot; parameters=&quot;self,enemy&quot; type=&quot;boolean&quot;&gt;&lt;!&#91;CDATA&#91;\n    third_value = false\n    msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)\n    msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)\n    wait {\n      show menu (&quot;What is your battle choice?&quot;, split (&quot;Attack;Defend;Cast;Item;Run&quot;, &quot;;&quot;), false) {\n        switch (result) {\n          case (&quot;Attack&quot;) {\n            fourth_value = false\n            if (RandomChance (GetInt (enemy,&quot;agi&quot;) - GetInt (self,&quot;spd&quot;)) = true) {\n              msg (enemy&#46;alias + &quot;evaded your attack!&quot;)\n              fourth_value = true\n            }\n            else if (RandomChance (GetInt (enemy,&quot;Dex&quot;) - GetInt (self,&quot;agi&quot;)) = true) {\n              msg (enemy&#46;alias + &quot;parried your attack!&quot;)\n              fourth_value = true\n            }\n            else if (RandomChance (GetInt (enemy,&quot;agi&quot;) - GetInt (self,&quot;dex&quot;)) = true) {\n              msg (enemy&#46;alias + &quot;blocked your attack!&quot;)\n              fourth_value = true\n            }\n            else if (RandomChance (GetInt (self,&quot;dex&quot;) - GetInt (enemy,&quot;spd&quot;)) = false) {\n              msg (&quot;Your attack missed &quot; + enemy&#46;alias +&quot;!&quot;)\n              fourth_value = true\n            }\n            else if (RandomChance (GetInt (enemy,&quot;pr&quot;) - GetInt (self,&quot;hc&quot;)) = true) {\n              msg (&quot;Your attack got resisted by &quot; + enemy&#46;alias +&quot;!&quot;)\n              fourth_value = true\n            }\n            else if (fourth_value = false) {\n              if (self&#46;defending = true and enemy&#46;defending = true) {\n                enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * 2 * GetInt (self,&quot;pd&quot;) / 2 + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)\n                msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)\n                self&#46;defending = false\n              }\n              else if (self&#46;defending = true and enemy&#46;defending = false) {\n                enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * 2 * GetInt (self,&quot;pd&quot;) + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)\n                msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)\n                self&#46;defending = false\n              }\n              else if (self&#46;defending = false and enemy&#46;defending = true) {\n                enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * GetInt (self,&quot;pd&quot;) / 2 + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)\n                msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)\n              }\n              else if (self&#46;defending = false and enemy&#46;defending = false) {\n                enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * GetInt (self,&quot;pd&quot;) + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)\n                msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)\n              }\n            }\n          }\n          case (&quot;Defend&quot;) {\n            if (self&#46;defending = false) {\n              self&#46;defending = true\n            }\n          }\n          case (&quot;Cast&quot;) {\n            self&#46;defending = false\n          }\n          case (&quot;Item&quot;) {\n            self&#46;defending = false\n          }\n          case (&quot;Run&quot;) {\n            self&#46;defending = false\n          }\n        }\n        if (GetInt (enemy,&quot;cur_hp&quot;) &gt; 0) {\n          if (RandomChance (GetInt (self,&quot;spd&quot;) - GetInt (enemy,&quot;spd&quot;)) = true) {\n            msg (&quot;You get an extra battle turn!&quot;)\n            self_battle_turn (self,enemy)\n          }\n          else {\n            msg (&quot;Your battle turn is over&#46;&quot;)\n            third_value = false\n          }\n        }\n        else if (GetInt (enemy,&quot;cur_hp&quot;) &lt;= 0) {\n          msg (enemy&#46;alias + &quot; is dead&#46;&quot;)\n          msg (&quot;You have won the battle!&quot;)\n          enemy&#46;defending = false\n          enemy&#46;dead = true\n          third_value = true\n          wait {\n            ClearScreen\n          }\n        }\n      }\n    }\n    return (third_value)\n  &#93;&#93;&gt;&lt;/function&gt;\n  &lt;function name=&quot;enemy_battle_turn&quot; parameters=&quot;self,enemy&quot; type=&quot;boolean&quot;&gt;&lt;!&#91;CDATA&#91;\n    fifth_value = false\n    msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)\n    msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)\n    result = GetRandomInt (1,3)\n    switch (result) {\n      case (1) {\n        sixth_value = false\n        if (RandomChance (GetInt (self,&quot;agi&quot;) - GetInt (enemy,&quot;spd&quot;)) = true) {\n          msg (&quot;You have evaded the attack!&quot;)\n          sixth_value = true\n        }\n        else if (RandomChance (GetInt (self,&quot;dex&quot;) - GetInt (enemy,&quot;agi&quot;)) = true) {\n          msg (&quot;You have parried the attack!&quot;)\n          sixth_value = true\n        }\n        else if (RandomChance (GetInt (self,&quot;agi&quot;) - GetInt (enemy,&quot;dex&quot;)) = true) {\n          msg (&quot;You have blocked the attack!&quot;)\n          sixth_value = true\n        }\n        else if (RandomChance (GetInt (enemy,&quot;dex&quot;) - GetInt (self,&quot;spd&quot;)) = false) {\n          msg (enemy&#46;alias +&quot;'s attack missed!&quot;)\n          sixth_value = true\n        }\n        else if (RandomChance (GetInt (self,&quot;pr&quot;) - GetInt (enemy,&quot;hc&quot;)) = true) {\n          msg (&quot;You resisted the attack!&quot;)\n          sixth_value = true\n        }\n        else if (sixth_value = false) { \n          if (enemy&#46;defending = true and self&#46;defending = true) {\n            self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * 2 * GetInt (enemy,&quot;pd&quot;) / 2 + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)\n            msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)\n            enemy&#46;defending = false\n          }\n          else if (enemy&#46;defending = true and self&#46;defending = false) {\n            self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * 2 * GetInt (enemy,&quot;pd&quot;) + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)\n            msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)\n            enemy&#46;defending = false\n          }\n          else if (enemy&#46;defending = false and self&#46;defending = true) {\n            self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * GetInt (enemy,&quot;pd&quot;) / 2 + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)\n            msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)\n          }\n          else if (enemy&#46;defending = false and self&#46;defending = false) {\n            self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * GetInt (enemy,&quot;pd&quot;) + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)\n            msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)\n          }\n        }\n      }\n      case (2) {\n        if (enemy&#46;defending = false) {\n          msg (enemy&#46;alias + &quot; has choosen to defend itself&#46;&quot;)\n          enemy&#46;defending = true\n        }\n      }\n      case (3) {\n        enemy&#46;defending = false\n        msg (&quot;Cast&quot;)\n      }\n    }\n    if (GetInt (self,&quot;cur_hp&quot;) &gt; 0) {\n      if (RandomChance (GetInt (enemy,&quot;spd&quot;) - GetInt (self,&quot;spd&quot;)) = true) {\n        msg (enemy&#46;alias + &quot; gets an extra battle turn!&quot;)\n        wait {\n          enemy_battle_turn (self,enemy)\n        }\n      }\n      else {\n        msg (enemy&#46;alias + &quot; 's battle turn is over&#46;&quot;)\n        fifth_value = true\n      }\n    }\n    else if (GetInt (self,&quot;cur_hp&quot;) &lt;= 0) {\n      msg (self&#46;alias + &quot; has died&#46;&quot;)\n      msg (&quot;GAME OVER&quot;)\n      finish\n    }\n    return (fifth_value)\n  &#93;&#93;&gt;&lt;/function&gt;\n  &lt;function name=&quot;npc_reachable&quot; parameters=&quot;object&quot; type=&quot;boolean&quot;&gt;\n    value = false\n    foreach (x,ScopeReachableNotHeld ()) {\n      if (x=object) {\n        value = true\n      }\n    }\n    return (value)\n  &lt;/function&gt;\n  &lt;function name=&quot;crit_hit&quot; parameters=&quot;object&quot; type=&quot;int&quot;&gt;\n    if (RandomChance (GetInt (object,&quot;luck&quot;)) = true) {\n      value = 2\n    }\n    else {\n      value = 1\n    }\n    return (value)\n  &lt;/function&gt;\n&lt;/asl&gt;[/code:1mnamifm]",
      "EditableFormat": "bbcode",
      "HTML": "the reason that we need to see full game codes, is that individual parts of code are connected to other parts of code, so while the individual part of code that you post, might not have any error, the other segment(s) of code that use or are used by your posted part of code, can have the error, so that's why we often can't identify the problem, as the small part of code you post, doesn't have any error in it, but some other part of your game code, does. We need to make sure EVERYTHING matches up as it should, because your entire game code is one giant dependant interconnected web, and it ALL must be correct for it to work.<br/><br/>---------<br/><br/>see if this can help you, possibly see what the issue might be:<br/><br/>(using #object# for this, to make it clearer)<br/><br/><pre><code>&lt;command name=&quot;fight_command&quot;&gt;<br/>    &lt;pattern&gt;fight #object#&lt;/pattern&gt;<br/>    &lt;script&gt;<br/>      battle_system (game&#46;pov,object)<br/>    &lt;/script&gt;<br/>  &lt;/command&gt;<br/><br/>&lt;function name=&quot;battle_system&quot; parameters=&quot;game&#46;pov,object&quot;&gt;<br/>    enemy = object<br/>    if (enemy = null) {<br/>      foreach (object_x,AllObjects()) {<br/>        if (object_x&#46;alias=object) {<br/>          enemy = object_x<br/>        }<br/>      }<br/>    }<br/>    if (enemy = null) {<br/>      // scripts<br/>    } else {<br/>      // scripts<br/>    }</code></pre><br/><br/>here's where you'd put this into your code (just a pseudo example):<br/><br/><pre><code>&lt;command name=&quot;fight_command&quot;&gt;<br/>    &lt;pattern&gt;fight #object#&lt;/pattern&gt;<br/>    &lt;script&gt;<br/>      battle_system (game&#46;pov,object)<br/>    &lt;/script&gt;<br/>  &lt;/command&gt;<br/><br/>&lt;function name=&quot;battle_system&quot; parameters=&quot;game&#46;pov,object&quot;&gt;<br/>    enemy = object<br/>    if (enemy = null) {<br/>      foreach (object_x,AllObjects()) {<br/>        if (object_x&#46;alias=object) {<br/>          enemy = object_x<br/>        }<br/>      }<br/>    }<br/>    if (enemy = null) {<br/>      // scripts<br/>    } else {<br/>      if (HasAttribute(object, &quot;enemy&quot;)) {<br/>        SetObjectFlagOn (object, &quot;incombat&quot;)<br/>        ShowMenu (&quot;What will you do? &quot;, player&#46;movelist, false) {<br/>          switch (result) {<br/>            case (&quot;kick&quot;) {<br/>              player&#46;damage = player&#46;Fight - object&#46;fightres<br/>              if (GetInt(player, &quot;damage&quot;) = 0) {<br/>                player&#46;damage = 0<br/>               }<br/>               object&#46;hp = object&#46;hp - player&#46;damage<br/>               msg (&quot;You kick &quot;+object&#46;prefix+&quot; &quot;+object&#46;name+&quot; for &quot;+player&#46;damage+&quot; damage!&quot;)<br/>             }<br/>             case (&quot;Magic Bolt&quot;) {<br/>               player&#46;damage = player&#46;Magic - object&#46;magicres<br/>               if (GetInt(player, &quot;damage&quot;) = 0) {<br/>                 player&#46;damage = 0<br/>               }<br/>               object&#46;hp = object&#46;hp - player&#46;damage<br/>               msg (&quot;You focus your magic at your horn and fire a Magic Bolt at &quot;+object&#46;prefix+&quot; &quot;+object&#46;name+&quot; for &quot;+player&#46;damage+&quot; damage!&quot;)<br/>           }<br/>     }<br/>  }<br/>}</code></pre><br/><br/>-----------------<br/><br/>(I use #text# for this, however)<br/><br/><pre><code>&lt;asl version=&quot;530&quot;&gt;<br/>  &lt;include ref=&quot;English&#46;aslx&quot; /&gt;<br/>  &lt;include ref=&quot;Core&#46;aslx&quot; /&gt;<br/>  &lt;game name=&quot;Testing Game Stuff&quot;&gt;<br/>    &lt;gameid&gt;d83ba5bb-2e3c-4f31-80c9-3e88a2dc082c&lt;/gameid&gt;<br/>    &lt;version&gt;1&#46;0&lt;/version&gt;<br/>    &lt;pov type=&quot;object&quot;&gt;player&lt;/pov&gt;<br/>    &lt;start type=&quot;script&quot;&gt;<br/>      cc<br/>    &lt;/start&gt;<br/>    &lt;turns type=&quot;int&quot;&gt;0&lt;/turns&gt;<br/>    &lt;statusattributes type=&quot;stringdictionary&quot;&gt;turns = &lt;/statusattributes&gt;<br/>  &lt;/game&gt;<br/>  &lt;object name=&quot;room&quot;&gt;<br/>    &lt;inherit name=&quot;editor_room&quot; /&gt;<br/>    &lt;object name=&quot;player&quot;&gt;<br/>      &lt;inherit name=&quot;defaultplayer&quot; /&gt;<br/>      &lt;inherit name=&quot;pc&quot; /&gt;<br/>      &lt;cur_hp type=&quot;int&quot;&gt;999&lt;/cur_hp&gt;<br/>      &lt;max_hp type=&quot;int&quot;&gt;999&lt;/max_hp&gt;<br/>      &lt;str type=&quot;int&quot;&gt;100&lt;/str&gt;<br/>      &lt;end type=&quot;int&quot;&gt;100&lt;/end&gt;<br/>      &lt;dex type=&quot;int&quot;&gt;100&lt;/dex&gt;<br/>      &lt;agi type=&quot;int&quot;&gt;100&lt;/agi&gt;<br/>      &lt;spd type=&quot;int&quot;&gt;100&lt;/spd&gt;<br/>      &lt;hc type=&quot;int&quot;&gt;100&lt;/hc&gt;<br/>      &lt;pd type=&quot;int&quot;&gt;100&lt;/pd&gt;<br/>      &lt;pr type=&quot;int&quot;&gt;100&lt;/pr&gt;<br/>    &lt;/object&gt;<br/>    &lt;object name=&quot;orc1&quot;&gt;<br/>      &lt;inherit name=&quot;editor_object&quot; /&gt;<br/>      &lt;inherit name=&quot;npc&quot; /&gt;<br/>      &lt;hostile type=&quot;boolean&quot;&gt;true&lt;/hostile&gt;<br/>      &lt;dead type=&quot;boolean&quot;&gt;false&lt;/dead&gt;<br/>      &lt;alias&gt;orc&lt;/alias&gt;<br/>      &lt;cur_hp type=&quot;int&quot;&gt;999&lt;/cur_hp&gt;<br/>      &lt;max_hp type=&quot;int&quot;&gt;999&lt;/max_hp&gt;<br/>      &lt;str type=&quot;int&quot;&gt;25&lt;/str&gt;<br/>      &lt;end type=&quot;int&quot;&gt;25&lt;/end&gt;<br/>      &lt;dex type=&quot;int&quot;&gt;25&lt;/dex&gt;<br/>      &lt;agi type=&quot;int&quot;&gt;25&lt;/agi&gt;<br/>      &lt;spd type=&quot;int&quot;&gt;25&lt;/spd&gt;<br/>      &lt;hc type=&quot;int&quot;&gt;25&lt;/hc&gt;<br/>      &lt;pd type=&quot;int&quot;&gt;25&lt;/pd&gt;<br/>      &lt;pr type=&quot;int&quot;&gt;25&lt;/pr&gt;<br/>    &lt;/object&gt;<br/>  &lt;/object&gt;<br/>  &lt;turnscript name=&quot;game_turns&quot;&gt;<br/>    &lt;enabled /&gt;<br/>    &lt;script&gt;<br/>      sa<br/>      game&#46;turns = game&#46;turns + 1<br/>    &lt;/script&gt;<br/>  &lt;/turnscript&gt;<br/>  &lt;command name=&quot;fight&quot;&gt;<br/>    &lt;pattern&gt;fight #text#&lt;/pattern&gt;<br/>    &lt;script&gt;<br/>      battle_system (game&#46;pov,text)<br/>    &lt;/script&gt;<br/>  &lt;/command&gt;<br/>  &lt;type name=&quot;char&quot;&gt;<br/>    &lt;cur_hp type=&quot;int&quot;&gt;0&lt;/cur_hp&gt;<br/>    &lt;drop type=&quot;boolean&quot;&gt;false&lt;/drop&gt;<br/>    &lt;defending type=&quot;boolean&quot;&gt;false&lt;/defending&gt;<br/>    &lt;max_hp type=&quot;int&quot;&gt;0&lt;/max_hp&gt;<br/>    &lt;str type=&quot;int&quot;&gt;0&lt;/str&gt;<br/>    &lt;end type=&quot;int&quot;&gt;0&lt;/end&gt;<br/>    &lt;dex type=&quot;int&quot;&gt;0&lt;/dex&gt;<br/>    &lt;agi type=&quot;int&quot;&gt;0&lt;/agi&gt;<br/>    &lt;spd type=&quot;int&quot;&gt;0&lt;/spd&gt;<br/>    &lt;hp type=&quot;int&quot;&gt;0&lt;/hp&gt;<br/>    &lt;hc type=&quot;int&quot;&gt;0&lt;/hc&gt;<br/>    &lt;pd type=&quot;int&quot;&gt;0&lt;/pd&gt;<br/>    &lt;pr type=&quot;int&quot;&gt;0&lt;/pr&gt;<br/>  &lt;/type&gt;<br/>  &lt;type name=&quot;pc&quot;&gt;<br/>    &lt;inherit name=&quot;char&quot; /&gt;<br/>    &lt;statusattributes type=&quot;stringdictionary&quot;&gt;hp = ;str = ;end = ;dex = ;agi = ;spd = ;hc = ;pd = ;pr = &lt;/statusattributes&gt;<br/>  &lt;/type&gt;<br/>  &lt;type name=&quot;npc&quot;&gt;<br/>    &lt;inherit name=&quot;char&quot; /&gt;<br/>    &lt;dead type=&quot;boolean&quot;&gt;false&lt;/dead&gt;<br/>    &lt;hostile type=&quot;boolean&quot;&gt;false&lt;/hostile&gt;<br/>    &lt;displayverbs type=&quot;list&quot;&gt;Look at; Talk; Fight&lt;/displayverbs&gt;<br/>  &lt;/type&gt;<br/>  &lt;function name=&quot;cc&quot;&gt;<br/>    msg (&quot;What is your name?&quot;)<br/>    get input {<br/>      game&#46;pov&#46;alias = result<br/>      msg (&quot; - &quot; + game&#46;pov&#46;alias)<br/>      show menu (&quot;What is your gender?&quot;, split (&quot;male;female&quot; , &quot;;&quot;), false) {<br/>        game&#46;pov&#46;gender = result<br/>        show menu (&quot;What is your race?&quot;, split (&quot;human;dwarf;elf&quot; , &quot;;&quot;), false) {<br/>          game&#46;pov&#46;race = result<br/>          show menu (&quot;What is your class?&quot;, split (&quot;warrior;cleric;mage;thief&quot; , &quot;;&quot;), false) {<br/>            game&#46;pov&#46;class = result<br/>            msg (game&#46;pov&#46;alias + &quot; is a &quot; + game&#46;pov&#46;gender + &quot; &quot; + game&#46;pov&#46;race + &quot; &quot; + game&#46;pov&#46;class + &quot;&#46;&quot;)<br/>            wait {<br/>              ClearScreen<br/>            }<br/>          }<br/>        }<br/>      }<br/>    }<br/>  &lt;/function&gt;<br/>  &lt;function name=&quot;sa&quot;&gt;<br/>    game&#46;pov&#46;hp = game&#46;pov&#46;cur_hp + &quot; / &quot; + game&#46;pov&#46;max_hp<br/>  &lt;/function&gt;<br/>  &lt;function name=&quot;battle_system&quot; parameters=&quot;self,text&quot; type=&quot;boolean&quot;&gt;<br/>    first_value = false<br/>    enemy = GetObject (text)<br/>    if (enemy = null) {<br/>      foreach (obj,AllObjects()) {<br/>        if (obj&#46;alias=text) {<br/>          enemy = obj<br/>        }<br/>      }<br/>    }<br/>    if (enemy = null) {<br/>      msg (&quot;There is no &quot; + text + &quot; here&#46;&quot;)<br/>      first_value = false<br/>    }<br/>    else if (not Doesinherit (enemy,&quot;npc&quot;)) {<br/>      msg (&quot;You can not battle that!&quot;)<br/>      first_value = false<br/>    }<br/>    else if (not npc_reachable (enemy)) {<br/>      msg (&quot;There is no &quot; + enemy&#46;alias + &quot; in your vicinity&#46;&quot;)<br/>      first_value = false<br/>    }<br/>    else if (GetBoolean (enemy,&quot;dead&quot;) = true) {<br/>      msg (enemy&#46;alias + &quot; is already dead&#46;&quot;)<br/>      first_value = false<br/>    }<br/>    else if (GetBoolean (enemy,&quot;hostile&quot;) = false) {<br/>      msg (enemy&#46;alias + &quot; is not hostile&#46;&quot;)<br/>      first_value = false<br/>    }<br/>    else if (battle_sequence (self,enemy) = true) {<br/>      msg (&quot;The battle is over&#46;&quot;)<br/>      first_value = true<br/>    }<br/>    return (first_value)<br/>  &lt;/function&gt;<br/>  &lt;function name=&quot;battle_sequence&quot; parameters=&quot;self,enemy&quot; type=&quot;boolean&quot;&gt;&lt;!&#91;CDATA&#91;<br/>    second_value = false<br/>    if (enemy&#46;dead = false) {<br/>      if (GetInt (self,&quot;spd&quot;) &gt; GetInt (enemy,&quot;spd&quot;)) {<br/>        on ready {<br/>          msg (&quot;You get to go first for this round&quot;)<br/>          if (self_battle_turn (self,enemy) = true) {<br/>            battle_sequence (self,enemy)<br/>          }<br/>        }<br/>        on ready {<br/>          if (enemy&#46;dead = false) {<br/>            if (enemy_battle_turn (self,enemy) = true) {<br/>              msg (&quot;The round has ended&#46;&quot;)<br/>            }<br/>          }<br/>        }<br/>        on ready {<br/>          battle_sequence (self,enemy)<br/>        }<br/>      }<br/>      else if (GetInt (self,&quot;spd&quot;) &lt; GetInt (enemy,&quot;spd&quot;)) {<br/>        on ready {<br/>          msg (enemy&#46;alias + &quot; gets to go first for this round&#46;&quot;)<br/>          if (enemy_battle_turn (self,enemy) = true) {<br/>            msg (&quot;It is now your turn&#46;&quot;)<br/>          }<br/>        }<br/>        on ready {<br/>          if (self_battle_turn (self,enemy) = true) {<br/>            battle_sequence (self,enemy)<br/>          }<br/>          else {<br/>            msg (&quot;The round has ended&#46;&quot;)<br/>          }<br/>        }<br/>        on ready {<br/>          battle_sequence (self,enemy)<br/>        }<br/>      }<br/>      else if (GetInt (self,&quot;spd&quot;) = GetInt (enemy,&quot;spd&quot;)) {<br/>        if (RandomChance (50) = true) {<br/>          on ready {<br/>            msg (&quot;You get to go first for this round&quot;)<br/>            if (self_battle_turn (self,enemy) = true) {<br/>              battle_sequence (self,enemy)<br/>            }<br/>          }<br/>          on ready {<br/>            if (enemy_battle_turn (self,enemy) = true) {<br/>              msg (&quot;The round has ended&#46;&quot;)<br/>            }<br/>          }<br/>          on ready {<br/>            battle_sequence (self,enemy)<br/>          }<br/>        }<br/>        else {<br/>          on ready {<br/>            msg (enemy&#46;alias + &quot; gets to go first for this round&#46;&quot;)<br/>            if (enemy_battle_turn (self,enemy) = true) {<br/>              msg (&quot;It is now your turn&#46;&quot;)<br/>            }<br/>          }<br/>          on ready {<br/>            if (self_battle_turn (self,enemy) = true) {<br/>              battle_sequence (self,enemy)<br/>            }<br/>            else {<br/>              msg (&quot;The round has ended&#46;&quot;)<br/>            }<br/>          }<br/>          on ready {<br/>            battle_sequence (self,enemy)<br/>          }<br/>        }<br/>      }<br/>    }<br/>    else {<br/>      second_value = true<br/>    }<br/>    return (second_value)<br/>  &#93;&#93;&gt;&lt;/function&gt;<br/>  &lt;function name=&quot;self_battle_turn&quot; parameters=&quot;self,enemy&quot; type=&quot;boolean&quot;&gt;&lt;!&#91;CDATA&#91;<br/>    third_value = false<br/>    msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>    msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>    wait {<br/>      show menu (&quot;What is your battle choice?&quot;, split (&quot;Attack;Defend;Cast;Item;Run&quot;, &quot;;&quot;), false) {<br/>        switch (result) {<br/>          case (&quot;Attack&quot;) {<br/>            fourth_value = false<br/>            if (RandomChance (GetInt (enemy,&quot;agi&quot;) - GetInt (self,&quot;spd&quot;)) = true) {<br/>              msg (enemy&#46;alias + &quot;evaded your attack!&quot;)<br/>              fourth_value = true<br/>            }<br/>            else if (RandomChance (GetInt (enemy,&quot;Dex&quot;) - GetInt (self,&quot;agi&quot;)) = true) {<br/>              msg (enemy&#46;alias + &quot;parried your attack!&quot;)<br/>              fourth_value = true<br/>            }<br/>            else if (RandomChance (GetInt (enemy,&quot;agi&quot;) - GetInt (self,&quot;dex&quot;)) = true) {<br/>              msg (enemy&#46;alias + &quot;blocked your attack!&quot;)<br/>              fourth_value = true<br/>            }<br/>            else if (RandomChance (GetInt (self,&quot;dex&quot;) - GetInt (enemy,&quot;spd&quot;)) = false) {<br/>              msg (&quot;Your attack missed &quot; + enemy&#46;alias +&quot;!&quot;)<br/>              fourth_value = true<br/>            }<br/>            else if (RandomChance (GetInt (enemy,&quot;pr&quot;) - GetInt (self,&quot;hc&quot;)) = true) {<br/>              msg (&quot;Your attack got resisted by &quot; + enemy&#46;alias +&quot;!&quot;)<br/>              fourth_value = true<br/>            }<br/>            else if (fourth_value = false) {<br/>              if (self&#46;defending = true and enemy&#46;defending = true) {<br/>                enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * 2 * GetInt (self,&quot;pd&quot;) / 2 + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)<br/>                msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>                self&#46;defending = false<br/>              }<br/>              else if (self&#46;defending = true and enemy&#46;defending = false) {<br/>                enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * 2 * GetInt (self,&quot;pd&quot;) + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)<br/>                msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>                self&#46;defending = false<br/>              }<br/>              else if (self&#46;defending = false and enemy&#46;defending = true) {<br/>                enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * GetInt (self,&quot;pd&quot;) / 2 + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)<br/>                msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>              }<br/>              else if (self&#46;defending = false and enemy&#46;defending = false) {<br/>                enemy&#46;cur_hp = enemy&#46;cur_hp - (crit_hit (self) * GetInt (self,&quot;pd&quot;) + GetInt (self,&quot;pd&quot;) * (GetInt (self,&quot;str&quot;) - GetInt (enemy,&quot;end&quot;)) / 100)<br/>                msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>              }<br/>            }<br/>          }<br/>          case (&quot;Defend&quot;) {<br/>            if (self&#46;defending = false) {<br/>              self&#46;defending = true<br/>            }<br/>          }<br/>          case (&quot;Cast&quot;) {<br/>            self&#46;defending = false<br/>          }<br/>          case (&quot;Item&quot;) {<br/>            self&#46;defending = false<br/>          }<br/>          case (&quot;Run&quot;) {<br/>            self&#46;defending = false<br/>          }<br/>        }<br/>        if (GetInt (enemy,&quot;cur_hp&quot;) &gt; 0) {<br/>          if (RandomChance (GetInt (self,&quot;spd&quot;) - GetInt (enemy,&quot;spd&quot;)) = true) {<br/>            msg (&quot;You get an extra battle turn!&quot;)<br/>            self_battle_turn (self,enemy)<br/>          }<br/>          else {<br/>            msg (&quot;Your battle turn is over&#46;&quot;)<br/>            third_value = false<br/>          }<br/>        }<br/>        else if (GetInt (enemy,&quot;cur_hp&quot;) &lt;= 0) {<br/>          msg (enemy&#46;alias + &quot; is dead&#46;&quot;)<br/>          msg (&quot;You have won the battle!&quot;)<br/>          enemy&#46;defending = false<br/>          enemy&#46;dead = true<br/>          third_value = true<br/>          wait {<br/>            ClearScreen<br/>          }<br/>        }<br/>      }<br/>    }<br/>    return (third_value)<br/>  &#93;&#93;&gt;&lt;/function&gt;<br/>  &lt;function name=&quot;enemy_battle_turn&quot; parameters=&quot;self,enemy&quot; type=&quot;boolean&quot;&gt;&lt;!&#91;CDATA&#91;<br/>    fifth_value = false<br/>    msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>    msg (enemy&#46;alias + &quot; has &quot; + enemy&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>    result = GetRandomInt (1,3)<br/>    switch (result) {<br/>      case (1) {<br/>        sixth_value = false<br/>        if (RandomChance (GetInt (self,&quot;agi&quot;) - GetInt (enemy,&quot;spd&quot;)) = true) {<br/>          msg (&quot;You have evaded the attack!&quot;)<br/>          sixth_value = true<br/>        }<br/>        else if (RandomChance (GetInt (self,&quot;dex&quot;) - GetInt (enemy,&quot;agi&quot;)) = true) {<br/>          msg (&quot;You have parried the attack!&quot;)<br/>          sixth_value = true<br/>        }<br/>        else if (RandomChance (GetInt (self,&quot;agi&quot;) - GetInt (enemy,&quot;dex&quot;)) = true) {<br/>          msg (&quot;You have blocked the attack!&quot;)<br/>          sixth_value = true<br/>        }<br/>        else if (RandomChance (GetInt (enemy,&quot;dex&quot;) - GetInt (self,&quot;spd&quot;)) = false) {<br/>          msg (enemy&#46;alias +&quot;'s attack missed!&quot;)<br/>          sixth_value = true<br/>        }<br/>        else if (RandomChance (GetInt (self,&quot;pr&quot;) - GetInt (enemy,&quot;hc&quot;)) = true) {<br/>          msg (&quot;You resisted the attack!&quot;)<br/>          sixth_value = true<br/>        }<br/>        else if (sixth_value = false) { <br/>          if (enemy&#46;defending = true and self&#46;defending = true) {<br/>            self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * 2 * GetInt (enemy,&quot;pd&quot;) / 2 + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)<br/>            msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>            enemy&#46;defending = false<br/>          }<br/>          else if (enemy&#46;defending = true and self&#46;defending = false) {<br/>            self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * 2 * GetInt (enemy,&quot;pd&quot;) + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)<br/>            msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>            enemy&#46;defending = false<br/>          }<br/>          else if (enemy&#46;defending = false and self&#46;defending = true) {<br/>            self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * GetInt (enemy,&quot;pd&quot;) / 2 + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)<br/>            msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>          }<br/>          else if (enemy&#46;defending = false and self&#46;defending = false) {<br/>            self&#46;cur_hp = self&#46;cur_hp - (crit_hit (enemy) * GetInt (enemy,&quot;pd&quot;) + GetInt (enemy,&quot;pd&quot;) * (GetInt (enemy,&quot;str&quot;) - GetInt (self,&quot;end&quot;)) / 100)<br/>            msg (self&#46;alias + &quot; has &quot; + self&#46;cur_hp + &quot; HP left&#46;&quot;)<br/>          }<br/>        }<br/>      }<br/>      case (2) {<br/>        if (enemy&#46;defending = false) {<br/>          msg (enemy&#46;alias + &quot; has choosen to defend itself&#46;&quot;)<br/>          enemy&#46;defending = true<br/>        }<br/>      }<br/>      case (3) {<br/>        enemy&#46;defending = false<br/>        msg (&quot;Cast&quot;)<br/>      }<br/>    }<br/>    if (GetInt (self,&quot;cur_hp&quot;) &gt; 0) {<br/>      if (RandomChance (GetInt (enemy,&quot;spd&quot;) - GetInt (self,&quot;spd&quot;)) = true) {<br/>        msg (enemy&#46;alias + &quot; gets an extra battle turn!&quot;)<br/>        wait {<br/>          enemy_battle_turn (self,enemy)<br/>        }<br/>      }<br/>      else {<br/>        msg (enemy&#46;alias + &quot; 's battle turn is over&#46;&quot;)<br/>        fifth_value = true<br/>      }<br/>    }<br/>    else if (GetInt (self,&quot;cur_hp&quot;) &lt;= 0) {<br/>      msg (self&#46;alias + &quot; has died&#46;&quot;)<br/>      msg (&quot;GAME OVER&quot;)<br/>      finish<br/>    }<br/>    return (fifth_value)<br/>  &#93;&#93;&gt;&lt;/function&gt;<br/>  &lt;function name=&quot;npc_reachable&quot; parameters=&quot;object&quot; type=&quot;boolean&quot;&gt;<br/>    value = false<br/>    foreach (x,ScopeReachableNotHeld ()) {<br/>      if (x=object) {<br/>        value = true<br/>      }<br/>    }<br/>    return (value)<br/>  &lt;/function&gt;<br/>  &lt;function name=&quot;crit_hit&quot; parameters=&quot;object&quot; type=&quot;int&quot;&gt;<br/>    if (RandomChance (GetInt (object,&quot;luck&quot;)) = true) {<br/>      value = 2<br/>    }<br/>    else {<br/>      value = 1<br/>    }<br/>    return (value)<br/>  &lt;/function&gt;<br/>&lt;/asl&gt;</code></pre>",
      "PostDate": "2014-07-13T04:49:04+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "29491",
      "UserId": 0,
      "Username": "Espera",
      "UserAvatar": null,
      "UserGravatar": "04bdffe31cdc4e1c0d61f05a2f5a7532",
      "EditableText": "I'd love to give you my whole game code, but I can't It's too huge to fit in a forum post. Whoever can address this is going to have to troubleshoot it with the code I've provided, or request specific other code.",
      "EditableFormat": "bbcode",
      "HTML": "I'd love to give you my whole game code, but I can't It's too huge to fit in a forum post. Whoever can address this is going to have to troubleshoot it with the code I've provided, or request specific other code.",
      "PostDate": "2014-07-13T05:05:33+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "29492",
      "UserId": 0,
      "Username": "Espera",
      "UserAvatar": null,
      "UserGravatar": "04bdffe31cdc4e1c0d61f05a2f5a7532",
      "EditableText": "I've checked to see if ti's an alias issue. I don't think it is. The problem comes up no matter what name I enter, including the test enemy's real name.",
      "EditableFormat": "bbcode",
      "HTML": "I've checked to see if ti's an alias issue. I don't think it is. The problem comes up no matter what name I enter, including the test enemy's real name.",
      "PostDate": "2014-07-13T05:09:02+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "29493",
      "UserId": 0,
      "Username": "Espera",
      "UserAvatar": null,
      "UserGravatar": "04bdffe31cdc4e1c0d61f05a2f5a7532",
      "EditableText": "I found a way you can see my code. Have at it. \n\n[url:1wgqs3ax]https&#58;//docs&#46;google&#46;com/document/d/1xtt0v0ibSv1AeMuUglZrI4V5iefsyI5gUqWiv6GuxN0/edit[/url:1wgqs3ax]",
      "EditableFormat": "bbcode",
      "HTML": "I found a way you can see my code. Have at it. <br/><br/><a href=\"https&#58;//docs&#46;google&#46;com/document/d/1xtt0v0ibSv1AeMuUglZrI4V5iefsyI5gUqWiv6GuxN0/edit\" rel=\"nofollow\">https&#58;//docs&#46;google&#46;com/document/d/1xtt0v0ibSv1AeMuUglZrI4V5iefsyI5gUqWiv6GuxN0/edit</a>",
      "PostDate": "2014-07-13T05:37:42+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "29494",
      "UserId": 0,
      "Username": "HegemonKhan",
      "UserAvatar": null,
      "UserGravatar": "a96cf34d8d97c57de38f54ee22b1759b",
      "EditableText": "I need to get permission to view file, sent a pm here on this site, to verify my email request for permission, as mine.",
      "EditableFormat": "bbcode",
      "HTML": "I need to get permission to view file, sent a pm here on this site, to verify my email request for permission, as mine.",
      "PostDate": "2014-07-13T06:02:05+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "29496",
      "UserId": 0,
      "Username": "Espera",
      "UserAvatar": null,
      "UserGravatar": "04bdffe31cdc4e1c0d61f05a2f5a7532",
      "EditableText": "Try again. The link should work now. Sorry, this is my first time using googledocs.",
      "EditableFormat": "bbcode",
      "HTML": "Try again. The link should work now. Sorry, this is my first time using googledocs.",
      "PostDate": "2014-07-13T07:24:43+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "29498",
      "UserId": 0,
      "Username": "jaynabonne",
      "UserAvatar": "6579_1344778256.jpg",
      "UserGravatar": "379859a7f1952a65399fc63997e68f0b",
      "EditableText": "The problem is that all variables are lost within the script for a ShowMenu. When you call ShowMenu, you need to save those objects somewhere (e.g. in the game) so that you can reference them once the menu choice has been made.\n\n[code:1qwlfrwo]if (HasAttribute(object, &quot;enemy&quot;)) {\n  SetObjectFlagOn (object, &quot;incombat&quot;)\n  game&#46;current_object = object     // Save current object for use in menu script&#46;\n  ShowMenu (&quot;What will you do? &quot;, player&#46;movelist, false) {\n    object = game&#46;current_object    // Restore current object\n    switch (result) {\n      case (&quot;kick&quot;) {\n        player&#46;damage = player&#46;Fight - object&#46;fightres\n        if (GetInt(player, &quot;damage&quot;) = 0) {\n          player&#46;damage = 0\n        }\n        object&#46;hp = object&#46;hp - player&#46;damage\n        msg (&quot;You kick &quot;+object&#46;prefix+&quot; &quot;+object&#46;name+&quot; for &quot;+player&#46;damage+&quot; damage!&quot;)\n      }\n      case (&quot;Magic Bolt&quot;) {\n        player&#46;damage = player&#46;Magic - object&#46;magicres\n        if (GetInt(player, &quot;damage&quot;) = 0) {\n          player&#46;damage = 0\n        }\n        object&#46;hp = object&#46;hp - player&#46;damage\n        msg (&quot;You focus your magic at your horn and fire a Magic Bolt at &quot;+object&#46;prefix+&quot; &quot;+object&#46;name+&quot; for &quot;+player&#46;damage+&quot; damage!&quot;)\n      }\n    }\n  }\n}\n\n[/code:1qwlfrwo]",
      "EditableFormat": "bbcode",
      "HTML": "The problem is that all variables are lost within the script for a ShowMenu. When you call ShowMenu, you need to save those objects somewhere (e.g. in the game) so that you can reference them once the menu choice has been made.<br/><br/><pre><code>if (HasAttribute(object, &quot;enemy&quot;)) {<br/>  SetObjectFlagOn (object, &quot;incombat&quot;)<br/>  game&#46;current_object = object     // Save current object for use in menu script&#46;<br/>  ShowMenu (&quot;What will you do? &quot;, player&#46;movelist, false) {<br/>    object = game&#46;current_object    // Restore current object<br/>    switch (result) {<br/>      case (&quot;kick&quot;) {<br/>        player&#46;damage = player&#46;Fight - object&#46;fightres<br/>        if (GetInt(player, &quot;damage&quot;) = 0) {<br/>          player&#46;damage = 0<br/>        }<br/>        object&#46;hp = object&#46;hp - player&#46;damage<br/>        msg (&quot;You kick &quot;+object&#46;prefix+&quot; &quot;+object&#46;name+&quot; for &quot;+player&#46;damage+&quot; damage!&quot;)<br/>      }<br/>      case (&quot;Magic Bolt&quot;) {<br/>        player&#46;damage = player&#46;Magic - object&#46;magicres<br/>        if (GetInt(player, &quot;damage&quot;) = 0) {<br/>          player&#46;damage = 0<br/>        }<br/>        object&#46;hp = object&#46;hp - player&#46;damage<br/>        msg (&quot;You focus your magic at your horn and fire a Magic Bolt at &quot;+object&#46;prefix+&quot; &quot;+object&#46;name+&quot; for &quot;+player&#46;damage+&quot; damage!&quot;)<br/>      }<br/>    }<br/>  }<br/>}<br/><br/></code></pre>",
      "PostDate": "2014-07-13T08:47:18+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "29500",
      "UserId": 0,
      "Username": "Espera",
      "UserAvatar": null,
      "UserGravatar": "04bdffe31cdc4e1c0d61f05a2f5a7532",
      "EditableText": "Thank you immensely, Jay. \nJust to be clear, the current_object attribute i sa string?",
      "EditableFormat": "bbcode",
      "HTML": "Thank you immensely, Jay. <br/>Just to be clear, the current_object attribute i sa string?",
      "PostDate": "2014-07-13T09:52:23+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "29501",
      "UserId": 0,
      "Username": "jaynabonne",
      "UserAvatar": "6579_1344778256.jpg",
      "UserGravatar": "379859a7f1952a65399fc63997e68f0b",
      "EditableText": "It's whatever is assigned to it. In this case, since it's the &quot;object&quot; parameter passed to the command, it's an actual object, the same as what you are using before the ShowMenu,",
      "EditableFormat": "bbcode",
      "HTML": "It's whatever is assigned to it. In this case, since it's the &quot;object&quot; parameter passed to the command, it's an actual object, the same as what you are using before the ShowMenu,",
      "PostDate": "2014-07-13T10:00:12+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "29502",
      "UserId": 0,
      "Username": "Espera",
      "UserAvatar": null,
      "UserGravatar": "04bdffe31cdc4e1c0d61f05a2f5a7532",
      "EditableText": "Thanks a buch! It's working.",
      "EditableFormat": "bbcode",
      "HTML": "Thanks a buch! It's working.",
      "PostDate": "2014-07-13T10:05:35+01:00",
      "LastEditDate": null
    }
  ]
}

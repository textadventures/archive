{
  "Topic": {
    "TopicId": "xavcnqi-p0kvddebaaryxa",
    "ForumId": "10",
    "Title": "Referencing an attribute using 'this' inside a menu",
    "LastUpdated": "2017-01-14T12:16:18.0011514Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "ac547548-bac8-4b8a-9cab-add5e21ae0a7",
      "UserId": 283832,
      "Username": "scrimshaw04",
      "AvatarUrl": "https://secure.gravatar.com/avatar/8d126990ac9c6b79315d4db221bf6ef7?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Hi again. I'm feeling a little like a broken record, but I'm a little confused about how 'this' and 'do' work when used inside a menu.\r\n\r\nThis is the code I currently have:\r\n\r\n```\r\ncommands = NewStringList()\r\nlist add (this.commands, \"Command_01\")\r\nlist add (this.commands, \"Command_01\")\r\nShowMenu (\"Commands:\", this.commands, true) {\r\n  if (result = \"Command_01\") {\r\n    do (this, \"Script_01\")\r\n  }\r\n  if (result = \"Command_02\") {\r\n    do (this, \"Script_02\")\r\n  }\r\n}\r\n```\r\n\r\nBut 'this' isn't recognised when it's used inside the menu. Is there anyway I can use 'do' to run a script attribute on an object without referencing it by name?",
      "EditableFormat": "markdown",
      "HTML": "<p>Hi again. I'm feeling a little like a broken record, but I'm a little confused about how 'this' and 'do' work when used inside a menu.</p>\n<p>This is the code I currently have:</p>\n<pre><code>commands = NewStringList()\nlist add (this.commands, \"Command_01\")\nlist add (this.commands, \"Command_01\")\nShowMenu (\"Commands:\", this.commands, true) {\n  if (result = \"Command_01\") {\n    do (this, \"Script_01\")\n  }\n  if (result = \"Command_02\") {\n    do (this, \"Script_02\")\n  }\n}\n</code></pre>\n<p>But 'this' isn't recognised when it's used inside the menu. Is there anyway I can use 'do' to run a script attribute on an object without referencing it by name?</p>\n\n",
      "PostDate": "2017-01-14T12:16:18.0011514Z",
      "LastEditDate": null
    },
    {
      "PostId": "1356c363-a7cf-4b7c-b511-7ead22705a78",
      "UserId": 247325,
      "Username": "hegemonkhan",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a96cf34d8d97c57de38f54ee22b1759b?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "the 'this' special keyword/keycommand GETS_AND_RETURNS (if it can, otherwise: ERROR) the parent (containing/container) Object of the (contained) scripting:\r\n\r\n```\r\n<object name=\"tree\">\r\n  <attr name=\"look\" type=\"script\">\r\n    msg (this.name)\r\n    // otherwise, you'd normally do this:\r\n    // msg (tree.name)\r\n  </attr>\r\n</object>\r\n\r\n// invoke (tree.look), it'll output: tree\r\n\r\n-----------------------------\r\n\r\n<object name=\"flower\">\r\n  <attr name=\"look\" type=\"script\">\r\n    // otherwise, you'd normally do this:\r\n    // msg (flower.name)\r\n  </attr>\r\n</object>\r\n\r\n// invoke (flower.look), it'll output: flower\r\n\r\n---------\r\n\r\n<type name=\"example_type\">\r\n  <attr name=\"look\" type=\"script\">\r\n    msg (this.name)\r\n  </attr>\r\n</type>\r\n\r\n<object name=\"tree\">\r\n  <inherit name=\"example_type\" />\r\n</object>\r\n// invoke (tree.look), it'll output: tree\r\n\r\n<object name=\"flower\">\r\n  <inherit name=\"example_type\" />\r\n</object>\r\n// invoke (flower.look), it'll output: flower\r\n```\r\n\r\n--------------\r\n\r\nI'm not that familiar with Commands in regards to this stuff (having local commands: commands inside of an Object/Room Object)...\r\n\r\nyou might not be able to do this:\r\n\r\nthis.commands / NAME_OF_OBJECT.commands\r\n\r\nif you can... then you need to change your:\r\n\r\ncommands = NewStringList()\r\n\r\nto this:\r\n\r\nthis.commands = NewStringList()\r\n\r\nand I'm assuming that this code block is indeed inside of Objects (as that's why you'd want to be using the 'this' keyword/keycommand), for example (not the most practical design/method, but it's just an example):\r\n\r\n(and, you got a few other mistakes to fix up, see below for corrections)\r\n\r\n(going by this: http://docs.textadventures.co.uk/quest/elements/ --- see the very bottom: any other XML element will set an attribute of that name on the parent object/type/exit/command, maybe the below might work)\r\n\r\n```\r\n<object name=\"example_1_object\">\r\n  <attr name=\"Command_01\" type=\"command\">\r\n    <pattern>XXX</pattern>\r\n    <script>\r\n      // XXX\r\n    </script>\r\n  </attr>\r\n  <attr name=\"Command_02\" type=\"command\">\r\n    <pattern>XXX</pattern>\r\n    <script>\r\n      // XXX\r\n    </script>\r\n  </attr>\r\n  <attr name=\"example_script\" type=\"script\">\r\n    this.commands = NewStringList()\r\n    list add (this.commands, \"Command_01\")\r\n    list add (this.commands, \"Command_02\")\r\n    ShowMenu (\"Commands:\", this.commands, true) {\r\n      if (result = \"Command_01\") {\r\n        do (this, \"Commands_01\", \"script\")\r\n      }\r\n      if (result = \"Command_02\") {\r\n        do (this, \"Commands_02\", \"script\")\r\n      }\r\n    }\r\n  </attr>\r\n</object>\r\n\r\n<object name=\"example_2_object\">\r\n  <attr name=\"Command_01\" type=\"command\">\r\n    <pattern>XXX</pattern>\r\n    <script>\r\n      // XXX\r\n    </script>\r\n  </attr>\r\n  <attr name=\"Command_02\" type=\"command\">\r\n    <pattern>XXX</pattern>\r\n    <script>\r\n      // XXX\r\n    </script>\r\n  </attr>\r\n  <attr name=\"example_script\" type=\"script\">\r\n    this.commands = NewStringList()\r\n    list add (this.commands, \"Command_01\")\r\n    list add (this.commands, \"Command_02\")\r\n    ShowMenu (\"Commands:\", this.commands, true) {\r\n      if (result = \"Command_01\") {\r\n        do (this, \"Commands_01\", \"script\")\r\n      }\r\n      if (result = \"Command_02\") {\r\n        do (this, \"Commands_02\", \"script\")\r\n      }\r\n    }\r\n  </attr>\r\n</object>\r\n```\r\n\r\n----------\r\n\r\nthis is way beyond my knowledge... unless you need to use Commands... you should just use a Function or Script Attributes (+ Delegates if need Parameters and/or return type)...\r\n\r\njust found this too:\r\n\r\nhttp://docs.textadventures.co.uk/quest/functions/allcommands.html\r\n\r\nlooks like some of the 'object' Parameters might actually mean OBJECT (of quest's engine's/itself's programming, its OOP/OOD structure --- which in quest, is its 'Elements', such as 'Commands', 'Turnscripts', 'Verbs', 'Exits', 'Objects', 'Functions', 'Object Types / Types', etc etc etc), so maybe it might be better for the 'do' syntax to put your Commands into an Objectlist Attribute and use the 'ObjectListItem', which may make it more simple (for me hopefully lol) to get the syntax working with 'do'....",
      "EditableFormat": "markdown",
      "HTML": "<p>the 'this' special keyword/keycommand GETS_AND_RETURNS (if it can, otherwise: ERROR) the parent (containing/container) Object of the (contained) scripting:</p>\n<pre><code>&lt;object name=\"tree\"&gt;\n  &lt;attr name=\"look\" type=\"script\"&gt;\n    msg (this.name)\n    // otherwise, you'd normally do this:\n    // msg (tree.name)\n  &lt;/attr&gt;\n&lt;/object&gt;\n\n// invoke (tree.look), it'll output: tree\n\n-----------------------------\n\n&lt;object name=\"flower\"&gt;\n  &lt;attr name=\"look\" type=\"script\"&gt;\n    // otherwise, you'd normally do this:\n    // msg (flower.name)\n  &lt;/attr&gt;\n&lt;/object&gt;\n\n// invoke (flower.look), it'll output: flower\n\n---------\n\n&lt;type name=\"example_type\"&gt;\n  &lt;attr name=\"look\" type=\"script\"&gt;\n    msg (this.name)\n  &lt;/attr&gt;\n&lt;/type&gt;\n\n&lt;object name=\"tree\"&gt;\n  &lt;inherit name=\"example_type\" /&gt;\n&lt;/object&gt;\n// invoke (tree.look), it'll output: tree\n\n&lt;object name=\"flower\"&gt;\n  &lt;inherit name=\"example_type\" /&gt;\n&lt;/object&gt;\n// invoke (flower.look), it'll output: flower\n</code></pre>\n<hr>\n<p>I'm not that familiar with Commands in regards to this stuff (having local commands: commands inside of an Object/Room Object)...</p>\n<p>you might not be able to do this:</p>\n<p>this.commands / NAME_OF_OBJECT.commands</p>\n<p>if you can... then you need to change your:</p>\n<p>commands = NewStringList()</p>\n<p>to this:</p>\n<p>this.commands = NewStringList()</p>\n<p>and I'm assuming that this code block is indeed inside of Objects (as that's why you'd want to be using the 'this' keyword/keycommand), for example (not the most practical design/method, but it's just an example):</p>\n<p>(and, you got a few other mistakes to fix up, see below for corrections)</p>\n<p>(going by this: http://docs.textadventures.co.uk/quest/elements/ --- see the very bottom: any other XML element will set an attribute of that name on the parent object/type/exit/command, maybe the below might work)</p>\n<pre><code>&lt;object name=\"example_1_object\"&gt;\n  &lt;attr name=\"Command_01\" type=\"command\"&gt;\n    &lt;pattern&gt;XXX&lt;/pattern&gt;\n    &lt;script&gt;\n      // XXX\n    &lt;/script&gt;\n  &lt;/attr&gt;\n  &lt;attr name=\"Command_02\" type=\"command\"&gt;\n    &lt;pattern&gt;XXX&lt;/pattern&gt;\n    &lt;script&gt;\n      // XXX\n    &lt;/script&gt;\n  &lt;/attr&gt;\n  &lt;attr name=\"example_script\" type=\"script\"&gt;\n    this.commands = NewStringList()\n    list add (this.commands, \"Command_01\")\n    list add (this.commands, \"Command_02\")\n    ShowMenu (\"Commands:\", this.commands, true) {\n      if (result = \"Command_01\") {\n        do (this, \"Commands_01\", \"script\")\n      }\n      if (result = \"Command_02\") {\n        do (this, \"Commands_02\", \"script\")\n      }\n    }\n  &lt;/attr&gt;\n&lt;/object&gt;\n\n&lt;object name=\"example_2_object\"&gt;\n  &lt;attr name=\"Command_01\" type=\"command\"&gt;\n    &lt;pattern&gt;XXX&lt;/pattern&gt;\n    &lt;script&gt;\n      // XXX\n    &lt;/script&gt;\n  &lt;/attr&gt;\n  &lt;attr name=\"Command_02\" type=\"command\"&gt;\n    &lt;pattern&gt;XXX&lt;/pattern&gt;\n    &lt;script&gt;\n      // XXX\n    &lt;/script&gt;\n  &lt;/attr&gt;\n  &lt;attr name=\"example_script\" type=\"script\"&gt;\n    this.commands = NewStringList()\n    list add (this.commands, \"Command_01\")\n    list add (this.commands, \"Command_02\")\n    ShowMenu (\"Commands:\", this.commands, true) {\n      if (result = \"Command_01\") {\n        do (this, \"Commands_01\", \"script\")\n      }\n      if (result = \"Command_02\") {\n        do (this, \"Commands_02\", \"script\")\n      }\n    }\n  &lt;/attr&gt;\n&lt;/object&gt;\n</code></pre>\n<hr>\n<p>this is way beyond my knowledge... unless you need to use Commands... you should just use a Function or Script Attributes (+ Delegates if need Parameters and/or return type)...</p>\n<p>just found this too:</p>\n<p>http://docs.textadventures.co.uk/quest/functions/allcommands.html</p>\n<p>looks like some of the 'object' Parameters might actually mean OBJECT (of quest's engine's/itself's programming, its OOP/OOD structure --- which in quest, is its 'Elements', such as 'Commands', 'Turnscripts', 'Verbs', 'Exits', 'Objects', 'Functions', 'Object Types / Types', etc etc etc), so maybe it might be better for the 'do' syntax to put your Commands into an Objectlist Attribute and use the 'ObjectListItem', which may make it more simple (for me hopefully lol) to get the syntax working with 'do'....</p>\n\n",
      "PostDate": "2017-01-14T16:52:41.1269413Z",
      "LastEditDate": "2017-01-14T17:02:16.6625427Z"
    },
    {
      "PostId": "3024bc64-11ee-4920-810f-96610fe82919",
      "UserId": 283832,
      "Username": "scrimshaw04",
      "AvatarUrl": "https://secure.gravatar.com/avatar/8d126990ac9c6b79315d4db221bf6ef7?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thanks hegemon! I don't quite understand your explanation yet, but I'm trying to work through it. :)\r\n\r\n EDIT: I thought I'd found a way to circumvent using 'this' inside a menu, but it seems I haven't. New thread here: http://textadventures.co.uk/forum/quest/topic/ajju5ga33eojfmi0qk9xnw/looping-a-script-but-pausing-for-user-input",
      "EditableFormat": "markdown",
      "HTML": "<p>Thanks hegemon! I don't quite understand your explanation yet, but I'm trying to work through it. :)</p>\n<p>EDIT: I thought I'd found a way to circumvent using 'this' inside a menu, but it seems I haven't. New thread here: http://textadventures.co.uk/forum/quest/topic/ajju5ga33eojfmi0qk9xnw/looping-a-script-but-pausing-for-user-input</p>\n\n",
      "PostDate": "2017-01-15T12:57:39.8347934Z",
      "LastEditDate": "2017-01-15T13:36:52.5056362Z"
    },
    {
      "PostId": "efde04e8-b75b-4293-895a-29c8b152eabc",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "As you say, `this` has no meaning inside `ShowMenu`. The solution is to assign the thing to an attribute of `game` before calling `ShowMenu`, and use that inside the script.",
      "EditableFormat": "markdown",
      "HTML": "<p>As you say, <code>this</code> has no meaning inside <code>ShowMenu</code>. The solution is to assign the thing to an attribute of <code>game</code> before calling <code>ShowMenu</code>, and use that inside the script.</p>\n\n",
      "PostDate": "2017-01-15T16:13:09.1716269Z",
      "LastEditDate": null
    },
    {
      "PostId": "adcdfabc-3dc7-4243-80c9-16037fb3d033",
      "UserId": 283832,
      "Username": "scrimshaw04",
      "AvatarUrl": "https://secure.gravatar.com/avatar/8d126990ac9c6b79315d4db221bf6ef7?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I... Don't quite understand how to do that yet. But I'll keep working on it.\r\n\r\nEDIT: OH! That was simpler that I thought it would be. Thanks!\r\n\r\nHere's an example of how my menu works, in case needs it for future reference\r\n\r\n```\r\ngame.menuitem = this\r\nthis.commands = NewStringList()\r\nlist add (this.commands, \"Attack\")\r\nlist add (this.commands, \"Defend\")\r\nlist add (this.commands, \"Do Nothing\")\r\nShowMenu (\"Commands:\", this.commands, true) {\r\n  if (result = \"Attack\") {\r\n    do (game.menuitem, \"attack_script\")\r\n  }\r\n  if (result = \"Defend\") {\r\n    do (game.menuitem, \"defend_script\")\r\n  }\r\n  if (result = \"Do Nothing\") {\r\n    do (game.menuitem, \"nothing_script\")\r\n  }\r\n  on ready {\r\n    do (game.menuitem, \"combat_script\")\r\n  }\r\n}\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p>I... Don't quite understand how to do that yet. But I'll keep working on it.</p>\n<p>EDIT: OH! That was simpler that I thought it would be. Thanks!</p>\n<p>Here's an example of how my menu works, in case needs it for future reference</p>\n<pre><code>game.menuitem = this\nthis.commands = NewStringList()\nlist add (this.commands, \"Attack\")\nlist add (this.commands, \"Defend\")\nlist add (this.commands, \"Do Nothing\")\nShowMenu (\"Commands:\", this.commands, true) {\n  if (result = \"Attack\") {\n    do (game.menuitem, \"attack_script\")\n  }\n  if (result = \"Defend\") {\n    do (game.menuitem, \"defend_script\")\n  }\n  if (result = \"Do Nothing\") {\n    do (game.menuitem, \"nothing_script\")\n  }\n  on ready {\n    do (game.menuitem, \"combat_script\")\n  }\n}\n</code></pre>\n\n",
      "PostDate": "2017-01-18T12:59:29.9774302Z",
      "LastEditDate": "2017-01-18T13:09:05.6302068Z"
    }
  ]
}

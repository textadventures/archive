{
  "Topic": {
    "TopicId": "7bg5lh_qzekskitklzftbg",
    "ForumId": "10",
    "Title": "Put ALL/MULTIPLE - How can we set this up?",
    "LastUpdated": "2021-05-03T18:07:17.7964371Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "844b49b0-afe1-4dad-92f4-ac95b24d6037",
      "UserId": 518866,
      "Username": "K.V.",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a97688aadc8152436180b511021e94a7?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Hello.\r\n\r\nIt seems like we covered this a couple of years ago...\r\n\r\nI came up with code, but it was no good. I remember that, and I can *find* that forum thread.\r\n\r\nIt seems like mrangel or Pixie posted some good code, though, but I can't find it.\r\n\r\nHere's how I'd like it to work:\r\n\r\n**>PUT BLUE EGG AND RED EGG IN BASKET**\r\nBlue egg: Done.\r\nRed egg: Done.\r\n\r\n---\r\n**>INVENTORY**\r\nYou are carrying a blue egg, a red egg and a green egg.\r\n\r\n**>PUT ALL BUT GREEN EGG IN BASKET**\r\nBlue egg: Done.\r\nRed egg: Done.\r\n\r\n---\r\n**>INVENTORY**\r\nYou are carrying a blue egg, a red egg and a green egg.\r\n\r\n**>PUT EVERYTHING EXCEPT GREEN EGG IN BASKET**\r\nBlue egg: Done.\r\nRed egg: Done.\r\n\r\n---\r\n**>INVENTORY**\r\nYou are carrying a blue egg, a red egg and a green egg.\r\n\r\n**>PUT ALL IN BASKET**\r\nBlue egg: Done.\r\nRed egg: Done.\r\nGreen egg: Done.\r\n\r\n---\r\n**>PUT BLUE EGG IN BASKET**\r\nDone.\r\n\r\n---\r\n\r\n---\r\nI've tried a few things, but I'm obviously not tuned into the correct frequency to code such things today.\r\n\r\nCurrently working on this game in Quest 5.8.0, by the way.",
      "EditableFormat": "markdown",
      "HTML": "<p>Hello.</p>\n<p>It seems like we covered this a couple of years ago...</p>\n<p>I came up with code, but it was no good. I remember that, and I can <em>find</em> that forum thread.</p>\n<p>It seems like mrangel or Pixie posted some good code, though, but I can't find it.</p>\n<p>Here's how I'd like it to work:</p>\n<p><strong>&gt;PUT BLUE EGG AND RED EGG IN BASKET</strong><br>\nBlue egg: Done.<br>\nRed egg: Done.</p>\n<hr>\n<p><strong>&gt;INVENTORY</strong><br>\nYou are carrying a blue egg, a red egg and a green egg.</p>\n<p><strong>&gt;PUT ALL BUT GREEN EGG IN BASKET</strong><br>\nBlue egg: Done.<br>\nRed egg: Done.</p>\n<hr>\n<p><strong>&gt;INVENTORY</strong><br>\nYou are carrying a blue egg, a red egg and a green egg.</p>\n<p><strong>&gt;PUT EVERYTHING EXCEPT GREEN EGG IN BASKET</strong><br>\nBlue egg: Done.<br>\nRed egg: Done.</p>\n<hr>\n<p><strong>&gt;INVENTORY</strong><br>\nYou are carrying a blue egg, a red egg and a green egg.</p>\n<p><strong>&gt;PUT ALL IN BASKET</strong><br>\nBlue egg: Done.<br>\nRed egg: Done.<br>\nGreen egg: Done.</p>\n<hr>\n<p><strong>&gt;PUT BLUE EGG IN BASKET</strong><br>\nDone.</p>\n<hr>\n<hr>\n<p>I've tried a few things, but I'm obviously not tuned into the correct frequency to code such things today.</p>\n<p>Currently working on this game in Quest 5.8.0, by the way.</p>\n\n",
      "PostDate": "2021-05-03T18:07:17.7964371Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "efdff769-970c-4f80-a3f9-e8c8d01f8181",
      "UserId": 518866,
      "Username": "K.V.",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a97688aadc8152436180b511021e94a7?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "What I've got going on right now:\r\n\r\n```xml\r\n  <command name=\"put\">\r\n    <pattern type=\"string\"><![CDATA[^(put|insert|place|drop) (?<object1>.*) (on to|onto|in to|into|on|in) (?<object2>.*)$]]></pattern>\r\n    <scope>object1=inventory|object2=container</scope>\r\n    <synonyms type=\"stringlist\">\r\n      <value>put</value>\r\n      <value>insert</value>\r\n      <value>place</value>\r\n      <value>drop</value>\r\n    </synonyms>\r\n    <allow_all />\r\n    <script><![CDATA[\r\n      put_something = false\r\n      // msg (multiple)\r\n      // msg (object1)\r\n      // msg (object2)\r\n      // msg (\"<hr/>\")\r\n      if (multiple) {\r\n        if (ListCount(object2) > 1) {\r\n          msg (\"object2 can't be multiple!\")\r\n        }\r\n        else {\r\n          object2 = ListItem(object2,0)\r\n          object1 = ListExclude(object1, object2)\r\n          foreach (obj, object1) {\r\n            if (not GetBoolean(obj, \"worn\")) {\r\n              Tell (CapFirst(GetDisplayAlias(obj))+\": \")\r\n              if (obj = object2) {\r\n                msg (\"You can't put something into itself.\")\r\n              }\r\n              else {\r\n                HandlePut (obj, object2)\r\n                put_something = true\r\n              }\r\n            }\r\n          }\r\n        }\r\n        if (not put_something) {\r\n          msg (\"You didn't put anything anywhere!\")\r\n        }\r\n      }\r\n      else {\r\n        object1 = ListItem(object1,0)\r\n        object2 = ListItem(object2,0)\r\n        if (object1 = object2) {\r\n          msg (\"You can't put something into itself.\")\r\n        }\r\n        else {\r\n          HandlePut (object1, object2)\r\n        }\r\n      }\r\n    ]]></script>\r\n  </command>\r\n\r\n  <function name=\"HandlePut\" parameters=\"object1, object2\">\r\n    // put object1 in/on object 2\r\n    canbedropped = true\r\n    if (HasBoolean(object1, \"drop\")) {\r\n      if (not object1.drop) {\r\n        canbedropped = false\r\n      }\r\n    }\r\n    if (object1.parent = object2) {\r\n      msg (DynamicTemplate(\"AlreadyThere\", object1))\r\n    }\r\n    else if (not ListContains(ScopeInventory(), object1)) {\r\n      msg (DynamicTemplate(\"NotCarrying\", object1))\r\n    }\r\n    else if (not canbedropped) {\r\n      if (HasString(object1,\"dropmsg\")) {\r\n        msg (object1.dropmsg)\r\n      }\r\n      else {\r\n        msg (DynamicTemplate(\"ObjectCannotBeStored\", object1))\r\n      }\r\n    }\r\n    else if (not ListContains(ScopeReachable(), object1)) {\r\n      msg (BlockingMessage(object1, \"\"))\r\n    }\r\n    else if (not ListContains(ScopeReachable(), object2)) {\r\n      msg (BlockingMessage(object2, \"\"))\r\n    }\r\n    else if (not object2.container) {\r\n      msg (Template(\"CannotDoThat\"))\r\n    }\r\n    else if (not object2.isopen) {\r\n      msg (DynamicTemplate(\"ObjectNotOpen\", object2))\r\n    }\r\n    else if (ListContains(ListParents(object2), object1)) {\r\n      msg (Template(\"CannotDoThat\"))\r\n    }\r\n    else if (not TestDropGlobal(object1, \"\")) {\r\n      // Do nothing, already handled\r\n    }\r\n    else {\r\n      if (GetBoolean(object2, \"hidechildren\")) {\r\n        object2.hidechildren = false\r\n      }\r\n      params = NewDictionary()\r\n      dictionary add (params, \"object\", object1)\r\n      dictionary add (params, \"destination\", object2)\r\n      if (HasScript(object2, \"addscript\")) {\r\n        do (object2, \"addscript\", params)\r\n      }\r\n      else if (HasScript(object1, \"drop\")) {\r\n        do (object1, \"drop\", params)\r\n      }\r\n      else {\r\n        object1.parent = object2\r\n        msg (Template(\"Done\"))\r\n      }\r\n    }\r\n    // must be carrying object1\r\n    // item cannot be dropped\r\n    // object1 must not be inside a closed container\r\n    // object2 must not be inside a closed container\r\n    // object2 must be an open container or surface\r\n    // object1 is inside object 2\r\n  </function>\r\n```\r\n\r\n---\r\nIt seems to work, but I normally overlook at least one thing.",
      "EditableFormat": "markdown",
      "HTML": "<p>What I've got going on right now:</p>\n<pre><code>  &lt;command name=\"put\"&gt;\n    &lt;pattern type=\"string\"&gt;&lt;![CDATA[^(put|insert|place|drop) (?&lt;object1&gt;.*) (on to|onto|in to|into|on|in) (?&lt;object2&gt;.*)$]]&gt;&lt;/pattern&gt;\n    &lt;scope&gt;object1=inventory|object2=container&lt;/scope&gt;\n    &lt;synonyms type=\"stringlist\"&gt;\n      &lt;value&gt;put&lt;/value&gt;\n      &lt;value&gt;insert&lt;/value&gt;\n      &lt;value&gt;place&lt;/value&gt;\n      &lt;value&gt;drop&lt;/value&gt;\n    &lt;/synonyms&gt;\n    &lt;allow_all /&gt;\n    &lt;script&gt;&lt;![CDATA[\n      put_something = false\n      // msg (multiple)\n      // msg (object1)\n      // msg (object2)\n      // msg (\"&lt;hr/&gt;\")\n      if (multiple) {\n        if (ListCount(object2) &gt; 1) {\n          msg (\"object2 can't be multiple!\")\n        }\n        else {\n          object2 = ListItem(object2,0)\n          object1 = ListExclude(object1, object2)\n          foreach (obj, object1) {\n            if (not GetBoolean(obj, \"worn\")) {\n              Tell (CapFirst(GetDisplayAlias(obj))+\": \")\n              if (obj = object2) {\n                msg (\"You can't put something into itself.\")\n              }\n              else {\n                HandlePut (obj, object2)\n                put_something = true\n              }\n            }\n          }\n        }\n        if (not put_something) {\n          msg (\"You didn't put anything anywhere!\")\n        }\n      }\n      else {\n        object1 = ListItem(object1,0)\n        object2 = ListItem(object2,0)\n        if (object1 = object2) {\n          msg (\"You can't put something into itself.\")\n        }\n        else {\n          HandlePut (object1, object2)\n        }\n      }\n    ]]&gt;&lt;/script&gt;\n  &lt;/command&gt;\n\n  &lt;function name=\"HandlePut\" parameters=\"object1, object2\"&gt;\n    // put object1 in/on object 2\n    canbedropped = true\n    if (HasBoolean(object1, \"drop\")) {\n      if (not object1.drop) {\n        canbedropped = false\n      }\n    }\n    if (object1.parent = object2) {\n      msg (DynamicTemplate(\"AlreadyThere\", object1))\n    }\n    else if (not ListContains(ScopeInventory(), object1)) {\n      msg (DynamicTemplate(\"NotCarrying\", object1))\n    }\n    else if (not canbedropped) {\n      if (HasString(object1,\"dropmsg\")) {\n        msg (object1.dropmsg)\n      }\n      else {\n        msg (DynamicTemplate(\"ObjectCannotBeStored\", object1))\n      }\n    }\n    else if (not ListContains(ScopeReachable(), object1)) {\n      msg (BlockingMessage(object1, \"\"))\n    }\n    else if (not ListContains(ScopeReachable(), object2)) {\n      msg (BlockingMessage(object2, \"\"))\n    }\n    else if (not object2.container) {\n      msg (Template(\"CannotDoThat\"))\n    }\n    else if (not object2.isopen) {\n      msg (DynamicTemplate(\"ObjectNotOpen\", object2))\n    }\n    else if (ListContains(ListParents(object2), object1)) {\n      msg (Template(\"CannotDoThat\"))\n    }\n    else if (not TestDropGlobal(object1, \"\")) {\n      // Do nothing, already handled\n    }\n    else {\n      if (GetBoolean(object2, \"hidechildren\")) {\n        object2.hidechildren = false\n      }\n      params = NewDictionary()\n      dictionary add (params, \"object\", object1)\n      dictionary add (params, \"destination\", object2)\n      if (HasScript(object2, \"addscript\")) {\n        do (object2, \"addscript\", params)\n      }\n      else if (HasScript(object1, \"drop\")) {\n        do (object1, \"drop\", params)\n      }\n      else {\n        object1.parent = object2\n        msg (Template(\"Done\"))\n      }\n    }\n    // must be carrying object1\n    // item cannot be dropped\n    // object1 must not be inside a closed container\n    // object2 must not be inside a closed container\n    // object2 must be an open container or surface\n    // object1 is inside object 2\n  &lt;/function&gt;\n</code></pre>\n<hr>\n<p>It seems to work, but I normally overlook at least one thing.</p>\n\n",
      "PostDate": "2021-05-04T01:44:48.070491Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "97659ec2-b3cb-44cf-a51e-5f89ef51f750",
      "UserId": 518866,
      "Username": "K.V.",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a97688aadc8152436180b511021e94a7?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "PS\r\n\r\nThe responses in the command's script are mostly just placeholders, until I make sure it's all working correctly.",
      "EditableFormat": "markdown",
      "HTML": "<p>PS</p>\n<p>The responses in the command's script are mostly just placeholders, until I make sure it's all working correctly.</p>\n\n",
      "PostDate": "2021-05-04T01:46:59.9338186Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

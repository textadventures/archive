{
  "Topic": {
    "TopicId": "e79sefonsuytiokrgdqjbw",
    "ForumId": "10",
    "Title": "Fun with iframes, JS, and ASLEvents",
    "LastUpdated": "2017-11-17T10:54:40.730798Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "d8415481-c709-4a42-9953-f3624b8c4c3a",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "http://i.imgur.com/FOIjtApb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "http://textadventures.co.uk/games/view/eizxbbbxc0s-xm1pwjbnhq/game-loader\r\n\r\n---\r\n<details><summary><b>CLICK HERE TO VIEW THE CODE</b></summary>\r\n\r\n---\r\n```\r\n<!--Saved by Quest 5.7.6404.15496-->\r\n<asl version=\"550\">\r\n  <include ref=\"English.aslx\" />\r\n  <include ref=\"Core.aslx\" />\r\n  <game name=\"Game Loader\">\r\n    <gameid>4b62879a-2b20-4397-b606-1451600777b8</gameid>\r\n    <version>0.0.17</version>\r\n    <firstpublished>2017</firstpublished>\r\n    <showpanes type=\"boolean\">false</showpanes>\r\n    <showlocation type=\"boolean\">false</showlocation>\r\n    <setcustomwidth />\r\n    <customwidth>auto</customwidth>\r\n    <start type=\"script\"><![CDATA[\r\n      msg (\"<center><b>Enter {command:HELP} for a few tips.</b></center>\")\r\n    ]]></start>\r\n    <subtitle>v{game.version}</subtitle>\r\n  </game>\r\n  <object name=\"room\">\r\n    <inherit name=\"editor_room\" />\r\n    <description type=\"string\"></description>\r\n    <message>{command:load:Load an online Quest game}.  {command:Insert text}.  {command:cmd:Send command to loaded game}. {command:ASLEvent:Run ASLEvent in loaded game}. {command:continue:Emulate 'CONTINUE' in loaded game}. {command:Save loaded game}.</message>\r\n    <enter type=\"script\">\r\n    </enter>\r\n    <beforeenter type=\"script\">\r\n    </beforeenter>\r\n    <beforefirstenter type=\"script\">\r\n    </beforefirstenter>\r\n    <firstenter type=\"script\">\r\n      msg (room.message)\r\n    </firstenter>\r\n    <object name=\"player\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"editor_player\" />\r\n    </object>\r\n    <turnscript name=\"commands\">\r\n      <enabled />\r\n      <script>\r\n        msg (room.message)\r\n      </script>\r\n    </turnscript>\r\n  </object>\r\n  <command name=\"load_game\">\r\n    <pattern>load;load game</pattern>\r\n    <script><![CDATA[\r\n      firsttime {\r\n        msg (\"<h3><center><b>This will not work in the desktop version of Quest.  It only works in the web player.</b></center></h3>\")\r\n      }\r\n      msg (\"Please paste the url of the game into the text input field and press ENTER.<br/><br/>Example of a good url: <br/><code>http://play2.textadventures.co.uk/Play.aspx?id=y_nxkvwae0oior_yrejn7g</code>\")\r\n      get input {\r\n        if (not StartsWith(result, \"http://play2.textadventures.co.uk/Play.aspx\")) {\r\n          msg (\"That's not a good url for an online Quest game.\")\r\n        }\r\n        else {\r\n          JS.eval (\"$('#myFrame').css('display', 'none');\")\r\n          msg (\"<iframe  style=\\\"display:none;\\\" id=\\\"myFrame\\\" src=\\\"\"+result+\"\\\"height=\\\"400px\\\" width=\\\"100%\\\" />\")\r\n          JS.eval (\"$('#myFrame').insertAfter('#txtCommand');$('#myFrame').css('display', 'block');\")\r\n          JS.eval (\"var loaded = document.getElementById('myFrame').contentWindow;\")\r\n        }\r\n      }\r\n    ]]></script>\r\n  </command>\r\n  <command name=\"jsEvalCmd\">\r\n    <pattern>JS.#text#</pattern>\r\n    <script>\r\n      JS.eval (text)\r\n    </script>\r\n  </command>\r\n  <command name=\"inserttext\">\r\n    <pattern>insert text</pattern>\r\n    <script>\r\n      msg (\"Please enter the text you'd like to print and press ENTER.\")\r\n      get input {\r\n        JS.loaded.addTextAndScroll (result)\r\n      }\r\n    </script>\r\n  </command>\r\n  <command name=\"help_kv\">\r\n    <pattern>help</pattern>\r\n    <script><![CDATA[\r\n      msg (\"{b:Quick help:}<br/>You can use JS.eval or just JS.*<br/><br/>You can enter LOAD GAME then paste in the url of an online Quest game.  <br/><br/>Example of a good url: <br/><code>http://play2.textadventures.co.uk/Play.aspx?id=y_nxkvwae0oior_yrejn7g</code><br/><br/>You can enter INSERT TEXT then enter whatever text you'd like the loaded game to print.<br/><br/>To send a command, enter CMD then enter your command.<hr/>NOTE:  You can use JS.loaded.* to do nearly anything in the loaded game.<hr/>\")\r\n    ]]></script>\r\n  </command>\r\n  <command name=\"command_in_load_game\">\r\n    <pattern>command;cmd</pattern>\r\n    <script><![CDATA[\r\n      msg (\"Please enter the command to send into the loaded game:\")\r\n      get input {\r\n        JS.loaded.addTextAndScroll (\"<br/>>\"+result+\"<br/>\")\r\n        JS.loaded.ASLEvent (\"HandleSingleCommand\", result)\r\n      }\r\n    ]]></script>\r\n  </command>\r\n  <command name=\"send_aslevent\">\r\n    <pattern>ASLEvent</pattern>\r\n    <script><![CDATA[\r\n      msg (\"Please enter the ASLEvent function to run in the loaded game (Example: HandleSingleCommand):\")\r\n      get input {\r\n        a = result\r\n        msg (\"Please enter the parameter (enter NULL if no parameter):\")\r\n        get input {\r\n          b = result\r\n          if (not b = \"NULL\") {\r\n            JS.loaded.addTextAndScroll (\"<br/>>ASLEvent(\\\"\"+a+\"\\\", \\\"\"+b+\"\\\")<br/>\")\r\n            JS.loaded.ASLEvent (a, b)\r\n          }\r\n          else {\r\n            JS.loaded.addTextAndScroll (\"<br/>>ASLEvent(\\\"\"+a+\"\\\", \\\"\\\")<br/>\")\r\n            JS.loaded.ASLEvent (a, \"\")\r\n          }\r\n        }\r\n      }\r\n    ]]></script>\r\n  </command>\r\n  <command name=\"continue_in_game\">\r\n    <pattern>continue</pattern>\r\n    <script>\r\n      JS.loaded.endWait ()\r\n    </script>\r\n  </command>\r\n  <command name=\"save_loaded\">\r\n    <pattern>save loaded game</pattern>\r\n    <script>\r\n      JS.loaded.saveGame ()\r\n    </script>\r\n  </command>\r\n</asl>\r\n```\r\n\r\n---\r\n\r\n</details>\r\n\r\n---\r\nAnyone have a link to a list of the default ASLEvents?\r\n\r\n```HandleSingleCommand``` works...\r\n\r\n```IncreaseScore``` would work, if I could figure out how to pass that parameter as an integer.  Everything I tried passes a string, which breaks scoring in the loaded game.",
      "EditableFormat": "markdown",
      "HTML": "<p>http://textadventures.co.uk/games/view/eizxbbbxc0s-xm1pwjbnhq/game-loader</p>\n<hr>\n<details><summary><b>CLICK HERE TO VIEW THE CODE</b></summary>\n<hr>\n<pre><code>&lt;!--Saved by Quest 5.7.6404.15496--&gt;\n&lt;asl version=\"550\"&gt;\n  &lt;include ref=\"English.aslx\" /&gt;\n  &lt;include ref=\"Core.aslx\" /&gt;\n  &lt;game name=\"Game Loader\"&gt;\n    &lt;gameid&gt;4b62879a-2b20-4397-b606-1451600777b8&lt;/gameid&gt;\n    &lt;version&gt;0.0.17&lt;/version&gt;\n    &lt;firstpublished&gt;2017&lt;/firstpublished&gt;\n    &lt;showpanes type=\"boolean\"&gt;false&lt;/showpanes&gt;\n    &lt;showlocation type=\"boolean\"&gt;false&lt;/showlocation&gt;\n    &lt;setcustomwidth /&gt;\n    &lt;customwidth&gt;auto&lt;/customwidth&gt;\n    &lt;start type=\"script\"&gt;&lt;![CDATA[\n      msg (\"&lt;center&gt;&lt;b&gt;Enter {command:HELP} for a few tips.&lt;/b&gt;&lt;/center&gt;\")\n    ]]&gt;&lt;/start&gt;\n    &lt;subtitle&gt;v{game.version}&lt;/subtitle&gt;\n  &lt;/game&gt;\n  &lt;object name=\"room\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;description type=\"string\"&gt;&lt;/description&gt;\n    &lt;message&gt;{command:load:Load an online Quest game}.  {command:Insert text}.  {command:cmd:Send command to loaded game}. {command:ASLEvent:Run ASLEvent in loaded game}. {command:continue:Emulate 'CONTINUE' in loaded game}. {command:Save loaded game}.&lt;/message&gt;\n    &lt;enter type=\"script\"&gt;\n    &lt;/enter&gt;\n    &lt;beforeenter type=\"script\"&gt;\n    &lt;/beforeenter&gt;\n    &lt;beforefirstenter type=\"script\"&gt;\n    &lt;/beforefirstenter&gt;\n    &lt;firstenter type=\"script\"&gt;\n      msg (room.message)\n    &lt;/firstenter&gt;\n    &lt;object name=\"player\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"editor_player\" /&gt;\n    &lt;/object&gt;\n    &lt;turnscript name=\"commands\"&gt;\n      &lt;enabled /&gt;\n      &lt;script&gt;\n        msg (room.message)\n      &lt;/script&gt;\n    &lt;/turnscript&gt;\n  &lt;/object&gt;\n  &lt;command name=\"load_game\"&gt;\n    &lt;pattern&gt;load;load game&lt;/pattern&gt;\n    &lt;script&gt;&lt;![CDATA[\n      firsttime {\n        msg (\"&lt;h3&gt;&lt;center&gt;&lt;b&gt;This will not work in the desktop version of Quest.  It only works in the web player.&lt;/b&gt;&lt;/center&gt;&lt;/h3&gt;\")\n      }\n      msg (\"Please paste the url of the game into the text input field and press ENTER.&lt;br/&gt;&lt;br/&gt;Example of a good url: &lt;br/&gt;&lt;code&gt;http://play2.textadventures.co.uk/Play.aspx?id=y_nxkvwae0oior_yrejn7g&lt;/code&gt;\")\n      get input {\n        if (not StartsWith(result, \"http://play2.textadventures.co.uk/Play.aspx\")) {\n          msg (\"That's not a good url for an online Quest game.\")\n        }\n        else {\n          JS.eval (\"$('#myFrame').css('display', 'none');\")\n          msg (\"&lt;iframe  style=\\\"display:none;\\\" id=\\\"myFrame\\\" src=\\\"\"+result+\"\\\"height=\\\"400px\\\" width=\\\"100%\\\" /&gt;\")\n          JS.eval (\"$('#myFrame').insertAfter('#txtCommand');$('#myFrame').css('display', 'block');\")\n          JS.eval (\"var loaded = document.getElementById('myFrame').contentWindow;\")\n        }\n      }\n    ]]&gt;&lt;/script&gt;\n  &lt;/command&gt;\n  &lt;command name=\"jsEvalCmd\"&gt;\n    &lt;pattern&gt;JS.#text#&lt;/pattern&gt;\n    &lt;script&gt;\n      JS.eval (text)\n    &lt;/script&gt;\n  &lt;/command&gt;\n  &lt;command name=\"inserttext\"&gt;\n    &lt;pattern&gt;insert text&lt;/pattern&gt;\n    &lt;script&gt;\n      msg (\"Please enter the text you'd like to print and press ENTER.\")\n      get input {\n        JS.loaded.addTextAndScroll (result)\n      }\n    &lt;/script&gt;\n  &lt;/command&gt;\n  &lt;command name=\"help_kv\"&gt;\n    &lt;pattern&gt;help&lt;/pattern&gt;\n    &lt;script&gt;&lt;![CDATA[\n      msg (\"{b:Quick help:}&lt;br/&gt;You can use JS.eval or just JS.*&lt;br/&gt;&lt;br/&gt;You can enter LOAD GAME then paste in the url of an online Quest game.  &lt;br/&gt;&lt;br/&gt;Example of a good url: &lt;br/&gt;&lt;code&gt;http://play2.textadventures.co.uk/Play.aspx?id=y_nxkvwae0oior_yrejn7g&lt;/code&gt;&lt;br/&gt;&lt;br/&gt;You can enter INSERT TEXT then enter whatever text you'd like the loaded game to print.&lt;br/&gt;&lt;br/&gt;To send a command, enter CMD then enter your command.&lt;hr/&gt;NOTE:  You can use JS.loaded.* to do nearly anything in the loaded game.&lt;hr/&gt;\")\n    ]]&gt;&lt;/script&gt;\n  &lt;/command&gt;\n  &lt;command name=\"command_in_load_game\"&gt;\n    &lt;pattern&gt;command;cmd&lt;/pattern&gt;\n    &lt;script&gt;&lt;![CDATA[\n      msg (\"Please enter the command to send into the loaded game:\")\n      get input {\n        JS.loaded.addTextAndScroll (\"&lt;br/&gt;&gt;\"+result+\"&lt;br/&gt;\")\n        JS.loaded.ASLEvent (\"HandleSingleCommand\", result)\n      }\n    ]]&gt;&lt;/script&gt;\n  &lt;/command&gt;\n  &lt;command name=\"send_aslevent\"&gt;\n    &lt;pattern&gt;ASLEvent&lt;/pattern&gt;\n    &lt;script&gt;&lt;![CDATA[\n      msg (\"Please enter the ASLEvent function to run in the loaded game (Example: HandleSingleCommand):\")\n      get input {\n        a = result\n        msg (\"Please enter the parameter (enter NULL if no parameter):\")\n        get input {\n          b = result\n          if (not b = \"NULL\") {\n            JS.loaded.addTextAndScroll (\"&lt;br/&gt;&gt;ASLEvent(\\\"\"+a+\"\\\", \\\"\"+b+\"\\\")&lt;br/&gt;\")\n            JS.loaded.ASLEvent (a, b)\n          }\n          else {\n            JS.loaded.addTextAndScroll (\"&lt;br/&gt;&gt;ASLEvent(\\\"\"+a+\"\\\", \\\"\\\")&lt;br/&gt;\")\n            JS.loaded.ASLEvent (a, \"\")\n          }\n        }\n      }\n    ]]&gt;&lt;/script&gt;\n  &lt;/command&gt;\n  &lt;command name=\"continue_in_game\"&gt;\n    &lt;pattern&gt;continue&lt;/pattern&gt;\n    &lt;script&gt;\n      JS.loaded.endWait ()\n    &lt;/script&gt;\n  &lt;/command&gt;\n  &lt;command name=\"save_loaded\"&gt;\n    &lt;pattern&gt;save loaded game&lt;/pattern&gt;\n    &lt;script&gt;\n      JS.loaded.saveGame ()\n    &lt;/script&gt;\n  &lt;/command&gt;\n&lt;/asl&gt;\n</code></pre>\n<hr>\n</details>\n<hr>\n<p>Anyone have a link to a list of the default ASLEvents?</p>\n<p><code>HandleSingleCommand</code> works...</p>\n<p><code>IncreaseScore</code> would work, if I could figure out how to pass that parameter as an integer.  Everything I tried passes a string, which breaks scoring in the loaded game.</p>\n\n",
      "PostDate": "2017-11-17T10:54:40.730798Z",
      "LastEditDate": "2017-11-17T11:41:51.7835344Z",
      "link": null
    }
  ]
}

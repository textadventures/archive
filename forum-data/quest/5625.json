{
  "Topic": {
    "TopicId": "5625",
    "ForumId": "10",
    "Title": "get input inside a while loop",
    "LastUpdated": "2015-11-18T17:53:04+00:00",
    "ReplyCount": 4
  },
  "Posts": [
    {
      "PostId": "38714",
      "UserId": 0,
      "Username": "vegas",
      "UserAvatar": null,
      "UserGravatar": "8c9dd93c02074161ff4c897289f3f999",
      "EditableText": "I am trying to simulate my character typing commands into a computer terminal and have the following code:\n[code:29umznx9]\nwhile (true) {\n  msg (&quot;Type your command&#46;&quot;)\n  get input {\n    switch (result) {\n      case (&quot;open&quot;) {\n        msg (&quot;opening door&quot;)\n        UnlockExit (room00exit)\n      }\n    }\n  }\n}\n[/code:29umznx9]\nUnfortunately, when I run it I get the following error:\n[quote:29umznx9]Error running script&#058; Only one 'get input' can be in progress at a time[/quote:29umznx9]\n\nI kind of understand why the error is happening, but can't think of a way to structure my code to stop it. Does anyone know of a way around this?",
      "EditableFormat": "bbcode",
      "HTML": "I am trying to simulate my character typing commands into a computer terminal and have the following code:<br/><pre><code><br/>while (true) {<br/>  msg (&quot;Type your command&#46;&quot;)<br/>  get input {<br/>    switch (result) {<br/>      case (&quot;open&quot;) {<br/>        msg (&quot;opening door&quot;)<br/>        UnlockExit (room00exit)<br/>      }<br/>    }<br/>  }<br/>}<br/></code></pre><br/>Unfortunately, when I run it I get the following error:<br/><blockquote><p>Error running script&#058; Only one 'get input' can be in progress at a time</p></blockquote><br/><br/>I kind of understand why the error is happening, but can't think of a way to structure my code to stop it. Does anyone know of a way around this?",
      "PostDate": "2015-11-15T15:04:13+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "38716",
      "UserId": 0,
      "Username": "XanMag",
      "UserAvatar": "7161_1436827710.jpg",
      "UserGravatar": "4b45a3afd18077f76f6569225c422bdb",
      "EditableText": "Here is how I structured my computer program...\n\n[code:2d60fpfq]msg (&quot;&lt;br/&gt;The screen clears and a single prompt appears in green&#46;&lt;br/&gt;&lt;br/&gt;Please type the last name of the person you would like to search or type 'stop' to quit using the computer or type 'return' to return to the program selection screen&#58;&lt;br/&gt;&quot;)\nget input {\n  switch (result) {\n    case (&quot;Dingo&quot;, &quot;dingo&quot;) {\n      play sound (&quot;alarm&#46;mp3&quot;, false, false)\n      msg (&quot;CLASSIFIED&#46;&#46;&#46;&lt;br/&gt;&lt;br/&gt;CLASSIFIED&#46;&#46;&#46;&lt;br/&gt;&lt;br/&gt;ACCESS DENIED&#46;&lt;br/&gt;&lt;br/&gt;CLASSIFIED&#46;&#46;&#46;&lt;br/&gt;&lt;br/&gt;CLASSIFIED&#46;&#46;&#46;&lt;br/&gt;&lt;br/&gt;ACCESS DENIED&#46;&quot;)\n      wait {\n        computer loop\n      }\n    }\n    case (&quot;Magoo&quot;,&quot;magoo&quot;) {\n      msg (&quot;&lt;b&gt;&lt;u&gt;Name&#58;&lt;/b&gt;&lt;/u&gt;  Xanadu Magoo&lt;br/&gt;&lt;br/&gt;&lt;b&gt;&lt;u&gt;General Appearance&#58;&lt;/b&gt;&lt;/u&gt;  Serious dork&#46;  Early thirties&#46;  5'8\\&quot;&#46;  105 pounds&#46;  Light brown hair, hazel eyes, pasty white complexion&#46;&lt;br/&gt;&lt;br/&gt;&lt;b&gt;&lt;u&gt;Occupation&#58;&lt;/b&gt;&lt;/u&gt;  Science Teacher at the Holy Moly Incapables&lt;br/&gt;&lt;b&gt;&lt;u&gt;Ethnicity&#58;&lt;/b&gt;&lt;/u&gt;  Caucasian, American&lt;br/&gt;&lt;br/&gt;&lt;b&gt;&lt;u&gt;Specialties&#58;&lt;/b&gt;&lt;/u&gt;  Above average knowledge in science, especially physics and chemisty&lt;br/&gt;&lt;br/&gt;&lt;b&gt;&lt;u&gt;Notes&#58;&lt;/b&gt;&lt;/u&gt;  Escaped several assassination attempts in the desert&#46;  In doing so, killed two desert patrol guards, one via electrocution and one died of complication with an unknown biotic factor&#46;  Infiltrated our compound for unknown reasons&#46;  Was forced into unconsciousness by Dr&#46; Dingo himself upon arrival&#46;  Assassination was to immediately follow, but Dr&#46; Dingo would not allow it&#46;  Instead, Xanadu Magoo is currently being help captive in prison cell one by orders of Dr&#46; Dingo&#46;&quot;)\n      wait {\n        computer loop\n     case (&quot;stop&quot;) {\n              msg (&quot;You type quit and hit enter&#46;  You back away from the computer and look for better things to do&#46;&quot;)\n            }\n            default {\n              default to program\n            }\ncase (&quot;stop&quot;) {\n      msg (&quot;You stop using the computer and you look for better things to do&#46;&quot;)\n      wait {\n        MoveObject (Xanadu, sarlashkars office)\n      }\n    case (&quot;return&quot;) {\n    msg (&quot;&lt;br/&gt;You type in 'return' and you return to the program option screen&#46;&lt;br/&gt;&quot;)\n    wait {\n      msg (&quot;&lt;br/&gt;Which program would you like to run (type 'stop' to stop using the computer)?&lt;br/&gt;1 - Dingo Database&lt;br/&gt;2 - Compound Information&lt;br/&gt;Stop - quit using computer&lt;br/&gt;&quot;)\n      get input {\n        switch (result) {\n          case (&quot;1&quot;) {\n            computer loop\n          }\n          case (&quot;2&quot;) {\n            computer loop 2\n          }\n          case (&quot;stop&quot;) {\n            msg (&quot;You type quit and hit enter&#46;  You back away from the computer and look for better things to do&#46;&quot;)\n          }\n          default {\n            default to program\n          }\n}[/code:2d60fpfq]\n\nObviously, I have a LOT more than just that, but I didn't want to post spoilers to my soon to be released game! <!-- s:lol: --><img src=\"{SMILIES_PATH}/icon_lol.gif\" alt=\":lol:\" title=\"Laughing\" /><!-- s:lol: -->\n\nPardon if the brackets are messed up... I copy-pasted only relevant stuff.  As far as you getting the error message... I'm not sure.  It looks fine to me, but someone will probably come along and give you better info in that regard.\n\nGood luck.",
      "EditableFormat": "bbcode",
      "HTML": "Here is how I structured my computer program...<br/><br/><pre><code>msg (&quot;&lt;br/&gt;The screen clears and a single prompt appears in green&#46;&lt;br/&gt;&lt;br/&gt;Please type the last name of the person you would like to search or type 'stop' to quit using the computer or type 'return' to return to the program selection screen&#58;&lt;br/&gt;&quot;)<br/>get input {<br/>  switch (result) {<br/>    case (&quot;Dingo&quot;, &quot;dingo&quot;) {<br/>      play sound (&quot;alarm&#46;mp3&quot;, false, false)<br/>      msg (&quot;CLASSIFIED&#46;&#46;&#46;&lt;br/&gt;&lt;br/&gt;CLASSIFIED&#46;&#46;&#46;&lt;br/&gt;&lt;br/&gt;ACCESS DENIED&#46;&lt;br/&gt;&lt;br/&gt;CLASSIFIED&#46;&#46;&#46;&lt;br/&gt;&lt;br/&gt;CLASSIFIED&#46;&#46;&#46;&lt;br/&gt;&lt;br/&gt;ACCESS DENIED&#46;&quot;)<br/>      wait {<br/>        computer loop<br/>      }<br/>    }<br/>    case (&quot;Magoo&quot;,&quot;magoo&quot;) {<br/>      msg (&quot;&lt;b&gt;&lt;u&gt;Name&#58;&lt;/b&gt;&lt;/u&gt;  Xanadu Magoo&lt;br/&gt;&lt;br/&gt;&lt;b&gt;&lt;u&gt;General Appearance&#58;&lt;/b&gt;&lt;/u&gt;  Serious dork&#46;  Early thirties&#46;  5'8\\&quot;&#46;  105 pounds&#46;  Light brown hair, hazel eyes, pasty white complexion&#46;&lt;br/&gt;&lt;br/&gt;&lt;b&gt;&lt;u&gt;Occupation&#58;&lt;/b&gt;&lt;/u&gt;  Science Teacher at the Holy Moly Incapables&lt;br/&gt;&lt;b&gt;&lt;u&gt;Ethnicity&#58;&lt;/b&gt;&lt;/u&gt;  Caucasian, American&lt;br/&gt;&lt;br/&gt;&lt;b&gt;&lt;u&gt;Specialties&#58;&lt;/b&gt;&lt;/u&gt;  Above average knowledge in science, especially physics and chemisty&lt;br/&gt;&lt;br/&gt;&lt;b&gt;&lt;u&gt;Notes&#58;&lt;/b&gt;&lt;/u&gt;  Escaped several assassination attempts in the desert&#46;  In doing so, killed two desert patrol guards, one via electrocution and one died of complication with an unknown biotic factor&#46;  Infiltrated our compound for unknown reasons&#46;  Was forced into unconsciousness by Dr&#46; Dingo himself upon arrival&#46;  Assassination was to immediately follow, but Dr&#46; Dingo would not allow it&#46;  Instead, Xanadu Magoo is currently being help captive in prison cell one by orders of Dr&#46; Dingo&#46;&quot;)<br/>      wait {<br/>        computer loop<br/>     case (&quot;stop&quot;) {<br/>              msg (&quot;You type quit and hit enter&#46;  You back away from the computer and look for better things to do&#46;&quot;)<br/>            }<br/>            default {<br/>              default to program<br/>            }<br/>case (&quot;stop&quot;) {<br/>      msg (&quot;You stop using the computer and you look for better things to do&#46;&quot;)<br/>      wait {<br/>        MoveObject (Xanadu, sarlashkars office)<br/>      }<br/>    case (&quot;return&quot;) {<br/>    msg (&quot;&lt;br/&gt;You type in 'return' and you return to the program option screen&#46;&lt;br/&gt;&quot;)<br/>    wait {<br/>      msg (&quot;&lt;br/&gt;Which program would you like to run (type 'stop' to stop using the computer)?&lt;br/&gt;1 - Dingo Database&lt;br/&gt;2 - Compound Information&lt;br/&gt;Stop - quit using computer&lt;br/&gt;&quot;)<br/>      get input {<br/>        switch (result) {<br/>          case (&quot;1&quot;) {<br/>            computer loop<br/>          }<br/>          case (&quot;2&quot;) {<br/>            computer loop 2<br/>          }<br/>          case (&quot;stop&quot;) {<br/>            msg (&quot;You type quit and hit enter&#46;  You back away from the computer and look for better things to do&#46;&quot;)<br/>          }<br/>          default {<br/>            default to program<br/>          }<br/>}</code></pre><br/><br/>Obviously, I have a LOT more than just that, but I didn't want to post spoilers to my soon to be released game! <!-- s:lol: --><img src=\"{SMILIES_PATH}/icon_lol.gif\" alt=\":lol:\" title=\"Laughing\" /><!-- s:lol: --><br/><br/>Pardon if the brackets are messed up... I copy-pasted only relevant stuff.  As far as you getting the error message... I'm not sure.  It looks fine to me, but someone will probably come along and give you better info in that regard.<br/><br/>Good luck.",
      "PostDate": "2015-11-15T17:18:00+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "38717",
      "UserId": 0,
      "Username": "The Pixie",
      "UserAvatar": null,
      "UserGravatar": "cfa37e927f96177bcf6053ae8f108f77",
      "EditableText": "It is not trivial.\n[code:37p3tjep]while (true) {\n  msg (&quot;Type your command&#46;&quot;)\n  get input {\n    switch (result) {\n      case (&quot;open&quot;) {\n        msg (&quot;opening door&quot;)\n        UnlockExit (room00exit)\n      }\n    }\n  }\n}[/code:37p3tjep]\nThe problem, as you perhaps realised, is that the [i:37p3tjep]get input[/i:37p3tjep] is waiting for the player to type something, but the script continues, going to the next cycle, and then gets to a second [i:37p3tjep]get input[/i:37p3tjep], and hence the error. This will get the same error:\n[code:37p3tjep]  get input {\n    msg(&quot;You said&#58; &quot; + result)\n  }\n  get input {\n    msg(&quot;You said&#58; &quot; + result)\n  }[/code:37p3tjep]\nThe trick, in general, is to put the second [i:37p3tjep]get input[/i:37p3tjep] inside the block, like this:\n[code:37p3tjep]  get input {\n    msg(&quot;You said&#58; &quot; + result)\n    get input {\n      msg(&quot;You said&#58; &quot; + result)\n    }\n  }\n[/code:37p3tjep]\nDoing that in a loop is not possible, so you need to look at recursion, which I did here (and good luck working out how that works!):\n<!-- l --><a class=\"postlink-local\" href=\"http://forum.textadventures.co.uk/viewtopic.php?f=18&amp;t=5492\">viewtopic.php?f=18&amp;t=5492</a><!-- l -->\n\nDid I say it is not trivial?\n\nAn alternative is to subvert the Quest command system, so instead of using[i:37p3tjep] get input[/i:37p3tjep], you handle regular commands as though they were instructions to the computer. You can change the prompt to make this apparent to the player. Whether that is easier or better is debatable.",
      "EditableFormat": "bbcode",
      "HTML": "It is not trivial.<br/><pre><code>while (true) {<br/>  msg (&quot;Type your command&#46;&quot;)<br/>  get input {<br/>    switch (result) {<br/>      case (&quot;open&quot;) {<br/>        msg (&quot;opening door&quot;)<br/>        UnlockExit (room00exit)<br/>      }<br/>    }<br/>  }<br/>}</code></pre><br/>The problem, as you perhaps realised, is that the <span style=\"font-style:italic;\">get input</span> is waiting for the player to type something, but the script continues, going to the next cycle, and then gets to a second <span style=\"font-style:italic;\">get input</span>, and hence the error. This will get the same error:<br/><pre><code>  get input {<br/>    msg(&quot;You said&#58; &quot; + result)<br/>  }<br/>  get input {<br/>    msg(&quot;You said&#58; &quot; + result)<br/>  }</code></pre><br/>The trick, in general, is to put the second <span style=\"font-style:italic;\">get input</span> inside the block, like this:<br/><pre><code>  get input {<br/>    msg(&quot;You said&#58; &quot; + result)<br/>    get input {<br/>      msg(&quot;You said&#58; &quot; + result)<br/>    }<br/>  }<br/></code></pre><br/>Doing that in a loop is not possible, so you need to look at recursion, which I did here (and good luck working out how that works!):<br/><!-- l --><a class=\"postlink-local\" href=\"http://forum.textadventures.co.uk/viewtopic.php?f=18&amp;t=5492\">viewtopic.php?f=18&amp;t=5492</a><!-- l --><br/><br/>Did I say it is not trivial?<br/><br/>An alternative is to subvert the Quest command system, so instead of using<span style=\"font-style:italic;\"> get input</span>, you handle regular commands as though they were instructions to the computer. You can change the prompt to make this apparent to the player. Whether that is easier or better is debatable.",
      "PostDate": "2015-11-15T18:20:42+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "38722",
      "UserId": 0,
      "Username": "vegas",
      "UserAvatar": null,
      "UserGravatar": "8c9dd93c02074161ff4c897289f3f999",
      "EditableText": "Interesting. I'll try recursion first, seeing as that wouldn't require restructuring my game. But yeah, my other option was to have the computer terminal as another room and feed commands into it that way, while hiding as best I can the fact that it is a room. I'll post again if I find a good solution",
      "EditableFormat": "bbcode",
      "HTML": "Interesting. I'll try recursion first, seeing as that wouldn't require restructuring my game. But yeah, my other option was to have the computer terminal as another room and feed commands into it that way, while hiding as best I can the fact that it is a room. I'll post again if I find a good solution",
      "PostDate": "2015-11-16T00:31:53+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "38747",
      "UserId": 0,
      "Username": "TinFoilMkIV",
      "UserAvatar": null,
      "UserGravatar": "d70c7b1a4be0b3fe6f68912d606f4298",
      "EditableText": "As The Pixie said, not anywhere near as simple as it may sound. I ran into this problem myself a while back, and the issue is as he said above, the code still runs, so when you do a get input attempting a loop this is basically what happens\n[code:3jy6x0jz]get input {\n\t//do input stuff\n\t//this section only happens after the input is resolved\n\t}\n//this stuff is still happening while the game is waiting for your input \n\t\n//attempt to loop back to input\n\t\n//error because the game is still waiting for your input while trying to rerun the get input again[/code:3jy6x0jz]\n\nBasically you have to have the overall script end with the get input, you need everything that occurs after the input to be inside the get input results if it is still going to be part of the same script.\n\nOne of the tricks I personally use it to have the looping section of code stored outside of the main code block. This can be done by storing as a function, or as a script attribute of an object. I personally prefer script attributes since in most cases that I use this it's not something that will be called very often outside of one or two specific situations, and I don't want to clutter up my functions with things that aren't common use.\n\nThen you call the attribute script to run when you want the get input to happen, and as part of the results you can have it call itself again in the case that it loops, and in the case that it proceeds to something else you call a different script to achieve that. You don't actually have to break the results into a separate script but I tend to do that for organizational purposes as well as being able to pull different script results in different ways without re-writing code a bunch of times.\n\nSo it might look something like this\n[code:3jy6x0jz]//computer terminal activation and whatever text goes here before the input\nmsg (&quot;Type your command&#46;&quot;)\ndo (computer, &quot;command prompt&quot;)\n//this calls the &quot;command prompt&quot; script from the object 'computer'[/code:3jy6x0jz]\n[code:3jy6x0jz]//command prompt script\ngetinput {\n\tswitch (result) {\n\t\tcase (&quot;open&quot;) {\n\t\t\t//do open stuff  here\n\t\t}\n\t\tdefault { //this is the equivalent of an 'else' for a switch, no matching cases will execute this code\n\t\t\tdo (computer, &quot;command prompt&quot;)\n\t\t\t//this causes the command prompt to repeat on an invalid command\n\t\t}\n\t}\n}[/code:3jy6x0jz]",
      "EditableFormat": "bbcode",
      "HTML": "As The Pixie said, not anywhere near as simple as it may sound. I ran into this problem myself a while back, and the issue is as he said above, the code still runs, so when you do a get input attempting a loop this is basically what happens<br/><pre><code>get input {<br/>\t//do input stuff<br/>\t//this section only happens after the input is resolved<br/>\t}<br/>//this stuff is still happening while the game is waiting for your input <br/>\t<br/>//attempt to loop back to input<br/>\t<br/>//error because the game is still waiting for your input while trying to rerun the get input again</code></pre><br/><br/>Basically you have to have the overall script end with the get input, you need everything that occurs after the input to be inside the get input results if it is still going to be part of the same script.<br/><br/>One of the tricks I personally use it to have the looping section of code stored outside of the main code block. This can be done by storing as a function, or as a script attribute of an object. I personally prefer script attributes since in most cases that I use this it's not something that will be called very often outside of one or two specific situations, and I don't want to clutter up my functions with things that aren't common use.<br/><br/>Then you call the attribute script to run when you want the get input to happen, and as part of the results you can have it call itself again in the case that it loops, and in the case that it proceeds to something else you call a different script to achieve that. You don't actually have to break the results into a separate script but I tend to do that for organizational purposes as well as being able to pull different script results in different ways without re-writing code a bunch of times.<br/><br/>So it might look something like this<br/><pre><code>//computer terminal activation and whatever text goes here before the input<br/>msg (&quot;Type your command&#46;&quot;)<br/>do (computer, &quot;command prompt&quot;)<br/>//this calls the &quot;command prompt&quot; script from the object 'computer'</code></pre><br/><pre><code>//command prompt script<br/>getinput {<br/>\tswitch (result) {<br/>\t\tcase (&quot;open&quot;) {<br/>\t\t\t//do open stuff  here<br/>\t\t}<br/>\t\tdefault { //this is the equivalent of an 'else' for a switch, no matching cases will execute this code<br/>\t\t\tdo (computer, &quot;command prompt&quot;)<br/>\t\t\t//this causes the command prompt to repeat on an invalid command<br/>\t\t}<br/>\t}<br/>}</code></pre>",
      "PostDate": "2015-11-18T17:53:04+00:00",
      "LastEditDate": null
    }
  ]
}

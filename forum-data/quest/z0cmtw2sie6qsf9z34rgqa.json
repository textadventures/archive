{
  "Topic": {
    "TopicId": "z0cmtw2sie6qsf9z34rgqa",
    "ForumId": "10",
    "Title": "Preventing the player from changing rooms",
    "LastUpdated": "2019-05-05T20:35:37.1874355Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "ec247c47-dfd4-4c5a-8877-7f7980a5465a",
      "UserId": 417937,
      "Username": "hebrewhammertyme",
      "AvatarUrl": "https://secure.gravatar.com/avatar/d82f1193448dd7fd09f4d4085218b239?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Hi guys! In a text adventure game I'm practicing with, I'd like to have an NPC set a flag that puts them close to you and prevents you from changing rooms until you retreat. The flag setting is easy, but is there a simple way to temporarily immobilize the player until a specific command is given?",
      "EditableFormat": "markdown",
      "HTML": "<p>Hi guys! In a text adventure game I'm practicing with, I'd like to have an NPC set a flag that puts them close to you and prevents you from changing rooms until you retreat. The flag setting is easy, but is there a simple way to temporarily immobilize the player until a specific command is given?</p>\n\n",
      "PostDate": "2019-05-05T20:35:37.1874355Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "17b0369a-ecb1-47ba-b70f-503268e4c74e",
      "UserId": 267336,
      "Username": "jmnevil54",
      "AvatarUrl": "https://secure.gravatar.com/avatar/5d73d7ec1dbe20a5cb46f02a6d53f187?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "You need to lock that room. There should be an option in the exit's attributes or features.\r\n\r\nThis is how it looks on the web version.\r\n_\r\nhttps://i.imgur.com/DkZTDAk.png\r\nhttps://i.imgur.com/VsID1P6.png\r\n\r\nTo unlock it, you need to name the exit. Then you need to find where you want the code to go, and put the unlock exit function there.\r\n_\r\nhttps://i.imgur.com/CP0wCDt.png\r\nhttps://i.imgur.com/QinAaS6.png\r\n_\r\n\r\nYou can also make the exit invisible, not shown, if you prefer that.\r\n_\r\nHere it is on the web version.\r\n_\r\nYou need to have the option unchecked for the exit to be invisible.\r\n_\r\nhttps://i.imgur.com/wLt7ekX.png\r\nhttps://i.imgur.com/4AJcwj5.png\r\n_\r\nCode to make it visible or invisible. The exit also has to be named for this to work.\r\n_\r\nhttps://i.imgur.com/0kjA55K.png\r\n_\r\n(I forgot the code to do that big line thing.)",
      "EditableFormat": "markdown",
      "HTML": "<p>You need to lock that room. There should be an option in the exit's attributes or features.</p>\n<p>This is how it looks on the web version.<br>\n_<br>\nhttps://i.imgur.com/DkZTDAk.png<br>\nhttps://i.imgur.com/VsID1P6.png</p>\n<p>To unlock it, you need to name the exit. Then you need to find where you want the code to go, and put the unlock exit function there.<br>\n_<br>\nhttps://i.imgur.com/CP0wCDt.png<br>\nhttps://i.imgur.com/QinAaS6.png<br>\n_</p>\n<p>You can also make the exit invisible, not shown, if you prefer that.<br>\n_<br>\nHere it is on the web version.<br>\n_<br>\nYou need to have the option unchecked for the exit to be invisible.<br>\n_<br>\nhttps://i.imgur.com/wLt7ekX.png<br>\nhttps://i.imgur.com/4AJcwj5.png<br>\n_<br>\nCode to make it visible or invisible. The exit also has to be named for this to work.<br>\n_<br>\nhttps://i.imgur.com/0kjA55K.png<br>\n_<br>\n(I forgot the code to do that big line thing.)</p>\n\n",
      "PostDate": "2019-05-05T23:26:05.1363067Z",
      "LastEditDate": "2019-05-05T23:45:38.5805685Z",
      "link": null
    },
    {
      "PostId": "d09d85bb-a935-462a-b53b-764461ac31bc",
      "UserId": 417937,
      "Username": "hebrewhammertyme",
      "AvatarUrl": "https://i.imgur.com/ATL42aAb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Appreciate it, jmnevil! But what about universally? I could do this, but I would have to code every single exit throughout the game. Doable, but seems inefficient. I've basically coded all of my enemy NPC's to advance to striking range on my character once I enter. I would also have to include the \"You can't escape at this range\" message in the \"Print message when locked\" section, which means it would display it whenever a door is actually locked.\r\n\r\nSeriously though, thank you for the help! This is certainly an option I can make work with some modifications.",
      "EditableFormat": "markdown",
      "HTML": "<p>Appreciate it, jmnevil! But what about universally? I could do this, but I would have to code every single exit throughout the game. Doable, but seems inefficient. I've basically coded all of my enemy NPC's to advance to striking range on my character once I enter. I would also have to include the \"You can't escape at this range\" message in the \"Print message when locked\" section, which means it would display it whenever a door is actually locked.</p>\n<p>Seriously though, thank you for the help! This is certainly an option I can make work with some modifications.</p>\n\n",
      "PostDate": "2019-05-06T00:28:36.8649044Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "941374cc-8863-434e-bc47-a0f635113bbd",
      "UserId": 247325,
      "Username": "hegemonkhan",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a96cf34d8d97c57de38f54ee22b1759b?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "might not be what you want, but maybe this can be of help for you:\r\n\r\nhttps://docs.textadventures.co.uk/quest/guides/immobilise_the_player.html",
      "EditableFormat": "markdown",
      "HTML": "<p>might not be what you want, but maybe this can be of help for you:</p>\n<p>https://docs.textadventures.co.uk/quest/guides/immobilise_the_player.html</p>\n\n",
      "PostDate": "2019-05-06T02:17:39.105503Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "17c8266d-bdaf-423c-a589-4c94053606b4",
      "UserId": 260569,
      "Username": "DarkLizerd",
      "AvatarUrl": "https://i.imgur.com/vjdH3t6b.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Have you tried moving the player and NPC to a \"combat room\" with no exits, then move the player back to the old room when he wins?\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Have you tried moving the player and NPC to a \"combat room\" with no exits, then move the player back to the old room when he wins?</p>\n\n",
      "PostDate": "2019-05-06T15:33:15.8917897Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "0011feba-f10e-438b-9198-8c099af8f267",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "One alternative would be modifying the \"go\" command so that it checks if you're able to move.\r\n\r\nIt could just be a matter of adding an extra check to the existing command:\r\n\r\n```\r\n    if (exit.visible) {\r\n      if (HasObject (game.pov, \"immobilised\")) {\r\n        msg (CapFirst (GetDisplayAlias (game.pov.immobilised)) + \" won't let you move!\")\r\n      }\r\n      else if (exit.locked) {\r\n        msg (exit.lockmessage)\r\n      }\r\n      else if (exit.runscript) {\r\n        if (HasScript(exit, \"script\")) {\r\n          do (exit, \"script\")\r\n        }\r\n      }\r\n      else if (exit.lookonly) {\r\n         msg (\"[UnresolvedLocation]\")\r\n      }\r\n      else {\r\n        if (HasString(exit, \"message\")) {\r\n          if (not exit.message = \"\") {\r\n            if (game.clearscreenonroomenter) {\r\n              game.currentexitmessage = exit.message\r\n            }\r\n            else {\r\n              msg(exit.message)\r\n            }\r\n          }\r\n        }\r\n        game.pov.parent = exit.to\r\n      }\r\n    }\r\n    else {\r\n      msg (\"[UnresolvedLocation]\")\r\n    }\r\n```\r\n\r\nThen when an NPC stops you moving, you just do `player.immobilised = some_npc` to immobilise them, and set that attribute to null when the player is free to move again.",
      "EditableFormat": "markdown",
      "HTML": "<p>One alternative would be modifying the \"go\" command so that it checks if you're able to move.</p>\n<p>It could just be a matter of adding an extra check to the existing command:</p>\n<pre><code>    if (exit.visible) {\n      if (HasObject (game.pov, \"immobilised\")) {\n        msg (CapFirst (GetDisplayAlias (game.pov.immobilised)) + \" won't let you move!\")\n      }\n      else if (exit.locked) {\n        msg (exit.lockmessage)\n      }\n      else if (exit.runscript) {\n        if (HasScript(exit, \"script\")) {\n          do (exit, \"script\")\n        }\n      }\n      else if (exit.lookonly) {\n         msg (\"[UnresolvedLocation]\")\n      }\n      else {\n        if (HasString(exit, \"message\")) {\n          if (not exit.message = \"\") {\n            if (game.clearscreenonroomenter) {\n              game.currentexitmessage = exit.message\n            }\n            else {\n              msg(exit.message)\n            }\n          }\n        }\n        game.pov.parent = exit.to\n      }\n    }\n    else {\n      msg (\"[UnresolvedLocation]\")\n    }\n</code></pre>\n<p>Then when an NPC stops you moving, you just do <code>player.immobilised = some_npc</code> to immobilise them, and set that attribute to null when the player is free to move again.</p>\n\n",
      "PostDate": "2019-05-06T17:08:31.3842878Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

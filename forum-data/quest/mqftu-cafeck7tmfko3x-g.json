{
  "Topic": {
    "TopicId": "mqftu-cafeck7tmfko3x-g",
    "ForumId": "10",
    "Title": "Leave my Map Alone! [SOLVED]",
    "LastUpdated": "2018-05-16T14:55:37.0531081Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "d57a6cd1-97eb-4160-9394-d79dce215d83",
      "UserId": 199273,
      "Username": "DavyB",
      "AvatarUrl": "http://i.imgur.com/8BcaZCyb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I have posted a few queries recently about features that I thought would be difficult to implement but proved 'easy enough'. Hopefully this one will be the same.\r\n\r\nHow can I restrict the map/grid area to 'display', stopping users from interacting with it? Currently they can move the map and resize it, which sometimes cause problems.",
      "EditableFormat": "markdown",
      "HTML": "<p>I have posted a few queries recently about features that I thought would be difficult to implement but proved 'easy enough'. Hopefully this one will be the same.</p>\n<p>How can I restrict the map/grid area to 'display', stopping users from interacting with it? Currently they can move the map and resize it, which sometimes cause problems.</p>\n\n",
      "PostDate": "2018-05-16T14:55:37.0531081Z",
      "LastEditDate": "2018-05-21T07:05:33.0641967Z",
      "link": null
    },
    {
      "PostId": "d4320218-ebdb-4728-a696-9dca709bc7c5",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Add this to game.inituserinterface to prevent resizing:\r\n\r\n```\r\nJS.eval(\"gridApi.zoomIn = function(){};\")\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p>Add this to game.inituserinterface to prevent resizing:</p>\n<pre><code>JS.eval(\"gridApi.zoomIn = function(){};\")\n</code></pre>\n\n",
      "PostDate": "2018-05-16T15:16:04.7847291Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "6d853668-bde5-414c-9b97-a9955bb7e848",
      "UserId": 199273,
      "Username": "DavyB",
      "AvatarUrl": "http://i.imgur.com/8BcaZCyb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Great, that was quick!  &#128077;\r\n\r\nThat's 50% of the problem. Now just need to stop someone clicking on the map, holding the mouse button down and moving it!",
      "EditableFormat": "markdown",
      "HTML": "<p>Great, that was quick!  üëç</p>\n<p>That's 50% of the problem. Now just need to stop someone clicking on the map, holding the mouse button down and moving it!</p>\n\n",
      "PostDate": "2018-05-16T15:30:27.6887606Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "d23f4e05-dae2-4a62-8c89-4c8e73f0f411",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I can't find the stuff that lets you move the map by clicking...\r\n\r\nI tried ```onclick``` and unbinding \"click\", but neither had any effect.\r\n\r\nIf I don't find the solution soon, someone else will most assuredly know how to do it.",
      "EditableFormat": "markdown",
      "HTML": "<p>I can't find the stuff that lets you move the map by clicking...</p>\n<p>I tried <code>onclick</code> and unbinding \"click\", but neither had any effect.</p>\n<p>If I don't find the solution soon, someone else will most assuredly know how to do it.</p>\n\n",
      "PostDate": "2018-05-16T15:38:20.2647679Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "bdacc3b9-ebca-4f8a-9567-45a4d95bdcc4",
      "UserId": 199273,
      "Username": "DavyB",
      "AvatarUrl": "http://i.imgur.com/8BcaZCyb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thanks KV, I've just uploaded a new version of Giantkiller Too than includes the fix to stop maps being resized. I'll leave this thread open in the hope that someone can help with blocking the movement of the map.",
      "EditableFormat": "markdown",
      "HTML": "<p>Thanks KV, I've just uploaded a new version of Giantkiller Too than includes the fix to stop maps being resized. I'll leave this thread open in the hope that someone can help with blocking the movement of the map.</p>\n\n",
      "PostDate": "2018-05-19T16:34:39.1651392Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "64653704-980e-45bb-947d-bf668b3c9be3",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "It may be possible to put an invisible DIV over the map, so when the player tries to click or drag, the map underneath is not affected.",
      "EditableFormat": "markdown",
      "HTML": "<p>It may be possible to put an invisible DIV over the map, so when the player tries to click or drag, the map underneath is not affected.</p>\n\n",
      "PostDate": "2018-05-19T19:42:03.7889086Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "24d48eb8-e5a2-485e-955f-b873e727d097",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "In grid.js:\r\n\r\n```\r\nfunction onMouseDrag(event) {\r\n    updateOffset(event.delta);\r\n}\r\n````\r\n\r\n---\r\nIf you modify that code in the grid.js file, it will keep you from dragging the map, but I can't figure out how to get that function from within a game.  (I tried adding the function every way I could think of.)\r\n\r\nThis does make it add console log entries, but it only adds this functionality rather than overriding the function:\r\n\r\n```\r\npaper.tool.onMouseDrag = function(e){console.log(e);}\r\n```\r\n\r\n---\r\nIf we can't modify this function from within the game, it's no good.  Our grid.js file is not published with the game, so any changes we make to it don't matter.",
      "EditableFormat": "markdown",
      "HTML": "<p>In grid.js:</p>\n<pre><code>function onMouseDrag(event) {\n    updateOffset(event.delta);\n}\n</code></pre>\n<hr>\n<p>If you modify that code in the grid.js file, it will keep you from dragging the map, but I can't figure out how to get that function from within a game.  (I tried adding the function every way I could think of.)</p>\n<p>This does make it add console log entries, but it only adds this functionality rather than overriding the function:</p>\n<pre><code>paper.tool.onMouseDrag = function(e){console.log(e);}\n</code></pre>\n<hr>\n<p>If we can't modify this function from within the game, it's no good.  Our grid.js file is not published with the game, so any changes we make to it don't matter.</p>\n\n",
      "PostDate": "2018-05-20T01:42:06.1180324Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "f729c2f1-be1d-409b-bdf4-ddc4208e2508",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "<a href=\"https://user-images.githubusercontent.com/30656341/40274817-2c1db0c4-5ba6-11e8-8c9a-e9702e7d7b98.gif\"><img loop src=\"https://user-images.githubusercontent.com/30656341/40274817-2c1db0c4-5ba6-11e8-8c9a-e9702e7d7b98.gif\"/></a>",
      "EditableFormat": "markdown",
      "HTML": "<p><a href=\"https://user-images.githubusercontent.com/30656341/40274817-2c1db0c4-5ba6-11e8-8c9a-e9702e7d7b98.gif\"><img src=\"https://user-images.githubusercontent.com/30656341/40274817-2c1db0c4-5ba6-11e8-8c9a-e9702e7d7b98.gif\"></a></p>\n\n",
      "PostDate": "2018-05-20T01:50:53.2899413Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "6b44484d-5e0e-491a-9bdf-24d0ad473af9",
      "UserId": 360208,
      "Username": "CodeNick",
      "AvatarUrl": "https://secure.gravatar.com/avatar/759c6a15a72f2500107323208d0f5434?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "**_```oof.```_**",
      "EditableFormat": "markdown",
      "HTML": "<p><strong><em><code>oof.</code></em></strong></p>\n\n",
      "PostDate": "2018-05-20T03:09:39.5258942Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "c42ce2b6-f601-476d-b71b-7b951eada6c8",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> It may be possible to put an invisible DIV over the map\r\n\r\nI tried this, but it didn't work.\r\n\r\n```\r\nvar mapHolder = $('<div id='map-holder'/>');\r\n$('#gameBorder').append(mapHolder);\r\nsetCss(mapHolder, 'position:fixed;top:20px;')\r\nmapHolder.append($('#gridCanvas'));\r\n```\r\n\r\n---\r\nIt works as far as putting all the elements where I'm telling it to is concerned, but I still can't stop the ```onMouseDrag()``` in grid.js.  Of course, I'm not certain I'm actually doing what Pixie suggested, either...",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>It may be possible to put an invisible DIV over the map</p>\n</blockquote>\n<p>I tried this, but it didn't work.</p>\n<pre><code>var mapHolder = $('&lt;div id='map-holder'/&gt;');\n$('#gameBorder').append(mapHolder);\nsetCss(mapHolder, 'position:fixed;top:20px;')\nmapHolder.append($('#gridCanvas'));\n</code></pre>\n<hr>\n<p>It works as far as putting all the elements where I'm telling it to is concerned, but I still can't stop the <code>onMouseDrag()</code> in grid.js.  Of course, I'm not certain I'm actually doing what Pixie suggested, either...</p>\n\n",
      "PostDate": "2018-05-20T03:39:11.1772419Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "08d74d1a-c6bf-42c0-b4b3-9beab20fb29d",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I got it, I got it!\r\n\r\n```\r\nJS.eval (\"/* change this value to true to allow map dragging */ var canDragMap = false; paper.tool._onHandleEvent = function (type, point, event) { \tif (canDragMap){ \tpaper = this._scope; \tvar called = false; \tswitch (type) { \tcase 'mousedown': \t\tthis._updateEvent(type, point, null, null, true, false, false); \t\tcalled = this._fireEvent(type, event); \t\tbreak; \tcase 'mousedrag': \t\t \t\t  var needsChange = false, \t\t\t\tmatchMaxDistance = false; \t\t\twhile (this._updateEvent(type, point, this.minDistance, \t\t\t\t\tthis.maxDistance, false, needsChange, matchMaxDistance)) { \t\t\t\tcalled = this._fireEvent(type, event) || called; \t\t\t\tneedsChange = true; \t\t\t\tmatchMaxDistance = true; \t\t\t} \t\t \t\tbreak; \tcase 'mouseup': \t\tif (!point.equals(this._point) \t\t\t\t&& this._updateEvent('mousedrag', point, this.minDistance, \t\t\t\t\t\tthis.maxDistance, false, false, false)) { \t\t\tcalled = this._fireEvent('mousedrag', event); \t\t} \t\tthis._updateEvent(type, point, null, this.maxDistance, false, \t\t\t\tfalse, false); \t\tcalled = this._fireEvent(type, event) || called; \t\tthis._updateEvent(type, point, null, null, true, false, false); \t\tthis._firstMove = true; \t\tbreak; \tcase 'mousemove': \t\twhile (this._updateEvent(type, point, this.minDistance, \t\t\t\tthis.maxDistance, this._firstMove, true, false)) { \t\t\tcalled = this._fireEvent(type, event) || called; \t\t\tthis._firstMove = false; \t\t} \t\tbreak; \t} \treturn called; \t} else { \t\t  /* Do nothing.*/ \t} }\")\r\n```\r\n\r\n---\r\nPut that in the user interface initialisation script.  It will disable map-dragging **and grid-clicking**.\r\n\r\n---\r\nAs long as that long line of code is in your user interface initialisation script (or the content of that call is in an included Javascript file), you can enable and disable map dragging whenever you please.\r\n\r\n\r\nTo enable dragging:  ```JS.eval(\"canDragMap = true;\")```\r\n\r\nTo disable:  ```JS.eval(\"canDragMap = false;\")```\r\n\r\n---\r\nHere it is in plain JS format, if you'd rather paste it into a Javascript file which will be added to the game:\r\n\r\n<details>\r\n\r\n```js\r\nvar canDragMap = false; /* Set this value to true to enable map dragging  */\r\n\r\npaper.tool._onHandleEvent = function (type, point, event) {\r\n\tif (canDragMap){\r\n\tpaper = this._scope;\r\n\tvar called = false;\r\n\tswitch (type) {\r\n\tcase 'mousedown':\r\n\t\tthis._updateEvent(type, point, null, null, true, false, false);\r\n\t\tcalled = this._fireEvent(type, event);\r\n\t\tbreak;\r\n\tcase 'mousedrag':\r\n\t\t\r\n\t\t  var needsChange = false,\r\n\t\t\t\tmatchMaxDistance = false;\r\n\t\t\twhile (this._updateEvent(type, point, this.minDistance,\r\n\t\t\t\t\tthis.maxDistance, false, needsChange, matchMaxDistance)) {\r\n\t\t\t\tcalled = this._fireEvent(type, event) || called;\r\n\t\t\t\tneedsChange = true;\r\n\t\t\t\tmatchMaxDistance = true;\r\n\t\t\t}\r\n\t\t\r\n\t\tbreak;\r\n\tcase 'mouseup':\r\n\t\tif (!point.equals(this._point)\r\n\t\t\t\t&& this._updateEvent('mousedrag', point, this.minDistance,\r\n\t\t\t\t\t\tthis.maxDistance, false, false, false)) {\r\n\t\t\tcalled = this._fireEvent('mousedrag', event);\r\n\t\t}\r\n\t\tthis._updateEvent(type, point, null, this.maxDistance, false,\r\n\t\t\t\tfalse, false);\r\n\t\tcalled = this._fireEvent(type, event) || called;\r\n\t\tthis._updateEvent(type, point, null, null, true, false, false);\r\n\t\tthis._firstMove = true;\r\n\t\tbreak;\r\n\tcase 'mousemove':\r\n\t\twhile (this._updateEvent(type, point, this.minDistance,\r\n\t\t\t\tthis.maxDistance, this._firstMove, true, false)) {\r\n\t\t\tcalled = this._fireEvent(type, event) || called;\r\n\t\t\tthis._firstMove = false;\r\n\t\t}\r\n\t\tbreak;\r\n\t}\r\n\treturn called;\r\n\t} else {\r\n\t\t  /* Do nothing.*/\r\n\t}\r\n}\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p>I got it, I got it!</p>\n<pre><code>JS.eval (\"/* change this value to true to allow map dragging */ var canDragMap = false; paper.tool._onHandleEvent = function (type, point, event) { \tif (canDragMap){ \tpaper = this._scope; \tvar called = false; \tswitch (type) { \tcase 'mousedown': \t\tthis._updateEvent(type, point, null, null, true, false, false); \t\tcalled = this._fireEvent(type, event); \t\tbreak; \tcase 'mousedrag': \t\t \t\t  var needsChange = false, \t\t\t\tmatchMaxDistance = false; \t\t\twhile (this._updateEvent(type, point, this.minDistance, \t\t\t\t\tthis.maxDistance, false, needsChange, matchMaxDistance)) { \t\t\t\tcalled = this._fireEvent(type, event) || called; \t\t\t\tneedsChange = true; \t\t\t\tmatchMaxDistance = true; \t\t\t} \t\t \t\tbreak; \tcase 'mouseup': \t\tif (!point.equals(this._point) \t\t\t\t&amp;&amp; this._updateEvent('mousedrag', point, this.minDistance, \t\t\t\t\t\tthis.maxDistance, false, false, false)) { \t\t\tcalled = this._fireEvent('mousedrag', event); \t\t} \t\tthis._updateEvent(type, point, null, this.maxDistance, false, \t\t\t\tfalse, false); \t\tcalled = this._fireEvent(type, event) || called; \t\tthis._updateEvent(type, point, null, null, true, false, false); \t\tthis._firstMove = true; \t\tbreak; \tcase 'mousemove': \t\twhile (this._updateEvent(type, point, this.minDistance, \t\t\t\tthis.maxDistance, this._firstMove, true, false)) { \t\t\tcalled = this._fireEvent(type, event) || called; \t\t\tthis._firstMove = false; \t\t} \t\tbreak; \t} \treturn called; \t} else { \t\t  /* Do nothing.*/ \t} }\")\n</code></pre>\n<hr>\n<p>Put that in the user interface initialisation script.  It will disable map-dragging <strong>and grid-clicking</strong>.</p>\n<hr>\n<p>As long as that long line of code is in your user interface initialisation script (or the content of that call is in an included Javascript file), you can enable and disable map dragging whenever you please.</p>\n<p>To enable dragging:  <code>JS.eval(\"canDragMap = true;\")</code></p>\n<p>To disable:  <code>JS.eval(\"canDragMap = false;\")</code></p>\n<hr>\n<p>Here it is in plain JS format, if you'd rather paste it into a Javascript file which will be added to the game:</p>\n<details>\n<pre><code>var canDragMap = false; /* Set this value to true to enable map dragging  */\n\npaper.tool._onHandleEvent = function (type, point, event) {\n\tif (canDragMap){\n\tpaper = this._scope;\n\tvar called = false;\n\tswitch (type) {\n\tcase 'mousedown':\n\t\tthis._updateEvent(type, point, null, null, true, false, false);\n\t\tcalled = this._fireEvent(type, event);\n\t\tbreak;\n\tcase 'mousedrag':\n\t\t\n\t\t  var needsChange = false,\n\t\t\t\tmatchMaxDistance = false;\n\t\t\twhile (this._updateEvent(type, point, this.minDistance,\n\t\t\t\t\tthis.maxDistance, false, needsChange, matchMaxDistance)) {\n\t\t\t\tcalled = this._fireEvent(type, event) || called;\n\t\t\t\tneedsChange = true;\n\t\t\t\tmatchMaxDistance = true;\n\t\t\t}\n\t\t\n\t\tbreak;\n\tcase 'mouseup':\n\t\tif (!point.equals(this._point)\n\t\t\t\t&amp;&amp; this._updateEvent('mousedrag', point, this.minDistance,\n\t\t\t\t\t\tthis.maxDistance, false, false, false)) {\n\t\t\tcalled = this._fireEvent('mousedrag', event);\n\t\t}\n\t\tthis._updateEvent(type, point, null, this.maxDistance, false,\n\t\t\t\tfalse, false);\n\t\tcalled = this._fireEvent(type, event) || called;\n\t\tthis._updateEvent(type, point, null, null, true, false, false);\n\t\tthis._firstMove = true;\n\t\tbreak;\n\tcase 'mousemove':\n\t\twhile (this._updateEvent(type, point, this.minDistance,\n\t\t\t\tthis.maxDistance, this._firstMove, true, false)) {\n\t\t\tcalled = this._fireEvent(type, event) || called;\n\t\t\tthis._firstMove = false;\n\t\t}\n\t\tbreak;\n\t}\n\treturn called;\n\t} else {\n\t\t  /* Do nothing.*/\n\t}\n}\n</code></pre>\n\n</details>",
      "PostDate": "2018-05-20T04:01:13.4548762Z",
      "LastEditDate": "2018-05-20T04:13:33.5763199Z",
      "link": null
    },
    {
      "PostId": "a8870c95-a524-4cb6-a89e-f4c58e63d8b2",
      "UserId": 199273,
      "Username": "DavyB",
      "AvatarUrl": "http://i.imgur.com/8BcaZCyb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Wow KV, you have done it! I've tested it out and uploaded a new version of Giantkiller Too. I've not put in the option to allow the map to be accessible as that causes problems in this game (I use part of the grid for some puzzles).\r\n\r\n...it's a particular treat to find the problem solved while I slept!!!\r\n\r\n&#128077;&#128077;&#128077;&#128077;&#128077;",
      "EditableFormat": "markdown",
      "HTML": "<p>Wow KV, you have done it! I've tested it out and uploaded a new version of Giantkiller Too. I've not put in the option to allow the map to be accessible as that causes problems in this game (I use part of the grid for some puzzles).</p>\n<p>...it's a particular treat to find the problem solved while I slept!!!</p>\n<p>üëçüëçüëçüëçüëç</p>\n\n",
      "PostDate": "2018-05-20T08:46:35.2206166Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "f580775b-7912-4204-9279-c2643ac97a57",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Might be easier to do:\r\n```\r\nJS.eval (\"paper.getTool().off('mousedrag');\")\r\n```\r\n\r\nNot so easy to re-enable it though.\r\nHmm...\r\n```\r\nJS.eval (\"$(function (){ var draghandler = paper.getTool()._onMouseDrag; enableMapDrag = function () { paper.getTool().on('mousedrag', draghandler); }; disableMapDrag = function () { paper.getTool().off('mousedrag'); };});\")\r\n```\r\nThen you can use `JS.enableMapDrag` and `JS.disableMapDrag`.",
      "EditableFormat": "markdown",
      "HTML": "<p>Might be easier to do:</p>\n<pre><code>JS.eval (\"paper.getTool().off('mousedrag');\")\n</code></pre>\n<p>Not so easy to re-enable it though.<br>\nHmm...</p>\n<pre><code>JS.eval (\"$(function (){ var draghandler = paper.getTool()._onMouseDrag; enableMapDrag = function () { paper.getTool().on('mousedrag', draghandler); }; disableMapDrag = function () { paper.getTool().off('mousedrag'); };});\")\n</code></pre>\n<p>Then you can use <code>JS.enableMapDrag</code> and <code>JS.disableMapDrag</code>.</p>\n\n",
      "PostDate": "2018-05-20T09:31:57.597713Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "568dc894-7c9c-48c4-a99a-227101e9b2e4",
      "UserId": 199273,
      "Username": "DavyB",
      "AvatarUrl": "http://i.imgur.com/8BcaZCyb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "That certainly works in my case and impressively concise!",
      "EditableFormat": "markdown",
      "HTML": "<p>That certainly works in my case and impressively concise!</p>\n\n",
      "PostDate": "2018-05-20T09:47:07.6371145Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

{
  "Topic": {
    "TopicId": "4569",
    "ForumId": "10",
    "Title": "Problem with getting turn scripts to work",
    "LastUpdated": "2014-09-04T22:25:23+01:00",
    "ReplyCount": 7
  },
  "Posts": [
    {
      "PostId": "30027",
      "UserId": 0,
      "Username": "Eaten By A Grue",
      "UserAvatar": null,
      "UserGravatar": "4db52f63bf7861a1affcb452c0121da8",
      "EditableText": "Hi!  A game I'm working on includes a bottle of wine item which can cause intoxication that gradually fades (or if you drink too much, you pass out for a bit and it 'resets').   I implemented this by making 'drink wine' run turn scripts that do different things depending on the player's current alcohol level.   It works well at first but the timing becomes odd if the player drinks multiple times.   What I want to happen is --\n\nIf the player drinks when sober, they go to level one for ten turns then go back to zero.\nIf the player drinks at level one, they go to level two for ten turns then go back to level one (and then return to level zero after another ten turns).\nIf the player drinks at level two, they reset to zero right away.\n\nHere is what this section looks like in the code view.   Maybe someone could spot a mistake or let me know if there's a better way to do this!\n\n &lt;drink type=&quot;script&quot;&gt;&lt;![CDATA[\n        IncreaseObjectCounter (player, &quot;alclevel&quot;)\n        if (GetInt(player, &quot;alclevel&quot;) = 1) {\n          msg (&quot;You take a healthy gulp of wine.  It's got quite a kick to it, and you feel light-headed almost at once.&quot;)\n          SetTurnTimeout (10) {\n            if (GetInt(player, &quot;alclevel&quot;) = 1) {\n              msg (&quot;&lt;br/&gt;Your head feels perfectly clear again.&quot;)\n              DecreaseObjectCounter (player, &quot;alclevel&quot;)\n            }\n          }\n        }\n        else if (GetInt(player, &quot;alclevel&quot;) = 2) {\n          msg (&quot;You take another healthy guzzle from the bottle.  You're starting to feel more confident.  And tough!  In fact, you feel like you could take on the world and lick it with one hand tied behind your back!  You're not scared of anything!&quot;)\n          SetTurnTimeout (10) {\n            if (GetInt(player, &quot;alclevel&quot;) = 2) {\n              msg (&quot;&lt;br/&gt;You're beginning to sober up, and your bravado fades a little as you remember the dangers of your situation.&quot;)\n              DecreaseObjectCounter (player, &quot;alclevel&quot;)\n              SetTurnTimeout (10) {\n                if (GetInt(player, &quot;alclevel&quot;) = 1) {\n                  msg (&quot;&lt;br/&gt;Your head feels perfectly clear again.&quot;)\n                  DecreaseObjectCounter (player, &quot;alclevel&quot;)\n                }\n              }\n            }\n          }\n        }\n        else if (GetInt(player, &quot;alclevel&quot;) = 3) {\n          msg (&quot;You take a long, sloppy draft from the bottle.  You're so plastered now you're having trouble staying upright.  You sit down, head spinning, and clutch the bottle, the beautiful, beautiful bottle, like a lifeline in a storm.&lt;br/&gt;&lt;br/&gt;After a few minutes of frantic effort by your liver, you jerk awake, feeling a little sick, but sober.&quot;)\n          DecreaseObjectCounter (player, &quot;alclevel&quot;)\n          DecreaseObjectCounter (player, &quot;alclevel&quot;)\n          DecreaseObjectCounter (player, &quot;alclevel&quot;)\n        }\n      ]]&gt;&lt;/drink&gt;",
      "EditableFormat": "bbcode",
      "HTML": "Hi!  A game I'm working on includes a bottle of wine item which can cause intoxication that gradually fades (or if you drink too much, you pass out for a bit and it 'resets').   I implemented this by making 'drink wine' run turn scripts that do different things depending on the player's current alcohol level.   It works well at first but the timing becomes odd if the player drinks multiple times.   What I want to happen is --<br/><br/>If the player drinks when sober, they go to level one for ten turns then go back to zero.<br/>If the player drinks at level one, they go to level two for ten turns then go back to level one (and then return to level zero after another ten turns).<br/>If the player drinks at level two, they reset to zero right away.<br/><br/>Here is what this section looks like in the code view.   Maybe someone could spot a mistake or let me know if there's a better way to do this!<br/><br/> &lt;drink type=&quot;script&quot;&gt;&lt;![CDATA[<br/>        IncreaseObjectCounter (player, &quot;alclevel&quot;)<br/>        if (GetInt(player, &quot;alclevel&quot;) = 1) {<br/>          msg (&quot;You take a healthy gulp of wine.  It's got quite a kick to it, and you feel light-headed almost at once.&quot;)<br/>          SetTurnTimeout (10) {<br/>            if (GetInt(player, &quot;alclevel&quot;) = 1) {<br/>              msg (&quot;&lt;br/&gt;Your head feels perfectly clear again.&quot;)<br/>              DecreaseObjectCounter (player, &quot;alclevel&quot;)<br/>            }<br/>          }<br/>        }<br/>        else if (GetInt(player, &quot;alclevel&quot;) = 2) {<br/>          msg (&quot;You take another healthy guzzle from the bottle.  You're starting to feel more confident.  And tough!  In fact, you feel like you could take on the world and lick it with one hand tied behind your back!  You're not scared of anything!&quot;)<br/>          SetTurnTimeout (10) {<br/>            if (GetInt(player, &quot;alclevel&quot;) = 2) {<br/>              msg (&quot;&lt;br/&gt;You're beginning to sober up, and your bravado fades a little as you remember the dangers of your situation.&quot;)<br/>              DecreaseObjectCounter (player, &quot;alclevel&quot;)<br/>              SetTurnTimeout (10) {<br/>                if (GetInt(player, &quot;alclevel&quot;) = 1) {<br/>                  msg (&quot;&lt;br/&gt;Your head feels perfectly clear again.&quot;)<br/>                  DecreaseObjectCounter (player, &quot;alclevel&quot;)<br/>                }<br/>              }<br/>            }<br/>          }<br/>        }<br/>        else if (GetInt(player, &quot;alclevel&quot;) = 3) {<br/>          msg (&quot;You take a long, sloppy draft from the bottle.  You're so plastered now you're having trouble staying upright.  You sit down, head spinning, and clutch the bottle, the beautiful, beautiful bottle, like a lifeline in a storm.&lt;br/&gt;&lt;br/&gt;After a few minutes of frantic effort by your liver, you jerk awake, feeling a little sick, but sober.&quot;)<br/>          DecreaseObjectCounter (player, &quot;alclevel&quot;)<br/>          DecreaseObjectCounter (player, &quot;alclevel&quot;)<br/>          DecreaseObjectCounter (player, &quot;alclevel&quot;)<br/>        }<br/>      ]]&gt;&lt;/drink&gt;",
      "PostDate": "2014-09-03T07:49:26+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "30029",
      "UserId": 0,
      "Username": "jaynabonne",
      "UserAvatar": "6579_1344778256.jpg",
      "UserGravatar": "379859a7f1952a65399fc63997e68f0b",
      "EditableText": "It looks reasonable to me. I tried it out and didn't see a problem (yet). Do you have a command sequence that shows the problem? It might be some sort of edge case.\n\nAlso, is this the online editor or the desktop (Windows) one?",
      "EditableFormat": "bbcode",
      "HTML": "It looks reasonable to me. I tried it out and didn't see a problem (yet). Do you have a command sequence that shows the problem? It might be some sort of edge case.<br/><br/>Also, is this the online editor or the desktop (Windows) one?",
      "PostDate": "2014-09-03T09:31:20+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "30030",
      "UserId": 0,
      "Username": "jaynabonne",
      "UserAvatar": "6579_1344778256.jpg",
      "UserGravatar": "379859a7f1952a65399fc63997e68f0b",
      "EditableText": "Actually, I take it back - it depends on how you define &quot;works&quot;. If you want there to always be a ten turn delay, then you can't use it the way you are, as the old turn timeout scripts are still in operation. So if you do this:\n\ndrink (level = 1)\ndrink (level = 2)\ndrink (level = 3)\nwait 5 turns\ndrink (level = 1)\n\nthen the script from the first drink will kick in on the next turn. As far as I know, there is no way to kill a &quot;turn timeout&quot; script (there might be, but I haven't researched it yet - there's definitely nothing simple).\n\nThe most straightforward way to do what you want is have a real turnscript instead, something that runs after each turn. Then you can handle the different alcohol levels yourself. You'll also have to track the number of turns that have elapsed, but that is the benefit, as it allows you to reset the turn count when things change, so you can always make things kick in ten turns hence.\n\nEdit: What you could do: have an alcohol level on the player. Whenever they drink, add 10 to it. On each turn, via the turn script, if their alcohol level is not zero, decrement it by 1, with your messages ocurring at 0 and 10. If when you add 10 to the drink level, it exceeds 20, then it's the &quot;drunk too much&quot; case, and you do the pass out thing and return the alcohol level to 0.",
      "EditableFormat": "bbcode",
      "HTML": "Actually, I take it back - it depends on how you define &quot;works&quot;. If you want there to always be a ten turn delay, then you can't use it the way you are, as the old turn timeout scripts are still in operation. So if you do this:<br/><br/>drink (level = 1)<br/>drink (level = 2)<br/>drink (level = 3)<br/>wait 5 turns<br/>drink (level = 1)<br/><br/>then the script from the first drink will kick in on the next turn. As far as I know, there is no way to kill a &quot;turn timeout&quot; script (there might be, but I haven't researched it yet - there's definitely nothing simple).<br/><br/>The most straightforward way to do what you want is have a real turnscript instead, something that runs after each turn. Then you can handle the different alcohol levels yourself. You'll also have to track the number of turns that have elapsed, but that is the benefit, as it allows you to reset the turn count when things change, so you can always make things kick in ten turns hence.<br/><br/>Edit: What you could do: have an alcohol level on the player. Whenever they drink, add 10 to it. On each turn, via the turn script, if their alcohol level is not zero, decrement it by 1, with your messages ocurring at 0 and 10. If when you add 10 to the drink level, it exceeds 20, then it's the &quot;drunk too much&quot; case, and you do the pass out thing and return the alcohol level to 0.",
      "PostDate": "2014-09-03T09:41:06+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "30038",
      "UserId": 0,
      "Username": "HegemonKhan",
      "UserAvatar": null,
      "UserGravatar": "a96cf34d8d97c57de38f54ee22b1759b",
      "EditableText": "there's two types of 'counting' :\n\n1. 'tally' counting: you just keep increasing this number: game.turns = game.turns + 1\n2. cyclical counting: when you hit a certain number, it resets: game.turns = (game.turns + 1) % 5\n\nthe modulus operator (division but only returns the remainder instead): %\n\n+1, % 5\n\n0\n(0+1) / 5 -&gt; R: 1\n(1+1) / 5 -&gt; R: 2\n(2+1) / 5 -&gt; R: 3\n(3+1) / 5 -&gt; R: 4\n(4+1) / 5 -&gt; R: 0\n(5+1) / 5 -&gt; R: 1\n(6+1) / 5 -&gt; R: 2\n(7+1) / 5 -&gt; R: 3\n(8+1) / 5 -&gt; R: 4\n(9+1) / 5 -&gt; R: 0\netc etc etc\n\n-------------------------\n\nwhat method do you need for doing what you want (I'm still trying to figure out exactly what you want done, lol) ??? :\n\n(within the) Turnscript&#058;\n\n1. tally: if (x=1) do this 1, if (x=2) do this 2, etc etc etc\n2: cyclical: if (x=0), do this thing\n3. tally + cyclical (having these as seperate attributes, but the tally is used by the cyclical ~ hopefully you understand this method's application as I'm baffled at how to explain it, lol): x=x+1, y = x % 5, if (y=0) do this thing\n\n[code:3ed6xmi8]&lt;game name=&quot;blah&quot;&gt;\n  // day_tally = day_tally + 1\n  // day_tally = 90\n  // pretend all months are 30 days long, and ignore all the other complexity that I'm ignoring with my example of calender attr\n  // day_of_the_month = ( day_tally % 30 ) + 1 = 1\n&lt;/game&gt;\n\n&lt;turnscript name=&quot;blah&quot;&gt;\n  &lt;enabled /&gt;\n  &lt;script&gt;\n    if (day_of_the_month % 7 + 1 = 1) {\n      day_of_the_week = &quot;monday&quot;\n    } else if (day_of_month % 7 + 1 = 2) {\n      day_of_the_week = &quot;tuesday&quot;\n    } else if&#46;&#46;&#46;\n      etc etc etc\n    }\n  &lt;/script&gt;\n&lt;/turnscript&gt;[/code:3ed6xmi8]",
      "EditableFormat": "bbcode",
      "HTML": "there's two types of 'counting' :<br/><br/>1. 'tally' counting: you just keep increasing this number: game.turns = game.turns + 1<br/>2. cyclical counting: when you hit a certain number, it resets: game.turns = (game.turns + 1) % 5<br/><br/>the modulus operator (division but only returns the remainder instead): %<br/><br/>+1, % 5<br/><br/>0<br/>(0+1) / 5 -&gt; R: 1<br/>(1+1) / 5 -&gt; R: 2<br/>(2+1) / 5 -&gt; R: 3<br/>(3+1) / 5 -&gt; R: 4<br/>(4+1) / 5 -&gt; R: 0<br/>(5+1) / 5 -&gt; R: 1<br/>(6+1) / 5 -&gt; R: 2<br/>(7+1) / 5 -&gt; R: 3<br/>(8+1) / 5 -&gt; R: 4<br/>(9+1) / 5 -&gt; R: 0<br/>etc etc etc<br/><br/>-------------------------<br/><br/>what method do you need for doing what you want (I'm still trying to figure out exactly what you want done, lol) ??? :<br/><br/>(within the) Turnscript&#058;<br/><br/>1. tally: if (x=1) do this 1, if (x=2) do this 2, etc etc etc<br/>2: cyclical: if (x=0), do this thing<br/>3. tally + cyclical (having these as seperate attributes, but the tally is used by the cyclical ~ hopefully you understand this method's application as I'm baffled at how to explain it, lol): x=x+1, y = x % 5, if (y=0) do this thing<br/><br/><pre><code>&lt;game name=&quot;blah&quot;&gt;<br/>  // day_tally = day_tally + 1<br/>  // day_tally = 90<br/>  // pretend all months are 30 days long, and ignore all the other complexity that I'm ignoring with my example of calender attr<br/>  // day_of_the_month = ( day_tally % 30 ) + 1 = 1<br/>&lt;/game&gt;<br/><br/>&lt;turnscript name=&quot;blah&quot;&gt;<br/>  &lt;enabled /&gt;<br/>  &lt;script&gt;<br/>    if (day_of_the_month % 7 + 1 = 1) {<br/>      day_of_the_week = &quot;monday&quot;<br/>    } else if (day_of_month % 7 + 1 = 2) {<br/>      day_of_the_week = &quot;tuesday&quot;<br/>    } else if&#46;&#46;&#46;<br/>      etc etc etc<br/>    }<br/>  &lt;/script&gt;<br/>&lt;/turnscript&gt;</code></pre>",
      "PostDate": "2014-09-04T01:59:56+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "30039",
      "UserId": 0,
      "Username": "Eaten By A Grue",
      "UserAvatar": null,
      "UserGravatar": "4db52f63bf7861a1affcb452c0121da8",
      "EditableText": "Thanks for the help!  I'll try the universal turn script thing and see if I can get it to work.  This is on the desktop version by the way.   One more question; I also need the game to be able to tell when the player is at 'level two' because one puzzle is a door that's treated as locked until the first time you pass through it at that level (because it's a scary cave, and you have to find something that gives you courage); can I still do that using the changes you suggested?",
      "EditableFormat": "bbcode",
      "HTML": "Thanks for the help!  I'll try the universal turn script thing and see if I can get it to work.  This is on the desktop version by the way.   One more question; I also need the game to be able to tell when the player is at 'level two' because one puzzle is a door that's treated as locked until the first time you pass through it at that level (because it's a scary cave, and you have to find something that gives you courage); can I still do that using the changes you suggested?",
      "PostDate": "2014-09-04T08:19:26+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "30041",
      "UserId": 0,
      "Username": "jaynabonne",
      "UserAvatar": "6579_1344778256.jpg",
      "UserGravatar": "379859a7f1952a65399fc63997e68f0b",
      "EditableText": "If you go with what I suggested, then it would be your level 2 if the alclevel is between 11 and 20.\n\nI just realized what I had suggested won't work exactly. Just adding 10 will give you the same problem you had before (e.g. if the level has decreased to 1 and you add 10, it will then be 11 and drop level on the next turn). You need to round up to the nearest 10 after adding 10. I can post code later if you like (I'm at work now.)",
      "EditableFormat": "bbcode",
      "HTML": "If you go with what I suggested, then it would be your level 2 if the alclevel is between 11 and 20.<br/><br/>I just realized what I had suggested won't work exactly. Just adding 10 will give you the same problem you had before (e.g. if the level has decreased to 1 and you add 10, it will then be 11 and drop level on the next turn). You need to round up to the nearest 10 after adding 10. I can post code later if you like (I'm at work now.)",
      "PostDate": "2014-09-04T10:33:28+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "30047",
      "UserId": 0,
      "Username": "HegemonKhan",
      "UserAvatar": null,
      "UserGravatar": "a96cf34d8d97c57de38f54ee22b1759b",
      "EditableText": "I forgot that there's a 3rd way as well:\n\n3. using a 'range', for example, inside a turnscript&#058;\n\nif (x &gt; 0 and x &lt;= 5) {\n// do this 1\n} else if (x &gt; 5 and x &lt;= 10) {\n// do this 2\n} else if...\n// etc etc etc\n}\n\n----------------------------\n\nturnscripts are 'always activating' functions, so you want your 'if~else if~else' condition scripting within the turnscript (and if you want to do any counting, then this as well too, obviously), so these are very useful for constantly checking as to whether to do an action for you, for another example:\n\n[code:271fypyk]&lt;turnscript name=&quot;leveling_turnscript&quot;&gt;\n// leveling_function&#58;\n// if (player&#46;experience &gt;= player&#46;level * 100 + 100) {\n//  player&#46;experience = player&#46;experience - player&#46;level * 100 + 100\n//  player&#46;level = player&#46;level + 1\n//  leveling_function (repeating this script block)\n&lt;/turnscript&gt;[/code:271fypyk]\n\n----------------------------\n\nthe other option is using the 'changed' Script attribute:\n\nwhenever 'whatever' attribute's value changes, do whatever script(s) ~ aka do anything you want",
      "EditableFormat": "bbcode",
      "HTML": "I forgot that there's a 3rd way as well:<br/><br/>3. using a 'range', for example, inside a turnscript&#058;<br/><br/>if (x &gt; 0 and x &lt;= 5) {<br/>// do this 1<br/>} else if (x &gt; 5 and x &lt;= 10) {<br/>// do this 2<br/>} else if...<br/>// etc etc etc<br/>}<br/><br/>----------------------------<br/><br/>turnscripts are 'always activating' functions, so you want your 'if~else if~else' condition scripting within the turnscript (and if you want to do any counting, then this as well too, obviously), so these are very useful for constantly checking as to whether to do an action for you, for another example:<br/><br/><pre><code>&lt;turnscript name=&quot;leveling_turnscript&quot;&gt;<br/>// leveling_function&#58;<br/>// if (player&#46;experience &gt;= player&#46;level * 100 + 100) {<br/>//  player&#46;experience = player&#46;experience - player&#46;level * 100 + 100<br/>//  player&#46;level = player&#46;level + 1<br/>//  leveling_function (repeating this script block)<br/>&lt;/turnscript&gt;</code></pre><br/><br/>----------------------------<br/><br/>the other option is using the 'changed' Script attribute:<br/><br/>whenever 'whatever' attribute's value changes, do whatever script(s) ~ aka do anything you want",
      "PostDate": "2014-09-04T15:18:11+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "30063",
      "UserId": 0,
      "Username": "jaynabonne",
      "UserAvatar": "6579_1344778256.jpg",
      "UserGravatar": "379859a7f1952a65399fc63997e68f0b",
      "EditableText": "Here's code that should do what you want (take what you need from it in terms of the command):\n\n[code:2fo24a86]&lt;!--Saved by Quest 5&#46;5&#46;5328&#46;26617--&gt;\n&lt;asl version=&quot;550&quot;&gt;\n  &lt;include ref=&quot;English&#46;aslx&quot; /&gt;\n  &lt;include ref=&quot;Core&#46;aslx&quot; /&gt;\n  &lt;game name=&quot;drinktest&quot;&gt;\n    &lt;gameid&gt;f9a6d4f3-d97c-4fe0-a0f1-362733077258&lt;/gameid&gt;\n    &lt;version&gt;1&#46;0&lt;/version&gt;\n    &lt;firstpublished&gt;2014&lt;/firstpublished&gt;\n  &lt;/game&gt;\n  &lt;object name=&quot;room&quot;&gt;\n    &lt;inherit name=&quot;editor_room&quot; /&gt;\n    &lt;object name=&quot;player&quot;&gt;\n      &lt;inherit name=&quot;editor_object&quot; /&gt;\n      &lt;inherit name=&quot;editor_player&quot; /&gt;\n      &lt;alclevel type=&quot;int&quot;&gt;0&lt;/alclevel&gt;\n      &lt;drink type=&quot;script&quot;&gt;&lt;!&#91;CDATA&#91;\n      \tif (player&#46;alclevel = 0) {\n          msg (&quot;You take a healthy gulp of wine&#46; It's got quite a kick to it, and you feel light-headed almost at once&#46;&quot;)\n      \t  player&#46;alclevel = 10\n      \t} else if (player&#46;alclevel &lt;= 10) {\n          msg (&quot;You take another healthy guzzle from the bottle&#46; You're starting to feel more confident&#46; And tough! In fact, you feel like you could take on the world and lick it with one hand tied behind your back! You're not scared of anything!&quot;)\n      \t  player&#46;alclevel = 20\n      \t} else {\n          msg (&quot;You take a long, sloppy draft from the bottle&#46; You're so plastered now you're having trouble staying upright&#46; You sit down, head spinning, and clutch the bottle, the beautiful, beautiful bottle, like a lifeline in a storm&#46;&lt;br/&gt;&lt;br/&gt;After a few minutes of frantic effort by your liver, you jerk awake, feeling a little sick, but sober&#46;&quot;)\n          player&#46;alclevel = 0\n      \t}\n      &#93;&#93;&gt;&lt;/drink&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n  &lt;turnscript name=&quot;alclevel_turnscript&quot;&gt;\n\t  &lt;enabled /&gt;\n\t  &lt;script&gt;&lt;!&#91;CDATA&#91;\n\t  \tif (player&#46;alclevel &lt;&gt; 0) {\n\t  \t\tplayer&#46;alclevel = player&#46;alclevel - 1\n\t  \t\tif (player&#46;alclevel = 0) {\n\t\t        msg (&quot;&lt;br/&gt;Your head feels perfectly clear again&#46;&quot;)\n\t  \t\t} else if (player&#46;alclevel = 10) {\n\t            msg (&quot;&lt;br/&gt;You're beginning to sober up, and your bravado fades a little as you remember the dangers of your situation&#46;&quot;)\n\t  \t\t}\n\t  \t}\n\t  \t&#93;&#93;&gt;\n\t  &lt;/script&gt;\n  &lt;/turnscript&gt;\n  &lt;command name=&quot;drinkcommand&quot;&gt;\n    &lt;pattern&gt;drink&lt;/pattern&gt;\n    &lt;script&gt;\n      do(player, &quot;drink&quot;)\n    &lt;/script&gt;\n  &lt;/command&gt;\n&lt;/asl&gt;\n[/code:2fo24a86]\nThe core parts are the &quot;drink&quot; script&#058;\n\n[code:2fo24a86]      &lt;drink type=&quot;script&quot;&gt;&lt;!&#91;CDATA&#91;\n         if (player&#46;alclevel = 0) {\n          msg (&quot;You take a healthy gulp of wine&#46; It's got quite a kick to it, and you feel light-headed almost at once&#46;&quot;)\n           player&#46;alclevel = 10\n         } else if (player&#46;alclevel &lt;= 10) {\n          msg (&quot;You take another healthy guzzle from the bottle&#46; You're starting to feel more confident&#46; And tough! In fact, you feel like you could take on the world and lick it with one hand tied behind your back! You're not scared of anything!&quot;)\n           player&#46;alclevel = 20\n         } else {\n          msg (&quot;You take a long, sloppy draft from the bottle&#46; You're so plastered now you're having trouble staying upright&#46; You sit down, head spinning, and clutch the bottle, the beautiful, beautiful bottle, like a lifeline in a storm&#46;&lt;br/&gt;&lt;br/&gt;After a few minutes of frantic effort by your liver, you jerk awake, feeling a little sick, but sober&#46;&quot;)\n          player&#46;alclevel = 0\n         }\n      &#93;&#93;&gt;&lt;/drink&gt;[/code:2fo24a86]\nand the turn script&#058;\n\n[code:2fo24a86]  &lt;turnscript name=&quot;alclevel_turnscript&quot;&gt;\n\t  &lt;enabled /&gt;\n\t  &lt;script&gt;&lt;!&#91;CDATA&#91;\n\t  \tif (player&#46;alclevel &lt;&gt; 0) {\n\t  \t\tplayer&#46;alclevel = player&#46;alclevel - 1\n\t  \t\tif (player&#46;alclevel = 0) {\n\t\t        msg (&quot;&lt;br/&gt;Your head feels perfectly clear again&#46;&quot;)\n\t  \t\t} else if (player&#46;alclevel = 10) {\n\t            msg (&quot;&lt;br/&gt;You're beginning to sober up, and your bravado fades a little as you remember the dangers of your situation&#46;&quot;)\n\t  \t\t}\n\t  \t}\n\t  \t&#93;&#93;&gt;\n\t  &lt;/script&gt;\n  &lt;/turnscript&gt;\n[/code:2fo24a86]\nLet me know if you have any questions or problems.",
      "EditableFormat": "bbcode",
      "HTML": "Here's code that should do what you want (take what you need from it in terms of the command):<br/><br/><pre><code>&lt;!--Saved by Quest 5&#46;5&#46;5328&#46;26617--&gt;<br/>&lt;asl version=&quot;550&quot;&gt;<br/>  &lt;include ref=&quot;English&#46;aslx&quot; /&gt;<br/>  &lt;include ref=&quot;Core&#46;aslx&quot; /&gt;<br/>  &lt;game name=&quot;drinktest&quot;&gt;<br/>    &lt;gameid&gt;f9a6d4f3-d97c-4fe0-a0f1-362733077258&lt;/gameid&gt;<br/>    &lt;version&gt;1&#46;0&lt;/version&gt;<br/>    &lt;firstpublished&gt;2014&lt;/firstpublished&gt;<br/>  &lt;/game&gt;<br/>  &lt;object name=&quot;room&quot;&gt;<br/>    &lt;inherit name=&quot;editor_room&quot; /&gt;<br/>    &lt;object name=&quot;player&quot;&gt;<br/>      &lt;inherit name=&quot;editor_object&quot; /&gt;<br/>      &lt;inherit name=&quot;editor_player&quot; /&gt;<br/>      &lt;alclevel type=&quot;int&quot;&gt;0&lt;/alclevel&gt;<br/>      &lt;drink type=&quot;script&quot;&gt;&lt;!&#91;CDATA&#91;<br/>      \tif (player&#46;alclevel = 0) {<br/>          msg (&quot;You take a healthy gulp of wine&#46; It's got quite a kick to it, and you feel light-headed almost at once&#46;&quot;)<br/>      \t  player&#46;alclevel = 10<br/>      \t} else if (player&#46;alclevel &lt;= 10) {<br/>          msg (&quot;You take another healthy guzzle from the bottle&#46; You're starting to feel more confident&#46; And tough! In fact, you feel like you could take on the world and lick it with one hand tied behind your back! You're not scared of anything!&quot;)<br/>      \t  player&#46;alclevel = 20<br/>      \t} else {<br/>          msg (&quot;You take a long, sloppy draft from the bottle&#46; You're so plastered now you're having trouble staying upright&#46; You sit down, head spinning, and clutch the bottle, the beautiful, beautiful bottle, like a lifeline in a storm&#46;&lt;br/&gt;&lt;br/&gt;After a few minutes of frantic effort by your liver, you jerk awake, feeling a little sick, but sober&#46;&quot;)<br/>          player&#46;alclevel = 0<br/>      \t}<br/>      &#93;&#93;&gt;&lt;/drink&gt;<br/>    &lt;/object&gt;<br/>  &lt;/object&gt;<br/>  &lt;turnscript name=&quot;alclevel_turnscript&quot;&gt;<br/>\t  &lt;enabled /&gt;<br/>\t  &lt;script&gt;&lt;!&#91;CDATA&#91;<br/>\t  \tif (player&#46;alclevel &lt;&gt; 0) {<br/>\t  \t\tplayer&#46;alclevel = player&#46;alclevel - 1<br/>\t  \t\tif (player&#46;alclevel = 0) {<br/>\t\t        msg (&quot;&lt;br/&gt;Your head feels perfectly clear again&#46;&quot;)<br/>\t  \t\t} else if (player&#46;alclevel = 10) {<br/>\t            msg (&quot;&lt;br/&gt;You're beginning to sober up, and your bravado fades a little as you remember the dangers of your situation&#46;&quot;)<br/>\t  \t\t}<br/>\t  \t}<br/>\t  \t&#93;&#93;&gt;<br/>\t  &lt;/script&gt;<br/>  &lt;/turnscript&gt;<br/>  &lt;command name=&quot;drinkcommand&quot;&gt;<br/>    &lt;pattern&gt;drink&lt;/pattern&gt;<br/>    &lt;script&gt;<br/>      do(player, &quot;drink&quot;)<br/>    &lt;/script&gt;<br/>  &lt;/command&gt;<br/>&lt;/asl&gt;<br/></code></pre><br/>The core parts are the &quot;drink&quot; script&#058;<br/><br/><pre><code>      &lt;drink type=&quot;script&quot;&gt;&lt;!&#91;CDATA&#91;<br/>         if (player&#46;alclevel = 0) {<br/>          msg (&quot;You take a healthy gulp of wine&#46; It's got quite a kick to it, and you feel light-headed almost at once&#46;&quot;)<br/>           player&#46;alclevel = 10<br/>         } else if (player&#46;alclevel &lt;= 10) {<br/>          msg (&quot;You take another healthy guzzle from the bottle&#46; You're starting to feel more confident&#46; And tough! In fact, you feel like you could take on the world and lick it with one hand tied behind your back! You're not scared of anything!&quot;)<br/>           player&#46;alclevel = 20<br/>         } else {<br/>          msg (&quot;You take a long, sloppy draft from the bottle&#46; You're so plastered now you're having trouble staying upright&#46; You sit down, head spinning, and clutch the bottle, the beautiful, beautiful bottle, like a lifeline in a storm&#46;&lt;br/&gt;&lt;br/&gt;After a few minutes of frantic effort by your liver, you jerk awake, feeling a little sick, but sober&#46;&quot;)<br/>          player&#46;alclevel = 0<br/>         }<br/>      &#93;&#93;&gt;&lt;/drink&gt;</code></pre><br/>and the turn script&#058;<br/><br/><pre><code>  &lt;turnscript name=&quot;alclevel_turnscript&quot;&gt;<br/>\t  &lt;enabled /&gt;<br/>\t  &lt;script&gt;&lt;!&#91;CDATA&#91;<br/>\t  \tif (player&#46;alclevel &lt;&gt; 0) {<br/>\t  \t\tplayer&#46;alclevel = player&#46;alclevel - 1<br/>\t  \t\tif (player&#46;alclevel = 0) {<br/>\t\t        msg (&quot;&lt;br/&gt;Your head feels perfectly clear again&#46;&quot;)<br/>\t  \t\t} else if (player&#46;alclevel = 10) {<br/>\t            msg (&quot;&lt;br/&gt;You're beginning to sober up, and your bravado fades a little as you remember the dangers of your situation&#46;&quot;)<br/>\t  \t\t}<br/>\t  \t}<br/>\t  \t&#93;&#93;&gt;<br/>\t  &lt;/script&gt;<br/>  &lt;/turnscript&gt;<br/></code></pre><br/>Let me know if you have any questions or problems.",
      "PostDate": "2014-09-04T22:25:23+01:00",
      "LastEditDate": null
    }
  ]
}

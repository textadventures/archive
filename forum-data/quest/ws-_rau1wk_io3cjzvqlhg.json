{
  "Topic": {
    "TopicId": "ws-_rau1wk_io3cjzvqlhg",
    "ForumId": "10",
    "Title": "Hyperlink Issues",
    "LastUpdated": "2018-12-19T20:01:44.7827906Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "cd3b92e0-1271-4887-a4a0-454ef43f580c",
      "UserId": 199273,
      "Username": "DavyB",
      "AvatarUrl": "http://i.imgur.com/8BcaZCyb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I've turned up a few issues in allowing game players to switch hyperlinks on and off dynamically during game play. Below is test code to illustrate the problems. Hyperlinks have been selected under the Display game tab. They can be switched switched off with LINKS OFF and back on with LINKS ON. They are on initially.\r\n\r\nIssue 1: Links are shown in a disambiguation menu when links are supposedly 'off'? (try x bin)\r\n\r\nIssue 2: If hyperlinks are NOT selected under the game Display tab, they still appear in a disambiguation menu.\r\n\r\nIssue 3: Again with hyperlinks NOT selected, they are still shown in the following text: _You are in a {command:l:room}._ Typing LINKS OFF appears to clear the link but on typing LOOK it reappears!\r\n\r\nIssue 4: While experimenting, I'm repeatedly told that the game has been modified outside Quest, with an invitation to reload?\r\n\r\nThoughts?\r\n```\r\n<!--Saved by Quest 5.8.6836.13983-->\r\n<asl version=\"580\">\r\n  <include ref=\"English.aslx\" />\r\n  <include ref=\"Core.aslx\" />\r\n  <game name=\"Link Test\">\r\n    <gameid>7bc55f56-daae-4ab6-88ff-98fc07ec4344</gameid>\r\n    <version>1.0</version>\r\n    <firstpublished>2018</firstpublished>\r\n    <enablehyperlinks />\r\n    <attr name=\"autodescription_youcango\" type=\"int\">0</attr>\r\n    <attr name=\"autodescription_description\" type=\"int\">1</attr>\r\n    <attr name=\"autodescription_youarein\" type=\"int\">0</attr>\r\n    <attr name=\"link_status\">on</attr>\r\n    <feature_advancedscripts />\r\n    <inituserinterface type=\"script\"><![CDATA[\r\n      JS.eval (\"if (typeof(linksEnabled)=='undefined'){var linksEnabled = true;} function updateCommandLinks(data) {     $('.commandlink').each(function (index, e) {         var $e = $(e);         if (!$(e).data('deactivated')) {             var elementid = $e.data('elementid');             var available = $.inArray(elementid, data) > -1 || elementid.length == 0;             if (available) {                 if (linksEnabled) {$e.removeClass('disabled');}             } else {                 $e.addClass('disabled');             }         }     });$('.cmdlink').each(function(){\tif (!linksEnabled) {\t\t$(this).addClass('disabled');\t}});};\")\r\n      SetHyperlinkStatus (game.link_status)\r\n    ]]></inituserinterface>\r\n    <underlinehyperlinks />\r\n  </game>\r\n  <object name=\"room\">\r\n    <inherit name=\"editor_room\" />\r\n    <isroom />\r\n    <description>You are in a {command:l:room}.</description>\r\n    <object name=\"player\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"editor_player\" />\r\n    </object>\r\n    <object name=\"bread bin\">\r\n      <inherit name=\"editor_object\" />\r\n    </object>\r\n    <object name=\"has bin\">\r\n      <inherit name=\"editor_object\" />\r\n    </object>\r\n  </object>\r\n  <command name=\"links\">\r\n    <pattern>links #text#</pattern>\r\n    <script>\r\n      SetHyperlinkStatus (text)\r\n    </script>\r\n  </command>\r\n  <function name=\"SetHyperlinkStatus\" parameters=\"setting\">\r\n    if (setting = \"on\") {\r\n      bool = \"true\"\r\n    }\r\n    else {\r\n      bool = \"false\"\r\n    }\r\n    JS.eval (\"var linksEnabled = \"+bool+\";\")\r\n    if (bool = \"false\") {\r\n      game.suppresshyperlinks = true\r\n      game.link_status = \"off\"\r\n      JS.eval (\"$('.cmdlink,.commandlink').each(function(){$(this).addClass('disabled');});\")\r\n    }\r\n    else {\r\n      game.suppresshyperlinks = false\r\n      game.link_status = \"on\"\r\n    }\r\n  </function>\r\n</asl>\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p>I've turned up a few issues in allowing game players to switch hyperlinks on and off dynamically during game play. Below is test code to illustrate the problems. Hyperlinks have been selected under the Display game tab. They can be switched switched off with LINKS OFF and back on with LINKS ON. They are on initially.</p>\n<p>Issue 1: Links are shown in a disambiguation menu when links are supposedly 'off'? (try x bin)</p>\n<p>Issue 2: If hyperlinks are NOT selected under the game Display tab, they still appear in a disambiguation menu.</p>\n<p>Issue 3: Again with hyperlinks NOT selected, they are still shown in the following text: <em>You are in a {command:l:room}.</em> Typing LINKS OFF appears to clear the link but on typing LOOK it reappears!</p>\n<p>Issue 4: While experimenting, I'm repeatedly told that the game has been modified outside Quest, with an invitation to reload?</p>\n<p>Thoughts?</p>\n<pre><code>&lt;!--Saved by Quest 5.8.6836.13983--&gt;\n&lt;asl version=\"580\"&gt;\n  &lt;include ref=\"English.aslx\" /&gt;\n  &lt;include ref=\"Core.aslx\" /&gt;\n  &lt;game name=\"Link Test\"&gt;\n    &lt;gameid&gt;7bc55f56-daae-4ab6-88ff-98fc07ec4344&lt;/gameid&gt;\n    &lt;version&gt;1.0&lt;/version&gt;\n    &lt;firstpublished&gt;2018&lt;/firstpublished&gt;\n    &lt;enablehyperlinks /&gt;\n    &lt;attr name=\"autodescription_youcango\" type=\"int\"&gt;0&lt;/attr&gt;\n    &lt;attr name=\"autodescription_description\" type=\"int\"&gt;1&lt;/attr&gt;\n    &lt;attr name=\"autodescription_youarein\" type=\"int\"&gt;0&lt;/attr&gt;\n    &lt;attr name=\"link_status\"&gt;on&lt;/attr&gt;\n    &lt;feature_advancedscripts /&gt;\n    &lt;inituserinterface type=\"script\"&gt;&lt;![CDATA[\n      JS.eval (\"if (typeof(linksEnabled)=='undefined'){var linksEnabled = true;} function updateCommandLinks(data) {     $('.commandlink').each(function (index, e) {         var $e = $(e);         if (!$(e).data('deactivated')) {             var elementid = $e.data('elementid');             var available = $.inArray(elementid, data) &gt; -1 || elementid.length == 0;             if (available) {                 if (linksEnabled) {$e.removeClass('disabled');}             } else {                 $e.addClass('disabled');             }         }     });$('.cmdlink').each(function(){\tif (!linksEnabled) {\t\t$(this).addClass('disabled');\t}});};\")\n      SetHyperlinkStatus (game.link_status)\n    ]]&gt;&lt;/inituserinterface&gt;\n    &lt;underlinehyperlinks /&gt;\n  &lt;/game&gt;\n  &lt;object name=\"room\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;isroom /&gt;\n    &lt;description&gt;You are in a {command:l:room}.&lt;/description&gt;\n    &lt;object name=\"player\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"editor_player\" /&gt;\n    &lt;/object&gt;\n    &lt;object name=\"bread bin\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n    &lt;/object&gt;\n    &lt;object name=\"has bin\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n  &lt;command name=\"links\"&gt;\n    &lt;pattern&gt;links #text#&lt;/pattern&gt;\n    &lt;script&gt;\n      SetHyperlinkStatus (text)\n    &lt;/script&gt;\n  &lt;/command&gt;\n  &lt;function name=\"SetHyperlinkStatus\" parameters=\"setting\"&gt;\n    if (setting = \"on\") {\n      bool = \"true\"\n    }\n    else {\n      bool = \"false\"\n    }\n    JS.eval (\"var linksEnabled = \"+bool+\";\")\n    if (bool = \"false\") {\n      game.suppresshyperlinks = true\n      game.link_status = \"off\"\n      JS.eval (\"$('.cmdlink,.commandlink').each(function(){$(this).addClass('disabled');});\")\n    }\n    else {\n      game.suppresshyperlinks = false\n      game.link_status = \"on\"\n    }\n  &lt;/function&gt;\n&lt;/asl&gt;\n</code></pre>\n\n",
      "PostDate": "2018-12-19T20:01:44.7827906Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "c989aef9-cb1b-4514-92de-a2696a01ba03",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "As far as I'm aware, the \"enable hyperlinks\" option in Quest controls whether `GetDisplayName(object)`, `{object:objectname}` and the core descriptions system generate links. It doesn't affect menus, or any command links you explicitly add to the text.\r\n\r\nIf you want to disable all links, you could use some javascript to modify the addText function so that it disables all links as they're printed:\r\n```\r\n$(function () {\r\n  var realAddText = addText;\r\n  turnHyperlinksOff = function () {\r\n    $('.cmdlink,.commandlink').addClass('disabled');\r\n    addText = function (text) {\r\n      text = $(text);\r\n      text.find('.cmdlink,.commandlink').addClass('disabled');\r\n      realAddText (text);\r\n    };\r\n  };\r\n  turnHyperlinksOff = function () {\r\n    addText = realAddText;\r\n  };\r\n});\r\n```\r\n(then activated using `JS.turnHyperlinksOff()` and `JS.turnHyperlinksOn()` from Quest)",
      "EditableFormat": "markdown",
      "HTML": "<p>As far as I'm aware, the \"enable hyperlinks\" option in Quest controls whether <code>GetDisplayName(object)</code>, <code>{object:objectname}</code> and the core descriptions system generate links. It doesn't affect menus, or any command links you explicitly add to the text.</p>\n<p>If you want to disable all links, you could use some javascript to modify the addText function so that it disables all links as they're printed:</p>\n<pre><code>$(function () {\n  var realAddText = addText;\n  turnHyperlinksOff = function () {\n    $('.cmdlink,.commandlink').addClass('disabled');\n    addText = function (text) {\n      text = $(text);\n      text.find('.cmdlink,.commandlink').addClass('disabled');\n      realAddText (text);\n    };\n  };\n  turnHyperlinksOff = function () {\n    addText = realAddText;\n  };\n});\n</code></pre>\n<p>(then activated using <code>JS.turnHyperlinksOff()</code> and <code>JS.turnHyperlinksOn()</code> from Quest)</p>\n\n",
      "PostDate": "2018-12-19T20:56:17.5647024Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "2dc86947-7e63-4c2b-8348-8b3c5abb6da1",
      "UserId": 199273,
      "Username": "DavyB",
      "AvatarUrl": "http://i.imgur.com/8BcaZCyb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thanks mrangel, I assume this should replace the code K.V. gave me to handle hyperlinks? \r\n\r\nI've been avoiding JavaScript and the documentation I've found does not spell out the details clearly enough for me. What is the best way to include this function in a game? \r\n\r\nI found that K.V.'s code covers most cases, though a couple of other oddities have turned up that I have still to explore. I'm hoping they will go away when I try out your code!",
      "EditableFormat": "markdown",
      "HTML": "<p>Thanks mrangel, I assume this should replace the code K.V. gave me to handle hyperlinks?</p>\n<p>I've been avoiding JavaScript and the documentation I've found does not spell out the details clearly enough for me. What is the best way to include this function in a game?</p>\n<p>I found that K.V.'s code covers most cases, though a couple of other oddities have turned up that I have still to explore. I'm hoping they will go away when I try out your code!</p>\n\n",
      "PostDate": "2018-12-20T09:52:21.3741056Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

{
  "Topic": {
    "TopicId": "foqv8xlvmuawhinhd2imwg",
    "ForumId": "10",
    "Title": "NPC Doing...",
    "LastUpdated": "2019-01-24T11:53:53.5832742Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "a2d5f0af-59b3-4b95-a750-0eec5f4f7b1a",
      "UserId": 304102,
      "Username": "Doctor Agon",
      "AvatarUrl": "http://i.imgur.com/Lzd3mOwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I know I've seen this on one of the forum questions, but I can't seem to find it.\r\nMaybe I'm using an old library as well.\r\n\r\nI've just set up an NPC, and at the bottom it says; 'Doing NPC...'\r\nI think I read somewhere that Pixie put this in as a check to see what the NPC was doing, but how do I get rid of the message.\r\nIs there a checkbox I can use or some coding that goes into the start script.\r\n\r\nAny help is appreciated.",
      "EditableFormat": "markdown",
      "HTML": "<p>I know I've seen this on one of the forum questions, but I can't seem to find it.<br>\nMaybe I'm using an old library as well.</p>\n<p>I've just set up an NPC, and at the bottom it says; 'Doing NPC...'<br>\nI think I read somewhere that Pixie put this in as a check to see what the NPC was doing, but how do I get rid of the message.<br>\nIs there a checkbox I can use or some coding that goes into the start script.</p>\n<p>Any help is appreciated.</p>\n\n",
      "PostDate": "2019-01-24T11:53:53.5832742Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "4a03629f-2297-493f-a8f1-350a073eccc3",
      "UserId": 304102,
      "Username": "Doctor Agon",
      "AvatarUrl": "http://i.imgur.com/Lzd3mOwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I thought I had then, rereading the documentation, it mentions ```game.npcdebug``` and setting it to either true or false. The information to help you debug what the npc is doing is displayed in blue.\r\n\r\nThis is something else. Arghhh",
      "EditableFormat": "markdown",
      "HTML": "<p>I thought I had then, rereading the documentation, it mentions <code>game.npcdebug</code> and setting it to either true or false. The information to help you debug what the npc is doing is displayed in blue.</p>\n<p>This is something else. Arghhh</p>\n\n",
      "PostDate": "2019-01-24T19:21:16.7600983Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "1370862e-3fcd-4c7d-a9d1-8b72b99fb8b7",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Looks like I left in a line I was using for debugging. Open the library up in a text editor, and delete line 96:\r\n\r\n```\r\n          msg(\"Doing \" + o.name)\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Looks like I left in a line I was using for debugging. Open the library up in a text editor, and delete line 96:</p>\n<pre><code>          msg(\"Doing \" + o.name)\n</code></pre>\n\n",
      "PostDate": "2019-01-24T20:35:43.8597099Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "8d489484-7c16-45a7-b709-63c2323a18c0",
      "UserId": 304102,
      "Username": "Doctor Agon",
      "AvatarUrl": "http://i.imgur.com/Lzd3mOwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Found it. Thanks Pixie.\r\nAlso, didn't realise there was a new version of 'NpcLib'. So updated that too.\r\nIs it still beta testing? Will the tutorial notes be updated too, or are they now included in the library on the various tabs?",
      "EditableFormat": "markdown",
      "HTML": "<p>Found it. Thanks Pixie.<br>\nAlso, didn't realise there was a new version of 'NpcLib'. So updated that too.<br>\nIs it still beta testing? Will the tutorial notes be updated too, or are they now included in the library on the various tabs?</p>\n\n",
      "PostDate": "2019-01-24T20:50:57.8953488Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "cd178a2b-d3a4-49cb-86e7-90f2be56eb00",
      "UserId": 304102,
      "Username": "Doctor Agon",
      "AvatarUrl": "http://i.imgur.com/Lzd3mOwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "One further question.\r\n\r\nI want my NPC character to patrol a route, starting from position A to B to C, then B and back to A and repeat.\r\n\r\nI thought I'd found the answer by inserting ```this.deletefromlist = false``` into the script at the bottom, but it doesn't appear to be working.\r\n\r\nWhat am I doing wrong.",
      "EditableFormat": "markdown",
      "HTML": "<p>One further question.</p>\n<p>I want my NPC character to patrol a route, starting from position A to B to C, then B and back to A and repeat.</p>\n<p>I thought I'd found the answer by inserting <code>this.deletefromlist = false</code> into the script at the bottom, but it doesn't appear to be working.</p>\n<p>What am I doing wrong.</p>\n\n",
      "PostDate": "2019-01-24T22:55:36.0893352Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "5c69519b-5f95-4fe8-9979-a325bf462315",
      "UserId": 282833,
      "Username": "Io",
      "AvatarUrl": "http://i.imgur.com/XVmdocTb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Way I'd do this is have the attribute NPC.RoomID as an Integer. So if say, A to B to C, then back to B, then to A, it goes something like this. And pardon my psuedocode:\r\n```\r\nSwitch based on NPC.RoomID:\r\ncase(1): Move NPC to A, set NPC.RoomID=2\r\ncase(2): Move NPC to B, set NPC.RoomID=3\r\ncase(3): Move NPC to C, set NPC.RoomID=4\r\ncase(4): Move NPC to B, set NPC.RoomID=1\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p>Way I'd do this is have the attribute NPC.RoomID as an Integer. So if say, A to B to C, then back to B, then to A, it goes something like this. And pardon my psuedocode:</p>\n<pre><code>Switch based on NPC.RoomID:\ncase(1): Move NPC to A, set NPC.RoomID=2\ncase(2): Move NPC to B, set NPC.RoomID=3\ncase(3): Move NPC to C, set NPC.RoomID=4\ncase(4): Move NPC to B, set NPC.RoomID=1\n</code></pre>\n\n",
      "PostDate": "2019-01-24T23:21:03.2142589Z",
      "LastEditDate": "2019-01-24T23:21:51.7346301Z",
      "link": null
    },
    {
      "PostId": "0a4fd42a-a6aa-4905-b355-7ee25868a9b1",
      "UserId": 304102,
      "Username": "Doctor Agon",
      "AvatarUrl": "http://i.imgur.com/Lzd3mOwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Let me clarify:\r\n\r\nThere is a tab called NPC Actions, I've put into the box at the top, 'List of actions to perform', \r\n```\r\nGoTo:RoomA\r\nGoTo:RoomB\r\nGoTo:RoomC\r\nGoTo:RoomB\r\nGoTo:RoomA\r\n```\r\nThen there is a box on the same tab at the bottom, 'NPC script (run with Npc Script)', where I have then inserted the code\r\n```this.deletefromlist = false```, not sure what I've done wrong, but the NPC character is not repeating the list of actions.\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Let me clarify:</p>\n<p>There is a tab called NPC Actions, I've put into the box at the top, 'List of actions to perform',</p>\n<pre><code>GoTo:RoomA\nGoTo:RoomB\nGoTo:RoomC\nGoTo:RoomB\nGoTo:RoomA\n</code></pre>\n<p>Then there is a box on the same tab at the bottom, 'NPC script (run with Npc Script)', where I have then inserted the code<br>\n<code>this.deletefromlist = false</code>, not sure what I've done wrong, but the NPC character is not repeating the list of actions.</p>\n\n",
      "PostDate": "2019-01-25T06:48:08.4411817Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "e573bdbb-d701-469e-8a09-013ec33548fc",
      "UserId": 304102,
      "Username": "Doctor Agon",
      "AvatarUrl": "http://i.imgur.com/Lzd3mOwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Further to my previous issue regarding having the NPC character repeat a pattern. I have come across another problem.\r\n\r\nAsk/Tell NPC to follow.\r\n\r\nThe NPC says okay, and looks at you expectantly. When I then move to a new location, I'm hit with the error message;\r\nError running script: Object reference not set to an instance of an object.\r\n\r\nAsking the NPC to sit or stand or crouch is ok, but asking the NPC to follow results in this message. Do I need to set up an attribute on the NPC.\r\n\r\nAny help with this question, and the previous one, will be greatly appreciated.\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Further to my previous issue regarding having the NPC character repeat a pattern. I have come across another problem.</p>\n<p>Ask/Tell NPC to follow.</p>\n<p>The NPC says okay, and looks at you expectantly. When I then move to a new location, I'm hit with the error message;<br>\nError running script: Object reference not set to an instance of an object.</p>\n<p>Asking the NPC to sit or stand or crouch is ok, but asking the NPC to follow results in this message. Do I need to set up an attribute on the NPC.</p>\n<p>Any help with this question, and the previous one, will be greatly appreciated.</p>\n\n",
      "PostDate": "2019-01-26T13:18:42.4070945Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "3ecd04ae-420e-46ec-b27c-8dcdb257b07d",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "### The stuff I see in the library which concerns following (ignoring the \"stop following\" bits):\r\n\r\n```\r\n  <command name=\"go\">\r\n    <pattern type=\"string\"><![CDATA[^go to (?<exit>.*)$|^go (?<exit>.*)$|^(?<exit>north|east|south|west|northeast|northwest|southeast|southwest|in|out|up|down|n|e|s|w|ne|nw|se|sw|o|u|d)$]]></pattern>\r\n    <unresolved>[UnresolvedLocation]</unresolved>\r\n    <script>\r\n      old = game.pov.parent\r\n      if (exit.visible) {\r\n        if (ExitCheck(exit)) {\r\n          // nothing\r\n        }\r\n        else if (exit.locked) {\r\n          msg (exit.lockmessage)\r\n        }\r\n        else if (exit.runscript) {\r\n          StandUp\r\n          if (HasScript(exit, \"script\")) {\r\n            do (exit, \"script\")\r\n          }\r\n        }\r\n        else if (exit.lookonly) {\r\n          msg ([UnresolvedLocation])\r\n        }\r\n        else {\r\n          StandUp\r\n          if (HasString(exit, \"message\")) {\r\n            if (not exit.message = \"\") {\r\n              if (game.clearscreenonroomenter) {\r\n                game.currentexitmessage = exit.message\r\n              }\r\n              else {\r\n                msg (exit.message)\r\n              }\r\n            }\r\n          }\r\n          game.pov.parent = exit.to\r\n        }\r\n      }\r\n      else {\r\n        msg ([UnresolvedLocation])\r\n      }\r\n```\r\n**THE BIT WHICH INVOLVES FOLLOWING:**\r\n```\r\n      if (not old = game.pov.parent) {\r\n        foreach (npc, FilterByAttribute(AllObjects(), \"following\", game.pov)) {\r\n          do (npc, \"followplayer\")\r\n        }\r\n      }\r\n```\r\n```\r\n    </script>\r\n</command>\r\n```\r\n\r\nNOTE:  I don't see ```followplayer``` anywhere else in the code in this library.\r\n\r\nPerhaps that is the missing script attribute?\r\n\r\n...or maybe that snippet should be:\r\n\r\n```\r\n      if (not old = game.pov.parent) {\r\n        foreach (npc, FilterByAttribute(AllObjects(), \"following\", game.pov)) {\r\n          NpcFollow (npc, npc.following)\r\n        }\r\n      }\r\n```\r\n***This is untested.***\r\n\r\n---\r\n#### The rest of this is just the other related code snippets (with no notes from me):\r\n\r\n```\r\n  <command name=\"cmd_tell_to_follow\">\r\n    <pattern type=\"string\"><![CDATA[^((tell|ask) (?<objectnpc>.*) to|(?<objectnpc>.*),) (follow me|follow)$]]></pattern>\r\n    <script>\r\n      if (not DoesInherit(objectnpc, \"NpcType\")) {\r\n        msg(DynamicTemplate(\"PosturesNotNpc\", objectnpc))\r\n      }\r\n      else {\r\n        do (objectnpc, \"requestfollow\")\r\n      }        \r\n    </script>\r\n</command>\r\n```\r\n\r\n---\r\n```\r\n    <requestfollow type=\"script\">\r\n      do (this, \"checkagreement\", QuickParams(\"command\", \"follow\"))\r\n      if (this.complies) {\r\n        if (this.following = game.pov) {\r\n          msg (\"'I am!' says \" + GetDefiniteName(this) + \".\")\r\n        }\r\n        else {\r\n          msg (\"'\" + this.yesmsg + \"' says \" + GetDefiniteName(this) + \", looking expectantly at you.\")\r\n          this.following = game.pov\r\n        }\r\n      }\r\n</requestfollow>\r\n```\r\n\r\n---\r\n\r\n---\r\n```\r\n  <function name=\"NpcFollow\" parameters=\"npc, obj\" type=\"boolean\">\r\n    if (not npc.parent = obj.parent) {\r\n      NpcGoTo(npc, obj.parent)\r\n    }\r\n    else if (HasAttribute(npc, \"followidle\")) {\r\n      msg(PickOneString(npc.followidle))\r\n    }\r\n    return (false)\r\n</function>\r\n```\r\n\r\n---\r\n",
      "EditableFormat": "markdown",
      "HTML": "<h3>The stuff I see in the library which concerns following (ignoring the \"stop following\" bits):</h3>\n<pre><code>  &lt;command name=\"go\"&gt;\n    &lt;pattern type=\"string\"&gt;&lt;![CDATA[^go to (?&lt;exit&gt;.*)$|^go (?&lt;exit&gt;.*)$|^(?&lt;exit&gt;north|east|south|west|northeast|northwest|southeast|southwest|in|out|up|down|n|e|s|w|ne|nw|se|sw|o|u|d)$]]&gt;&lt;/pattern&gt;\n    &lt;unresolved&gt;[UnresolvedLocation]&lt;/unresolved&gt;\n    &lt;script&gt;\n      old = game.pov.parent\n      if (exit.visible) {\n        if (ExitCheck(exit)) {\n          // nothing\n        }\n        else if (exit.locked) {\n          msg (exit.lockmessage)\n        }\n        else if (exit.runscript) {\n          StandUp\n          if (HasScript(exit, \"script\")) {\n            do (exit, \"script\")\n          }\n        }\n        else if (exit.lookonly) {\n          msg ([UnresolvedLocation])\n        }\n        else {\n          StandUp\n          if (HasString(exit, \"message\")) {\n            if (not exit.message = \"\") {\n              if (game.clearscreenonroomenter) {\n                game.currentexitmessage = exit.message\n              }\n              else {\n                msg (exit.message)\n              }\n            }\n          }\n          game.pov.parent = exit.to\n        }\n      }\n      else {\n        msg ([UnresolvedLocation])\n      }\n</code></pre>\n<p><strong>THE BIT WHICH INVOLVES FOLLOWING:</strong></p>\n<pre><code>      if (not old = game.pov.parent) {\n        foreach (npc, FilterByAttribute(AllObjects(), \"following\", game.pov)) {\n          do (npc, \"followplayer\")\n        }\n      }\n</code></pre>\n<pre><code>    &lt;/script&gt;\n&lt;/command&gt;\n</code></pre>\n<p>NOTE:  I don't see <code>followplayer</code> anywhere else in the code in this library.</p>\n<p>Perhaps that is the missing script attribute?</p>\n<p>...or maybe that snippet should be:</p>\n<pre><code>      if (not old = game.pov.parent) {\n        foreach (npc, FilterByAttribute(AllObjects(), \"following\", game.pov)) {\n          NpcFollow (npc, npc.following)\n        }\n      }\n</code></pre>\n<p><strong><em>This is untested.</em></strong></p>\n<hr>\n<h4>The rest of this is just the other related code snippets (with no notes from me):</h4>\n<pre><code>  &lt;command name=\"cmd_tell_to_follow\"&gt;\n    &lt;pattern type=\"string\"&gt;&lt;![CDATA[^((tell|ask) (?&lt;objectnpc&gt;.*) to|(?&lt;objectnpc&gt;.*),) (follow me|follow)$]]&gt;&lt;/pattern&gt;\n    &lt;script&gt;\n      if (not DoesInherit(objectnpc, \"NpcType\")) {\n        msg(DynamicTemplate(\"PosturesNotNpc\", objectnpc))\n      }\n      else {\n        do (objectnpc, \"requestfollow\")\n      }        \n    &lt;/script&gt;\n&lt;/command&gt;\n</code></pre>\n<hr>\n<pre><code>    &lt;requestfollow type=\"script\"&gt;\n      do (this, \"checkagreement\", QuickParams(\"command\", \"follow\"))\n      if (this.complies) {\n        if (this.following = game.pov) {\n          msg (\"'I am!' says \" + GetDefiniteName(this) + \".\")\n        }\n        else {\n          msg (\"'\" + this.yesmsg + \"' says \" + GetDefiniteName(this) + \", looking expectantly at you.\")\n          this.following = game.pov\n        }\n      }\n&lt;/requestfollow&gt;\n</code></pre>\n<hr>\n<hr>\n<pre><code>  &lt;function name=\"NpcFollow\" parameters=\"npc, obj\" type=\"boolean\"&gt;\n    if (not npc.parent = obj.parent) {\n      NpcGoTo(npc, obj.parent)\n    }\n    else if (HasAttribute(npc, \"followidle\")) {\n      msg(PickOneString(npc.followidle))\n    }\n    return (false)\n&lt;/function&gt;\n</code></pre>\n<hr>\n\n",
      "PostDate": "2019-01-26T13:45:01.4796871Z",
      "LastEditDate": "2019-01-26T13:47:02.9883601Z",
      "link": null
    },
    {
      "PostId": "59b48c67-f160-4b96-acee-4881ff81cb8c",
      "UserId": 304102,
      "Username": "Doctor Agon",
      "AvatarUrl": "http://i.imgur.com/Lzd3mOwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "That seems to work KV, but now the NPC won't stop following you, even when you tell it to stop following you, wait, desist or all other manner of obscenities, the NPC wont leave you alone.\r\n\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>That seems to work KV, but now the NPC won't stop following you, even when you tell it to stop following you, wait, desist or all other manner of obscenities, the NPC wont leave you alone.</p>\n\n",
      "PostDate": "2019-01-26T16:02:42.8445275Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "d5cfbaed-2342-42f6-a766-802c2ac62fd1",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Curses!\r\n\r\nHrmm...  I'm not around a PC, but maybe...\r\n\r\nIt's probably wise to avoid changing too much code, so, instead of changing that code to call the ```NpcFollow``` function, perhaps adding a ```followplayer``` script attribute to each NPC (a script which calls the ```NpcFollow``` function) would alter the outcome?\r\n\r\nHrmm...\r\n\r\nI'll have access to a PC this afternoon, and I'll see what I can deduce if no one has posted a solution by then.",
      "EditableFormat": "markdown",
      "HTML": "<p>Curses!</p>\n<p>Hrmm...  I'm not around a PC, but maybe...</p>\n<p>It's probably wise to avoid changing too much code, so, instead of changing that code to call the <code>NpcFollow</code> function, perhaps adding a <code>followplayer</code> script attribute to each NPC (a script which calls the <code>NpcFollow</code> function) would alter the outcome?</p>\n<p>Hrmm...</p>\n<p>I'll have access to a PC this afternoon, and I'll see what I can deduce if no one has posted a solution by then.</p>\n\n",
      "PostDate": "2019-01-26T18:30:42.7345429Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "6fad8eda-74d9-4d17-a1dd-5dfae3ee5f1d",
      "UserId": 304102,
      "Username": "Doctor Agon",
      "AvatarUrl": "http://i.imgur.com/Lzd3mOwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I tried altering 'requestwait' attribute of the NPC, changing the last else statement from\r\n```\r\nmsg (\"'\" + this.yesmsg + \"' says \" + GetDefiniteName(this) + \", tapping \" + this.possessive + \" foot.\")\r\nthis.following = game.pov\r\n```\r\nto\r\n```\r\nmsg (\"'\" + this.yesmsg + \"' says \" + GetDefiniteName(this) + \", tapping \" + this.possessive + \" foot.\")\r\nthis.following = null\r\n```\r\nand that seems to have done the trick.\r\n\r\nBut I also noted something else as I was messing about, trying different commands.\r\nWhen asking the NPC to sit, lie down, etc, the NPC does it. Then ask the NPC to follow, move to the next room, the NPC follows you to the next room, still sitting, lying down, etc.\r\n\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>I tried altering 'requestwait' attribute of the NPC, changing the last else statement from</p>\n<pre><code>msg (\"'\" + this.yesmsg + \"' says \" + GetDefiniteName(this) + \", tapping \" + this.possessive + \" foot.\")\nthis.following = game.pov\n</code></pre>\n<p>to</p>\n<pre><code>msg (\"'\" + this.yesmsg + \"' says \" + GetDefiniteName(this) + \", tapping \" + this.possessive + \" foot.\")\nthis.following = null\n</code></pre>\n<p>and that seems to have done the trick.</p>\n<p>But I also noted something else as I was messing about, trying different commands.<br>\nWhen asking the NPC to sit, lie down, etc, the NPC does it. Then ask the NPC to follow, move to the next room, the NPC follows you to the next room, still sitting, lying down, etc.</p>\n\n",
      "PostDate": "2019-01-26T18:40:54.2806253Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "72fac169-7c05-46b3-aee7-240d2145d6f8",
      "UserId": 304102,
      "Username": "Doctor Agon",
      "AvatarUrl": "http://i.imgur.com/Lzd3mOwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Also, just noted something else.\r\n\r\nIf the NPC, has a list of actions, and as it passes you(i.e. is in the same room as you, on it's way to complete its list of actions), you tell the NPC to follow, it carries on with its list of actions, then it follows you, (always the number of uncompleted actions behind, when you asked the NPC to follow), stalking you as it were, until you double back and are in the same room again.",
      "EditableFormat": "markdown",
      "HTML": "<p>Also, just noted something else.</p>\n<p>If the NPC, has a list of actions, and as it passes you(i.e. is in the same room as you, on it's way to complete its list of actions), you tell the NPC to follow, it carries on with its list of actions, then it follows you, (always the number of uncompleted actions behind, when you asked the NPC to follow), stalking you as it were, until you double back and are in the same room again.</p>\n\n",
      "PostDate": "2019-01-27T07:30:56.4467143Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "71ddcde1-f80c-45cc-b41f-91d6af5a63e6",
      "UserId": 304102,
      "Username": "Doctor Agon",
      "AvatarUrl": "http://i.imgur.com/Lzd3mOwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thought I was onto something then: I've modified the npc_type requestfollow script as follows\r\n```\r\ndo (this, \"checkagreement\", QuickParams(\"command\", \"follow\"))\r\nif (this.complies) {\r\n  if (this.following = game.pov) {\r\n    msg (\"'I am!' says \" + GetDefiniteName(this) + \".\")\r\n  }\r\n  else {\r\n    msg (\"'\" + this.yesmsg + \"' says \" + GetDefiniteName(this) + \", looking expectantly at you.\")\r\n    this.following = game.pov\r\n  }\r\n}\r\n// Checks to see if \"actions\" has been set up (meaning at least on action has been added) to avoid errors.\r\nif (HasAttribute(this, \"actions\")) {\r\n  if (ListCount(this.actions) > 0) {\r\n    foreach (s, this.actions) {\r\n      list remove (this.actions, s)\r\n      PrintIfDebug (this, \"Deleted\")\r\n    }\r\n  }\r\n}\r\n```\r\nThe NPC's list of actions is deleted, but now I get the error message\r\n'Collection was modified; enumeration operation may not execute.'\r\n\r\nRethink!!!\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Thought I was onto something then: I've modified the npc_type requestfollow script as follows</p>\n<pre><code>do (this, \"checkagreement\", QuickParams(\"command\", \"follow\"))\nif (this.complies) {\n  if (this.following = game.pov) {\n    msg (\"'I am!' says \" + GetDefiniteName(this) + \".\")\n  }\n  else {\n    msg (\"'\" + this.yesmsg + \"' says \" + GetDefiniteName(this) + \", looking expectantly at you.\")\n    this.following = game.pov\n  }\n}\n// Checks to see if \"actions\" has been set up (meaning at least on action has been added) to avoid errors.\nif (HasAttribute(this, \"actions\")) {\n  if (ListCount(this.actions) &gt; 0) {\n    foreach (s, this.actions) {\n      list remove (this.actions, s)\n      PrintIfDebug (this, \"Deleted\")\n    }\n  }\n}\n</code></pre>\n<p>The NPC's list of actions is deleted, but now I get the error message<br>\n'Collection was modified; enumeration operation may not execute.'</p>\n<p>Rethink!!!</p>\n\n",
      "PostDate": "2019-01-27T09:49:50.9713895Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "6fbcad42-be2b-4149-b3e2-e07b3572a0d4",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> 'Collection was modified; enumeration operation may not execute.'\r\n\r\nYou can't modify a list inside a foreach loop.\r\n\r\nYour code:\r\n```\r\n    foreach (s, this.actions) {\r\n      list remove (this.actions, s)\r\n      PrintIfDebug (this, \"Deleted\")\r\n    }\r\n```\r\ncould be updated to:\r\n```\r\n    foreach (s, ListExclude (this.actions, \"\")) {\r\n      list remove (this.actions, s)\r\n      PrintIfDebug (this, \"Deleted\")\r\n    }\r\n```\r\nforcing the `foreach` to apply to a *copy* of the list, allowing you to remove each one from the original list.\r\n\r\nOr you could use a much quicker way to remove all elements from a list:\r\n```\r\nthis.actions = NewList()\r\n```\r\n(or NewObjectList or NewStringList if appropriate)\r\n\r\n\r\n**(the remainder of this post is me going off at a tangent; but might be helpful to anyone having the same error in slightly different circumstances. Or might be something useful for you to know in future)**\r\n\r\nIf you want to print a message for each item removed, or if a future modification might require you to do something with each one before removing it, you could do:\r\n```\r\nwhile (ListCount (this.actions) > 0) {\r\n  s = ListItem (this.actions, 0)\r\n  list remove (this.actions, s)\r\n  PrintIfDebug (this, \"Deleted \"+ToString(s))\r\n}\r\n```\r\n\r\n(and I'm completely digressing now, but a useful paradigm if you want to test and remove some elements from a list would be:\r\n```\r\ni = 0;\r\nwhile (ListCount (this.actions) > i) {\r\n  s = ListItem (this.actions, i)\r\n  if (IsUrgentAction (s)) {\r\n    i = i + 1\r\n    PrintIfDebug (this, \"Didn't delete \"+ToString(s))\r\n  }\r\n  else {\r\n    list remove (this.actions, s)\r\n    PrintIfDebug (this, \"Deleted \"+ToString(s))\r\n  }\r\n}\r\n```\r\n(this might be useful if some actions are \"urgent\". For example, an NPC who is on fire might still want to put himself out before following you, but forget all other queued actions. The variable `i` is only incremented if an item remains in the list, because if you remove item 0 from the list then the next item is now in slot 0. I know it's a silly example, but the \"remove an item or increment the list counter\" loop is a useful trick to know)",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>'Collection was modified; enumeration operation may not execute.'</p>\n</blockquote>\n<p>You can't modify a list inside a foreach loop.</p>\n<p>Your code:</p>\n<pre><code>    foreach (s, this.actions) {\n      list remove (this.actions, s)\n      PrintIfDebug (this, \"Deleted\")\n    }\n</code></pre>\n<p>could be updated to:</p>\n<pre><code>    foreach (s, ListExclude (this.actions, \"\")) {\n      list remove (this.actions, s)\n      PrintIfDebug (this, \"Deleted\")\n    }\n</code></pre>\n<p>forcing the <code>foreach</code> to apply to a <em>copy</em> of the list, allowing you to remove each one from the original list.</p>\n<p>Or you could use a much quicker way to remove all elements from a list:</p>\n<pre><code>this.actions = NewList()\n</code></pre>\n<p>(or NewObjectList or NewStringList if appropriate)</p>\n<p><strong>(the remainder of this post is me going off at a tangent; but might be helpful to anyone having the same error in slightly different circumstances. Or might be something useful for you to know in future)</strong></p>\n<p>If you want to print a message for each item removed, or if a future modification might require you to do something with each one before removing it, you could do:</p>\n<pre><code>while (ListCount (this.actions) &gt; 0) {\n  s = ListItem (this.actions, 0)\n  list remove (this.actions, s)\n  PrintIfDebug (this, \"Deleted \"+ToString(s))\n}\n</code></pre>\n<p>(and I'm completely digressing now, but a useful paradigm if you want to test and remove some elements from a list would be:</p>\n<pre><code>i = 0;\nwhile (ListCount (this.actions) &gt; i) {\n  s = ListItem (this.actions, i)\n  if (IsUrgentAction (s)) {\n    i = i + 1\n    PrintIfDebug (this, \"Didn't delete \"+ToString(s))\n  }\n  else {\n    list remove (this.actions, s)\n    PrintIfDebug (this, \"Deleted \"+ToString(s))\n  }\n}\n</code></pre>\n<p>(this might be useful if some actions are \"urgent\". For example, an NPC who is on fire might still want to put himself out before following you, but forget all other queued actions. The variable <code>i</code> is only incremented if an item remains in the list, because if you remove item 0 from the list then the next item is now in slot 0. I know it's a silly example, but the \"remove an item or increment the list counter\" loop is a useful trick to know)</p>\n\n",
      "PostDate": "2019-01-27T14:36:24.7845942Z",
      "LastEditDate": "2019-01-27T22:26:45.7189421Z",
      "link": null
    },
    {
      "PostId": "c5b4b2aa-3e29-48e6-9df8-5b1b6d17b422",
      "UserId": 304102,
      "Username": "Doctor Agon",
      "AvatarUrl": "http://i.imgur.com/Lzd3mOwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thanks mrangel, your first code\r\n```\r\nforeach (s, ListExclude (this.actions, null)) {\r\n      list remove (this.actions, s)\r\n      PrintIfDebug (this, \"Deleted\")\r\n    }\r\n```\r\nproduced an error, too ambiguous, but the second code\r\n```\r\nwhile (ListCount (this.actions) > 0) {\r\n  s = ListItem (this.actions, 0)\r\n  list remove (this.actions, s)\r\n  PrintIfDebug (this, \"Deleted \"+ToString(s))\r\n}\r\n```\r\nseems to work, now to put it into the other bits of code it might affect, and alter the fact that the NPC can follow you while their lying down, and WAHEY!!!\r\n\r\nAnyone got any ideas on how I can have a list of actions repeat, as I posted a bit further up the page. \r\nI get myself side-tracked with little bits of coding.",
      "EditableFormat": "markdown",
      "HTML": "<p>Thanks mrangel, your first code</p>\n<pre><code>foreach (s, ListExclude (this.actions, null)) {\n      list remove (this.actions, s)\n      PrintIfDebug (this, \"Deleted\")\n    }\n</code></pre>\n<p>produced an error, too ambiguous, but the second code</p>\n<pre><code>while (ListCount (this.actions) &gt; 0) {\n  s = ListItem (this.actions, 0)\n  list remove (this.actions, s)\n  PrintIfDebug (this, \"Deleted \"+ToString(s))\n}\n</code></pre>\n<p>seems to work, now to put it into the other bits of code it might affect, and alter the fact that the NPC can follow you while their lying down, and WAHEY!!!</p>\n<p>Anyone got any ideas on how I can have a list of actions repeat, as I posted a bit further up the page.<br>\nI get myself side-tracked with little bits of coding.</p>\n\n",
      "PostDate": "2019-01-27T16:35:13.1089291Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "4d51c4df-46cf-478e-a092-980510e6bcaa",
      "UserId": 304102,
      "Username": "Doctor Agon",
      "AvatarUrl": "http://i.imgur.com/Lzd3mOwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Sorry to harp on about this thing, but once I get something into my head, sometimes I can't let go.\r\n\r\nIf you tell an NPC character to 'follow you', then change your mind and tell them to 'sit down' or whatever, then move in any direction, would you expect that character to follow you?\r\n\r\nAt the moment they follow you, still in the posture you have just given them.\r\n\r\nBut, I was thinking, maybe they should still be stuck there, until you again ask/tell that NPC character to 'follow you.\r\n\r\nAny thoughts...",
      "EditableFormat": "markdown",
      "HTML": "<p>Sorry to harp on about this thing, but once I get something into my head, sometimes I can't let go.</p>\n<p>If you tell an NPC character to 'follow you', then change your mind and tell them to 'sit down' or whatever, then move in any direction, would you expect that character to follow you?</p>\n<p>At the moment they follow you, still in the posture you have just given them.</p>\n<p>But, I was thinking, maybe they should still be stuck there, until you again ask/tell that NPC character to 'follow you.</p>\n<p>Any thoughts...</p>\n\n",
      "PostDate": "2019-01-27T19:11:51.7460204Z",
      "LastEditDate": "2019-01-27T19:12:21.1029388Z",
      "link": null
    },
    {
      "PostId": "a6cd2d21-cc61-4a0b-b917-e74a9d0ec5e5",
      "UserId": 282833,
      "Username": "Io",
      "AvatarUrl": "http://i.imgur.com/XVmdocTb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I would indeed expect them to just sit in one place until you tell them to again follow you. The description you gave gives me the impression of someone sitting on air, sliding along the ground after you like a bad flash animation.",
      "EditableFormat": "markdown",
      "HTML": "<p>I would indeed expect them to just sit in one place until you tell them to again follow you. The description you gave gives me the impression of someone sitting on air, sliding along the ground after you like a bad flash animation.</p>\n\n",
      "PostDate": "2019-01-28T15:28:19.451745Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "d02593b7-2ee8-4c07-9790-6b57238c54c7",
      "UserId": 304102,
      "Username": "Doctor Agon",
      "AvatarUrl": "http://i.imgur.com/Lzd3mOwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Yes, If there is, lets say a bed in the room, you tell the NPC to get on the bed, displayed in the 'Places and Objects' box, will be\r\nNPC (reclining on bed)\r\ntell NPC to follow, Okay. You then move and the NPC follows you, but it still says _'NPC (reclining on bed)'_.\r\nIf you tell them to get of the bed, your met with the message, _'I can't see that (bed)'_\r\n\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Yes, If there is, lets say a bed in the room, you tell the NPC to get on the bed, displayed in the 'Places and Objects' box, will be<br>\nNPC (reclining on bed)<br>\ntell NPC to follow, Okay. You then move and the NPC follows you, but it still says <em>'NPC (reclining on bed)'</em>.<br>\nIf you tell them to get of the bed, your met with the message, <em>'I can't see that (bed)'</em></p>\n\n",
      "PostDate": "2019-01-28T19:21:08.4039702Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

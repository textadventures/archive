{
  "Topic": {
    "TopicId": "a393qorxxeyokj46x8sdzq",
    "ForumId": "10",
    "Title": "LiftLib5.4 problem",
    "LastUpdated": "2018-02-14T20:00:57.0981845Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "016ed34f-9209-4dc7-a384-94eaa14a8c11",
      "UserId": 344046,
      "Username": "baskham",
      "AvatarUrl": "https://secure.gravatar.com/avatar/7689475b10ef3f61ec180330cc180daa?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Hi.\r\n\r\nI have been playing around with LiftLib5.4 a bit.\r\nIt looks like a very neat way to handle elevators.\r\n\r\nBut I have a couple of issues.\r\n\r\n1. If the map is enabled, a load of errormsgs will occur when exiting the lift.\r\nLike this:\r\n\"Error running script: Error evaluating expression 'DictionaryItem(coordinates, coordinate)': The given key was not present in the dictionary.\"\r\nI am guessing this is because Quest can't handle being dropped in a new location.\r\nBut is there a way around this, or will I just have to go without the map?\r\n\r\n2. When the lift has moved to a new location it just displays the arrival message.\r\nIs there a way to print the room description for the liftroom incl the hyperlink to the exit?\r\n\r\n3. I can't figure out how to translate the Press command for a liftbutton.\r\ni have tried adding it to the verb template in the lib. And I have tried adding the proper word (tryk) to the displayverb list.\r\nBut no success.\r\nAnd as a sidenote, it would be great if clicking the link for the button would just activate it instead of presenting a -item menu.\r\nBut I guess that is to much to ask :-D\r\n\r\nAnyway.\r\nI am having a ball playing with Quest.\r\nThank you so much for keeping it alive.\r\n\r\nBR\r\nBenny.",
      "EditableFormat": "markdown",
      "HTML": "<p>Hi.</p>\n<p>I have been playing around with LiftLib5.4 a bit.<br>\nIt looks like a very neat way to handle elevators.</p>\n<p>But I have a couple of issues.</p>\n<ol>\n<li>\n<p>If the map is enabled, a load of errormsgs will occur when exiting the lift.<br>\nLike this:<br>\n\"Error running script: Error evaluating expression 'DictionaryItem(coordinates, coordinate)': The given key was not present in the dictionary.\"<br>\nI am guessing this is because Quest can't handle being dropped in a new location.<br>\nBut is there a way around this, or will I just have to go without the map?</p>\n</li>\n<li>\n<p>When the lift has moved to a new location it just displays the arrival message.<br>\nIs there a way to print the room description for the liftroom incl the hyperlink to the exit?</p>\n</li>\n<li>\n<p>I can't figure out how to translate the Press command for a liftbutton.<br>\ni have tried adding it to the verb template in the lib. And I have tried adding the proper word (tryk) to the displayverb list.<br>\nBut no success.<br>\nAnd as a sidenote, it would be great if clicking the link for the button would just activate it instead of presenting a -item menu.<br>\nBut I guess that is to much to ask :-D</p>\n</li>\n</ol>\n<p>Anyway.<br>\nI am having a ball playing with Quest.<br>\nThank you so much for keeping it alive.</p>\n<p>BR<br>\nBenny.</p>\n\n",
      "PostDate": "2018-02-14T20:00:57.0981845Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "e8626607-ab02-41d3-ad65-5c0926b6fe8b",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I have just updated LiftLib, and the instructions, so some of this will be easier. The instructions have also moved, and are now here:\r\nhttps://github.com/ThePix/quest/wiki/Library:-Lifts\r\n\r\n1. The map has problems when we try to do stuff that is a little odd. Take a look at the Teleporting section of the tutorial; one of the solutions there may be suitable and may work. I have never used the map with LiftLib, so it may take some trial and error I am afraid.\r\nhttp://docs.textadventures.co.uk/quest/showing_a_map.html\r\n\r\n2. You can now override the `Arrival` function to do this; see the instructions.\r\n\r\n3. The updated instructions now explains how to do this.\r\n\r\nYou could set the buttons to be scenery, which would stop Quest putting them in the room descriptions (they would also not appear in the inventory pane). Then you could have the buttons in the room description you write, with a command link.\r\n\r\nYou can see two buttons, one marked {command:press first floor button:first floor}, the other {command:press second floor button:second floor}",
      "EditableFormat": "markdown",
      "HTML": "<p>I have just updated LiftLib, and the instructions, so some of this will be easier. The instructions have also moved, and are now here:<br>\nhttps://github.com/ThePix/quest/wiki/Library:-Lifts</p>\n<ol>\n<li>\n<p>The map has problems when we try to do stuff that is a little odd. Take a look at the Teleporting section of the tutorial; one of the solutions there may be suitable and may work. I have never used the map with LiftLib, so it may take some trial and error I am afraid.<br>\nhttp://docs.textadventures.co.uk/quest/showing_a_map.html</p>\n</li>\n<li>\n<p>You can now override the <code>Arrival</code> function to do this; see the instructions.</p>\n</li>\n<li>\n<p>The updated instructions now explains how to do this.</p>\n</li>\n</ol>\n<p>You could set the buttons to be scenery, which would stop Quest putting them in the room descriptions (they would also not appear in the inventory pane). Then you could have the buttons in the room description you write, with a command link.</p>\n<p>You can see two buttons, one marked {command:press first floor button:first floor}, the other {command:press second floor button:second floor}</p>\n\n",
      "PostDate": "2018-02-15T08:43:56.3721522Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "78d343dd-764e-4dd9-acb5-3358835ab24f",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I'm thinking that when the current floor changes, you could add the change in floor numbers onto the room's z coordinate; then call `Grid_CalculateMapCoordinates` and `Grid_Redraw` (which I think should be efficient to make it calculate the coordinates for the room outside the lift on the destination floor).\r\nPossibly checking if the room outside already has coordinates, and if so change the lift's coordinates to be adjacent to that room; but that would be a bit more code.",
      "EditableFormat": "markdown",
      "HTML": "<p>I'm thinking that when the current floor changes, you could add the change in floor numbers onto the room's z coordinate; then call <code>Grid_CalculateMapCoordinates</code> and <code>Grid_Redraw</code> (which I think should be efficient to make it calculate the coordinates for the room outside the lift on the destination floor).<br>\nPossibly checking if the room outside already has coordinates, and if so change the lift's coordinates to be adjacent to that room; but that would be a bit more code.</p>\n\n",
      "PostDate": "2018-02-15T10:57:45.307348Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "7b188705-8609-47ec-b133-0b7efb571e0f",
      "UserId": 344046,
      "Username": "baskham",
      "AvatarUrl": "https://secure.gravatar.com/avatar/7689475b10ef3f61ec180330cc180daa?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thank you for the new version.\r\nI am impressed with the speed of updates here :-)\r\n\r\nBut.\r\nThere seems to be a problem.\r\nI have implemented a lift.\r\nI have not done anything with translations or descriptions.\r\nJust added a lift, exits and buttons as described.\r\n\r\nBut when i stand in the elevator and press a button, i get the msg:\r\n\"Error running script: Error compiling expression 'notmoved': Unknown object or variable 'notmoved'\"\r\n\r\nIf I then walk out of the elevator I get:\r\n\"Error running script: Error compiling expression 'not this.leavingmsg = \"\"': Unknown object or variable 'this'\"\r\nBut the elevator has actually moved.\r\nI get the correct room description for the new floor.\r\n\r\nBR Benny",
      "EditableFormat": "markdown",
      "HTML": "<p>Thank you for the new version.<br>\nI am impressed with the speed of updates here :-)</p>\n<p>But.<br>\nThere seems to be a problem.<br>\nI have implemented a lift.<br>\nI have not done anything with translations or descriptions.<br>\nJust added a lift, exits and buttons as described.</p>\n<p>But when i stand in the elevator and press a button, i get the msg:<br>\n\"Error running script: Error compiling expression 'notmoved': Unknown object or variable 'notmoved'\"</p>\n<p>If I then walk out of the elevator I get:<br>\n\"Error running script: Error compiling expression 'not this.leavingmsg = \"\"': Unknown object or variable 'this'\"<br>\nBut the elevator has actually moved.<br>\nI get the correct room description for the new floor.</p>\n<p>BR Benny</p>\n\n",
      "PostDate": "2018-02-15T18:43:53.8618733Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "d1779aa0-5c72-498e-9665-b8520037bc9b",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "At the very end of the ```PressButton()``` function:\r\n\r\nChange:\r\n```\r\n      if (not silently) {\r\n        Arrival(button, s, notmoved)\r\n      }\r\n```\r\n\r\nTo:\r\n\r\n```\r\n      if (not silently) {\r\n        Arrival(button, s, moved)\r\n      }\r\n```\r\n\r\n\r\n---\r\nThen...\r\n\r\nIn the library (or in full code view), replace ```LeavingTheLift()``` with this (or just add the parameter \"this\"):\r\n\r\n```\r\n  <function name=\"LeavingTheLift\" parameters=\"this\">\r\n    if (not this.leavingmsg = \"\") {\r\n      msg (this.leavingmsg)\r\n    }\r\n\t</function>\r\n```\r\n\r\n\r\n---\r\nFinally, change  the ```onexit``` script on the \"liftroom\" type to this:\r\n\r\n\r\n```\r\n <type name=\"liftroom\">\r\n    <current_floor type=\"int\">1</current_floor>\r\n    <usage_count type=\"int\">0</usage_count>\r\n    <lockexits type=\"boolean\">false</lockexits>\r\n    <goingup>The lift ascends to ###.</goingup>\r\n    <goingdown>The lift descends to ###.</goingdown>\r\n    <leavingmsg type=\"string\"></leavingmsg>\r\n    <samefloor>Nothing happens. Perhaps because you are already on ###.</samefloor>\r\n    <onexit type=\"script\">\r\n      LeavingTheLift(this)\r\n    </onexit>\r\n  </type>\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p>At the very end of the <code>PressButton()</code> function:</p>\n<p>Change:</p>\n<pre><code>      if (not silently) {\n        Arrival(button, s, notmoved)\n      }\n</code></pre>\n<p>To:</p>\n<pre><code>      if (not silently) {\n        Arrival(button, s, moved)\n      }\n</code></pre>\n<hr>\n<p>Then...</p>\n<p>In the library (or in full code view), replace <code>LeavingTheLift()</code> with this (or just add the parameter \"this\"):</p>\n<pre><code>  &lt;function name=\"LeavingTheLift\" parameters=\"this\"&gt;\n    if (not this.leavingmsg = \"\") {\n      msg (this.leavingmsg)\n    }\n\t&lt;/function&gt;\n</code></pre>\n<hr>\n<p>Finally, change  the <code>onexit</code> script on the \"liftroom\" type to this:</p>\n<pre><code> &lt;type name=\"liftroom\"&gt;\n    &lt;current_floor type=\"int\"&gt;1&lt;/current_floor&gt;\n    &lt;usage_count type=\"int\"&gt;0&lt;/usage_count&gt;\n    &lt;lockexits type=\"boolean\"&gt;false&lt;/lockexits&gt;\n    &lt;goingup&gt;The lift ascends to ###.&lt;/goingup&gt;\n    &lt;goingdown&gt;The lift descends to ###.&lt;/goingdown&gt;\n    &lt;leavingmsg type=\"string\"&gt;&lt;/leavingmsg&gt;\n    &lt;samefloor&gt;Nothing happens. Perhaps because you are already on ###.&lt;/samefloor&gt;\n    &lt;onexit type=\"script\"&gt;\n      LeavingTheLift(this)\n    &lt;/onexit&gt;\n  &lt;/type&gt;\n</code></pre>\n\n",
      "PostDate": "2018-02-15T20:13:01.1858298Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "884eca3d-28be-4b47-aadd-f40a191d1f07",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Going by MrAngel's suggestion and the \"showing a map\" guide, I ended up with a script which I think would work if the lift actually moved.\r\n\r\nThe way it is now, you can remove all the grid functions, and everything works the same.\r\n\r\nI have a different image set for each room on a different level.\r\n\r\nWhen you move up or down in the lift, the map doesn't change until you exit the lift.  At that point, the images behave correctly with or without adding the bits including ```Grid_SetGridCoordinateForPlayer```.\r\n\r\n<details>\r\n\r\n\r\n```\r\n  <function name=\"_PressButton\" parameters=\"button, silently\">\r\n      exit = ObjectListItem (ScopeExitsForRoom (button.parent), 0)\r\n      current = exit.to\r\n      current_button = null\r\n      foreach (o, GetDirectChildren(button.parent)) {\r\n        if (o.destination = current) current_button = o\r\n      }\r\n      if (exit.to = button.destination) {\r\n        moved = false\r\n        s = button.parent.samefloor\r\n      }\r\n      else {\r\n        moved = true\r\n\t\tlastFloor = current.name\r\n\t\tlastFloor = GetObject(lastFloor)\r\n        exit.to = button.destination\r\n        if (button.parent.current_floor > button.floor) {\r\n\t\t  if (game.gridmap) {\r\n\t\t\tGrid_SetGridCoordinateForPlayer (game.pov, lastFloor, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, exit.to, \"z\")+1)\r\n\t      }\r\n          s = button.parent.goingdown\r\n        }\r\n        else {\r\n\t\t  if (game.gridmap) {\r\n\t\t    Grid_SetGridCoordinateForPlayer (game.pov, exit.to, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, lastFloor, \"z\")+1)\r\n\t      }\r\n          s = button.parent.goingup\r\n        }\r\n        button.parent.current_floor = button.floor\r\n        if (not current_button = null) {\r\n          if (HasString(current_button, \"departure\")) {\r\n            s = current_button.departure + \" \" + s\r\n          }\r\n        }\r\n        if (HasString(button, \"arrival\")) {\r\n          s = s + \" \" + button.arrival\r\n        }\r\n        button.parent.usage_count = button.parent.usage_count + 1\r\n      }\r\n      // prepend the button pressing message\r\n      s = button.pressmsg + \" \" + s\r\n      // Swap ### for the floor name\r\n      if (HasString(button, \"floorname\")) {\r\n        s = Replace (s, \"###\", ToString (button.floorname))\r\n      }\r\n      else {\r\n        s = Replace (s, \"###\", \"floor \" + button.floor)\r\n      }\r\n      if (not silently) {\r\n        Arrival(button, s, moved)\r\n      }\r\n\t</function>\r\n```\r\n\r\n</details>\r\n\r\n---\r\nAdding ```Grid_Redraw()``` didn't make any difference, either.\r\n\r\n---\r\nWhere is the \"z\" coordinate coming from?\r\n\r\nI've been poring over the grid functions, but I can't find the origin of \"z\".",
      "EditableFormat": "markdown",
      "HTML": "<p>Going by MrAngel's suggestion and the \"showing a map\" guide, I ended up with a script which I think would work if the lift actually moved.</p>\n<p>The way it is now, you can remove all the grid functions, and everything works the same.</p>\n<p>I have a different image set for each room on a different level.</p>\n<p>When you move up or down in the lift, the map doesn't change until you exit the lift.  At that point, the images behave correctly with or without adding the bits including <code>Grid_SetGridCoordinateForPlayer</code>.</p>\n<details>\n<pre><code>  &lt;function name=\"_PressButton\" parameters=\"button, silently\"&gt;\n      exit = ObjectListItem (ScopeExitsForRoom (button.parent), 0)\n      current = exit.to\n      current_button = null\n      foreach (o, GetDirectChildren(button.parent)) {\n        if (o.destination = current) current_button = o\n      }\n      if (exit.to = button.destination) {\n        moved = false\n        s = button.parent.samefloor\n      }\n      else {\n        moved = true\n\t\tlastFloor = current.name\n\t\tlastFloor = GetObject(lastFloor)\n        exit.to = button.destination\n        if (button.parent.current_floor &gt; button.floor) {\n\t\t  if (game.gridmap) {\n\t\t\tGrid_SetGridCoordinateForPlayer (game.pov, lastFloor, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, exit.to, \"z\")+1)\n\t      }\n          s = button.parent.goingdown\n        }\n        else {\n\t\t  if (game.gridmap) {\n\t\t    Grid_SetGridCoordinateForPlayer (game.pov, exit.to, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, lastFloor, \"z\")+1)\n\t      }\n          s = button.parent.goingup\n        }\n        button.parent.current_floor = button.floor\n        if (not current_button = null) {\n          if (HasString(current_button, \"departure\")) {\n            s = current_button.departure + \" \" + s\n          }\n        }\n        if (HasString(button, \"arrival\")) {\n          s = s + \" \" + button.arrival\n        }\n        button.parent.usage_count = button.parent.usage_count + 1\n      }\n      // prepend the button pressing message\n      s = button.pressmsg + \" \" + s\n      // Swap ### for the floor name\n      if (HasString(button, \"floorname\")) {\n        s = Replace (s, \"###\", ToString (button.floorname))\n      }\n      else {\n        s = Replace (s, \"###\", \"floor \" + button.floor)\n      }\n      if (not silently) {\n        Arrival(button, s, moved)\n      }\n\t&lt;/function&gt;\n</code></pre>\n</details>\n<hr>\n<p>Adding <code>Grid_Redraw()</code> didn't make any difference, either.</p>\n<hr>\n<p>Where is the \"z\" coordinate coming from?</p>\n<p>I've been poring over the grid functions, but I can't find the origin of \"z\".</p>\n\n",
      "PostDate": "2018-02-15T21:05:29.1084048Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "27c5c670-02f9-447e-9309-888c4672b60f",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> Where is the \"z\" coordinate coming from?\r\nI've been poring over the grid functions, but I can't find the origin of \"z\".\r\n\r\nLooks like it's increased/decreased by Grid_CalculateMapCoordinates when it sees an exit that inherits the up/down directions.\r\n\r\nI was thinking of something like ...\r\n```\r\nGrid_SetGridCoordinateForPlayer (game.pov, button.parent, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, button.parent, \"z\") + button.floor - button.parent.current_floor)\r\n\r\nGrid_CalculateMapCoordinates (button.parent, game.pov)\r\n\r\nGrid_Redraw()\r\n```\r\nChanges the z coordinate of the lift itself, so it's drawn on the floor you last got out of it on.\r\n\r\n(Though if I was building a library like this, I'd likely have the buttons display a message and change `current_floor`, and give the lift room a `changedcurrent_floor` script that handles moving the exits. More cleanly separating the button logic (which a user might want to change; such as having lockable buttons) from the exit-and-grid-moving logic (which are unlikely to need changing))",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>Where is the \"z\" coordinate coming from?<br>\nI've been poring over the grid functions, but I can't find the origin of \"z\".</p>\n</blockquote>\n<p>Looks like it's increased/decreased by Grid_CalculateMapCoordinates when it sees an exit that inherits the up/down directions.</p>\n<p>I was thinking of something like ...</p>\n<pre><code>Grid_SetGridCoordinateForPlayer (game.pov, button.parent, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, button.parent, \"z\") + button.floor - button.parent.current_floor)\n\nGrid_CalculateMapCoordinates (button.parent, game.pov)\n\nGrid_Redraw()\n</code></pre>\n<p>Changes the z coordinate of the lift itself, so it's drawn on the floor you last got out of it on.</p>\n<p>(Though if I was building a library like this, I'd likely have the buttons display a message and change <code>current_floor</code>, and give the lift room a <code>changedcurrent_floor</code> script that handles moving the exits. More cleanly separating the button logic (which a user might want to change; such as having lockable buttons) from the exit-and-grid-moving logic (which are unlikely to need changing))</p>\n\n",
      "PostDate": "2018-02-15T23:12:08.847331Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "0d5a6a89-c8dd-4981-a8f5-e0d02049ed8c",
      "UserId": 248029,
      "Username": "Anonynn",
      "AvatarUrl": "https://i.imgur.com/1xu84dwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I'm confused why this is even a library? Can't you just make a bunch of up rooms and lock them, and then at the lock ask what floor the player would like to go to, correspond those floors with the rooms and then add some description that says something like...\"you pass rooms 43, 44, 45, 46, 47, 48 and arrive at floor 49 and vice versa for going to any of the other rooms. Just curious is all :) Unless it was an exercise for coding or something.\r\n\r\nAnonynn. ",
      "EditableFormat": "markdown",
      "HTML": "<p>I'm confused why this is even a library? Can't you just make a bunch of up rooms and lock them, and then at the lock ask what floor the player would like to go to, correspond those floors with the rooms and then add some description that says something like...\"you pass rooms 43, 44, 45, 46, 47, 48 and arrive at floor 49 and vice versa for going to any of the other rooms. Just curious is all :) Unless it was an exercise for coding or something.</p>\n<p>Anonynn.</p>\n\n",
      "PostDate": "2018-02-16T04:03:34.0032572Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "bfd52e1d-addf-407a-afd8-9f33a327e4ab",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I couldn't get the grid to behave correctly with that library (which is due to my lack of knowledge concerning the grid), so I made this one (which is inferior (and is an exercise for coding or something), but seems to work (tested offline only)):\r\n\r\nElevatorLib.aslx\r\nhttps://gist.github.com/KVonGit/44e6fc640237dedcbed361146ceaabfd\r\n\r\nElevatorLibTester.aslx\r\nhttps://gist.github.com/KVonGit/b0d72e81d9c82c38aad7056a93189c05\r\n\r\nTest it out online (seems to work online or offline):\r\nhttp://textadventures.co.uk/games/view/ztjksxjmbeugnybfaqkgxa/elevatorlibtester\r\n\r\n---\r\nThis works with GridImageLib, too:\r\n\r\nhttps://gist.github.com/KVonGit/2851a12ee553599d8e7ee80939227ed5#file-gridimagelib-aslx\r\n\r\n---\r\nI just now saw mrangel's last post.\r\n\r\nI'll try that out on LiftLib and return.\r\n\r\n---\r\n**UPDATE**\r\n\r\nI added mrangel's code to **LiftLib**, and it works on the way up, but using the lift after reaching the top messed all the layers up.  (I'm quite certain I didn't put the code in the right place.)\r\n\r\n\r\n<details>\r\n\r\n```\r\n      else {\r\n        moved = true\r\n\t\tlastFloor = current.name\r\n\t\tlastFloor = GetObject(lastFloor)\r\n        exit.to = button.destination\r\n        if (button.parent.current_floor > button.floor) {\r\n\t\t  if (game.gridmap) {\r\n\t\t\tGrid_SetGridCoordinateForPlayer (game.pov, button.parent, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, button.parent, \"z\") + button.floor - button.parent.current_floor)\r\n\r\n\t\t\tGrid_CalculateMapCoordinates (button.parent, game.pov)\r\n\r\n\t\t\tGrid_Redraw()\r\n\t      }\r\n          s = button.parent.goingdown\r\n        }\r\n        else {\r\n\t\t  if (game.gridmap) {\r\n\t\t    Grid_SetGridCoordinateForPlayer (game.pov, button.parent, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, button.parent, \"z\") + button.floor - button.parent.current_floor)\r\n\r\n\t\t\tGrid_CalculateMapCoordinates (button.parent, game.pov)\r\n\r\n\t\t\tGrid_Redraw()\r\n\t      }\r\n          s = button.parent.goingup\r\n        }\r\n```\r\n\r\n</details>",
      "EditableFormat": "markdown",
      "HTML": "<p>I couldn't get the grid to behave correctly with that library (which is due to my lack of knowledge concerning the grid), so I made this one (which is inferior (and is an exercise for coding or something), but seems to work (tested offline only)):</p>\n<p>ElevatorLib.aslx<br>\nhttps://gist.github.com/KVonGit/44e6fc640237dedcbed361146ceaabfd</p>\n<p>ElevatorLibTester.aslx<br>\nhttps://gist.github.com/KVonGit/b0d72e81d9c82c38aad7056a93189c05</p>\n<p>Test it out online (seems to work online or offline):<br>\nhttp://textadventures.co.uk/games/view/ztjksxjmbeugnybfaqkgxa/elevatorlibtester</p>\n<hr>\n<p>This works with GridImageLib, too:</p>\n<p>https://gist.github.com/KVonGit/2851a12ee553599d8e7ee80939227ed5#file-gridimagelib-aslx</p>\n<hr>\n<p>I just now saw mrangel's last post.</p>\n<p>I'll try that out on LiftLib and return.</p>\n<hr>\n<p><strong>UPDATE</strong></p>\n<p>I added mrangel's code to <strong>LiftLib</strong>, and it works on the way up, but using the lift after reaching the top messed all the layers up.  (I'm quite certain I didn't put the code in the right place.)</p>\n<details>\n<pre><code>      else {\n        moved = true\n\t\tlastFloor = current.name\n\t\tlastFloor = GetObject(lastFloor)\n        exit.to = button.destination\n        if (button.parent.current_floor &gt; button.floor) {\n\t\t  if (game.gridmap) {\n\t\t\tGrid_SetGridCoordinateForPlayer (game.pov, button.parent, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, button.parent, \"z\") + button.floor - button.parent.current_floor)\n\n\t\t\tGrid_CalculateMapCoordinates (button.parent, game.pov)\n\n\t\t\tGrid_Redraw()\n\t      }\n          s = button.parent.goingdown\n        }\n        else {\n\t\t  if (game.gridmap) {\n\t\t    Grid_SetGridCoordinateForPlayer (game.pov, button.parent, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, button.parent, \"z\") + button.floor - button.parent.current_floor)\n\n\t\t\tGrid_CalculateMapCoordinates (button.parent, game.pov)\n\n\t\t\tGrid_Redraw()\n\t      }\n          s = button.parent.goingup\n        }\n</code></pre>\n</details>\n\n",
      "PostDate": "2018-02-16T04:24:50.7272867Z",
      "LastEditDate": "2018-02-23T22:49:17.475421Z",
      "link": null
    },
    {
      "PostId": "376edd2c-fd14-4a03-9891-ca90276a1827",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> I added mrangel's code to LiftLib, and it works on the way up, but using the lift after reaching the top messed all the layers up. (I'm quite certain I didn't put the code in the right place.)\r\n\r\nI'm assuming the code can be placed after changing `exit.to` but before changing `current_floor`. Looks right.\r\nBy \"messes up the layers\", do you mean that it redraws the lift room on the layer it's now on, but leaves the player 'dot' on the wrong floor?\r\nThe player's moved to a different floor, but their changedparentscript hasn't been called.\r\n\r\nMight be easier to do this by giving the liftroom a `changedcurrent_floor` so that it fires correctly whether triggered by a button, some other script, or when the player enters the lift:\r\n```\r\n  if (game.gridmap) {\r\n    if (Grid_GetRoomBooleanForPlayer(game.pov, object, \"grid_isdrawn\")) {\r\n      Grid_SetGridCoordinateForPlayer (game.pov, this, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, this, \"z\") + this.current_floor - oldvalue)\r\n      Grid_CalculateMapCoordinates (button.parent, game.pov)\r\n      Grid_Redraw()\r\n      if (this = game.pov.parent) {\r\n        Grid_DrawPlayerInRoom (this)\r\n      }\r\n    }\r\n  }\r\n```\r\nDoes that play any better?\r\n\r\n(Actually... sorry for the tangent from the original thread... but I think it might be more elegant to model a lift as a series of rooms, one for each floor, connected by invisible up/down exits, and a \"lift controller\" object that might be invisible. The lift controller's changedparent script unlocks the doors on the floor it's on, locks the doors on all other floors, and moves all objects inside the lift to the same room as it. The lift buttons (and call buttons) loop over moving the lift controller to the specified floor, one floor at a time. If you're working with some kind of timing system, you could even have a turnscript that moves the lift controller up to a certain number of floors towards the chosen one. Press the call button and the lift moves towards your current location at 3 floors per turn, giving the guys chasing you a chance to catch up. And because you're moving one floor at a time, it will call the player's changedparent once for every floor - and the map script checks for an exit between your old and new rooms, even if it's invisible)",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>I added mrangel's code to LiftLib, and it works on the way up, but using the lift after reaching the top messed all the layers up. (I'm quite certain I didn't put the code in the right place.)</p>\n</blockquote>\n<p>I'm assuming the code can be placed after changing <code>exit.to</code> but before changing <code>current_floor</code>. Looks right.<br>\nBy \"messes up the layers\", do you mean that it redraws the lift room on the layer it's now on, but leaves the player 'dot' on the wrong floor?<br>\nThe player's moved to a different floor, but their changedparentscript hasn't been called.</p>\n<p>Might be easier to do this by giving the liftroom a <code>changedcurrent_floor</code> so that it fires correctly whether triggered by a button, some other script, or when the player enters the lift:</p>\n<pre><code>  if (game.gridmap) {\n    if (Grid_GetRoomBooleanForPlayer(game.pov, object, \"grid_isdrawn\")) {\n      Grid_SetGridCoordinateForPlayer (game.pov, this, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, this, \"z\") + this.current_floor - oldvalue)\n      Grid_CalculateMapCoordinates (button.parent, game.pov)\n      Grid_Redraw()\n      if (this = game.pov.parent) {\n        Grid_DrawPlayerInRoom (this)\n      }\n    }\n  }\n</code></pre>\n<p>Does that play any better?</p>\n<p>(Actually... sorry for the tangent from the original thread... but I think it might be more elegant to model a lift as a series of rooms, one for each floor, connected by invisible up/down exits, and a \"lift controller\" object that might be invisible. The lift controller's changedparent script unlocks the doors on the floor it's on, locks the doors on all other floors, and moves all objects inside the lift to the same room as it. The lift buttons (and call buttons) loop over moving the lift controller to the specified floor, one floor at a time. If you're working with some kind of timing system, you could even have a turnscript that moves the lift controller up to a certain number of floors towards the chosen one. Press the call button and the lift moves towards your current location at 3 floors per turn, giving the guys chasing you a chance to catch up. And because you're moving one floor at a time, it will call the player's changedparent once for every floor - and the map script checks for an exit between your old and new rooms, even if it's invisible)</p>\n\n",
      "PostDate": "2018-02-16T10:07:09.383288Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "89930867-de8a-41a9-b5d8-c918f60fe068",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> By \"messes up the layers\", do you mean that it redraws the lift room on the layer it's now on, but leaves the player 'dot' on the wrong floor?\r\n\r\nIt kept on adding more and more layers once you reached the upper-most level.  (It was doing other weird things, too.  In my experience, once the map goes crazy, it does not get back in line until you restart.)\r\n\r\n> Might be easier to do this by giving the liftroom a changedcurrent_floor\r\n\r\nThat's a good idea.  I'll test it out.  (I'd like to make Pixie's library work with the map, if possible.)\r\n\r\n> Actually... sorry for the tangent from the original thread... but I think it might be more elegant to model a lift as a series of rooms, one for each floor, connected by invisible up/down exits\r\n\r\nHa!  That's funny.  That's what I ended up making yesterday.  \r\n\r\n(I made myself a note to add the elevator doors.  I was debating how the turns between floors should work, and decided to leave all that alone until today.)\r\n\r\nhttp://textadventures.co.uk/forum/quest/topic/a393qorxxeyokj46x8sdzq/liftlib5-4-problem#bfd52e1d-addf-407a-afd8-9f33a327e4ab\r\n",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>By \"messes up the layers\", do you mean that it redraws the lift room on the layer it's now on, but leaves the player 'dot' on the wrong floor?</p>\n</blockquote>\n<p>It kept on adding more and more layers once you reached the upper-most level.  (It was doing other weird things, too.  In my experience, once the map goes crazy, it does not get back in line until you restart.)</p>\n<blockquote>\n<p>Might be easier to do this by giving the liftroom a changedcurrent_floor</p>\n</blockquote>\n<p>That's a good idea.  I'll test it out.  (I'd like to make Pixie's library work with the map, if possible.)</p>\n<blockquote>\n<p>Actually... sorry for the tangent from the original thread... but I think it might be more elegant to model a lift as a series of rooms, one for each floor, connected by invisible up/down exits</p>\n</blockquote>\n<p>Ha!  That's funny.  That's what I ended up making yesterday.</p>\n<p>(I made myself a note to add the elevator doors.  I was debating how the turns between floors should work, and decided to leave all that alone until today.)</p>\n<p>http://textadventures.co.uk/forum/quest/topic/a393qorxxeyokj46x8sdzq/liftlib5-4-problem#bfd52e1d-addf-407a-afd8-9f33a327e4ab</p>\n\n",
      "PostDate": "2018-02-16T14:25:30.9327066Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "3618befd-d10a-45f8-ae5f-a5b01d75e490",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "This is what I've got going now:\r\n\r\n<details><summary>OLD CODE</summary>\r\n\r\n```\r\n<attr name=\"changedcurrent_floor\" type=\"script\">\r\n      thisdict = DictionaryItem(player.grid_coordinates,\"lift\")\r\n      thisZ = DictionaryItem(thisdict,\"z\")\r\n      // msg(thisZ)\r\n      oldvalue = this.last_floor\r\n      currentvalue = this.current_floor\r\n      change = oldvalue - currentvalue\r\n      if (game.gridmap) {\r\n        if (Grid_GetRoomBooleanForPlayer(game.pov, this, \"grid_isdrawn\")) {\r\n          newZ = thisZ + change\r\n          dictionary remove (thisdict, \"z\")\r\n          dictionary add (thisdict, \"z\", currentvalue*1.0-1)\r\n          // Grid_CalculateMapCoordinates (this, game.pov) //THIS EFFECTS NOTHING\r\n          // Grid_Redraw  //THIS CLEARS ANY GRID FILLS\r\n          Grid_DrawPlayerInRoom (game.pov.parent)\r\n          //VisitRoom (game.pov.parent)  //THIS EFFECTS NOTHING\r\n        }\r\n      }\r\n    </attr>\r\n```\r\n\r\n</details>\r\n\r\n---\r\nIt does everything EXCEPT make the lift appear to be on the same level as the player.  Meaning the grid is just faded out, but everything else looks and works correctly.\r\n\r\n[![image](https://user-images.githubusercontent.com/30656341/36317880-e464fd2c-1303-11e8-884e-3b3d2f95e11d.png)](https://drive.google.com/file/d/1YTmKXcPLkyqqwEMLkpgXo1ZHu0iQ128p/view?usp=sharing)",
      "EditableFormat": "markdown",
      "HTML": "<p>This is what I've got going now:</p>\n<details><summary>OLD CODE</summary>\n<pre><code>&lt;attr name=\"changedcurrent_floor\" type=\"script\"&gt;\n      thisdict = DictionaryItem(player.grid_coordinates,\"lift\")\n      thisZ = DictionaryItem(thisdict,\"z\")\n      // msg(thisZ)\n      oldvalue = this.last_floor\n      currentvalue = this.current_floor\n      change = oldvalue - currentvalue\n      if (game.gridmap) {\n        if (Grid_GetRoomBooleanForPlayer(game.pov, this, \"grid_isdrawn\")) {\n          newZ = thisZ + change\n          dictionary remove (thisdict, \"z\")\n          dictionary add (thisdict, \"z\", currentvalue*1.0-1)\n          // Grid_CalculateMapCoordinates (this, game.pov) //THIS EFFECTS NOTHING\n          // Grid_Redraw  //THIS CLEARS ANY GRID FILLS\n          Grid_DrawPlayerInRoom (game.pov.parent)\n          //VisitRoom (game.pov.parent)  //THIS EFFECTS NOTHING\n        }\n      }\n    &lt;/attr&gt;\n</code></pre>\n</details>\n<hr>\n<p>It does everything EXCEPT make the lift appear to be on the same level as the player.  Meaning the grid is just faded out, but everything else looks and works correctly.</p>\n<p><a href=\"https://drive.google.com/file/d/1YTmKXcPLkyqqwEMLkpgXo1ZHu0iQ128p/view?usp=sharing\"><img src=\"https://user-images.githubusercontent.com/30656341/36317880-e464fd2c-1303-11e8-884e-3b3d2f95e11d.png\" alt=\"image\"></a></p>\n\n",
      "PostDate": "2018-02-16T16:27:59.2511632Z",
      "LastEditDate": "2018-02-23T22:48:26.4207639Z",
      "link": null
    },
    {
      "PostId": "dc1fcab1-505c-4e92-a534-fa0308a18893",
      "UserId": 344046,
      "Username": "baskham",
      "AvatarUrl": "https://secure.gravatar.com/avatar/7689475b10ef3f61ec180330cc180daa?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Hi guys.\r\n\r\nI have now tried the solution for the LiftLib.\r\nIt works like a breeze :-)\r\nThank you!!\r\n\r\nI will try out the mapping part later today or tomorrow.\r\n\r\nBR Benny.",
      "EditableFormat": "markdown",
      "HTML": "<p>Hi guys.</p>\n<p>I have now tried the solution for the LiftLib.<br>\nIt works like a breeze :-)<br>\nThank you!!</p>\n<p>I will try out the mapping part later today or tomorrow.</p>\n<p>BR Benny.</p>\n\n",
      "PostDate": "2018-02-19T13:55:10.2080955Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "4680ba67-4f4b-4783-8ef0-078ebd637dcc",
      "UserId": 344046,
      "Username": "baskham",
      "AvatarUrl": "https://secure.gravatar.com/avatar/7689475b10ef3f61ec180330cc180daa?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Hmm.\r\n\r\nMaybe I am overestimating my on skills....\r\n\r\nBut from all the updates in this thread, I can't really figure out what to change where to get the map working :-(",
      "EditableFormat": "markdown",
      "HTML": "<p>Hmm.</p>\n<p>Maybe I am overestimating my on skills....</p>\n<p>But from all the updates in this thread, I can't really figure out what to change where to get the map working :-(</p>\n\n",
      "PostDate": "2018-02-21T17:45:06.2263264Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "43ca19e8-bad1-4334-9670-6d5719ce5f72",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "This is the best I've come up with when using the library you are using.\r\n\r\nWell...  The library on GitHub is LiftLib v2.1, and this is that, only slightly modified.  (Thanks to mrangel!)\r\n\r\n\r\n---\r\nThe library (modified):\r\n\r\n[Current mod of LiftLib.aslx](http://textadventures.co.uk/forum/quest/topic/a393qorxxeyokj46x8sdzq/liftlib5-4-problem#21b030ff-e831-4836-aeb7-659fa3876211)\r\n\r\n---\r\nThe example game:\r\n\r\n<details>\r\n\r\n```\r\n<!--Saved by Quest 5.7.6606.27193-->\r\n<asl version=\"550\">\r\n  <include ref=\"English.aslx\" />\r\n  <include ref=\"Core.aslx\" />\r\n  <include ref=\"LiftLib.aslx\" />\r\n  <game name=\"Lift Test\">\r\n    <gameid>7c83176c-78e9-47e5-a841-120cf10fa971</gameid>\r\n    <version>1.0</version>\r\n    <firstpublished>2018</firstpublished>\r\n    <gridmap />\r\n  </game>\r\n  <object name=\"room\">\r\n    <inherit name=\"editor_room\" />\r\n  </object>\r\n  <object name=\"first floor lobby\">\r\n    <inherit name=\"editor_room\" />\r\n    <inherit name=\"liftentrance\" />\r\n    <exit name=\"EXIT_f1_to_lift\" alias=\"north\" to=\"lift\">\r\n      <inherit name=\"liftentrance\" />\r\n      <inherit name=\"northdirection\" />\r\n    </exit>\r\n    <exit name=\"EXIT_f1_to_f2\" alias=\"up the stairs\" to=\"second floor lobby\">\r\n      <inherit name=\"updirection\" />\r\n      <runscript />\r\n      <script type=\"script\">\r\n        MapUpFrom(this.to)\r\n        game.pov.parent = this.to\r\n      </script>\r\n    </exit>\r\n    <object name=\"player\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"editor_player\" />\r\n      <changedparent type=\"script\">\r\n        if (game.pov = this) {\r\n          if (IsDefined(\"oldvalue\")) {\r\n            OnEnterRoom (oldvalue)\r\n            this.lastparent = oldvalue\r\n          }\r\n          else {\r\n            OnEnterRoom (null)\r\n          }\r\n          if (game.gridmap) {\r\n            MergePOVCoordinates\r\n          }\r\n        }\r\n        this.hasbeenmoved = true\r\n      </changedparent>\r\n    </object>\r\n  </object>\r\n  <object name=\"second floor lobby\">\r\n    <inherit name=\"editor_room\" />\r\n    <exit name=\"EXIT_f2_to_lift\" alias=\"north\" to=\"lift\">\r\n      <inherit name=\"liftentrance\" />\r\n      <inherit name=\"northdirection\" />\r\n    </exit>\r\n    <exit name=\"EXIT_f2_to_f1\" alias=\"down the stairs\" to=\"first floor lobby\">\r\n      <inherit name=\"downdirection\" />\r\n      <runscript />\r\n      <script type=\"script\">\r\n        MapDownFrom(this.to)\r\n        game.pov.parent = this.to\r\n      </script>\r\n    </exit>\r\n    <exit name=\"EXIT_f2_to_f3\" alias=\"up the stairs\" to=\"third floor lobby\">\r\n      <inherit name=\"updirection\" />\r\n      <runscript />\r\n      <script type=\"script\">\r\n        MapUpFrom(this.to)\r\n        game.pov.parent = this.to\r\n      </script>\r\n    </exit>\r\n    <exit name=\"EXIT_f2_to_offices\" alias=\"west\" to=\"offices\">\r\n      <inherit name=\"westdirection\" />\r\n    </exit>\r\n  </object>\r\n  <object name=\"third floor lobby\">\r\n    <inherit name=\"editor_room\" />\r\n    <exit name=\"EXIT_f3_to_lift\" alias=\"north\" to=\"lift\">\r\n      <inherit name=\"liftentrance\" />\r\n      <inherit name=\"northdirection\" />\r\n    </exit>\r\n    <exit name=\"EXIT_f3_to_f2\" alias=\"down the stairs\" to=\"second floor lobby\">\r\n      <inherit name=\"downdirection\" />\r\n      <runscript />\r\n      <script type=\"script\">\r\n        MapDownFrom(this.to)\r\n        game.pov.parent = this.to\r\n      </script>\r\n    </exit>\r\n    <exit name=\"EXIT_f3_to_meetingrooms\" alias=\"east\" to=\"meeting rooms\">\r\n      <inherit name=\"eastdirection\" />\r\n    </exit>\r\n  </object>\r\n  <object name=\"lift\">\r\n    <inherit name=\"editor_room\" />\r\n    <inherit name=\"liftroom\" />\r\n    <attr name=\"grid_fill\">Navy</attr>\r\n    <exit name=\"EXIT_lift_to_f1\" alias=\"south\" to=\"first floor lobby\">\r\n      <inherit name=\"southdirection\" />\r\n    </exit>\r\n    <object name=\"button1\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"liftbutton\" />\r\n      <alias>button marked \"1\"</alias>\r\n      <alt type=\"stringlist\">\r\n        <value>button 1</value>\r\n      </alt>\r\n      <destination type=\"object\">first floor lobby</destination>\r\n    </object>\r\n    <object name=\"button2\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"liftbutton\" />\r\n      <floor type=\"int\">2</floor>\r\n      <alias>button marked \"2\"</alias>\r\n      <alt type=\"stringlist\">\r\n        <value>button 2</value>\r\n      </alt>\r\n      <destination type=\"object\">second floor lobby</destination>\r\n    </object>\r\n    <object name=\"button3\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"liftbutton\" />\r\n      <floor type=\"int\">3</floor>\r\n      <alias>button marked \"3\"</alias>\r\n      <alt type=\"stringlist\">\r\n        <value>button 3</value>\r\n      </alt>\r\n      <destination type=\"object\">third floor lobby</destination>\r\n    </object>\r\n  </object>\r\n  <object name=\"offices\">\r\n    <inherit name=\"editor_room\" />\r\n    <exit alias=\"east\" to=\"second floor lobby\">\r\n      <inherit name=\"eastdirection\" />\r\n    </exit>\r\n  </object>\r\n  <object name=\"meeting rooms\">\r\n    <inherit name=\"editor_room\" />\r\n    <exit alias=\"west\" to=\"third floor lobby\">\r\n      <inherit name=\"westdirection\" />\r\n    </exit>\r\n  </object>\r\n  <function name=\"MapUpFrom\" parameters=\"room\">\r\n    Grid_SetGridCoordinateForPlayer (game.pov, room, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, game.pov.parent, \"z\")+1)\r\n  </function>\r\n  <function name=\"MapDownFrom\" parameters=\"room\">\r\n    Grid_SetGridCoordinateForPlayer (game.pov, game.pov.parent, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, room, \"z\")+1)\r\n  </function>\r\n</asl>\r\n```\r\n\r\n</details>",
      "EditableFormat": "markdown",
      "HTML": "<p>This is the best I've come up with when using the library you are using.</p>\n<p>Well...  The library on GitHub is LiftLib v2.1, and this is that, only slightly modified.  (Thanks to mrangel!)</p>\n<hr>\n<p>The library (modified):</p>\n<p><a href=\"http://textadventures.co.uk/forum/quest/topic/a393qorxxeyokj46x8sdzq/liftlib5-4-problem#21b030ff-e831-4836-aeb7-659fa3876211\">Current mod of LiftLib.aslx</a></p>\n<hr>\n<p>The example game:</p>\n<details>\n<pre><code>&lt;!--Saved by Quest 5.7.6606.27193--&gt;\n&lt;asl version=\"550\"&gt;\n  &lt;include ref=\"English.aslx\" /&gt;\n  &lt;include ref=\"Core.aslx\" /&gt;\n  &lt;include ref=\"LiftLib.aslx\" /&gt;\n  &lt;game name=\"Lift Test\"&gt;\n    &lt;gameid&gt;7c83176c-78e9-47e5-a841-120cf10fa971&lt;/gameid&gt;\n    &lt;version&gt;1.0&lt;/version&gt;\n    &lt;firstpublished&gt;2018&lt;/firstpublished&gt;\n    &lt;gridmap /&gt;\n  &lt;/game&gt;\n  &lt;object name=\"room\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n  &lt;/object&gt;\n  &lt;object name=\"first floor lobby\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;inherit name=\"liftentrance\" /&gt;\n    &lt;exit name=\"EXIT_f1_to_lift\" alias=\"north\" to=\"lift\"&gt;\n      &lt;inherit name=\"liftentrance\" /&gt;\n      &lt;inherit name=\"northdirection\" /&gt;\n    &lt;/exit&gt;\n    &lt;exit name=\"EXIT_f1_to_f2\" alias=\"up the stairs\" to=\"second floor lobby\"&gt;\n      &lt;inherit name=\"updirection\" /&gt;\n      &lt;runscript /&gt;\n      &lt;script type=\"script\"&gt;\n        MapUpFrom(this.to)\n        game.pov.parent = this.to\n      &lt;/script&gt;\n    &lt;/exit&gt;\n    &lt;object name=\"player\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"editor_player\" /&gt;\n      &lt;changedparent type=\"script\"&gt;\n        if (game.pov = this) {\n          if (IsDefined(\"oldvalue\")) {\n            OnEnterRoom (oldvalue)\n            this.lastparent = oldvalue\n          }\n          else {\n            OnEnterRoom (null)\n          }\n          if (game.gridmap) {\n            MergePOVCoordinates\n          }\n        }\n        this.hasbeenmoved = true\n      &lt;/changedparent&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n  &lt;object name=\"second floor lobby\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;exit name=\"EXIT_f2_to_lift\" alias=\"north\" to=\"lift\"&gt;\n      &lt;inherit name=\"liftentrance\" /&gt;\n      &lt;inherit name=\"northdirection\" /&gt;\n    &lt;/exit&gt;\n    &lt;exit name=\"EXIT_f2_to_f1\" alias=\"down the stairs\" to=\"first floor lobby\"&gt;\n      &lt;inherit name=\"downdirection\" /&gt;\n      &lt;runscript /&gt;\n      &lt;script type=\"script\"&gt;\n        MapDownFrom(this.to)\n        game.pov.parent = this.to\n      &lt;/script&gt;\n    &lt;/exit&gt;\n    &lt;exit name=\"EXIT_f2_to_f3\" alias=\"up the stairs\" to=\"third floor lobby\"&gt;\n      &lt;inherit name=\"updirection\" /&gt;\n      &lt;runscript /&gt;\n      &lt;script type=\"script\"&gt;\n        MapUpFrom(this.to)\n        game.pov.parent = this.to\n      &lt;/script&gt;\n    &lt;/exit&gt;\n    &lt;exit name=\"EXIT_f2_to_offices\" alias=\"west\" to=\"offices\"&gt;\n      &lt;inherit name=\"westdirection\" /&gt;\n    &lt;/exit&gt;\n  &lt;/object&gt;\n  &lt;object name=\"third floor lobby\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;exit name=\"EXIT_f3_to_lift\" alias=\"north\" to=\"lift\"&gt;\n      &lt;inherit name=\"liftentrance\" /&gt;\n      &lt;inherit name=\"northdirection\" /&gt;\n    &lt;/exit&gt;\n    &lt;exit name=\"EXIT_f3_to_f2\" alias=\"down the stairs\" to=\"second floor lobby\"&gt;\n      &lt;inherit name=\"downdirection\" /&gt;\n      &lt;runscript /&gt;\n      &lt;script type=\"script\"&gt;\n        MapDownFrom(this.to)\n        game.pov.parent = this.to\n      &lt;/script&gt;\n    &lt;/exit&gt;\n    &lt;exit name=\"EXIT_f3_to_meetingrooms\" alias=\"east\" to=\"meeting rooms\"&gt;\n      &lt;inherit name=\"eastdirection\" /&gt;\n    &lt;/exit&gt;\n  &lt;/object&gt;\n  &lt;object name=\"lift\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;inherit name=\"liftroom\" /&gt;\n    &lt;attr name=\"grid_fill\"&gt;Navy&lt;/attr&gt;\n    &lt;exit name=\"EXIT_lift_to_f1\" alias=\"south\" to=\"first floor lobby\"&gt;\n      &lt;inherit name=\"southdirection\" /&gt;\n    &lt;/exit&gt;\n    &lt;object name=\"button1\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"liftbutton\" /&gt;\n      &lt;alias&gt;button marked \"1\"&lt;/alias&gt;\n      &lt;alt type=\"stringlist\"&gt;\n        &lt;value&gt;button 1&lt;/value&gt;\n      &lt;/alt&gt;\n      &lt;destination type=\"object\"&gt;first floor lobby&lt;/destination&gt;\n    &lt;/object&gt;\n    &lt;object name=\"button2\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"liftbutton\" /&gt;\n      &lt;floor type=\"int\"&gt;2&lt;/floor&gt;\n      &lt;alias&gt;button marked \"2\"&lt;/alias&gt;\n      &lt;alt type=\"stringlist\"&gt;\n        &lt;value&gt;button 2&lt;/value&gt;\n      &lt;/alt&gt;\n      &lt;destination type=\"object\"&gt;second floor lobby&lt;/destination&gt;\n    &lt;/object&gt;\n    &lt;object name=\"button3\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"liftbutton\" /&gt;\n      &lt;floor type=\"int\"&gt;3&lt;/floor&gt;\n      &lt;alias&gt;button marked \"3\"&lt;/alias&gt;\n      &lt;alt type=\"stringlist\"&gt;\n        &lt;value&gt;button 3&lt;/value&gt;\n      &lt;/alt&gt;\n      &lt;destination type=\"object\"&gt;third floor lobby&lt;/destination&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n  &lt;object name=\"offices\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;exit alias=\"east\" to=\"second floor lobby\"&gt;\n      &lt;inherit name=\"eastdirection\" /&gt;\n    &lt;/exit&gt;\n  &lt;/object&gt;\n  &lt;object name=\"meeting rooms\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;exit alias=\"west\" to=\"third floor lobby\"&gt;\n      &lt;inherit name=\"westdirection\" /&gt;\n    &lt;/exit&gt;\n  &lt;/object&gt;\n  &lt;function name=\"MapUpFrom\" parameters=\"room\"&gt;\n    Grid_SetGridCoordinateForPlayer (game.pov, room, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, game.pov.parent, \"z\")+1)\n  &lt;/function&gt;\n  &lt;function name=\"MapDownFrom\" parameters=\"room\"&gt;\n    Grid_SetGridCoordinateForPlayer (game.pov, game.pov.parent, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, room, \"z\")+1)\n  &lt;/function&gt;\n&lt;/asl&gt;\n</code></pre>\n</details>\n\n",
      "PostDate": "2018-02-21T18:33:03.2493232Z",
      "LastEditDate": "2018-02-26T19:09:06.4967834Z",
      "link": null
    },
    {
      "PostId": "34b97b9f-d714-4b3b-a5a4-01665d08cdbb",
      "UserId": 344046,
      "Username": "baskham",
      "AvatarUrl": "https://secure.gravatar.com/avatar/7689475b10ef3f61ec180330cc180daa?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Yay!!!\r\n\r\nIt works like a charm.\r\nThank you so much!!\r\n\r\nOnly one little thing.\r\nif you disable the map in the game object, it complains when you press a liftbutton:\r\n\"'DictionaryItem(player.grid_coordinates,\"Elevator1\")': DictionaryItem function expected dictionary parameter but was passed 'null'\"\r\n\r\nElevator1 is the name of my liftroom.\r\n\r\nBR Benny",
      "EditableFormat": "markdown",
      "HTML": "<p>Yay!!!</p>\n<p>It works like a charm.<br>\nThank you so much!!</p>\n<p>Only one little thing.<br>\nif you disable the map in the game object, it complains when you press a liftbutton:<br>\n\"'DictionaryItem(player.grid_coordinates,\"Elevator1\")': DictionaryItem function expected dictionary parameter but was passed 'null'\"</p>\n<p>Elevator1 is the name of my liftroom.</p>\n<p>BR Benny</p>\n\n",
      "PostDate": "2018-02-23T20:25:12.8456403Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "4a0894c7-7a1b-4b68-9cb6-a494823a2b5b",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "@KV\r\nNot sure why you have this line in the changed_currentfloor function:\r\n\r\n> `oldvalue = this.last_floor`\r\n\r\nSeems like it might be adding a possibility for future odd behaviour. Within a script named `changedcurrent_floor`, you already have a special variable named `oldvalue` that contains the previous value of `this.current_floor`. This is behaviour of changed* functions.",
      "EditableFormat": "markdown",
      "HTML": "<p>@KV<br>\nNot sure why you have this line in the changed_currentfloor function:</p>\n<blockquote>\n<p><code>oldvalue = this.last_floor</code></p>\n</blockquote>\n<p>Seems like it might be adding a possibility for future odd behaviour. Within a script named <code>changedcurrent_floor</code>, you already have a special variable named <code>oldvalue</code> that contains the previous value of <code>this.current_floor</code>. This is behaviour of changed* functions.</p>\n\n",
      "PostDate": "2018-02-23T20:42:30.9614162Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "cd2cb7f2-b7f5-44f2-91fc-e0d029638876",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Whoops!\r\n\r\nI made an error in the liftroom type's script.\r\n\r\n---\r\nThe revised, modified library:\r\n\r\n[Current mod of LiftLib.aslx](http://textadventures.co.uk/forum/quest/topic/a393qorxxeyokj46x8sdzq/liftlib5-4-problem#21b030ff-e831-4836-aeb7-659fa3876211)",
      "EditableFormat": "markdown",
      "HTML": "<p>Whoops!</p>\n<p>I made an error in the liftroom type's script.</p>\n<hr>\n<p>The revised, modified library:</p>\n<p><a href=\"http://textadventures.co.uk/forum/quest/topic/a393qorxxeyokj46x8sdzq/liftlib5-4-problem#21b030ff-e831-4836-aeb7-659fa3876211\">Current mod of LiftLib.aslx</a></p>\n\n",
      "PostDate": "2018-02-23T20:46:23.076625Z",
      "LastEditDate": "2018-02-26T19:08:14.711822Z",
      "link": null
    },
    {
      "PostId": "144e71a0-a565-4b2a-a64d-4843480bdde7",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": ">Within a script named ```changedcurrent_floor```, you already have a special variable named ```oldvalue``` that contains the previous value of  ```this.current_floor```.\r\n\r\nI thought so, too, but just using ```oldvalue``` in the script threw an error.  So, I added that line.  (It is highly probable that I had it messed up somehow, though.)\r\n\r\n---\r\nJust double checked. \r\n\r\nWhen I comment that line out, I get this error:\r\n\r\n\r\n**Error running script: Error compiling expression 'oldvalue - currentvalue': ArithmeticElement: Operation 'Subtract' is not defined for types 'Object' and 'Int32'\r\nYou press the button. The lift ascends to floor 2.**\r\n\r\n",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>Within a script named <code>changedcurrent_floor</code>, you already have a special variable named <code>oldvalue</code> that contains the previous value of  <code>this.current_floor</code>.</p>\n</blockquote>\n<p>I thought so, too, but just using <code>oldvalue</code> in the script threw an error.  So, I added that line.  (It is highly probable that I had it messed up somehow, though.)</p>\n<hr>\n<p>Just double checked.</p>\n<p>When I comment that line out, I get this error:</p>\n<p><strong>Error running script: Error compiling expression 'oldvalue - currentvalue': ArithmeticElement: Operation 'Subtract' is not defined for types 'Object' and 'Int32'<br>\nYou press the button. The lift ascends to floor 2.</strong></p>\n\n",
      "PostDate": "2018-02-23T20:48:59.5749713Z",
      "LastEditDate": "2018-02-23T20:54:13.8711276Z",
      "link": null
    },
    {
      "PostId": "53821dad-7a85-427b-b810-d59414116420",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "That's weird.\r\nOh; `oldvalue` is null the first time you assign something to it. (Even if it previously had a value inherited from its type, I think? Because the variable of the object itself is being set now)\r\n\r\nHowever, your use of last_floor is problematic, because before setting the current floor, you've done:\r\n> `button.parent.last_floor = button.floor`\r\n\r\nSo you're setting both currentvalue and oldvalue to the floor property of the button that's been pressed. I think you either want `current_button.floor` in that line; or you want to set last_floor *after* changing current_floor so that it will have the right value next time.",
      "EditableFormat": "markdown",
      "HTML": "<p>That's weird.<br>\nOh; <code>oldvalue</code> is null the first time you assign something to it. (Even if it previously had a value inherited from its type, I think? Because the variable of the object itself is being set now)</p>\n<p>However, your use of last_floor is problematic, because before setting the current floor, you've done:</p>\n<blockquote>\n<p><code>button.parent.last_floor = button.floor</code></p>\n</blockquote>\n<p>So you're setting both currentvalue and oldvalue to the floor property of the button that's been pressed. I think you either want <code>current_button.floor</code> in that line; or you want to set last_floor <em>after</em> changing current_floor so that it will have the right value next time.</p>\n\n",
      "PostDate": "2018-02-23T21:08:09.1733924Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "e727eb7d-bcbe-4bca-a6c3-cfc9bd021108",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thank you!\r\n\r\nI didn't even notice that.\r\n\r\n(I fixed it in the last post.)",
      "EditableFormat": "markdown",
      "HTML": "<p>Thank you!</p>\n<p>I didn't even notice that.</p>\n<p>(I fixed it in the last post.)</p>\n\n",
      "PostDate": "2018-02-23T22:39:45.0850716Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "64165009-f961-4772-aef1-ea1f5199a693",
      "UserId": 344046,
      "Username": "baskham",
      "AvatarUrl": "https://secure.gravatar.com/avatar/7689475b10ef3f61ec180330cc180daa?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Hmmm.\r\n\r\nThis is a little weird.\r\n\r\nWith the library from feb. 21. It works with the map enabled but not when it is disabled.\r\n\r\nWith the new lib from feb. 23. It is the other way around.\r\nNow when the map is enabled I get:\r\n\"Error running script: Error evaluating expression 'DictionaryItem(player.grid_coordinates,\"lift\")': The given key was not present in the dictionary.\"\r\n(Note it now says \"lift\" in the errormsg. My lift is called \"elevator1\")\r\nAnd when I disable the map it works :-O :'(\r\n\r\nBR\r\nBenny",
      "EditableFormat": "markdown",
      "HTML": "<p>Hmmm.</p>\n<p>This is a little weird.</p>\n<p>With the library from feb. 21. It works with the map enabled but not when it is disabled.</p>\n<p>With the new lib from feb. 23. It is the other way around.<br>\nNow when the map is enabled I get:<br>\n\"Error running script: Error evaluating expression 'DictionaryItem(player.grid_coordinates,\"lift\")': The given key was not present in the dictionary.\"<br>\n(Note it now says \"lift\" in the errormsg. My lift is called \"elevator1\")<br>\nAnd when I disable the map it works :-O :'(</p>\n<p>BR<br>\nBenny</p>\n\n",
      "PostDate": "2018-02-25T18:26:28.3509441Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "de499096-4e1e-473e-ab1f-44a49b8885cc",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Make a backup copy of your copy of LiftLib.\r\n\r\nOpen the LiftLib file in your game's folder in a text editor.\r\n\r\nDelete ALL the text.\r\n\r\nPaste this in and save.  (This is the same code posted [here](http://textadventures.co.uk/forum/quest/topic/a393qorxxeyokj46x8sdzq/liftlib5-4-problem#cd2cb7f2-b7f5-44f2-91fc-e0d029638876).)\r\n\r\nRun the game.\r\n\r\n(This works with or without the map for me.)\r\n\r\n[Current mod of LiftLib.aslx](http://textadventures.co.uk/forum/quest/topic/a393qorxxeyokj46x8sdzq/liftlib5-4-problem#21b030ff-e831-4836-aeb7-659fa3876211)",
      "EditableFormat": "markdown",
      "HTML": "<p>Make a backup copy of your copy of LiftLib.</p>\n<p>Open the LiftLib file in your game's folder in a text editor.</p>\n<p>Delete ALL the text.</p>\n<p>Paste this in and save.  (This is the same code posted <a href=\"http://textadventures.co.uk/forum/quest/topic/a393qorxxeyokj46x8sdzq/liftlib5-4-problem#cd2cb7f2-b7f5-44f2-91fc-e0d029638876\">here</a>.)</p>\n<p>Run the game.</p>\n<p>(This works with or without the map for me.)</p>\n<p><a href=\"http://textadventures.co.uk/forum/quest/topic/a393qorxxeyokj46x8sdzq/liftlib5-4-problem#21b030ff-e831-4836-aeb7-659fa3876211\">Current mod of LiftLib.aslx</a></p>\n\n",
      "PostDate": "2018-02-26T04:17:16.8358053Z",
      "LastEditDate": "2018-02-26T19:07:22.0189065Z",
      "link": null
    },
    {
      "PostId": "149ad5c8-ddfd-4b44-8be8-80fdd2653dd9",
      "UserId": 344046,
      "Username": "baskham",
      "AvatarUrl": "https://secure.gravatar.com/avatar/7689475b10ef3f61ec180330cc180daa?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I tried the last version of the liftlib.\r\nBoth with my project and with a VERY simple little game.\r\n\r\nI still got the same problem.\r\nBut I managed to figure out why!!!!\r\n\r\nThe lift must be called lift.\r\nOtherwise it complains when the map is enabled.\r\n\r\nI can definitely live with that.\r\nAt least for now :-)\r\nBut it might be worth fixing.\r\n\r\nBR Benny",
      "EditableFormat": "markdown",
      "HTML": "<p>I tried the last version of the liftlib.<br>\nBoth with my project and with a VERY simple little game.</p>\n<p>I still got the same problem.<br>\nBut I managed to figure out why!!!!</p>\n<p>The lift must be called lift.<br>\nOtherwise it complains when the map is enabled.</p>\n<p>I can definitely live with that.<br>\nAt least for now :-)<br>\nBut it might be worth fixing.</p>\n<p>BR Benny</p>\n\n",
      "PostDate": "2018-02-26T17:47:09.9156204Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "b355571e-9c21-49f7-84dc-be9cd7c45911",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Mine is called \"Elevator\" in this game, and it works perfectly using [the library in this post](http://textadventures.co.uk/forum/quest/topic/a393qorxxeyokj46x8sdzq/liftlib5-4-problem#de499096-4e1e-473e-ab1f-44a49b8885cc).\r\n\r\n---\r\n### The example game:\r\n\r\n<details>\r\n\r\n```\r\n<!--Saved by Quest 5.7.6606.27193-->\r\n<asl version=\"550\">\r\n  <include ref=\"English.aslx\" />\r\n  <include ref=\"Core.aslx\" />\r\n  <include ref=\"LiftLib.aslx\" />\r\n  <game name=\"Lift Test\">\r\n    <gameid>7c83176c-78e9-47e5-a841-120cf10fa971</gameid>\r\n    <version>1.0</version>\r\n    <firstpublished>2018</firstpublished>\r\n    <gridmap type=\"boolean\">false</gridmap>\r\n  </game>\r\n  <object name=\"room\">\r\n    <inherit name=\"editor_room\" />\r\n  </object>\r\n  <object name=\"first floor lobby\">\r\n    <inherit name=\"editor_room\" />\r\n    <inherit name=\"liftentrance\" />\r\n    <exit name=\"EXIT_f1_to_lift\" alias=\"north\" to=\"Elevator\">\r\n      <inherit name=\"liftentrance\" />\r\n      <inherit name=\"northdirection\" />\r\n    </exit>\r\n    <exit name=\"EXIT_f1_to_f2\" alias=\"up the stairs\" to=\"second floor lobby\">\r\n      <inherit name=\"updirection\" />\r\n      <runscript />\r\n      <script type=\"script\">\r\n        MapUpFrom (this.to)\r\n        game.pov.parent = this.to\r\n      </script>\r\n    </exit>\r\n    <object name=\"player\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"editor_player\" />\r\n      <changedparent type=\"script\">\r\n        if (game.pov = this) {\r\n          if (IsDefined(\"oldvalue\")) {\r\n            OnEnterRoom (oldvalue)\r\n            this.lastparent = oldvalue\r\n          }\r\n          else {\r\n            OnEnterRoom (null)\r\n          }\r\n          if (game.gridmap) {\r\n            MergePOVCoordinates\r\n          }\r\n        }\r\n        this.hasbeenmoved = true\r\n      </changedparent>\r\n    </object>\r\n  </object>\r\n  <object name=\"second floor lobby\">\r\n    <inherit name=\"editor_room\" />\r\n    <exit name=\"EXIT_f2_to_lift\" alias=\"north\" to=\"Elevator\">\r\n      <inherit name=\"liftentrance\" />\r\n      <inherit name=\"northdirection\" />\r\n    </exit>\r\n    <exit name=\"EXIT_f2_to_f1\" alias=\"down the stairs\" to=\"first floor lobby\">\r\n      <inherit name=\"downdirection\" />\r\n      <runscript />\r\n      <script type=\"script\">\r\n        MapDownFrom (this.to)\r\n        game.pov.parent = this.to\r\n      </script>\r\n    </exit>\r\n    <exit name=\"EXIT_f2_to_f3\" alias=\"up the stairs\" to=\"third floor lobby\">\r\n      <inherit name=\"updirection\" />\r\n      <runscript />\r\n      <script type=\"script\">\r\n        MapUpFrom (this.to)\r\n        game.pov.parent = this.to\r\n      </script>\r\n    </exit>\r\n    <exit name=\"EXIT_f2_to_offices\" alias=\"west\" to=\"offices\">\r\n      <inherit name=\"westdirection\" />\r\n    </exit>\r\n  </object>\r\n  <object name=\"third floor lobby\">\r\n    <inherit name=\"editor_room\" />\r\n    <exit name=\"EXIT_f3_to_lift\" alias=\"north\" to=\"Elevator\">\r\n      <inherit name=\"liftentrance\" />\r\n      <inherit name=\"northdirection\" />\r\n    </exit>\r\n    <exit name=\"EXIT_f3_to_f2\" alias=\"down the stairs\" to=\"second floor lobby\">\r\n      <inherit name=\"downdirection\" />\r\n      <runscript />\r\n      <script type=\"script\">\r\n        MapDownFrom (this.to)\r\n        game.pov.parent = this.to\r\n      </script>\r\n    </exit>\r\n    <exit name=\"EXIT_f3_to_meetingrooms\" alias=\"east\" to=\"meeting rooms\">\r\n      <inherit name=\"eastdirection\" />\r\n    </exit>\r\n  </object>\r\n  <object name=\"Elevator\">\r\n    <inherit name=\"editor_room\" />\r\n    <inherit name=\"liftroom\" />\r\n    <attr name=\"grid_fill\">Navy</attr>\r\n    <exit name=\"EXIT_lift_to_f1\" alias=\"south\" to=\"first floor lobby\">\r\n      <inherit name=\"southdirection\" />\r\n    </exit>\r\n    <object name=\"button1\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"liftbutton\" />\r\n      <alias>button marked \"1\"</alias>\r\n      <alt type=\"stringlist\">\r\n        <value>button 1</value>\r\n      </alt>\r\n      <destination type=\"object\">first floor lobby</destination>\r\n    </object>\r\n    <object name=\"button2\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"liftbutton\" />\r\n      <floor type=\"int\">2</floor>\r\n      <alias>button marked \"2\"</alias>\r\n      <alt type=\"stringlist\">\r\n        <value>button 2</value>\r\n      </alt>\r\n      <destination type=\"object\">second floor lobby</destination>\r\n    </object>\r\n    <object name=\"button3\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"liftbutton\" />\r\n      <floor type=\"int\">3</floor>\r\n      <alias>button marked \"3\"</alias>\r\n      <alt type=\"stringlist\">\r\n        <value>button 3</value>\r\n      </alt>\r\n      <destination type=\"object\">third floor lobby</destination>\r\n    </object>\r\n  </object>\r\n  <object name=\"offices\">\r\n    <inherit name=\"editor_room\" />\r\n    <exit alias=\"east\" to=\"second floor lobby\">\r\n      <inherit name=\"eastdirection\" />\r\n    </exit>\r\n  </object>\r\n  <object name=\"meeting rooms\">\r\n    <inherit name=\"editor_room\" />\r\n    <exit alias=\"west\" to=\"third floor lobby\">\r\n      <inherit name=\"westdirection\" />\r\n    </exit>\r\n  </object>\r\n  <function name=\"MapUpFrom\" parameters=\"room\">\r\n    Grid_SetGridCoordinateForPlayer (game.pov, room, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, game.pov.parent, \"z\")+1)\r\n  </function>\r\n  <function name=\"MapDownFrom\" parameters=\"room\">\r\n    Grid_SetGridCoordinateForPlayer (game.pov, game.pov.parent, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, room, \"z\")+1)\r\n  </function>\r\n</asl>\r\n```\r\n\r\n</details>\r\n\r\n---\r\nAre you setting the lift object up with the \"lifttype\" type?",
      "EditableFormat": "markdown",
      "HTML": "<p>Mine is called \"Elevator\" in this game, and it works perfectly using <a href=\"http://textadventures.co.uk/forum/quest/topic/a393qorxxeyokj46x8sdzq/liftlib5-4-problem#de499096-4e1e-473e-ab1f-44a49b8885cc\">the library in this post</a>.</p>\n<hr>\n<h3>The example game:</h3>\n<details>\n<pre><code>&lt;!--Saved by Quest 5.7.6606.27193--&gt;\n&lt;asl version=\"550\"&gt;\n  &lt;include ref=\"English.aslx\" /&gt;\n  &lt;include ref=\"Core.aslx\" /&gt;\n  &lt;include ref=\"LiftLib.aslx\" /&gt;\n  &lt;game name=\"Lift Test\"&gt;\n    &lt;gameid&gt;7c83176c-78e9-47e5-a841-120cf10fa971&lt;/gameid&gt;\n    &lt;version&gt;1.0&lt;/version&gt;\n    &lt;firstpublished&gt;2018&lt;/firstpublished&gt;\n    &lt;gridmap type=\"boolean\"&gt;false&lt;/gridmap&gt;\n  &lt;/game&gt;\n  &lt;object name=\"room\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n  &lt;/object&gt;\n  &lt;object name=\"first floor lobby\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;inherit name=\"liftentrance\" /&gt;\n    &lt;exit name=\"EXIT_f1_to_lift\" alias=\"north\" to=\"Elevator\"&gt;\n      &lt;inherit name=\"liftentrance\" /&gt;\n      &lt;inherit name=\"northdirection\" /&gt;\n    &lt;/exit&gt;\n    &lt;exit name=\"EXIT_f1_to_f2\" alias=\"up the stairs\" to=\"second floor lobby\"&gt;\n      &lt;inherit name=\"updirection\" /&gt;\n      &lt;runscript /&gt;\n      &lt;script type=\"script\"&gt;\n        MapUpFrom (this.to)\n        game.pov.parent = this.to\n      &lt;/script&gt;\n    &lt;/exit&gt;\n    &lt;object name=\"player\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"editor_player\" /&gt;\n      &lt;changedparent type=\"script\"&gt;\n        if (game.pov = this) {\n          if (IsDefined(\"oldvalue\")) {\n            OnEnterRoom (oldvalue)\n            this.lastparent = oldvalue\n          }\n          else {\n            OnEnterRoom (null)\n          }\n          if (game.gridmap) {\n            MergePOVCoordinates\n          }\n        }\n        this.hasbeenmoved = true\n      &lt;/changedparent&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n  &lt;object name=\"second floor lobby\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;exit name=\"EXIT_f2_to_lift\" alias=\"north\" to=\"Elevator\"&gt;\n      &lt;inherit name=\"liftentrance\" /&gt;\n      &lt;inherit name=\"northdirection\" /&gt;\n    &lt;/exit&gt;\n    &lt;exit name=\"EXIT_f2_to_f1\" alias=\"down the stairs\" to=\"first floor lobby\"&gt;\n      &lt;inherit name=\"downdirection\" /&gt;\n      &lt;runscript /&gt;\n      &lt;script type=\"script\"&gt;\n        MapDownFrom (this.to)\n        game.pov.parent = this.to\n      &lt;/script&gt;\n    &lt;/exit&gt;\n    &lt;exit name=\"EXIT_f2_to_f3\" alias=\"up the stairs\" to=\"third floor lobby\"&gt;\n      &lt;inherit name=\"updirection\" /&gt;\n      &lt;runscript /&gt;\n      &lt;script type=\"script\"&gt;\n        MapUpFrom (this.to)\n        game.pov.parent = this.to\n      &lt;/script&gt;\n    &lt;/exit&gt;\n    &lt;exit name=\"EXIT_f2_to_offices\" alias=\"west\" to=\"offices\"&gt;\n      &lt;inherit name=\"westdirection\" /&gt;\n    &lt;/exit&gt;\n  &lt;/object&gt;\n  &lt;object name=\"third floor lobby\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;exit name=\"EXIT_f3_to_lift\" alias=\"north\" to=\"Elevator\"&gt;\n      &lt;inherit name=\"liftentrance\" /&gt;\n      &lt;inherit name=\"northdirection\" /&gt;\n    &lt;/exit&gt;\n    &lt;exit name=\"EXIT_f3_to_f2\" alias=\"down the stairs\" to=\"second floor lobby\"&gt;\n      &lt;inherit name=\"downdirection\" /&gt;\n      &lt;runscript /&gt;\n      &lt;script type=\"script\"&gt;\n        MapDownFrom (this.to)\n        game.pov.parent = this.to\n      &lt;/script&gt;\n    &lt;/exit&gt;\n    &lt;exit name=\"EXIT_f3_to_meetingrooms\" alias=\"east\" to=\"meeting rooms\"&gt;\n      &lt;inherit name=\"eastdirection\" /&gt;\n    &lt;/exit&gt;\n  &lt;/object&gt;\n  &lt;object name=\"Elevator\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;inherit name=\"liftroom\" /&gt;\n    &lt;attr name=\"grid_fill\"&gt;Navy&lt;/attr&gt;\n    &lt;exit name=\"EXIT_lift_to_f1\" alias=\"south\" to=\"first floor lobby\"&gt;\n      &lt;inherit name=\"southdirection\" /&gt;\n    &lt;/exit&gt;\n    &lt;object name=\"button1\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"liftbutton\" /&gt;\n      &lt;alias&gt;button marked \"1\"&lt;/alias&gt;\n      &lt;alt type=\"stringlist\"&gt;\n        &lt;value&gt;button 1&lt;/value&gt;\n      &lt;/alt&gt;\n      &lt;destination type=\"object\"&gt;first floor lobby&lt;/destination&gt;\n    &lt;/object&gt;\n    &lt;object name=\"button2\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"liftbutton\" /&gt;\n      &lt;floor type=\"int\"&gt;2&lt;/floor&gt;\n      &lt;alias&gt;button marked \"2\"&lt;/alias&gt;\n      &lt;alt type=\"stringlist\"&gt;\n        &lt;value&gt;button 2&lt;/value&gt;\n      &lt;/alt&gt;\n      &lt;destination type=\"object\"&gt;second floor lobby&lt;/destination&gt;\n    &lt;/object&gt;\n    &lt;object name=\"button3\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"liftbutton\" /&gt;\n      &lt;floor type=\"int\"&gt;3&lt;/floor&gt;\n      &lt;alias&gt;button marked \"3\"&lt;/alias&gt;\n      &lt;alt type=\"stringlist\"&gt;\n        &lt;value&gt;button 3&lt;/value&gt;\n      &lt;/alt&gt;\n      &lt;destination type=\"object\"&gt;third floor lobby&lt;/destination&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n  &lt;object name=\"offices\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;exit alias=\"east\" to=\"second floor lobby\"&gt;\n      &lt;inherit name=\"eastdirection\" /&gt;\n    &lt;/exit&gt;\n  &lt;/object&gt;\n  &lt;object name=\"meeting rooms\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;exit alias=\"west\" to=\"third floor lobby\"&gt;\n      &lt;inherit name=\"westdirection\" /&gt;\n    &lt;/exit&gt;\n  &lt;/object&gt;\n  &lt;function name=\"MapUpFrom\" parameters=\"room\"&gt;\n    Grid_SetGridCoordinateForPlayer (game.pov, room, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, game.pov.parent, \"z\")+1)\n  &lt;/function&gt;\n  &lt;function name=\"MapDownFrom\" parameters=\"room\"&gt;\n    Grid_SetGridCoordinateForPlayer (game.pov, game.pov.parent, \"z\", Grid_GetGridCoordinateForPlayer(game.pov, room, \"z\")+1)\n  &lt;/function&gt;\n&lt;/asl&gt;\n</code></pre>\n</details>\n<hr>\n<p>Are you setting the lift object up with the \"lifttype\" type?</p>\n\n",
      "PostDate": "2018-02-26T18:10:57.68846Z",
      "LastEditDate": "2018-02-26T19:04:07.3031049Z",
      "link": null
    },
    {
      "PostId": "1a4fde85-cae9-4a5a-b9ac-ec55486a181c",
      "UserId": 344046,
      "Username": "baskham",
      "AvatarUrl": "https://secure.gravatar.com/avatar/7689475b10ef3f61ec180330cc180daa?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "This is so weird!!\r\n\r\nI use the lib you posted yesterday.\r\nAnd the game below.\r\n\r\nAnd it complains if the map is enabled and the lift is called anything other than \"lift\"\r\nOtherwise it is fine. :-O:-O`\r\n\r\n-------------------------------------------------------\r\n````<!--Saved by Quest 5.7.6606.27193-->\r\n<asl version=\"550\">\r\n  <include ref=\"English.aslx\" />\r\n  <include ref=\"Core.aslx\" />\r\n  <include ref=\"LiftLib.aslx\" />\r\n  <game name=\"lifttesta\">\r\n    <gameid>22bf84c4-8e87-42d3-9884-89491618f4b9</gameid>\r\n    <version>1.0</version>\r\n    <firstpublished>2018</firstpublished>\r\n    <gridmap />\r\n  </game>\r\n  <object name=\"room\">\r\n    <inherit name=\"editor_room\" />\r\n    <object name=\"player\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"editor_player\" />\r\n    </object>\r\n    <exit alias=\"east\" to=\"room1\">\r\n      <inherit name=\"eastdirection\" />\r\n    </exit>\r\n    <object name=\"hammer\">\r\n      <inherit name=\"editor_object\" />\r\n      <take />\r\n      <feature_usegive />\r\n      <selfuseon type=\"scriptdictionary\" />\r\n    </object>\r\n    <object name=\"nail\">\r\n      <inherit name=\"editor_object\" />\r\n      <feature_usegive />\r\n      <useon type=\"scriptdictionary\">\r\n        <item key=\"hammer\">\r\n          msg (\"bang bang\")\r\n        </item>\r\n      </useon>\r\n    </object>\r\n  </object>\r\n  <object name=\"room1\">\r\n    <inherit name=\"editor_room\" />\r\n    <exit alias=\"west\" to=\"room\">\r\n      <inherit name=\"westdirection\" />\r\n    </exit>\r\n    <exit alias=\"east\" to=\"room2\">\r\n      <inherit name=\"eastdirection\" />\r\n    </exit>\r\n  </object>\r\n  <object name=\"room2\">\r\n    <inherit name=\"editor_room\" />\r\n    <exit alias=\"west\" to=\"room1\">\r\n      <inherit name=\"westdirection\" />\r\n    </exit>\r\n    <exit alias=\"east\" to=\"lift\">\r\n      <inherit name=\"eastdirection\" />\r\n      <inherit name=\"liftentrance\" />\r\n    </exit>\r\n  </object>\r\n  <object name=\"lift\">\r\n    <inherit name=\"editor_room\" />\r\n    <inherit name=\"liftroom\" />\r\n    <object name=\"knap1\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"liftbutton\" />\r\n      <floor type=\"int\">1</floor>\r\n      <destination type=\"object\">room2</destination>\r\n    </object>\r\n    <object name=\"knap2\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"liftbutton\" />\r\n      <floor type=\"int\">2</floor>\r\n      <destination type=\"object\">rooma</destination>\r\n    </object>\r\n    <exit alias=\"west\" to=\"room2\">\r\n      <inherit name=\"westdirection\" />\r\n    </exit>\r\n  </object>\r\n  <object name=\"rooma\">\r\n    <inherit name=\"editor_room\" />\r\n    <exit alias=\"south\" to=\"roomb\">\r\n      <inherit name=\"southdirection\" />\r\n    </exit>\r\n    <exit alias=\"east\" to=\"lift\">\r\n      <inherit name=\"eastdirection\" />\r\n      <inherit name=\"liftentrance\" />\r\n    </exit>\r\n  </object>\r\n  <object name=\"roomb\">\r\n    <inherit name=\"editor_room\" />\r\n    <exit alias=\"north\" to=\"rooma\">\r\n      <inherit name=\"northdirection\" />\r\n    </exit>\r\n  </object>\r\n</asl>```\r\n-------------------------------------------------------",
      "EditableFormat": "markdown",
      "HTML": "<p>This is so weird!!</p>\n<p>I use the lib you posted yesterday.<br>\nAnd the game below.</p>\n<p>And it complains if the map is enabled and the lift is called anything other than \"lift\"<br>\nOtherwise it is fine. :-O:-O`</p>\n<hr>\n<pre><code>&lt;asl version=\"550\"&gt;\n  &lt;include ref=\"English.aslx\" /&gt;\n  &lt;include ref=\"Core.aslx\" /&gt;\n  &lt;include ref=\"LiftLib.aslx\" /&gt;\n  &lt;game name=\"lifttesta\"&gt;\n    &lt;gameid&gt;22bf84c4-8e87-42d3-9884-89491618f4b9&lt;/gameid&gt;\n    &lt;version&gt;1.0&lt;/version&gt;\n    &lt;firstpublished&gt;2018&lt;/firstpublished&gt;\n    &lt;gridmap /&gt;\n  &lt;/game&gt;\n  &lt;object name=\"room\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;object name=\"player\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"editor_player\" /&gt;\n    &lt;/object&gt;\n    &lt;exit alias=\"east\" to=\"room1\"&gt;\n      &lt;inherit name=\"eastdirection\" /&gt;\n    &lt;/exit&gt;\n    &lt;object name=\"hammer\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;take /&gt;\n      &lt;feature_usegive /&gt;\n      &lt;selfuseon type=\"scriptdictionary\" /&gt;\n    &lt;/object&gt;\n    &lt;object name=\"nail\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;feature_usegive /&gt;\n      &lt;useon type=\"scriptdictionary\"&gt;\n        &lt;item key=\"hammer\"&gt;\n          msg (\"bang bang\")\n        &lt;/item&gt;\n      &lt;/useon&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n  &lt;object name=\"room1\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;exit alias=\"west\" to=\"room\"&gt;\n      &lt;inherit name=\"westdirection\" /&gt;\n    &lt;/exit&gt;\n    &lt;exit alias=\"east\" to=\"room2\"&gt;\n      &lt;inherit name=\"eastdirection\" /&gt;\n    &lt;/exit&gt;\n  &lt;/object&gt;\n  &lt;object name=\"room2\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;exit alias=\"west\" to=\"room1\"&gt;\n      &lt;inherit name=\"westdirection\" /&gt;\n    &lt;/exit&gt;\n    &lt;exit alias=\"east\" to=\"lift\"&gt;\n      &lt;inherit name=\"eastdirection\" /&gt;\n      &lt;inherit name=\"liftentrance\" /&gt;\n    &lt;/exit&gt;\n  &lt;/object&gt;\n  &lt;object name=\"lift\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;inherit name=\"liftroom\" /&gt;\n    &lt;object name=\"knap1\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"liftbutton\" /&gt;\n      &lt;floor type=\"int\"&gt;1&lt;/floor&gt;\n      &lt;destination type=\"object\"&gt;room2&lt;/destination&gt;\n    &lt;/object&gt;\n    &lt;object name=\"knap2\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"liftbutton\" /&gt;\n      &lt;floor type=\"int\"&gt;2&lt;/floor&gt;\n      &lt;destination type=\"object\"&gt;rooma&lt;/destination&gt;\n    &lt;/object&gt;\n    &lt;exit alias=\"west\" to=\"room2\"&gt;\n      &lt;inherit name=\"westdirection\" /&gt;\n    &lt;/exit&gt;\n  &lt;/object&gt;\n  &lt;object name=\"rooma\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;exit alias=\"south\" to=\"roomb\"&gt;\n      &lt;inherit name=\"southdirection\" /&gt;\n    &lt;/exit&gt;\n    &lt;exit alias=\"east\" to=\"lift\"&gt;\n      &lt;inherit name=\"eastdirection\" /&gt;\n      &lt;inherit name=\"liftentrance\" /&gt;\n    &lt;/exit&gt;\n  &lt;/object&gt;\n  &lt;object name=\"roomb\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;exit alias=\"north\" to=\"rooma\"&gt;\n      &lt;inherit name=\"northdirection\" /&gt;\n    &lt;/exit&gt;\n  &lt;/object&gt;\n&lt;/asl&gt;```\n-------------------------------------------------------\n</code></pre>\n\n",
      "PostDate": "2018-02-26T18:34:47.4676183Z",
      "LastEditDate": "2018-02-26T18:37:06.4866117Z",
      "link": null
    },
    {
      "PostId": "21b030ff-e831-4836-aeb7-659fa3876211",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "You are absolutely right!\r\n\r\nI don't how that example still worked, but I made a new one and it had the same problem you describe with the map.\r\n\r\nI fixed the library.  (Sorry!!!)\r\n\r\nHad to change this:\r\n```thisdict = DictionaryItem(player.grid_coordinates,\"lift\")```\r\n\r\n\r\nto this:\r\n```thisdict = DictionaryItem(player.grid_coordinates, this.name)```\r\n\r\n\r\n```\r\n<?xml version=\"1.0\"?>\r\n<library>\r\n  <!--\r\n  If you are viewing this on GitHub and want to download it, right click on the RAW button\r\n  just above, and select \"Save link as...\"\r\n  -->\r\n\r\n\r\n  <!--\r\n  LiftLib v2.1\r\n  \r\n  Quest version: 5.6\r\n  Written by: The Pixie, 2011-2018\r\n  \r\n  Version 2.1_and_a_half\r\n  Modded by: KV, 2018\r\n  Tutorial and notes here:\r\n  https://github.com/ThePix/quest/wiki/Lift-Library\r\n  -->\r\n\r\n\r\n\r\n\r\n  <verb name=\"press\">\r\n    <property>press</property>\r\n    <pattern>press;push</pattern>\r\n    <defaultexpression>\"You can't press \" + object.article + \".\"</defaultexpression>\r\n  </verb>\r\n  \r\n  \r\n  \r\n\r\n  <type name=\"liftroom\">\r\n    <current_floor type=\"int\">1</current_floor>\r\n    <usage_count type=\"int\">0</usage_count>\r\n    <lockexits type=\"boolean\">false</lockexits>\r\n    <goingup>The lift ascends to ###.</goingup>\r\n    <goingdown>The lift descends to ###.</goingdown>\r\n    <leavingmsg type=\"string\"></leavingmsg>\r\n    <samefloor>Nothing happens. Perhaps because you are already on ###.</samefloor>\r\n\t<attr name=\"changedcurrent_floor\" type=\"script\">\r\n      oldvalue = this.last_floor\r\n      currentvalue = this.current_floor\r\n      change = oldvalue - currentvalue\r\n      if (game.gridmap) {\r\n\tthisdict = DictionaryItem(player.grid_coordinates, this.name)\r\n        if (Grid_GetRoomBooleanForPlayer(game.pov, this, \"grid_isdrawn\")) {\r\n          dictionary remove (thisdict, \"z\")\r\n          dictionary add (thisdict, \"z\", currentvalue*1.0+change)\r\n          Grid_CalculateMapCoordinates (this, game.pov)\r\n          Grid_Redraw  //THIS CLEARS ANY GRID FILLS!\r\n          Grid_DrawPlayerInRoom (game.pov.parent)\r\n        }\r\n      }\r\n    </attr>\r\n    <onexit type=\"script\">\r\n      LeavingTheLift(this)\r\n    </onexit>\r\n  </type>\r\n  \r\n  \r\n  \r\n\r\n  <type name=\"liftbutton\">\r\n    <displayverbs type=\"simplestringlist\">Press</displayverbs>\r\n    <floor type=\"int\">1</floor>\r\n    <pressmsg>You press the button.</pressmsg>\r\n    <press type=\"script\">\r\n      _PressButton(this, false)\r\n    </press>\r\n    <move type=\"script\">\r\n      // Invoke this to have the lift move to this button's destination\r\n      // without any text appearing. The Arrival function is not called\r\n      _PressButton(this, true)\r\n    </move>\r\n  </type>\r\n\r\n  <type name=\"liftentrance\">\r\n    <runscript type=\"boolean\">true</runscript>\r\n    <script type=\"script\">\r\n      exit = ObjectListItem (ScopeExitsForRoom (this.to), 0)\r\n      exit.to = game.pov.parent\r\n\t  game.pov.parent.last_floor = game.pov.parent.parent\r\n      MoveObject (game.pov, this.to)\r\n      //msg(\"about to check children of \" + this.to.name)\r\n      foreach (obj, GetDirectChildren (this.to)) {\r\n        if (DoesInherit (obj, \"liftbutton\")) {\r\n          if (obj.to = this.parent) {\r\n            this.to.current_floor = obj.floor\r\n            //msg(\"exit setting to \" + obj.floor + \" a \" + TypeOf(obj.floor))\r\n          }\r\n        }\r\n      }\r\n    </script>\r\n  </type>\r\n\r\n  \r\n  <function name=\"_PressButton\" parameters=\"button, silently\">\r\n      exit = ObjectListItem (ScopeExitsForRoom (button.parent), 0)\r\n      current = exit.to\r\n      current_button = null\r\n      foreach (o, GetDirectChildren(button.parent)) {\r\n        if (o.destination = current) current_button = o\r\n      }\r\n      if (exit.to = button.destination) {\r\n        moved = false\r\n        s = button.parent.samefloor\r\n      }\r\n      else {\r\n        moved = true\r\n\t\tbutton.parent.last_floor = button.parent.current_floor\r\n        exit.to = button.destination\r\n        if (button.parent.current_floor > button.floor) {\r\n          s = button.parent.goingdown\r\n        }\r\n        else {\r\n          s = button.parent.goingup\r\n        }\r\n        button.parent.current_floor = button.floor\r\n        if (not current_button = null) {\r\n          if (HasString(current_button, \"departure\")) {\r\n            s = current_button.departure + \" \" + s\r\n          }\r\n        }\r\n        if (HasString(button, \"arrival\")) {\r\n          s = s + \" \" + button.arrival\r\n        }\r\n        button.parent.usage_count = button.parent.usage_count + 1\r\n      }\r\n      // prepend the button pressing message\r\n      s = button.pressmsg + \" \" + s\r\n      // Swap ### for the floor name\r\n      if (HasString(button, \"floorname\")) {\r\n        s = Replace (s, \"###\", ToString (button.floorname))\r\n      }\r\n      else {\r\n        s = Replace (s, \"###\", \"floor \" + button.floor)\r\n      }\r\n      if (not silently) {\r\n        Arrival(button, s, moved)\r\n      }\r\n\t</function>\r\n\r\n  \r\n  \r\n\r\n\r\n  <!--\r\n  This is called when the player presses a button (but not\r\n  when the lift is moved another time).\r\n  You can override this to have it print in a fancy way, or to have it do something when\r\n  the lift moves.\r\n  -->\r\n  <function name=\"Arrival\" parameters=\"button, s, moved\">\r\n    msg(s)\r\n\t</function>\r\n\r\n\r\n  <function name=\"LeavingTheLift\" parameters=\"this\">\r\n    if (not this.leavingmsg = \"\") {\r\n      msg (this.leavingmsg)\r\n    }\r\n\t</function>\r\n\r\n\r\n  <function name=\"LiftRoom\" type=\"object\" parameters=\"button\">\r\n    if (DoesInherit(button, \"liftroom\")) {\r\n      return (button)\r\n    }\r\n    return (button.parent)\r\n\t</function>\r\n\r\n  <function name=\"LiftExit\" type=\"object\" parameters=\"button\">\r\n    return (ObjectListItem (ScopeExitsForRoom (LiftRoom(button)), 0))\r\n\t</function>\r\n\r\n  <function name=\"LiftCurrentFloor\" type=\"object\" parameters=\"button\">\r\n    exit = LiftExit(button)\r\n    return (exit.to)\r\n\t</function>\r\n\r\n  <function name=\"LiftCurrentButton\" type=\"object\" parameters=\"button\">\r\n    current = LiftCurrentFloor(button)\r\n    current_button = null\r\n    foreach (o, GetDirectChildren(LiftRoom(button))) {\r\n      if (o.destination = current) current_button = o\r\n    }\r\n    return (current_button)\r\n\t</function>\r\n\r\n  <function name=\"LiftAllButtons\" type=\"objectlist\" parameters=\"button\">\r\n    ol = NewObjectList()\r\n    foreach (o, GetDirectChildren(LiftRoom(button))) {\r\n      if (DoesInherit(o, \"liftbutton\")) list add(ol, o)\r\n    }\r\n    return (ol)\r\n\t</function>\r\n\r\n  <function name=\"LiftAllEntrances\" type=\"objectlist\" parameters=\"button\">\r\n    ol = NewObjectList()\r\n    foreach (o, LiftAllButtons(button)) {\r\n      list add(ol, GetObject(GetExitByLink (o.destination, LiftRoom(button))))\r\n    }\r\n    return (ol)\r\n\t</function>\r\n\r\n  <function name=\"LiftCurrentEntrance\" type=\"object\" parameters=\"button\">\r\n    return (GetObject(GetExitByLink (LiftCurrentFloor(button), LiftRoom(button))))\r\n\t</function>\r\n\r\n\r\n \r\n  \r\n  \r\n <!-- =================================================== -->\r\n  <!-- Tabs -->\r\n\r\n  <tab>\r\n    <parent>_ObjectEditor</parent>\r\n    <caption>Lift</caption>\r\n    <mustnotinherit>defaultplayer</mustnotinherit>\r\n\r\n    <control>\r\n      <controltype>dropdowntypes</controltype>\r\n      <caption>Type</caption>\r\n      <types>*=None; liftroom=Lift; liftbutton=Lift Button; liftentrance=Lift Entrance</types>\r\n      <width>150</width>\r\n    </control>\r\n\r\n    <control>\r\n      <controltype>textbox</controltype>\r\n      <caption>Same floor message</caption>\r\n      <attribute>samefloor</attribute>\r\n      <mustinherit>liftroom</mustinherit>\r\n    </control>\r\n\r\n    <control>\r\n      <controltype>textbox</controltype>\r\n      <caption>The going up message</caption>\r\n      <attribute>goingup</attribute>\r\n      <mustinherit>liftroom</mustinherit>\r\n    </control>\r\n\r\n    <control>\r\n      <controltype>textbox</controltype>\r\n      <caption>The going down message</caption>\r\n      <attribute>goingdown</attribute>\r\n      <mustinherit>liftroom</mustinherit>\r\n    </control>\r\n\r\n    <control>\r\n      <controltype>textbox</controltype>\r\n      <caption>The leaving message</caption>\r\n      <attribute>leavingmsg</attribute>\r\n      <mustinherit>liftroom</mustinherit>\r\n    </control>\r\n\r\n    <control>\r\n      <controltype>checkbox</controltype>\r\n      <caption>Lock exit after entering lift</caption>\r\n      <attribute>lockexits</attribute>\r\n      <mustinherit>liftroom</mustinherit>\r\n    </control>\r\n\r\n    <control>\r\n      <controltype>textbox</controltype>\r\n      <caption>Departure message</caption>\r\n      <attribute>departure</attribute>\r\n      <mustinherit>editor_room</mustinherit>\r\n      <mustinherit>liftbutton</mustinherit>\r\n    </control>\r\n\r\n    <control>\r\n      <controltype>textbox</controltype>\r\n      <caption>Arrival message</caption>\r\n      <attribute>arrival</attribute>\r\n      <mustinherit>liftbutton</mustinherit>\r\n    </control>\r\n\r\n    <control>\r\n      <controltype>textbox</controltype>\r\n      <caption>Press message</caption>\r\n      <attribute>pressmsg</attribute>\r\n      <mustinherit>liftbutton</mustinherit>\r\n    </control>\r\n\r\n    <control>\r\n      <controltype>textbox</controltype>\r\n      <caption>Floor name</caption>\r\n      <attribute>floorname</attribute>\r\n      <mustinherit>liftbutton</mustinherit>\r\n    </control>\r\n\r\n\r\n    <control>\r\n      <controltype>objects</controltype>\r\n      <caption>Destination</caption>\r\n      <attribute>destination</attribute>\r\n      <mustinherit>liftbutton</mustinherit>\r\n    </control>\r\n\r\n    <control>\r\n      <controltype>number</controltype>\r\n      <caption>Floor</caption>\r\n      <attribute>floor</attribute>\r\n      <width>100</width>\r\n      <mustinherit>liftbutton</mustinherit>\r\n    </control>\r\n\r\n  </tab>\r\n</library>\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p>You are absolutely right!</p>\n<p>I don't how that example still worked, but I made a new one and it had the same problem you describe with the map.</p>\n<p>I fixed the library.  (Sorry!!!)</p>\n<p>Had to change this:<br>\n<code>thisdict = DictionaryItem(player.grid_coordinates,\"lift\")</code></p>\n<p>to this:<br>\n<code>thisdict = DictionaryItem(player.grid_coordinates, this.name)</code></p>\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;library&gt;\n  &lt;!--\n  If you are viewing this on GitHub and want to download it, right click on the RAW button\n  just above, and select \"Save link as...\"\n  --&gt;\n\n\n  &lt;!--\n  LiftLib v2.1\n  \n  Quest version: 5.6\n  Written by: The Pixie, 2011-2018\n  \n  Version 2.1_and_a_half\n  Modded by: KV, 2018\n  Tutorial and notes here:\n  https://github.com/ThePix/quest/wiki/Lift-Library\n  --&gt;\n\n\n\n\n  &lt;verb name=\"press\"&gt;\n    &lt;property&gt;press&lt;/property&gt;\n    &lt;pattern&gt;press;push&lt;/pattern&gt;\n    &lt;defaultexpression&gt;\"You can't press \" + object.article + \".\"&lt;/defaultexpression&gt;\n  &lt;/verb&gt;\n  \n  \n  \n\n  &lt;type name=\"liftroom\"&gt;\n    &lt;current_floor type=\"int\"&gt;1&lt;/current_floor&gt;\n    &lt;usage_count type=\"int\"&gt;0&lt;/usage_count&gt;\n    &lt;lockexits type=\"boolean\"&gt;false&lt;/lockexits&gt;\n    &lt;goingup&gt;The lift ascends to ###.&lt;/goingup&gt;\n    &lt;goingdown&gt;The lift descends to ###.&lt;/goingdown&gt;\n    &lt;leavingmsg type=\"string\"&gt;&lt;/leavingmsg&gt;\n    &lt;samefloor&gt;Nothing happens. Perhaps because you are already on ###.&lt;/samefloor&gt;\n\t&lt;attr name=\"changedcurrent_floor\" type=\"script\"&gt;\n      oldvalue = this.last_floor\n      currentvalue = this.current_floor\n      change = oldvalue - currentvalue\n      if (game.gridmap) {\n\tthisdict = DictionaryItem(player.grid_coordinates, this.name)\n        if (Grid_GetRoomBooleanForPlayer(game.pov, this, \"grid_isdrawn\")) {\n          dictionary remove (thisdict, \"z\")\n          dictionary add (thisdict, \"z\", currentvalue*1.0+change)\n          Grid_CalculateMapCoordinates (this, game.pov)\n          Grid_Redraw  //THIS CLEARS ANY GRID FILLS!\n          Grid_DrawPlayerInRoom (game.pov.parent)\n        }\n      }\n    &lt;/attr&gt;\n    &lt;onexit type=\"script\"&gt;\n      LeavingTheLift(this)\n    &lt;/onexit&gt;\n  &lt;/type&gt;\n  \n  \n  \n\n  &lt;type name=\"liftbutton\"&gt;\n    &lt;displayverbs type=\"simplestringlist\"&gt;Press&lt;/displayverbs&gt;\n    &lt;floor type=\"int\"&gt;1&lt;/floor&gt;\n    &lt;pressmsg&gt;You press the button.&lt;/pressmsg&gt;\n    &lt;press type=\"script\"&gt;\n      _PressButton(this, false)\n    &lt;/press&gt;\n    &lt;move type=\"script\"&gt;\n      // Invoke this to have the lift move to this button's destination\n      // without any text appearing. The Arrival function is not called\n      _PressButton(this, true)\n    &lt;/move&gt;\n  &lt;/type&gt;\n\n  &lt;type name=\"liftentrance\"&gt;\n    &lt;runscript type=\"boolean\"&gt;true&lt;/runscript&gt;\n    &lt;script type=\"script\"&gt;\n      exit = ObjectListItem (ScopeExitsForRoom (this.to), 0)\n      exit.to = game.pov.parent\n\t  game.pov.parent.last_floor = game.pov.parent.parent\n      MoveObject (game.pov, this.to)\n      //msg(\"about to check children of \" + this.to.name)\n      foreach (obj, GetDirectChildren (this.to)) {\n        if (DoesInherit (obj, \"liftbutton\")) {\n          if (obj.to = this.parent) {\n            this.to.current_floor = obj.floor\n            //msg(\"exit setting to \" + obj.floor + \" a \" + TypeOf(obj.floor))\n          }\n        }\n      }\n    &lt;/script&gt;\n  &lt;/type&gt;\n\n  \n  &lt;function name=\"_PressButton\" parameters=\"button, silently\"&gt;\n      exit = ObjectListItem (ScopeExitsForRoom (button.parent), 0)\n      current = exit.to\n      current_button = null\n      foreach (o, GetDirectChildren(button.parent)) {\n        if (o.destination = current) current_button = o\n      }\n      if (exit.to = button.destination) {\n        moved = false\n        s = button.parent.samefloor\n      }\n      else {\n        moved = true\n\t\tbutton.parent.last_floor = button.parent.current_floor\n        exit.to = button.destination\n        if (button.parent.current_floor &gt; button.floor) {\n          s = button.parent.goingdown\n        }\n        else {\n          s = button.parent.goingup\n        }\n        button.parent.current_floor = button.floor\n        if (not current_button = null) {\n          if (HasString(current_button, \"departure\")) {\n            s = current_button.departure + \" \" + s\n          }\n        }\n        if (HasString(button, \"arrival\")) {\n          s = s + \" \" + button.arrival\n        }\n        button.parent.usage_count = button.parent.usage_count + 1\n      }\n      // prepend the button pressing message\n      s = button.pressmsg + \" \" + s\n      // Swap ### for the floor name\n      if (HasString(button, \"floorname\")) {\n        s = Replace (s, \"###\", ToString (button.floorname))\n      }\n      else {\n        s = Replace (s, \"###\", \"floor \" + button.floor)\n      }\n      if (not silently) {\n        Arrival(button, s, moved)\n      }\n\t&lt;/function&gt;\n\n  \n  \n\n\n  &lt;!--\n  This is called when the player presses a button (but not\n  when the lift is moved another time).\n  You can override this to have it print in a fancy way, or to have it do something when\n  the lift moves.\n  --&gt;\n  &lt;function name=\"Arrival\" parameters=\"button, s, moved\"&gt;\n    msg(s)\n\t&lt;/function&gt;\n\n\n  &lt;function name=\"LeavingTheLift\" parameters=\"this\"&gt;\n    if (not this.leavingmsg = \"\") {\n      msg (this.leavingmsg)\n    }\n\t&lt;/function&gt;\n\n\n  &lt;function name=\"LiftRoom\" type=\"object\" parameters=\"button\"&gt;\n    if (DoesInherit(button, \"liftroom\")) {\n      return (button)\n    }\n    return (button.parent)\n\t&lt;/function&gt;\n\n  &lt;function name=\"LiftExit\" type=\"object\" parameters=\"button\"&gt;\n    return (ObjectListItem (ScopeExitsForRoom (LiftRoom(button)), 0))\n\t&lt;/function&gt;\n\n  &lt;function name=\"LiftCurrentFloor\" type=\"object\" parameters=\"button\"&gt;\n    exit = LiftExit(button)\n    return (exit.to)\n\t&lt;/function&gt;\n\n  &lt;function name=\"LiftCurrentButton\" type=\"object\" parameters=\"button\"&gt;\n    current = LiftCurrentFloor(button)\n    current_button = null\n    foreach (o, GetDirectChildren(LiftRoom(button))) {\n      if (o.destination = current) current_button = o\n    }\n    return (current_button)\n\t&lt;/function&gt;\n\n  &lt;function name=\"LiftAllButtons\" type=\"objectlist\" parameters=\"button\"&gt;\n    ol = NewObjectList()\n    foreach (o, GetDirectChildren(LiftRoom(button))) {\n      if (DoesInherit(o, \"liftbutton\")) list add(ol, o)\n    }\n    return (ol)\n\t&lt;/function&gt;\n\n  &lt;function name=\"LiftAllEntrances\" type=\"objectlist\" parameters=\"button\"&gt;\n    ol = NewObjectList()\n    foreach (o, LiftAllButtons(button)) {\n      list add(ol, GetObject(GetExitByLink (o.destination, LiftRoom(button))))\n    }\n    return (ol)\n\t&lt;/function&gt;\n\n  &lt;function name=\"LiftCurrentEntrance\" type=\"object\" parameters=\"button\"&gt;\n    return (GetObject(GetExitByLink (LiftCurrentFloor(button), LiftRoom(button))))\n\t&lt;/function&gt;\n\n\n \n  \n  \n &lt;!-- =================================================== --&gt;\n  &lt;!-- Tabs --&gt;\n\n  &lt;tab&gt;\n    &lt;parent&gt;_ObjectEditor&lt;/parent&gt;\n    &lt;caption&gt;Lift&lt;/caption&gt;\n    &lt;mustnotinherit&gt;defaultplayer&lt;/mustnotinherit&gt;\n\n    &lt;control&gt;\n      &lt;controltype&gt;dropdowntypes&lt;/controltype&gt;\n      &lt;caption&gt;Type&lt;/caption&gt;\n      &lt;types&gt;*=None; liftroom=Lift; liftbutton=Lift Button; liftentrance=Lift Entrance&lt;/types&gt;\n      &lt;width&gt;150&lt;/width&gt;\n    &lt;/control&gt;\n\n    &lt;control&gt;\n      &lt;controltype&gt;textbox&lt;/controltype&gt;\n      &lt;caption&gt;Same floor message&lt;/caption&gt;\n      &lt;attribute&gt;samefloor&lt;/attribute&gt;\n      &lt;mustinherit&gt;liftroom&lt;/mustinherit&gt;\n    &lt;/control&gt;\n\n    &lt;control&gt;\n      &lt;controltype&gt;textbox&lt;/controltype&gt;\n      &lt;caption&gt;The going up message&lt;/caption&gt;\n      &lt;attribute&gt;goingup&lt;/attribute&gt;\n      &lt;mustinherit&gt;liftroom&lt;/mustinherit&gt;\n    &lt;/control&gt;\n\n    &lt;control&gt;\n      &lt;controltype&gt;textbox&lt;/controltype&gt;\n      &lt;caption&gt;The going down message&lt;/caption&gt;\n      &lt;attribute&gt;goingdown&lt;/attribute&gt;\n      &lt;mustinherit&gt;liftroom&lt;/mustinherit&gt;\n    &lt;/control&gt;\n\n    &lt;control&gt;\n      &lt;controltype&gt;textbox&lt;/controltype&gt;\n      &lt;caption&gt;The leaving message&lt;/caption&gt;\n      &lt;attribute&gt;leavingmsg&lt;/attribute&gt;\n      &lt;mustinherit&gt;liftroom&lt;/mustinherit&gt;\n    &lt;/control&gt;\n\n    &lt;control&gt;\n      &lt;controltype&gt;checkbox&lt;/controltype&gt;\n      &lt;caption&gt;Lock exit after entering lift&lt;/caption&gt;\n      &lt;attribute&gt;lockexits&lt;/attribute&gt;\n      &lt;mustinherit&gt;liftroom&lt;/mustinherit&gt;\n    &lt;/control&gt;\n\n    &lt;control&gt;\n      &lt;controltype&gt;textbox&lt;/controltype&gt;\n      &lt;caption&gt;Departure message&lt;/caption&gt;\n      &lt;attribute&gt;departure&lt;/attribute&gt;\n      &lt;mustinherit&gt;editor_room&lt;/mustinherit&gt;\n      &lt;mustinherit&gt;liftbutton&lt;/mustinherit&gt;\n    &lt;/control&gt;\n\n    &lt;control&gt;\n      &lt;controltype&gt;textbox&lt;/controltype&gt;\n      &lt;caption&gt;Arrival message&lt;/caption&gt;\n      &lt;attribute&gt;arrival&lt;/attribute&gt;\n      &lt;mustinherit&gt;liftbutton&lt;/mustinherit&gt;\n    &lt;/control&gt;\n\n    &lt;control&gt;\n      &lt;controltype&gt;textbox&lt;/controltype&gt;\n      &lt;caption&gt;Press message&lt;/caption&gt;\n      &lt;attribute&gt;pressmsg&lt;/attribute&gt;\n      &lt;mustinherit&gt;liftbutton&lt;/mustinherit&gt;\n    &lt;/control&gt;\n\n    &lt;control&gt;\n      &lt;controltype&gt;textbox&lt;/controltype&gt;\n      &lt;caption&gt;Floor name&lt;/caption&gt;\n      &lt;attribute&gt;floorname&lt;/attribute&gt;\n      &lt;mustinherit&gt;liftbutton&lt;/mustinherit&gt;\n    &lt;/control&gt;\n\n\n    &lt;control&gt;\n      &lt;controltype&gt;objects&lt;/controltype&gt;\n      &lt;caption&gt;Destination&lt;/caption&gt;\n      &lt;attribute&gt;destination&lt;/attribute&gt;\n      &lt;mustinherit&gt;liftbutton&lt;/mustinherit&gt;\n    &lt;/control&gt;\n\n    &lt;control&gt;\n      &lt;controltype&gt;number&lt;/controltype&gt;\n      &lt;caption&gt;Floor&lt;/caption&gt;\n      &lt;attribute&gt;floor&lt;/attribute&gt;\n      &lt;width&gt;100&lt;/width&gt;\n      &lt;mustinherit&gt;liftbutton&lt;/mustinherit&gt;\n    &lt;/control&gt;\n\n  &lt;/tab&gt;\n&lt;/library&gt;\n</code></pre>\n\n",
      "PostDate": "2018-02-26T18:58:41.1376483Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "57b19fad-e9f8-4ab0-93f3-aef440a201d3",
      "UserId": 344046,
      "Username": "baskham",
      "AvatarUrl": "https://secure.gravatar.com/avatar/7689475b10ef3f61ec180330cc180daa?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "YAY!!!!\r\n\r\nIt works!!\r\nIn all situations.\r\n\r\nThank you.\r\nUnited we stand :-)",
      "EditableFormat": "markdown",
      "HTML": "<p>YAY!!!!</p>\n<p>It works!!<br>\nIn all situations.</p>\n<p>Thank you.<br>\nUnited we stand :-)</p>\n\n",
      "PostDate": "2018-02-26T19:36:09.1220293Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "d0685afc-1954-4a72-bc68-f02d1ec7bd3b",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "You're welcome!\r\n\r\nThank you for going through all the frustration which led to the fix!\r\n\r\n---\r\nAlso note:\r\n\r\nI only fiddled with Pixie's library because he's got quite the agenda lately.  (Ahem.  I won't mention Quest 5.8.)\r\n\r\nAt some point, he will more than likely post an updated version of LiftLib which fixes the bugs and adds more functionality than we just did, and in a more efficient manner.",
      "EditableFormat": "markdown",
      "HTML": "<p>You're welcome!</p>\n<p>Thank you for going through all the frustration which led to the fix!</p>\n<hr>\n<p>Also note:</p>\n<p>I only fiddled with Pixie's library because he's got quite the agenda lately.  (Ahem.  I won't mention Quest 5.8.)</p>\n<p>At some point, he will more than likely post an updated version of LiftLib which fixes the bugs and adds more functionality than we just did, and in a more efficient manner.</p>\n\n",
      "PostDate": "2018-02-26T22:00:09.4183882Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "cfb5dcab-3b16-4f6b-84f3-f90b57a639ca",
      "UserId": 344046,
      "Username": "baskham",
      "AvatarUrl": "https://secure.gravatar.com/avatar/7689475b10ef3f61ec180330cc180daa?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": ":-(\r\n\r\nI now discovered a problem with this.\r\n\r\nIf you move around on the original floor, the grid is drawn correctly.\r\nThen if you take the lift to another floor, the already drawn map is still visible but toned down (or grayed out or whatever :-))\r\nAnd then when you leave the lift and move around the map of the new floor is drawn on top of the toned down map (but drawn correctly).\r\n\r\nThis is very confusing to some of my testers, as they don't realize that the toned down rooms should be ignored.\r\n\r\nIs there anyway to just erase the map when you go to a new floor?\r\nBut of course when you return to a floor, the map should once again  be drawn with the rooms you have already visited...",
      "EditableFormat": "markdown",
      "HTML": "<p>:-(</p>\n<p>I now discovered a problem with this.</p>\n<p>If you move around on the original floor, the grid is drawn correctly.<br>\nThen if you take the lift to another floor, the already drawn map is still visible but toned down (or grayed out or whatever :-))<br>\nAnd then when you leave the lift and move around the map of the new floor is drawn on top of the toned down map (but drawn correctly).</p>\n<p>This is very confusing to some of my testers, as they don't realize that the toned down rooms should be ignored.</p>\n<p>Is there anyway to just erase the map when you go to a new floor?<br>\nBut of course when you return to a floor, the map should once again  be drawn with the rooms you have already visited...</p>\n\n",
      "PostDate": "2018-03-22T19:26:30.644734Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

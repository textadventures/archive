{
  "Topic": {
    "TopicId": "si3c7rvwdeysrqxz1lhrpq",
    "ForumId": "10",
    "Title": "Custom Status Pane not working",
    "LastUpdated": "2017-09-08T18:19:24.5842931Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "41341fdd-ec81-45d7-b57b-367cb9183e07",
      "UserId": 194873,
      "Username": "ShadowsEdge19",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a24333a42009e96c558cb89dc0c26d30?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Hi,\r\nI'm trying to make my custom Status pane work based off the following guide: http://docs.textadventures.co.uk/quest/custom_panes.html\r\n\r\nBut all I get is \r\n\r\nHit Points:\t---\r\n\r\nThen a full black bar.\r\n\r\nWhat am I doing wrong here?\r\n\r\nAlso how do I go about pushing a refresh of the status bar once I've changed the HP of the player after a turn action inside a room object? \r\n\r\nI would also like to have another panel or addition to this one where other player stats are listed, like Strength, Defence, etc while keeping this HP bar.\r\n\r\n```\r\n<!--Saved by Quest 5.7.6404.15496-->\r\n<asl version=\"550\">\r\n  <include ref=\"English.aslx\" />\r\n  <include ref=\"Core.aslx\" />\r\n  <game name=\"TestCustomPane\">\r\n    <gameid>853d3220-63b6-4b84-a5e1-aa279b29d27f</gameid>\r\n    <version>1.0</version>\r\n    <firstpublished>2017</firstpublished>\r\n    <commandpane type=\"boolean\">false</commandpane>\r\n    <customstatuspane />\r\n    <attr name=\"feature_advancedwearables\" type=\"boolean\">false</attr>\r\n    <feature_advancedscripts />\r\n    <inituserinterface type=\"script\"><![CDATA[\r\n      s = \"<table width=\\\"100%\\\"><tr>\"\r\n      s = s + \"   <td style=\\\"text-align:right;\\\" width=\\\"50%\\\">Hit Points:</td>\"\r\n      s = s + \"   <td style=\\\"text-align:left;\\\" width=\\\"50%\\\"><span id=\\\"hits-span\\\">---</span></td>\"\r\n      s = s + \" </tr>\"\r\n      s = s + \" <tr>\"\r\n      s = s + \"   <td colspan=\\\"2\\\" style=\\\"border: thin solid;background:white;text-align:left;\\\">\"\r\n      s = s + \"   <span id=\\\"hits-indicator\\\" style=\\\"background-color:black;padding-right:200px;\\\"></span>\"\r\n      s = s + \"   </td>\"\r\n      s = s + \" </tr>\"\r\n      s = s + \"</table>\"\r\n      JS.setCustomStatus (s)\r\n      if (HasScript(player, \"changedhitpoints\")) {\r\n        do (player, \"changedhitpoints\")\r\n      }\r\n    ]]></inituserinterface>\r\n    <start type=\"script\"><![CDATA[\r\n      player.changedhitpoints => {\r\n        JS.eval (\"$('#hits-span').html('\" + player.HP + \"/\" + player.MaxHP + \"');\")\r\n        JS.eval (\"$('#hits-indicator').css('padding-right', '\" + (200 * player.HP / player.MaxHP) + \"px');\")\r\n      }\r\n      player.MaxHP = 200\r\n      player.HP = 100\r\n    ]]></start>\r\n  </game>\r\n  <object name=\"Start\">\r\n    <inherit name=\"editor_room\" />\r\n    <beforeenter type=\"script\">\r\n    </beforeenter>\r\n    <object name=\"player\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"editor_player\" />\r\n      <HP type=\"int\">150</HP>\r\n      <MaxHP type=\"int\">200</MaxHP>\r\n    </object>\r\n  </object>\r\n</asl>\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p>Hi,<br>\nI'm trying to make my custom Status pane work based off the following guide: http://docs.textadventures.co.uk/quest/custom_panes.html</p>\n<p>But all I get is</p>\n<p>Hit Points:\t---</p>\n<p>Then a full black bar.</p>\n<p>What am I doing wrong here?</p>\n<p>Also how do I go about pushing a refresh of the status bar once I've changed the HP of the player after a turn action inside a room object?</p>\n<p>I would also like to have another panel or addition to this one where other player stats are listed, like Strength, Defence, etc while keeping this HP bar.</p>\n<pre><code>&lt;!--Saved by Quest 5.7.6404.15496--&gt;\n&lt;asl version=\"550\"&gt;\n  &lt;include ref=\"English.aslx\" /&gt;\n  &lt;include ref=\"Core.aslx\" /&gt;\n  &lt;game name=\"TestCustomPane\"&gt;\n    &lt;gameid&gt;853d3220-63b6-4b84-a5e1-aa279b29d27f&lt;/gameid&gt;\n    &lt;version&gt;1.0&lt;/version&gt;\n    &lt;firstpublished&gt;2017&lt;/firstpublished&gt;\n    &lt;commandpane type=\"boolean\"&gt;false&lt;/commandpane&gt;\n    &lt;customstatuspane /&gt;\n    &lt;attr name=\"feature_advancedwearables\" type=\"boolean\"&gt;false&lt;/attr&gt;\n    &lt;feature_advancedscripts /&gt;\n    &lt;inituserinterface type=\"script\"&gt;&lt;![CDATA[\n      s = \"&lt;table width=\\\"100%\\\"&gt;&lt;tr&gt;\"\n      s = s + \"   &lt;td style=\\\"text-align:right;\\\" width=\\\"50%\\\"&gt;Hit Points:&lt;/td&gt;\"\n      s = s + \"   &lt;td style=\\\"text-align:left;\\\" width=\\\"50%\\\"&gt;&lt;span id=\\\"hits-span\\\"&gt;---&lt;/span&gt;&lt;/td&gt;\"\n      s = s + \" &lt;/tr&gt;\"\n      s = s + \" &lt;tr&gt;\"\n      s = s + \"   &lt;td colspan=\\\"2\\\" style=\\\"border: thin solid;background:white;text-align:left;\\\"&gt;\"\n      s = s + \"   &lt;span id=\\\"hits-indicator\\\" style=\\\"background-color:black;padding-right:200px;\\\"&gt;&lt;/span&gt;\"\n      s = s + \"   &lt;/td&gt;\"\n      s = s + \" &lt;/tr&gt;\"\n      s = s + \"&lt;/table&gt;\"\n      JS.setCustomStatus (s)\n      if (HasScript(player, \"changedhitpoints\")) {\n        do (player, \"changedhitpoints\")\n      }\n    ]]&gt;&lt;/inituserinterface&gt;\n    &lt;start type=\"script\"&gt;&lt;![CDATA[\n      player.changedhitpoints =&gt; {\n        JS.eval (\"$('#hits-span').html('\" + player.HP + \"/\" + player.MaxHP + \"');\")\n        JS.eval (\"$('#hits-indicator').css('padding-right', '\" + (200 * player.HP / player.MaxHP) + \"px');\")\n      }\n      player.MaxHP = 200\n      player.HP = 100\n    ]]&gt;&lt;/start&gt;\n  &lt;/game&gt;\n  &lt;object name=\"Start\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;beforeenter type=\"script\"&gt;\n    &lt;/beforeenter&gt;\n    &lt;object name=\"player\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"editor_player\" /&gt;\n      &lt;HP type=\"int\"&gt;150&lt;/HP&gt;\n      &lt;MaxHP type=\"int\"&gt;200&lt;/MaxHP&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n&lt;/asl&gt;\n</code></pre>\n\n",
      "PostDate": "2017-09-08T18:19:24.5842931Z",
      "LastEditDate": "2017-09-08T23:42:25.3272727Z",
      "link": null
    },
    {
      "PostId": "6f70dd99-d594-4a34-99d9-9fa8ab81873f",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "http://i.imgur.com/FOIjtApb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "![image](https://user-images.githubusercontent.com/30656341/30237799-13a3cd76-94ff-11e7-8c62-ebaadc8309cc.png)\r\n\r\n---\r\n\r\nHello!\r\n\r\n\r\nYou had:\r\n```\r\nplayer.MaxHP = 200\r\nplayer.HP = 100\r\n```\r\n\r\n\r\nI changed it to what Pixie has in the guide:\r\n\r\n```\r\nplayer.maxhitpoints = 200\r\nplayer.hitpoints = 100\r\n```\r\n\r\n\r\nI then took the liberty of replacing every instance of each with what Pixie had in the guide.  Here's the whole code:\r\n\r\n<details><summary>Click here for the code.</summary>\r\n\r\n```\r\n<!--Saved by Quest 5.7.6404.15496-->\r\n<asl version=\"550\">\r\n  <include ref=\"English.aslx\" />\r\n  <include ref=\"Core.aslx\" />\r\n  <game name=\"TestCustomPane\">\r\n    <gameid>853d3220-63b6-4b84-a5e1-aa279b29d27f</gameid>\r\n    <version>1.0</version>\r\n    <firstpublished>2017</firstpublished>\r\n    <commandpane type=\"boolean\">false</commandpane>\r\n    <customstatuspane />\r\n    <attr name=\"feature_advancedwearables\" type=\"boolean\">false</attr>\r\n    <feature_advancedscripts />\r\n    <inituserinterface type=\"script\"><![CDATA[\r\n      s = \"<table width=\\\"100%\\\"><tr>\"\r\n      s = s + \"   <td style=\\\"text-align:right;\\\" width=\\\"50%\\\">Hit Points:</td>\"\r\n      s = s + \"   <td style=\\\"text-align:left;\\\" width=\\\"50%\\\"><span id=\\\"hits-span\\\">---</span></td>\"\r\n      s = s + \" </tr>\"\r\n      s = s + \" <tr>\"\r\n      s = s + \"   <td colspan=\\\"2\\\" style=\\\"border: thin solid;background:white;text-align:left;\\\">\"\r\n      s = s + \"   <span id=\\\"hits-indicator\\\" style=\\\"background-color:black;padding-right:200px;\\\"></span>\"\r\n      s = s + \"   </td>\"\r\n      s = s + \" </tr>\"\r\n      s = s + \"</table>\"\r\n      JS.setCustomStatus (s)\r\n      if (HasScript(player, \"changedhitpoints\")) {\r\n        do (player, \"changedhitpoints\")\r\n      }\r\n    ]]></inituserinterface>\r\n    <start type=\"script\"><![CDATA[\r\n      player.changedhitpoints => {\r\n        JS.eval (\"$('#hits-span').html('\" + player.hitpoints + \"/\" + player.maxhitpoints + \"');\")\r\n        JS.eval (\"$('#hits-indicator').css('padding-right', '\" + (200 * player.hitpoints / player.maxhitpoints) + \"px');\")\r\n      }\r\n      player.maxhitpoints = 200\r\n      player.hitpoints = 100\r\n    ]]></start>\r\n  </game>\r\n  <object name=\"Start\">\r\n    <inherit name=\"editor_room\" />\r\n    <beforeenter type=\"script\">\r\n    </beforeenter>\r\n    <object name=\"player\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"editor_player\" />\r\n      <hitpoints type=\"int\">150</hitpoints>\r\n      <maxhitpoints type=\"int\">200</maxhitpoints>\r\n    </object>\r\n  </object>\r\n</asl>\r\n```\r\n\r\n\r\n</details>",
      "EditableFormat": "markdown",
      "HTML": "<p><img src=\"https://user-images.githubusercontent.com/30656341/30237799-13a3cd76-94ff-11e7-8c62-ebaadc8309cc.png\" alt=\"image\"></p>\n<hr>\n<p>Hello!</p>\n<p>You had:</p>\n<pre><code>player.MaxHP = 200\nplayer.HP = 100\n</code></pre>\n<p>I changed it to what Pixie has in the guide:</p>\n<pre><code>player.maxhitpoints = 200\nplayer.hitpoints = 100\n</code></pre>\n<p>I then took the liberty of replacing every instance of each with what Pixie had in the guide.  Here's the whole code:</p>\n<details><summary>Click here for the code.</summary>\n<pre><code>&lt;!--Saved by Quest 5.7.6404.15496--&gt;\n&lt;asl version=\"550\"&gt;\n  &lt;include ref=\"English.aslx\" /&gt;\n  &lt;include ref=\"Core.aslx\" /&gt;\n  &lt;game name=\"TestCustomPane\"&gt;\n    &lt;gameid&gt;853d3220-63b6-4b84-a5e1-aa279b29d27f&lt;/gameid&gt;\n    &lt;version&gt;1.0&lt;/version&gt;\n    &lt;firstpublished&gt;2017&lt;/firstpublished&gt;\n    &lt;commandpane type=\"boolean\"&gt;false&lt;/commandpane&gt;\n    &lt;customstatuspane /&gt;\n    &lt;attr name=\"feature_advancedwearables\" type=\"boolean\"&gt;false&lt;/attr&gt;\n    &lt;feature_advancedscripts /&gt;\n    &lt;inituserinterface type=\"script\"&gt;&lt;![CDATA[\n      s = \"&lt;table width=\\\"100%\\\"&gt;&lt;tr&gt;\"\n      s = s + \"   &lt;td style=\\\"text-align:right;\\\" width=\\\"50%\\\"&gt;Hit Points:&lt;/td&gt;\"\n      s = s + \"   &lt;td style=\\\"text-align:left;\\\" width=\\\"50%\\\"&gt;&lt;span id=\\\"hits-span\\\"&gt;---&lt;/span&gt;&lt;/td&gt;\"\n      s = s + \" &lt;/tr&gt;\"\n      s = s + \" &lt;tr&gt;\"\n      s = s + \"   &lt;td colspan=\\\"2\\\" style=\\\"border: thin solid;background:white;text-align:left;\\\"&gt;\"\n      s = s + \"   &lt;span id=\\\"hits-indicator\\\" style=\\\"background-color:black;padding-right:200px;\\\"&gt;&lt;/span&gt;\"\n      s = s + \"   &lt;/td&gt;\"\n      s = s + \" &lt;/tr&gt;\"\n      s = s + \"&lt;/table&gt;\"\n      JS.setCustomStatus (s)\n      if (HasScript(player, \"changedhitpoints\")) {\n        do (player, \"changedhitpoints\")\n      }\n    ]]&gt;&lt;/inituserinterface&gt;\n    &lt;start type=\"script\"&gt;&lt;![CDATA[\n      player.changedhitpoints =&gt; {\n        JS.eval (\"$('#hits-span').html('\" + player.hitpoints + \"/\" + player.maxhitpoints + \"');\")\n        JS.eval (\"$('#hits-indicator').css('padding-right', '\" + (200 * player.hitpoints / player.maxhitpoints) + \"px');\")\n      }\n      player.maxhitpoints = 200\n      player.hitpoints = 100\n    ]]&gt;&lt;/start&gt;\n  &lt;/game&gt;\n  &lt;object name=\"Start\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;beforeenter type=\"script\"&gt;\n    &lt;/beforeenter&gt;\n    &lt;object name=\"player\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"editor_player\" /&gt;\n      &lt;hitpoints type=\"int\"&gt;150&lt;/hitpoints&gt;\n      &lt;maxhitpoints type=\"int\"&gt;200&lt;/maxhitpoints&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n&lt;/asl&gt;\n</code></pre>\n</details>\n\n",
      "PostDate": "2017-09-09T06:35:28.063644Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "b241278d-3e97-47a5-887e-e71567a7e106",
      "UserId": 194873,
      "Username": "ShadowsEdge19",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a24333a42009e96c558cb89dc0c26d30?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I did a side by side comparison of the code I posted and the one you provided but other than the change in the attribute name (which should be inconsequential) there doesn't appear to be anything different, so what is it about that that works? \r\n\r\nI even changed the attributes again on your code and it does work now so again no idea what is different.",
      "EditableFormat": "markdown",
      "HTML": "<p>I did a side by side comparison of the code I posted and the one you provided but other than the change in the attribute name (which should be inconsequential) there doesn't appear to be anything different, so what is it about that that works?</p>\n<p>I even changed the attributes again on your code and it does work now so again no idea what is different.</p>\n\n",
      "PostDate": "2017-09-09T11:07:23.1035574Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "8c80b85d-9c0a-4c21-aa82-6eb1b8d1a199",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I also did a side-by-side comparison using `diff`. The difference in the two scripts: you had the variable named \"HP\", but the script named \"changedhitpoints\". As you don't have an attribute called \"hitpoints\", that script is never called.",
      "EditableFormat": "markdown",
      "HTML": "<p>I also did a side-by-side comparison using <code>diff</code>. The difference in the two scripts: you had the variable named \"HP\", but the script named \"changedhitpoints\". As you don't have an attribute called \"hitpoints\", that script is never called.</p>\n\n",
      "PostDate": "2017-09-09T11:54:50.9810144Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "74883f50-4d8b-48ed-868a-23035148baa9",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "http://i.imgur.com/FOIjtApb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "#### Gotta change these too (don't ask me why; maybe Pixie knows):\r\n\r\n\r\nYou have:\r\n\r\n```\r\nif (HasScript(player, \"changedhitpoints\")) {\r\n        do (player, \"changedhitpoints\")\r\n      }\r\n```\r\n\r\nThis works:\r\n```\r\nif (HasScript(player, \"changedHP\")) {\r\n        do (player, \"changedHP\")\r\n```\r\n\r\nYou have:\r\n```\r\nplayer.changedhitpoints => {\r\n```\r\n\r\n\r\nThis works:\r\n```\r\nplayer.changedHP => {\r\n```\r\n\r\n\r\n\r\n---\r\nNew code, with your HP and maxHP atts:\r\n\r\n```\r\n<!--Saved by Quest 5.7.6404.15496-->\r\n<asl version=\"550\">\r\n  <include ref=\"English.aslx\" />\r\n  <include ref=\"Core.aslx\" />\r\n  <game name=\"TestCustomPane\">\r\n    <gameid>853d3220-63b6-4b84-a5e1-aa279b29d27f</gameid>\r\n    <version>1.0</version>\r\n    <firstpublished>2017</firstpublished>\r\n    <commandpane type=\"boolean\">false</commandpane>\r\n    <customstatuspane />\r\n    <attr name=\"feature_advancedwearables\" type=\"boolean\">false</attr>\r\n    <feature_advancedscripts />\r\n    <inituserinterface type=\"script\"><![CDATA[\r\n      s = \"<table width=\\\"100%\\\"><tr>\"\r\n      s = s + \"   <td style=\\\"text-align:right;\\\" width=\\\"50%\\\">Hit Points:</td>\"\r\n      s = s + \"   <td style=\\\"text-align:left;\\\" width=\\\"50%\\\"><span id=\\\"hits-span\\\">---</span></td>\"\r\n      s = s + \" </tr>\"\r\n      s = s + \" <tr>\"\r\n      s = s + \"   <td colspan=\\\"2\\\" style=\\\"border: thin solid;background:white;text-align:left;\\\">\"\r\n      s = s + \"   <span id=\\\"hits-indicator\\\" style=\\\"background-color:black;padding-right:200px;\\\"></span>\"\r\n      s = s + \"   </td>\"\r\n      s = s + \" </tr>\"\r\n      s = s + \"</table>\"\r\n      JS.setCustomStatus (s)\r\n      if (HasScript(player, \"changedHP\")) {\r\n        do (player, \"changedHP\")\r\n      }\r\n    ]]></inituserinterface>\r\n    <start type=\"script\"><![CDATA[\r\n      player.changedHP => {\r\n        JS.eval (\"$('#hits-span').html('\" + player.HP + \"/\" + player.maxHP + \"');\")\r\n        JS.eval (\"$('#hits-indicator').css('padding-right', '\" + (200 * player.HP / player.maxHP) + \"px');\")\r\n      }\r\n      player.maxHP = 200\r\n      player.HP = 100\r\n    ]]></start>\r\n  </game>\r\n  <object name=\"Start\">\r\n    <inherit name=\"editor_room\" />\r\n    <beforeenter type=\"script\">\r\n    </beforeenter>\r\n    <object name=\"player\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"editor_player\" />\r\n      <HP type=\"int\">150</HP>\r\n      <maxHP type=\"int\">200</maxHP>\r\n    </object>\r\n  </object>\r\n</asl>\r\n\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<h4>Gotta change these too (don't ask me why; maybe Pixie knows):</h4>\n<p>You have:</p>\n<pre><code>if (HasScript(player, \"changedhitpoints\")) {\n        do (player, \"changedhitpoints\")\n      }\n</code></pre>\n<p>This works:</p>\n<pre><code>if (HasScript(player, \"changedHP\")) {\n        do (player, \"changedHP\")\n</code></pre>\n<p>You have:</p>\n<pre><code>player.changedhitpoints =&gt; {\n</code></pre>\n<p>This works:</p>\n<pre><code>player.changedHP =&gt; {\n</code></pre>\n<hr>\n<p>New code, with your HP and maxHP atts:</p>\n<pre><code>&lt;!--Saved by Quest 5.7.6404.15496--&gt;\n&lt;asl version=\"550\"&gt;\n  &lt;include ref=\"English.aslx\" /&gt;\n  &lt;include ref=\"Core.aslx\" /&gt;\n  &lt;game name=\"TestCustomPane\"&gt;\n    &lt;gameid&gt;853d3220-63b6-4b84-a5e1-aa279b29d27f&lt;/gameid&gt;\n    &lt;version&gt;1.0&lt;/version&gt;\n    &lt;firstpublished&gt;2017&lt;/firstpublished&gt;\n    &lt;commandpane type=\"boolean\"&gt;false&lt;/commandpane&gt;\n    &lt;customstatuspane /&gt;\n    &lt;attr name=\"feature_advancedwearables\" type=\"boolean\"&gt;false&lt;/attr&gt;\n    &lt;feature_advancedscripts /&gt;\n    &lt;inituserinterface type=\"script\"&gt;&lt;![CDATA[\n      s = \"&lt;table width=\\\"100%\\\"&gt;&lt;tr&gt;\"\n      s = s + \"   &lt;td style=\\\"text-align:right;\\\" width=\\\"50%\\\"&gt;Hit Points:&lt;/td&gt;\"\n      s = s + \"   &lt;td style=\\\"text-align:left;\\\" width=\\\"50%\\\"&gt;&lt;span id=\\\"hits-span\\\"&gt;---&lt;/span&gt;&lt;/td&gt;\"\n      s = s + \" &lt;/tr&gt;\"\n      s = s + \" &lt;tr&gt;\"\n      s = s + \"   &lt;td colspan=\\\"2\\\" style=\\\"border: thin solid;background:white;text-align:left;\\\"&gt;\"\n      s = s + \"   &lt;span id=\\\"hits-indicator\\\" style=\\\"background-color:black;padding-right:200px;\\\"&gt;&lt;/span&gt;\"\n      s = s + \"   &lt;/td&gt;\"\n      s = s + \" &lt;/tr&gt;\"\n      s = s + \"&lt;/table&gt;\"\n      JS.setCustomStatus (s)\n      if (HasScript(player, \"changedHP\")) {\n        do (player, \"changedHP\")\n      }\n    ]]&gt;&lt;/inituserinterface&gt;\n    &lt;start type=\"script\"&gt;&lt;![CDATA[\n      player.changedHP =&gt; {\n        JS.eval (\"$('#hits-span').html('\" + player.HP + \"/\" + player.maxHP + \"');\")\n        JS.eval (\"$('#hits-indicator').css('padding-right', '\" + (200 * player.HP / player.maxHP) + \"px');\")\n      }\n      player.maxHP = 200\n      player.HP = 100\n    ]]&gt;&lt;/start&gt;\n  &lt;/game&gt;\n  &lt;object name=\"Start\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;beforeenter type=\"script\"&gt;\n    &lt;/beforeenter&gt;\n    &lt;object name=\"player\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"editor_player\" /&gt;\n      &lt;HP type=\"int\"&gt;150&lt;/HP&gt;\n      &lt;maxHP type=\"int\"&gt;200&lt;/maxHP&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n&lt;/asl&gt;\n\n</code></pre>\n\n",
      "PostDate": "2017-09-09T12:17:26.533958Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "56bf08fe-acc1-4cbc-87cd-ef3971bbeadf",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "http://i.imgur.com/FOIjtApb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "mrangel beat me to it while I was bumbling around. (Ha-ha!)\r\n\r\n (I tried the side-by-side using diff, but I just went cross-eyed doing that!)\r\n\r\n(That means I was playing around with it and editing my post for more than 23 minutes, then... Whoa!)",
      "EditableFormat": "markdown",
      "HTML": "<p>mrangel beat me to it while I was bumbling around. (Ha-ha!)</p>\n<p>(I tried the side-by-side using diff, but I just went cross-eyed doing that!)</p>\n<p>(That means I was playing around with it and editing my post for more than 23 minutes, then... Whoa!)</p>\n\n",
      "PostDate": "2017-09-09T12:22:28.2265494Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "d11d204e-b635-412e-8936-e022c14b3c6e",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I did `diff` and found the obvious ones that had changed.\r\nThen a Perl one-liner:\r\n`perl -e 'while(<>) {s/maxhitpoints/MaxHP/g; s/hitpoints/HP/; print $_;}' `\r\nto change the working one to new variable names; and then `diff` that against the not-working version.\r\n\r\nThe reason you have to change the function names too is that whenever `player.hitpoints ` changes, it looks for a script `player.changedhitpoints` and runs it if it exists. If the names don't match, that script won't run.\r\n\r\nThe segment:\r\n```\r\nif (HasScript(player, \"changedhitpoints\")) {\r\n        do (player, \"changedhitpoints\")\r\n}\r\n```\r\nis to draw the bar correctly when you load a saved game. On a new game, that script doesn't exist yet because `inituserinterface` runs before `start`. So the first time the bar is drawn is when the line `player.HP = 100` automatically triggers the changedHP script.",
      "EditableFormat": "markdown",
      "HTML": "<p>I did <code>diff</code> and found the obvious ones that had changed.<br>\nThen a Perl one-liner:<br>\n<code>perl -e 'while(&lt;&gt;) {s/maxhitpoints/MaxHP/g; s/hitpoints/HP/; print $_;}'</code><br>\nto change the working one to new variable names; and then <code>diff</code> that against the not-working version.</p>\n<p>The reason you have to change the function names too is that whenever <code>player.hitpoints</code> changes, it looks for a script <code>player.changedhitpoints</code> and runs it if it exists. If the names don't match, that script won't run.</p>\n<p>The segment:</p>\n<pre><code>if (HasScript(player, \"changedhitpoints\")) {\n        do (player, \"changedhitpoints\")\n}\n</code></pre>\n<p>is to draw the bar correctly when you load a saved game. On a new game, that script doesn't exist yet because <code>inituserinterface</code> runs before <code>start</code>. So the first time the bar is drawn is when the line <code>player.HP = 100</code> automatically triggers the changedHP script.</p>\n\n",
      "PostDate": "2017-09-09T12:41:01.2457911Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "64591aa4-60ef-4b64-acc0-855aa6d19161",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "http://i.imgur.com/FOIjtApb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "mrangel,\r\n\r\nA-ha!\r\n\r\nThanks!  I would have asked about the stuff concerning the function and the bar, but I guess you foresaw that, huh?\r\n\r\n--- \r\n\r\nSee what my msys64 BASH! terminal looks like when I run ```diff -y```?\r\n\r\n<details><summary>Click to view screenshot</summary>\r\n\r\n![image](https://user-images.githubusercontent.com/30656341/30240510-504d028c-9537-11e7-9d0a-826bd78c62eb.png)\r\n\r\n</details>\r\n\r\n---\r\nI'm pretty sure I need a new ```diff``` viewer. ...or maybe I should just log in to Arch Linux first next time. (Ha-ha!)\r\n\r\nI used ```sed``` to replace the text.  It seems that learning Perl would be worthwhile.  It's similar to what I'm accustomed to, but a little 'neater' in appearance.\r\n\r\nI looked at your potato problem, too, but the solution to that one is far beyond me, so I just kept 'quiet'.",
      "EditableFormat": "markdown",
      "HTML": "<p>mrangel,</p>\n<p>A-ha!</p>\n<p>Thanks!  I would have asked about the stuff concerning the function and the bar, but I guess you foresaw that, huh?</p>\n<hr>\n<p>See what my msys64 BASH! terminal looks like when I run <code>diff -y</code>?</p>\n<details><summary>Click to view screenshot</summary>\n<p><img src=\"https://user-images.githubusercontent.com/30656341/30240510-504d028c-9537-11e7-9d0a-826bd78c62eb.png\" alt=\"image\"></p>\n</details>\n<hr>\n<p>I'm pretty sure I need a new <code>diff</code> viewer. ...or maybe I should just log in to Arch Linux first next time. (Ha-ha!)</p>\n<p>I used <code>sed</code> to replace the text.  It seems that learning Perl would be worthwhile.  It's similar to what I'm accustomed to, but a little 'neater' in appearance.</p>\n<p>I looked at your potato problem, too, but the solution to that one is far beyond me, so I just kept 'quiet'.</p>\n\n",
      "PostDate": "2017-09-09T13:30:46.2458126Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "41276bf2-e8a8-4a7a-872b-8349ddb5e7c0",
      "UserId": 194873,
      "Username": "ShadowsEdge19",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a24333a42009e96c558cb89dc0c26d30?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Okay that explains it. \r\nI wanted to change the status bar to be set to an attribute from a specific room instead of the player HP, now that I understand that issue. \r\n\r\nI created 2 rooms with an attribute called AlertStatus and 1 room with no attribute, I added the script setup for each room individually in the game global Start script and the status panel setup in the Enter Room script with a HasAttribute check on the player.parent (current Room the player resides in) for the AlertStatus, check it out:\r\n\r\n```\r\n<!--Saved by Quest 5.7.6404.15496-->\r\n<asl version=\"550\">\r\n  <include ref=\"English.aslx\" />\r\n  <include ref=\"Core.aslx\" />\r\n  <game name=\"TestRoomStatus\">\r\n    <gameid>0bae2a50-2560-4e7c-8016-02867de11bb8</gameid>\r\n    <version>1.0</version>\r\n    <firstpublished>2017</firstpublished>\r\n    <feature_advancedscripts />\r\n    <customstatuspane />\r\n    <roomenter type=\"script\"><![CDATA[\r\n      oRoomObj = player.parent\r\n      if (HasAttribute(oRoomObj,\"AlertStatus\")) {\r\n        s = \"<table width=\\\"100%\\\"><tr>\"\r\n        s = s + \"   <td style=\\\"text-align:right;\\\" width=\\\"50%\\\">Alert Status:</td>\"\r\n        s = s + \"   <td style=\\\"text-align:left;\\\" width=\\\"50%\\\"><span id=\\\"alert-span\\\">---</span></td>\"\r\n        s = s + \" </tr>\"\r\n        s = s + \" <tr>\"\r\n        s = s + \"   <td colspan=\\\"2\\\" style=\\\"border: thin solid;background:white;text-align:left;\\\">\"\r\n        s = s + \"   <span id=\\\"alert-indicator\\\" style=\\\"background-color:black;padding-right:200px;\\\"></span>\"\r\n        s = s + \"   </td>\"\r\n        s = s + \" </tr>\"\r\n        s = s + \"</table>\"\r\n        JS.setCustomStatus (s)\r\n        if (HasScript(oRoomObj, \"changedAlertStatus\")) {\r\n          do (oRoomObj, \"changedAlertStatus\")\r\n        }\r\n      }\r\n      else {\r\n        JS.setCustomStatus (\"Everything is fine!\")\r\n      }\r\n    ]]></roomenter>\r\n    <start type=\"script\"><![CDATA[\r\n      Room1.changedAlertStatus => {\r\n        JS.eval (\"$('#alert-span').html('\" + Room1.AlertStatus + \"/100');\")\r\n        JS.eval (\"$('#alert-indicator').css('padding-right', '\" + (200 * Room1.AlertStatus / 100) + \"px');\")\r\n      }\r\n      Room1.AlertStatus = 0\r\n      Room2.changedAlertStatus => {\r\n        JS.eval (\"$('#alert-span').html('\" + Room2.AlertStatus + \"/100');\")\r\n        JS.eval (\"$('#alert-indicator').css('padding-right', '\" + (200 * Room2.AlertStatus / 100) + \"px');\")\r\n      }\r\n      Room2.AlertStatus = 0\r\n    ]]></start>\r\n  </game>\r\n  <object name=\"Room1\">\r\n    <inherit name=\"editor_room\" />\r\n    <AlertStatus type=\"int\">0</AlertStatus>\r\n    <object name=\"player\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"editor_player\" />\r\n    </object>\r\n    <exit alias=\"south\" to=\"Room2\">\r\n      <inherit name=\"southdirection\" />\r\n    </exit>\r\n    <exit alias=\"east\" to=\"Room3\">\r\n      <inherit name=\"eastdirection\" />\r\n    </exit>\r\n  </object>\r\n  <object name=\"Room2\">\r\n    <inherit name=\"editor_room\" />\r\n    <AlertStatus type=\"string\"></AlertStatus>\r\n    <exit alias=\"north\" to=\"Room1\">\r\n      <inherit name=\"northdirection\" />\r\n    </exit>\r\n  </object>\r\n  <object name=\"Room3\">\r\n    <inherit name=\"editor_room\" />\r\n    <exit alias=\"west\" to=\"Room1\">\r\n      <inherit name=\"westdirection\" />\r\n    </exit>\r\n  </object>\r\n</asl>\r\n```\r\n\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Okay that explains it.<br>\nI wanted to change the status bar to be set to an attribute from a specific room instead of the player HP, now that I understand that issue.</p>\n<p>I created 2 rooms with an attribute called AlertStatus and 1 room with no attribute, I added the script setup for each room individually in the game global Start script and the status panel setup in the Enter Room script with a HasAttribute check on the player.parent (current Room the player resides in) for the AlertStatus, check it out:</p>\n<pre><code>&lt;!--Saved by Quest 5.7.6404.15496--&gt;\n&lt;asl version=\"550\"&gt;\n  &lt;include ref=\"English.aslx\" /&gt;\n  &lt;include ref=\"Core.aslx\" /&gt;\n  &lt;game name=\"TestRoomStatus\"&gt;\n    &lt;gameid&gt;0bae2a50-2560-4e7c-8016-02867de11bb8&lt;/gameid&gt;\n    &lt;version&gt;1.0&lt;/version&gt;\n    &lt;firstpublished&gt;2017&lt;/firstpublished&gt;\n    &lt;feature_advancedscripts /&gt;\n    &lt;customstatuspane /&gt;\n    &lt;roomenter type=\"script\"&gt;&lt;![CDATA[\n      oRoomObj = player.parent\n      if (HasAttribute(oRoomObj,\"AlertStatus\")) {\n        s = \"&lt;table width=\\\"100%\\\"&gt;&lt;tr&gt;\"\n        s = s + \"   &lt;td style=\\\"text-align:right;\\\" width=\\\"50%\\\"&gt;Alert Status:&lt;/td&gt;\"\n        s = s + \"   &lt;td style=\\\"text-align:left;\\\" width=\\\"50%\\\"&gt;&lt;span id=\\\"alert-span\\\"&gt;---&lt;/span&gt;&lt;/td&gt;\"\n        s = s + \" &lt;/tr&gt;\"\n        s = s + \" &lt;tr&gt;\"\n        s = s + \"   &lt;td colspan=\\\"2\\\" style=\\\"border: thin solid;background:white;text-align:left;\\\"&gt;\"\n        s = s + \"   &lt;span id=\\\"alert-indicator\\\" style=\\\"background-color:black;padding-right:200px;\\\"&gt;&lt;/span&gt;\"\n        s = s + \"   &lt;/td&gt;\"\n        s = s + \" &lt;/tr&gt;\"\n        s = s + \"&lt;/table&gt;\"\n        JS.setCustomStatus (s)\n        if (HasScript(oRoomObj, \"changedAlertStatus\")) {\n          do (oRoomObj, \"changedAlertStatus\")\n        }\n      }\n      else {\n        JS.setCustomStatus (\"Everything is fine!\")\n      }\n    ]]&gt;&lt;/roomenter&gt;\n    &lt;start type=\"script\"&gt;&lt;![CDATA[\n      Room1.changedAlertStatus =&gt; {\n        JS.eval (\"$('#alert-span').html('\" + Room1.AlertStatus + \"/100');\")\n        JS.eval (\"$('#alert-indicator').css('padding-right', '\" + (200 * Room1.AlertStatus / 100) + \"px');\")\n      }\n      Room1.AlertStatus = 0\n      Room2.changedAlertStatus =&gt; {\n        JS.eval (\"$('#alert-span').html('\" + Room2.AlertStatus + \"/100');\")\n        JS.eval (\"$('#alert-indicator').css('padding-right', '\" + (200 * Room2.AlertStatus / 100) + \"px');\")\n      }\n      Room2.AlertStatus = 0\n    ]]&gt;&lt;/start&gt;\n  &lt;/game&gt;\n  &lt;object name=\"Room1\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;AlertStatus type=\"int\"&gt;0&lt;/AlertStatus&gt;\n    &lt;object name=\"player\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"editor_player\" /&gt;\n    &lt;/object&gt;\n    &lt;exit alias=\"south\" to=\"Room2\"&gt;\n      &lt;inherit name=\"southdirection\" /&gt;\n    &lt;/exit&gt;\n    &lt;exit alias=\"east\" to=\"Room3\"&gt;\n      &lt;inherit name=\"eastdirection\" /&gt;\n    &lt;/exit&gt;\n  &lt;/object&gt;\n  &lt;object name=\"Room2\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;AlertStatus type=\"string\"&gt;&lt;/AlertStatus&gt;\n    &lt;exit alias=\"north\" to=\"Room1\"&gt;\n      &lt;inherit name=\"northdirection\" /&gt;\n    &lt;/exit&gt;\n  &lt;/object&gt;\n  &lt;object name=\"Room3\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;exit alias=\"west\" to=\"Room1\"&gt;\n      &lt;inherit name=\"westdirection\" /&gt;\n    &lt;/exit&gt;\n  &lt;/object&gt;\n&lt;/asl&gt;\n</code></pre>\n\n",
      "PostDate": "2017-09-09T13:58:06.6465691Z",
      "LastEditDate": "2017-09-09T13:58:51.5484234Z",
      "link": null
    },
    {
      "PostId": "ecb39a15-3955-44b0-9df6-2a0af14a3408",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Pretty neat. But a little inefficient; especially as you're going to have to add to your start script every time you add a new room with an AlertStatus.\r\n\r\nMight be easier to make the start script something like…\r\n```\r\nforeach (room, AllObjects()) {\r\n  if (HasAttribute (room, \"AlertStatus\")) {\r\n    room.changedAlertStatus => {\r\n      // When a room's alert status is changed, we change the status pane only if the player is in that room\r\n      // Whether the if() line is necessary will depend on your gameplay, but it does no harm to include it\r\n      if (Contains (this, game.pov)) {\r\n        JS.eval (\"$('#alert-span').html('\" + this.AlertStatus + \"/100');\")\r\n        JS.eval (\"$('#alert-indicator').css('padding-right', '\" + (200 * this.AlertStatus / 100) + \"px');\")\r\n      }\r\n    }\r\n    // Not sure if the next line is necessary.\r\n    // If you just set the attribute to 0 when you create a room, it's probably easier.\r\n    // Especially if you might later want a room whose alert level doesn't start at 0\r\n    room.AlertStatus = 0\r\n  }\r\n}\r\n```\r\nThat loops over all objects, and gives them all the same script if they have an AlertLevel attribute.\r\nIt also only updates the status pane if you change the alert level of the room the player is in; I can envision situations where you might want to change the alert in another room (leaving a decoy maybe? Or reducing it if a guard is in the room and sees you're not there?), and in those cases you wouldn't want the pane to show the alert level of the room that most recently had it changed. If you're not doing that, the 'if' statement is just one line, so doesn't make that much difference.\r\n\r\nIf you want some rooms to have an alert level _and_ have other scripts that trigger when you enter, I've got a script for that too, but am less confident that it would work without testing it.",
      "EditableFormat": "markdown",
      "HTML": "<p>Pretty neat. But a little inefficient; especially as you're going to have to add to your start script every time you add a new room with an AlertStatus.</p>\n<p>Might be easier to make the start script something like…</p>\n<pre><code>foreach (room, AllObjects()) {\n  if (HasAttribute (room, \"AlertStatus\")) {\n    room.changedAlertStatus =&gt; {\n      // When a room's alert status is changed, we change the status pane only if the player is in that room\n      // Whether the if() line is necessary will depend on your gameplay, but it does no harm to include it\n      if (Contains (this, game.pov)) {\n        JS.eval (\"$('#alert-span').html('\" + this.AlertStatus + \"/100');\")\n        JS.eval (\"$('#alert-indicator').css('padding-right', '\" + (200 * this.AlertStatus / 100) + \"px');\")\n      }\n    }\n    // Not sure if the next line is necessary.\n    // If you just set the attribute to 0 when you create a room, it's probably easier.\n    // Especially if you might later want a room whose alert level doesn't start at 0\n    room.AlertStatus = 0\n  }\n}\n</code></pre>\n<p>That loops over all objects, and gives them all the same script if they have an AlertLevel attribute.<br>\nIt also only updates the status pane if you change the alert level of the room the player is in; I can envision situations where you might want to change the alert in another room (leaving a decoy maybe? Or reducing it if a guard is in the room and sees you're not there?), and in those cases you wouldn't want the pane to show the alert level of the room that most recently had it changed. If you're not doing that, the 'if' statement is just one line, so doesn't make that much difference.</p>\n<p>If you want some rooms to have an alert level <em>and</em> have other scripts that trigger when you enter, I've got a script for that too, but am less confident that it would work without testing it.</p>\n\n",
      "PostDate": "2017-09-09T14:59:14.2301921Z",
      "LastEditDate": "2017-09-09T15:00:06.4683256Z",
      "link": null
    },
    {
      "PostId": "8911942b-10a5-4a06-ae1d-efccfc2fdb3e",
      "UserId": 194873,
      "Username": "ShadowsEdge19",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a24333a42009e96c558cb89dc0c26d30?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Great stuff! How do I just display a static attribute status that won't change?",
      "EditableFormat": "markdown",
      "HTML": "<p>Great stuff! How do I just display a static attribute status that won't change?</p>\n\n",
      "PostDate": "2017-09-09T23:51:21.3918001Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "f28d0bef-afea-40b9-b768-3ffdd4dfc6f8",
      "UserId": 277074,
      "Username": "Dcoder",
      "AvatarUrl": "http://i.imgur.com/d9UrZ6lb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Why does inituserinterface run before start?  I'm just wondering because in the full code view, start comes before inituserinterface.  Thanks.",
      "EditableFormat": "markdown",
      "HTML": "<p>Why does inituserinterface run before start?  I'm just wondering because in the full code view, start comes before inituserinterface.  Thanks.</p>\n\n",
      "PostDate": "2017-09-10T01:31:34.8848831Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "db928ea8-27de-445e-8d7f-7f6650023cca",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "http://i.imgur.com/FOIjtApb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "```inituserinterface``` runs before anything on start and on a save load.\r\n\r\n\r\nI think it's really just there to fix the display and GUI elements before anything else loads up on the screen.\r\n\r\n\r\nhttp://docs.textadventures.co.uk/quest/advanced_game_script.html\r\n\r\nhttp://docs.textadventures.co.uk/quest/functions/corelibrary/inituserinterface.html\r\n\r\n---\r\n\r\nIf you have libraries that adjust the display and the GUI stuff, things will load in a ...strange manner.\r\n\r\nI ended up putting a lot of testing messages in my start script, inituserinterface script, and the functions in my library that effected such things.\r\n\r\nIt was fun.",
      "EditableFormat": "markdown",
      "HTML": "<p><code>inituserinterface</code> runs before anything on start and on a save load.</p>\n<p>I think it's really just there to fix the display and GUI elements before anything else loads up on the screen.</p>\n<p>http://docs.textadventures.co.uk/quest/advanced_game_script.html</p>\n<p>http://docs.textadventures.co.uk/quest/functions/corelibrary/inituserinterface.html</p>\n<hr>\n<p>If you have libraries that adjust the display and the GUI stuff, things will load in a ...strange manner.</p>\n<p>I ended up putting a lot of testing messages in my start script, inituserinterface script, and the functions in my library that effected such things.</p>\n<p>It was fun.</p>\n\n",
      "PostDate": "2017-09-10T02:48:27.3682812Z",
      "LastEditDate": "2017-09-10T02:50:57.0955092Z",
      "link": null
    }
  ]
}

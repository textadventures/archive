{
  "Topic": {
    "TopicId": "2mjajkqb6kutorkgqwummq",
    "ForumId": "10",
    "Title": "Double Lines of Description When Changing the Player Object(SOLVED)",
    "LastUpdated": "2021-04-07T18:10:12.3086094Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "35de6ed2-7fec-4aa6-882f-8b8e3c421206",
      "UserId": 471465,
      "Username": "1234676543224",
      "AvatarUrl": "https://secure.gravatar.com/avatar/b4dd66b147d09a81479b3d1538111622?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "For some reason, whenever I try to move the player object, quest will print the description of the room twice. This also happens when I change the player object. I was just wondering if there is any way to fix this.",
      "EditableFormat": "markdown",
      "HTML": "<p>For some reason, whenever I try to move the player object, quest will print the description of the room twice. This also happens when I change the player object. I was just wondering if there is any way to fix this.</p>\n\n",
      "PostDate": "2021-04-07T18:10:12.3086094Z",
      "LastEditDate": "2021-04-09T21:47:05.1890735Z",
      "link": null
    },
    {
      "PostId": "e4163894-afd6-41d7-826a-43d9001387ec",
      "UserId": 56551,
      "Username": "XanMag",
      "AvatarUrl": "https://secure.gravatar.com/avatar/4b45a3afd18077f76f6569225c422bdb?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I had that issue before and got it fixed.  I’ll dig through my code and try and find out why that happens and what I did to fix it.  Until then...\r\n\r\nHappy gaming!",
      "EditableFormat": "markdown",
      "HTML": "<p>I had that issue before and got it fixed.  I’ll dig through my code and try and find out why that happens and what I did to fix it.  Until then...</p>\n<p>Happy gaming!</p>\n\n",
      "PostDate": "2021-04-07T19:38:02.3025129Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "b6a88805-991f-4406-aa7b-ffe55c303077",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Are you moving the player object twice? For example moving the player again within an enter or exit script; this can cause duplicate descriptions because the second move triggers another one before the first move finishes.",
      "EditableFormat": "markdown",
      "HTML": "<p>Are you moving the player object twice? For example moving the player again within an enter or exit script; this can cause duplicate descriptions because the second move triggers another one before the first move finishes.</p>\n\n",
      "PostDate": "2021-04-07T20:45:30.9892812Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "8f4ba69c-26bd-49ad-b115-bbde3da38b0c",
      "UserId": 471465,
      "Username": "1234676543224",
      "AvatarUrl": "https://secure.gravatar.com/avatar/b4dd66b147d09a81479b3d1538111622?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I don't believe that that is it @mrangel. I thought that was the problem at first also but I have tested it and found out that it is not.",
      "EditableFormat": "markdown",
      "HTML": "<p>I don't believe that that is it @mrangel. I thought that was the problem at first also but I have tested it and found out that it is not.</p>\n\n",
      "PostDate": "2021-04-07T21:02:34.2619904Z",
      "LastEditDate": "2021-04-07T21:04:16.0339847Z",
      "link": null
    },
    {
      "PostId": "0b0e4edc-6d13-46ae-9f98-03367dda6c92",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Can you share the game so we can take a look at it?\r\n\r\nWhat happens if you turn off automatically printing the room description? Does that make it appear once (in which case I'd assume you're manually calling ShowRoomDescription somewhere), or not at all?",
      "EditableFormat": "markdown",
      "HTML": "<p>Can you share the game so we can take a look at it?</p>\n<p>What happens if you turn off automatically printing the room description? Does that make it appear once (in which case I'd assume you're manually calling ShowRoomDescription somewhere), or not at all?</p>\n\n",
      "PostDate": "2021-04-08T09:05:26.3020748Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "37830569-08af-4a63-9fd0-2416977d1561",
      "UserId": 471465,
      "Username": "1234676543224",
      "AvatarUrl": "https://secure.gravatar.com/avatar/b4dd66b147d09a81479b3d1538111622?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "@mrangel \r\nSince the game is not yet finished, I'll message it to you privately.\r\nI turned off \"Automatically generate room descriptions\" and then called the ShowRoomDescription function under \"Script when entering a room\". The room description was not printed.",
      "EditableFormat": "markdown",
      "HTML": "<p>@mrangel<br>\nSince the game is not yet finished, I'll message it to you privately.<br>\nI turned off \"Automatically generate room descriptions\" and then called the ShowRoomDescription function under \"Script when entering a room\". The room description was not printed.</p>\n\n",
      "PostDate": "2021-04-08T14:48:24.4110296Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "01584694-cc31-4e88-8b5a-ba2c29d9d6e4",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> I turned off \"Automatically generate room descriptions\" and then called the ShowRoomDescription function under \"Script when entering a room\"\r\n\r\nI can't understand why you would do that.\r\n\r\nI would expect that to show the room description twice, but skip the room name, \"You can see:\", \"You can go:\" and all the other automatically-generated stuff.",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>I turned off \"Automatically generate room descriptions\" and then called the ShowRoomDescription function under \"Script when entering a room\"</p>\n</blockquote>\n<p>I can't understand why you would do that.</p>\n<p>I would expect that to show the room description twice, but skip the room name, \"You can see:\", \"You can go:\" and all the other automatically-generated stuff.</p>\n\n",
      "PostDate": "2021-04-08T21:57:21.6025341Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "573523e7-a307-41ac-bf38-c93c69c9115f",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "OK, I see your issue.\r\n\r\nWhen you enter a room or change characters, Quest does the following:\r\n1. Run exit scripts for the room you just left (if any)\r\n2. Run \"before enter\" scripts for room you are now in\r\n3. show the description for the room you are now in\r\n4. Run \"on enter\" scripts for the room you are in\r\n\r\nSo at the start, it does this for the first room\r\n\r\n1. <s>Run exit scripts</s>\r\n2. Run \"before enter\" script for creation room\r\n    * which runs character creation functions\r\n         * which changes the POV to `player1`\r\n            * which runs the enter room sequence for the new POV's room\r\n                1. <s>Run exit scripts</s>\r\n                2. <s>Run before enter scripts for current room (hut)</s>\r\n                3. Display description for current room (hut)\r\n                4. Run on enter scripts for hut (\"You hear screaming ...\")\r\n3. Display description for current room (hut)\r\n4. <s>Run on enter scripts for hut</s>\r\n\r\nIt's displaying twice because you're still in the middle of the \"enter room\" process for the creation room, and it will finish even if you're no longer in that room.\r\n\r\nThe easiest way to change\r\n<pre><code style=\"color: brown\">ChangePOV (player1)</code></pre>\r\nto\r\n<pre><code style=\"color: green\">game.pov = player1</code></pre>\r\n\r\nThis doesn't automatically call OnEnterRoom after switching POV, but still does the other initialisation stuff. So the sequence becomes:\r\n1. <s>Run exit scripts</s>\r\n2. Run \"before enter\" script for creation room\r\n    * which runs character creation functions\r\n         * which changes the POV to `player1` *without running room entry*\r\n3. Display description for current room (hut)\r\n4. Run on enter scripts for hut (\"You hear screaming ...\")\r\n\r\n\r\nHope that makes sense… I tried to explain why it's doing that rather than just giving a solution, because if you know why the problem occurs,  you can avoid similar issues in future.\r\n\r\n(Note: if you use this method later in the game when changing characters, you may have problems with the map. `ChangePOV` basically does 3 things: changes the value of `game.pov`, clears the map, and shows the room description. If the map had already been drawn you would also need to include the lines:\r\n```\r\nJS.Grid_ClearAllLayers ()\r\nGrid_Redraw\r\n```\r\nor it might be easier if you avoid moving the player or changing POV from within a room enter/exit script)",
      "EditableFormat": "markdown",
      "HTML": "<p>OK, I see your issue.</p>\n<p>When you enter a room or change characters, Quest does the following:</p>\n<ol>\n<li>Run exit scripts for the room you just left (if any)</li>\n<li>Run \"before enter\" scripts for room you are now in</li>\n<li>show the description for the room you are now in</li>\n<li>Run \"on enter\" scripts for the room you are in</li>\n</ol>\n<p>So at the start, it does this for the first room</p>\n<ol>\n<li><s>Run exit scripts</s></li>\n<li>Run \"before enter\" script for creation room\n<ul>\n<li>which runs character creation functions\n<ul>\n<li>which changes the POV to <code>player1</code>\n<ul>\n<li>which runs the enter room sequence for the new POV's room\n<ol>\n<li><s>Run exit scripts</s></li>\n<li><s>Run before enter scripts for current room (hut)</s></li>\n<li>Display description for current room (hut)</li>\n<li>Run on enter scripts for hut (\"You hear screaming ...\")</li>\n</ol>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Display description for current room (hut)</li>\n<li><s>Run on enter scripts for hut</s></li>\n</ol>\n<p>It's displaying twice because you're still in the middle of the \"enter room\" process for the creation room, and it will finish even if you're no longer in that room.</p>\n<p>The easiest way to change</p>\n<pre><code style=\"color: brown\">ChangePOV (player1)</code></pre>\n<p>to</p>\n<pre><code style=\"color: green\">game.pov = player1</code></pre>\n<p>This doesn't automatically call OnEnterRoom after switching POV, but still does the other initialisation stuff. So the sequence becomes:</p>\n<ol>\n<li><s>Run exit scripts</s></li>\n<li>Run \"before enter\" script for creation room\n<ul>\n<li>which runs character creation functions\n<ul>\n<li>which changes the POV to <code>player1</code> <em>without running room entry</em></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Display description for current room (hut)</li>\n<li>Run on enter scripts for hut (\"You hear screaming ...\")</li>\n</ol>\n<p>Hope that makes sense… I tried to explain why it's doing that rather than just giving a solution, because if you know why the problem occurs,  you can avoid similar issues in future.</p>\n<p>(Note: if you use this method later in the game when changing characters, you may have problems with the map. <code>ChangePOV</code> basically does 3 things: changes the value of <code>game.pov</code>, clears the map, and shows the room description. If the map had already been drawn you would also need to include the lines:</p>\n<pre><code>JS.Grid_ClearAllLayers ()\nGrid_Redraw\n</code></pre>\n<p>or it might be easier if you avoid moving the player or changing POV from within a room enter/exit script)</p>\n\n",
      "PostDate": "2021-04-08T22:28:39.5277835Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "dab9dd6d-3cd5-42ad-a20e-64233f64409b",
      "UserId": 471465,
      "Username": "1234676543224",
      "AvatarUrl": "https://secure.gravatar.com/avatar/b4dd66b147d09a81479b3d1538111622?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thanks a lot, the problem is completely solved and I feel like I understand what happened and will not make that mistake again.",
      "EditableFormat": "markdown",
      "HTML": "<p>Thanks a lot, the problem is completely solved and I feel like I understand what happened and will not make that mistake again.</p>\n\n",
      "PostDate": "2021-04-09T21:46:36.700447Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

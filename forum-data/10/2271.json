{
  "Topic": {
    "TopicId": "2271",
    "ForumId": "10",
    "Title": "party system",
    "LastUpdated": "2010-05-01T19:06:09+01:00",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "17316",
      "UserId": 0,
      "Username": "Tomsa",
      "UserAvatar": null,
      "UserGravatar": "ef37a3599eb99171e2b32ae318749ff7",
      "EditableText": "So, I played around a little the other day, tried to create a party system which allows you to change the lead character. This is what I did:\n\n1. Created a new window menu called &quot;commands&quot;. \n2. Window commands contain: swap character, cast arcane spells and cast divine spells. Each is connected to a command, which in turn is connected to a menu.\n3. You have three characters in your party, one of them inaccessible (the one you are playing).\n4. Choosing a character from the &quot;swap character&quot; menu will make the proper characters accessible/inaccessible and set a numeric variable to a specific value.\n5. A numeric variable called &quot;current character&quot; will determine if you can cast arcane or divine spells, depending on current character (mage, thief or cleric).\n\nBelow is my ASL code. Please let me know if I can improve this further (changing inventories for instance)\n\n' &quot;Party system&quot;\n' Created with QDK Pro 4.1.2\n\n!include &lt;stdverbs.lib&gt;\n\ndefine game &lt;Party system&gt;\n\tasl-version &lt;410&gt;\n\tstart &lt;cell&gt;\n\tgame info &lt;Created with QDK Pro 4.1.2&gt;\n\tdefault fontname &lt;System&gt;\n\tdefault fontsize &lt;14&gt;\n\tstartscript {\n\t\thide &lt;Mandrake the Mage&gt;\n\t\tflag on &lt;Tara dead&gt;\n\t}\n\tcommand &lt;swap character&gt; choose &lt;character list&gt;\n\tcommand &lt;cast arcane spells&gt; if ( %character% = 1 ) then choose &lt;arcane spells&gt; else msg &lt;Only mages may cast arcane spells.&gt;\n\tcommand &lt;cast divine spells&gt; if ( %character% = 3 ) then choose &lt;divine spells&gt; else msg &lt;Only clerics may cast divine spells.&gt;\n\tdefine variable &lt;character&gt;\n\t\ttype numeric\n\t\tvalue &lt;1&gt;\n\tend define\nend define\n\ndefine options\n\tdebug on\n\tpanes on\n\tabbreviations on\nend define\n\ndefine menu &lt;Commands&gt;\n\tswap character: swap character\n\tcast arcane spells: cast arcane spells\n\tcast divine spells: cast divine spells\nend define\n\ndefine room &lt;cell&gt;\n\tprefix &lt;a&gt;\n\tlook &lt;The cell is made entirely of stone slabs. It is damp and dark, with barely any light at all. Only an iron door lies between you and freedom.&gt;\n\tnorth locked &lt;freedom; You are all locked in.&gt;\n\n\tdefine object &lt;Mandrake the Mage&gt;\n\t\tlook &lt;Mandrake is a mage of tall stature. His black robe and hat match his red goatee.&gt;\n\t\tspeak if ( %character% = 3 ) then msg &lt;You should use your healing skills on Tara...that may be her only chance, as well as ours. She is the thief with lock picking skills after all...&gt; else msg &lt;There must be a way to get out of here...&gt;\n\t\tdisplaytype &lt;Character&gt;\n\t\tarticle &lt;him&gt;\n\t\tgender &lt;he&gt;\n\tend define\n\n\tdefine object &lt;Tara the Thief&gt;\n\t\tlook {\n\t\t\tif flag &lt;tara dead&gt; then {\n\t\t\t\tmsg &lt;Tara lies lifeless on the floor.&gt; } else msg &lt;Tara is quite slender.&gt;\n\t\t}\n\t\tspeak if flag &lt;tara dead&gt; then msg &lt;She does not speak much for the time being.&gt; else msg &lt;I have prepared for this moment. Recently I put a few extra lock picks into a small leather pouch, which I fed to Donk. Now here is the problem...we need to wait for it to come out the natural route...unless you fed him something really nasty.&gt;\n\t\tdisplaytype &lt;Character&gt;\n\t\tarticle &lt;her&gt;\n\t\tgender &lt;she&gt;\n\tend define\n\n\tdefine object &lt;Hans the Cleric&gt;\n\t\tlook &lt;Hans wears a gray tunic reminiscent of rags. His beard, also is in disarray.&gt;\n\t\tspeak if ( %character% = 1 ) then msg &lt;Do you have any idea what to do now?&gt; else msg &lt;God have mercy on us all...&gt;\n\t\tdisplaytype &lt;Character&gt;\n\t\tarticle &lt;him&gt;\n\t\tgender &lt;he&gt;\n\tend define\n\n\tdefine object &lt;Donk&gt;\n\t\tlook &lt;Donk is a donkey and a beast of burden. And burdened he is, body and soul.&gt;\n\t\tdisplaytype &lt;Object&gt;\n\t\tarticle &lt;it&gt;\n\t\tgender &lt;it&gt;\n\tend define\n\n\tdefine object &lt;iron door&gt;\n\t\tlook &lt;This is the door to the cell, made of thick iron. It is currently locked.&gt;\n\t\tprefix &lt;an&gt;\n\t\tdisplaytype &lt;Object&gt;\n\t\tarticle &lt;it&gt;\n\t\tgender &lt;it&gt;\n\t\tuse &lt;lock pick&gt; {\n\t\t\tif flag &lt;tara dead&gt; then msg &lt;Tara is the only one who knows how to use a lock pick.&gt; else {\n\t\t\t\tmsg &lt;Tara uses the lock pick on the iron door. Soon, you hear a clicking noise.&gt;\n\t\t\t\tunlock &lt;cell; north&gt; }\n\t\t}\n\tend define\n\n\tdefine object &lt;rotten apple&gt;\n\t\tlook &lt;This apple has seen better days. Should you decide to eat it, only you can be held accountable for a runny stomach.&gt;\n\t\ttake\n\t\tdisplaytype &lt;Object&gt;\n\t\tarticle &lt;it&gt;\n\t\tgender &lt;it&gt;\n\t\tgive to &lt;Donk&gt; {\n\t\t\tmsg &lt;You give the rotten apple to Donk, which he happily eats. It does not take long before his stomach starts grumbling, and moments later, Donk lifts his tail to drop a steaming pile of fresh dung on the stone floor, making the atmosphere of the cell unbearable.&gt;\n\t\t\tshow &lt;leather pouch&gt;\n\t\t}\n\tend define\n\n\tdefine object &lt;leather pouch&gt;\n\t\ttake\n\t\tdisplaytype &lt;Object&gt;\n\t\tarticle &lt;it&gt;\n\t\tgender &lt;it&gt;\n\t\thidden\n\t\tcontainer\n\t\topened\n\t\tadd\n\t\tremove\n\tend define\n\n\tdefine object &lt;lock pick&gt;\n\t\ttake\n\t\tdisplaytype &lt;Object&gt;\n\t\tarticle &lt;it&gt;\n\t\tgender &lt;it&gt;\n\t\tparent &lt;leather pouch&gt;\n\tend define\n\nend define\n\ndefine room &lt;freedom&gt;\n\tsouth &lt;cell&gt;\n\tscript playerwin\nend define\n\ndefine text &lt;intro&gt;\nYou awaken in a damp cell. Your party companions Tara the Thief and Hans the Cleric are here as well, but somebody is missing. Yes...that must be it - your other companion, Grogh the Orcish Berzerker, must have fallen asleep on his guard post the other night, that inexcusable sod. Even Donk, your pet donkey who carries your inventory, is here, which is kind of odd since his meat would have made an excellent stew.\nend define\n\ndefine text &lt;win&gt;\nYou have managed to escape the cell and a fate unknown. Now you and your merry band of adventurers may journey forth.\nend define\n\ndefine selection &lt;character list&gt;\n\tinfo &lt;Choose character&gt;\n\tchoice &lt;Mandrake the Mage&gt; {\n\t\tif ( %character% = 1 ) then msg &lt;You ARE Mandrake.&gt; else {\n\t\t\tmsg &lt;You now play as Mandrake.&gt;\n\t\t\tset numeric &lt;character; 1&gt;\n\t\t\thide &lt;Mandrake the Mage&gt;\n\t\t\tshow &lt;Tara the Thief&gt;\n\t\t\tshow &lt;Hans the Cleric&gt; }\n\t}\n\tchoice &lt;Tara the Thief&gt; {\n\t\tif ( %character% = 2 ) then msg &lt;You ARE Tara.&gt; else {\n\t\t\tif flag &lt;tara dead&gt; then msg &lt;You cannot choose her...she is dead!&gt; else {\n\t\t\t\tmsg &lt;You now play as Tara.&gt;\n\t\t\t\tset numeric &lt;character; 2&gt;\n\t\t\t\thide &lt;Tara the Thief&gt;\n\t\t\t\tshow &lt;Mandrake the Mage&gt;\n\t\t\t\tshow &lt;Hans the Cleric&gt; } }\n\t}\n\tchoice &lt;Hans the Cleric&gt; {\n\t\tif ( %character% = 3 ) then msg &lt;You ARE Hans.&gt; else {\n\t\t\tmsg &lt;You now play as Hans.&gt;\n\t\t\tset numeric &lt;character; 3&gt;\n\t\t\thide &lt;Hans the Cleric&gt;\n\t\t\tshow &lt;Mandrake the Mage&gt;\n\t\t\tshow &lt;Tara the Thief&gt; }\n\t}\nend define\ndefine selection &lt;divine spells&gt;\n\tchoice &lt;resurrect&gt; choose &lt;resurrect who&gt;\nend define\ndefine selection &lt;arcane spells&gt;\n\tchoice &lt;invisibility&gt; msg &lt;&gt;\nend define\ndefine selection &lt;resurrect who&gt;\n\tchoice &lt;Mandrake&gt; msg &lt;&gt;\n\tchoice &lt;Tara&gt; {\n\t\tmsg &lt;Hans casts resurrect on Tara, reviving her to full strenght.&gt;\n\t\tmsg &lt;&quot;Thank you Hans...I am alive again!&quot;&gt;\n\t\tflag off &lt;tara dead&gt;",
      "EditableFormat": "bbcode",
      "HTML": "So, I played around a little the other day, tried to create a party system which allows you to change the lead character. This is what I did:<br/><br/>1. Created a new window menu called &quot;commands&quot;. <br/>2. Window commands contain: swap character, cast arcane spells and cast divine spells. Each is connected to a command, which in turn is connected to a menu.<br/>3. You have three characters in your party, one of them inaccessible (the one you are playing).<br/>4. Choosing a character from the &quot;swap character&quot; menu will make the proper characters accessible/inaccessible and set a numeric variable to a specific value.<br/>5. A numeric variable called &quot;current character&quot; will determine if you can cast arcane or divine spells, depending on current character (mage, thief or cleric).<br/><br/>Below is my ASL code. Please let me know if I can improve this further (changing inventories for instance)<br/><br/>' &quot;Party system&quot;<br/>' Created with QDK Pro 4.1.2<br/><br/>!include &lt;stdverbs.lib&gt;<br/><br/>define game &lt;Party system&gt;<br/>\tasl-version &lt;410&gt;<br/>\tstart &lt;cell&gt;<br/>\tgame info &lt;Created with QDK Pro 4.1.2&gt;<br/>\tdefault fontname &lt;System&gt;<br/>\tdefault fontsize &lt;14&gt;<br/>\tstartscript {<br/>\t\thide &lt;Mandrake the Mage&gt;<br/>\t\tflag on &lt;Tara dead&gt;<br/>\t}<br/>\tcommand &lt;swap character&gt; choose &lt;character list&gt;<br/>\tcommand &lt;cast arcane spells&gt; if ( %character% = 1 ) then choose &lt;arcane spells&gt; else msg &lt;Only mages may cast arcane spells.&gt;<br/>\tcommand &lt;cast divine spells&gt; if ( %character% = 3 ) then choose &lt;divine spells&gt; else msg &lt;Only clerics may cast divine spells.&gt;<br/>\tdefine variable &lt;character&gt;<br/>\t\ttype numeric<br/>\t\tvalue &lt;1&gt;<br/>\tend define<br/>end define<br/><br/>define options<br/>\tdebug on<br/>\tpanes on<br/>\tabbreviations on<br/>end define<br/><br/>define menu &lt;Commands&gt;<br/>\tswap character: swap character<br/>\tcast arcane spells: cast arcane spells<br/>\tcast divine spells: cast divine spells<br/>end define<br/><br/>define room &lt;cell&gt;<br/>\tprefix &lt;a&gt;<br/>\tlook &lt;The cell is made entirely of stone slabs. It is damp and dark, with barely any light at all. Only an iron door lies between you and freedom.&gt;<br/>\tnorth locked &lt;freedom; You are all locked in.&gt;<br/><br/>\tdefine object &lt;Mandrake the Mage&gt;<br/>\t\tlook &lt;Mandrake is a mage of tall stature. His black robe and hat match his red goatee.&gt;<br/>\t\tspeak if ( %character% = 3 ) then msg &lt;You should use your healing skills on Tara...that may be her only chance, as well as ours. She is the thief with lock picking skills after all...&gt; else msg &lt;There must be a way to get out of here...&gt;<br/>\t\tdisplaytype &lt;Character&gt;<br/>\t\tarticle &lt;him&gt;<br/>\t\tgender &lt;he&gt;<br/>\tend define<br/><br/>\tdefine object &lt;Tara the Thief&gt;<br/>\t\tlook {<br/>\t\t\tif flag &lt;tara dead&gt; then {<br/>\t\t\t\tmsg &lt;Tara lies lifeless on the floor.&gt; } else msg &lt;Tara is quite slender.&gt;<br/>\t\t}<br/>\t\tspeak if flag &lt;tara dead&gt; then msg &lt;She does not speak much for the time being.&gt; else msg &lt;I have prepared for this moment. Recently I put a few extra lock picks into a small leather pouch, which I fed to Donk. Now here is the problem...we need to wait for it to come out the natural route...unless you fed him something really nasty.&gt;<br/>\t\tdisplaytype &lt;Character&gt;<br/>\t\tarticle &lt;her&gt;<br/>\t\tgender &lt;she&gt;<br/>\tend define<br/><br/>\tdefine object &lt;Hans the Cleric&gt;<br/>\t\tlook &lt;Hans wears a gray tunic reminiscent of rags. His beard, also is in disarray.&gt;<br/>\t\tspeak if ( %character% = 1 ) then msg &lt;Do you have any idea what to do now?&gt; else msg &lt;God have mercy on us all...&gt;<br/>\t\tdisplaytype &lt;Character&gt;<br/>\t\tarticle &lt;him&gt;<br/>\t\tgender &lt;he&gt;<br/>\tend define<br/><br/>\tdefine object &lt;Donk&gt;<br/>\t\tlook &lt;Donk is a donkey and a beast of burden. And burdened he is, body and soul.&gt;<br/>\t\tdisplaytype &lt;Object&gt;<br/>\t\tarticle &lt;it&gt;<br/>\t\tgender &lt;it&gt;<br/>\tend define<br/><br/>\tdefine object &lt;iron door&gt;<br/>\t\tlook &lt;This is the door to the cell, made of thick iron. It is currently locked.&gt;<br/>\t\tprefix &lt;an&gt;<br/>\t\tdisplaytype &lt;Object&gt;<br/>\t\tarticle &lt;it&gt;<br/>\t\tgender &lt;it&gt;<br/>\t\tuse &lt;lock pick&gt; {<br/>\t\t\tif flag &lt;tara dead&gt; then msg &lt;Tara is the only one who knows how to use a lock pick.&gt; else {<br/>\t\t\t\tmsg &lt;Tara uses the lock pick on the iron door. Soon, you hear a clicking noise.&gt;<br/>\t\t\t\tunlock &lt;cell; north&gt; }<br/>\t\t}<br/>\tend define<br/><br/>\tdefine object &lt;rotten apple&gt;<br/>\t\tlook &lt;This apple has seen better days. Should you decide to eat it, only you can be held accountable for a runny stomach.&gt;<br/>\t\ttake<br/>\t\tdisplaytype &lt;Object&gt;<br/>\t\tarticle &lt;it&gt;<br/>\t\tgender &lt;it&gt;<br/>\t\tgive to &lt;Donk&gt; {<br/>\t\t\tmsg &lt;You give the rotten apple to Donk, which he happily eats. It does not take long before his stomach starts grumbling, and moments later, Donk lifts his tail to drop a steaming pile of fresh dung on the stone floor, making the atmosphere of the cell unbearable.&gt;<br/>\t\t\tshow &lt;leather pouch&gt;<br/>\t\t}<br/>\tend define<br/><br/>\tdefine object &lt;leather pouch&gt;<br/>\t\ttake<br/>\t\tdisplaytype &lt;Object&gt;<br/>\t\tarticle &lt;it&gt;<br/>\t\tgender &lt;it&gt;<br/>\t\thidden<br/>\t\tcontainer<br/>\t\topened<br/>\t\tadd<br/>\t\tremove<br/>\tend define<br/><br/>\tdefine object &lt;lock pick&gt;<br/>\t\ttake<br/>\t\tdisplaytype &lt;Object&gt;<br/>\t\tarticle &lt;it&gt;<br/>\t\tgender &lt;it&gt;<br/>\t\tparent &lt;leather pouch&gt;<br/>\tend define<br/><br/>end define<br/><br/>define room &lt;freedom&gt;<br/>\tsouth &lt;cell&gt;<br/>\tscript playerwin<br/>end define<br/><br/>define text &lt;intro&gt;<br/>You awaken in a damp cell. Your party companions Tara the Thief and Hans the Cleric are here as well, but somebody is missing. Yes...that must be it - your other companion, Grogh the Orcish Berzerker, must have fallen asleep on his guard post the other night, that inexcusable sod. Even Donk, your pet donkey who carries your inventory, is here, which is kind of odd since his meat would have made an excellent stew.<br/>end define<br/><br/>define text &lt;win&gt;<br/>You have managed to escape the cell and a fate unknown. Now you and your merry band of adventurers may journey forth.<br/>end define<br/><br/>define selection &lt;character list&gt;<br/>\tinfo &lt;Choose character&gt;<br/>\tchoice &lt;Mandrake the Mage&gt; {<br/>\t\tif ( %character% = 1 ) then msg &lt;You ARE Mandrake.&gt; else {<br/>\t\t\tmsg &lt;You now play as Mandrake.&gt;<br/>\t\t\tset numeric &lt;character; 1&gt;<br/>\t\t\thide &lt;Mandrake the Mage&gt;<br/>\t\t\tshow &lt;Tara the Thief&gt;<br/>\t\t\tshow &lt;Hans the Cleric&gt; }<br/>\t}<br/>\tchoice &lt;Tara the Thief&gt; {<br/>\t\tif ( %character% = 2 ) then msg &lt;You ARE Tara.&gt; else {<br/>\t\t\tif flag &lt;tara dead&gt; then msg &lt;You cannot choose her...she is dead!&gt; else {<br/>\t\t\t\tmsg &lt;You now play as Tara.&gt;<br/>\t\t\t\tset numeric &lt;character; 2&gt;<br/>\t\t\t\thide &lt;Tara the Thief&gt;<br/>\t\t\t\tshow &lt;Mandrake the Mage&gt;<br/>\t\t\t\tshow &lt;Hans the Cleric&gt; } }<br/>\t}<br/>\tchoice &lt;Hans the Cleric&gt; {<br/>\t\tif ( %character% = 3 ) then msg &lt;You ARE Hans.&gt; else {<br/>\t\t\tmsg &lt;You now play as Hans.&gt;<br/>\t\t\tset numeric &lt;character; 3&gt;<br/>\t\t\thide &lt;Hans the Cleric&gt;<br/>\t\t\tshow &lt;Mandrake the Mage&gt;<br/>\t\t\tshow &lt;Tara the Thief&gt; }<br/>\t}<br/>end define<br/>define selection &lt;divine spells&gt;<br/>\tchoice &lt;resurrect&gt; choose &lt;resurrect who&gt;<br/>end define<br/>define selection &lt;arcane spells&gt;<br/>\tchoice &lt;invisibility&gt; msg &lt;&gt;<br/>end define<br/>define selection &lt;resurrect who&gt;<br/>\tchoice &lt;Mandrake&gt; msg &lt;&gt;<br/>\tchoice &lt;Tara&gt; {<br/>\t\tmsg &lt;Hans casts resurrect on Tara, reviving her to full strenght.&gt;<br/>\t\tmsg &lt;&quot;Thank you Hans...I am alive again!&quot;&gt;<br/>\t\tflag off &lt;tara dead&gt;",
      "PostDate": "2010-05-01T19:06:09+01:00",
      "LastEditDate": null
    }
  ]
}

{
  "Topic": {
    "TopicId": "2zx2ldmltuyjsk-h8vpmyg",
    "ForumId": "10",
    "Title": "Function: Replace not found?",
    "LastUpdated": "2024-05-08T08:26:28.1075669Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "e2e17777-08ff-4734-8c08-fb076dd1eae6",
      "UserId": 652801,
      "Username": "Gng",
      "AvatarUrl": "https://i.imgur.com/w0pOzA9b.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Quest won't find the Replace function. Is there another way to subtract a string from a string?",
      "EditableFormat": "markdown",
      "HTML": "<p>Quest won't find the Replace function. Is there another way to subtract a string from a string?</p>\n\n",
      "PostDate": "2024-05-08T08:26:28.1075669Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "85d85390-773e-472f-a948-7ea56851d131",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "The Replace function is the one you want.\r\n\r\nCan you show the code that isn't working, or the error message you're getting?\r\n\r\nIf it says something like `Could Not Find Function: Replace(Object, String, String)`, look at the message. In that example, the problem is that the first parameter you're passing it is not a string. If you spell the name of an attribute wrong, for example, its value will most likely be `null`, which counts as an object.\r\n\r\nA lot of built-in functions are strongly typed, which means that you need to make sure the types actually line up.\r\n\r\nAnother way this problem can come up is if you do something like:\r\n```\r\nrecoloured_description = Replace(GetAttribute (room, \"description\"), \"red\", \"blue\")\r\n```\r\nThis looks like it should work… but `GetAttribute`'s signature says its return type is \"Any\" rather than \"String\". So Quest looks for a function with the signature `Replace(Any, String, String)` and doesn't find it - it never even attempts to run the code. Making this example work has two solutions:\r\n```\r\nrecoloured_description = Replace(GetString (room, \"description\"), \"red\", \"blue\")\r\n```\r\nor\r\n```\r\ndesc = GetAttribute (room, \"description\")\r\nrecoloured_description = Replace(desc, \"red\", \"blue\")\r\n```\r\nIn the first case, you use a different function which always returns a string. In the second case, you get the value first, so that Quest assesses the second line based on the actual type of the value, rather checking if Replace can handle whatever value GetAttribute is capable of creating.\r\n\r\nSimilar issues are why it's advised to use `StringListItem` rather than `ListItem`, for example.\r\n\r\nIf this suggestion doesn't help you, it would probably be good to share the line of code you're using.",
      "EditableFormat": "markdown",
      "HTML": "<p>The Replace function is the one you want.</p>\n<p>Can you show the code that isn't working, or the error message you're getting?</p>\n<p>If it says something like <code>Could Not Find Function: Replace(Object, String, String)</code>, look at the message. In that example, the problem is that the first parameter you're passing it is not a string. If you spell the name of an attribute wrong, for example, its value will most likely be <code>null</code>, which counts as an object.</p>\n<p>A lot of built-in functions are strongly typed, which means that you need to make sure the types actually line up.</p>\n<p>Another way this problem can come up is if you do something like:</p>\n<pre><code>recoloured_description = Replace(GetAttribute (room, \"description\"), \"red\", \"blue\")\n</code></pre>\n<p>This looks like it should work… but <code>GetAttribute</code>'s signature says its return type is \"Any\" rather than \"String\". So Quest looks for a function with the signature <code>Replace(Any, String, String)</code> and doesn't find it - it never even attempts to run the code. Making this example work has two solutions:</p>\n<pre><code>recoloured_description = Replace(GetString (room, \"description\"), \"red\", \"blue\")\n</code></pre>\n<p>or</p>\n<pre><code>desc = GetAttribute (room, \"description\")\nrecoloured_description = Replace(desc, \"red\", \"blue\")\n</code></pre>\n<p>In the first case, you use a different function which always returns a string. In the second case, you get the value first, so that Quest assesses the second line based on the actual type of the value, rather checking if Replace can handle whatever value GetAttribute is capable of creating.</p>\n<p>Similar issues are why it's advised to use <code>StringListItem</code> rather than <code>ListItem</code>, for example.</p>\n<p>If this suggestion doesn't help you, it would probably be good to share the line of code you're using.</p>\n\n",
      "PostDate": "2024-05-08T08:44:35.2878067Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "d0968878-b144-43c3-9f63-facd4bad27f9",
      "UserId": 652801,
      "Username": "Gng",
      "AvatarUrl": "https://i.imgur.com/w0pOzA9b.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "As always thanks for these tips. I wasn't aware of \"any\" type.\r\n\r\nI just tried again and the code works now, I don't what I was doing wrong, thank you!\r\n\r\nHere's the code for anyone interested: \r\n```\r\nmsg (\"You equip your armor.\")\r\nplayer.armoramount = this.acid\r\nlist remove (this.inventoryverbs, \"Drop\")\r\nlist remove (this.inventoryverbs, \"Equip\")\r\nlist add (this.inventoryverbs, \"Unequip\")\r\nthis.alias = this.alias + \" (equipped)\"\r\nplayer.equippedarmor = this\r\n----------------------------------\r\nmsg (\"You unequip your armor.\")\r\nplayer.armoramount = 0\r\nlist add (this.inventoryverbs, \"Drop\")\r\nlist add (this.inventoryverbs, \"Equip\")\r\nlist remove (this.inventoryverbs, \"Unequip\")\r\nthis.alias = Replace(this.alias, \" (equipped)\", \" \")\r\nplayer.equippedarmor = \"non\"\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p>As always thanks for these tips. I wasn't aware of \"any\" type.</p>\n<p>I just tried again and the code works now, I don't what I was doing wrong, thank you!</p>\n<p>Here's the code for anyone interested:</p>\n<pre><code>msg (\"You equip your armor.\")\nplayer.armoramount = this.acid\nlist remove (this.inventoryverbs, \"Drop\")\nlist remove (this.inventoryverbs, \"Equip\")\nlist add (this.inventoryverbs, \"Unequip\")\nthis.alias = this.alias + \" (equipped)\"\nplayer.equippedarmor = this\n----------------------------------\nmsg (\"You unequip your armor.\")\nplayer.armoramount = 0\nlist add (this.inventoryverbs, \"Drop\")\nlist add (this.inventoryverbs, \"Equip\")\nlist remove (this.inventoryverbs, \"Unequip\")\nthis.alias = Replace(this.alias, \" (equipped)\", \" \")\nplayer.equippedarmor = \"non\"\n</code></pre>\n\n",
      "PostDate": "2024-05-09T19:17:23.1562862Z",
      "LastEditDate": "2024-05-09T19:19:05.9521693Z",
      "link": null
    },
    {
      "PostId": "bdaaabdc-e052-42f6-b0a9-09073776877f",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> I just tried again and the code works now, I don't what I was doing wrong, thank you!\r\n\r\nIn that kind of situation, the most likely cause of bugs is if the armour doesn't have an alias.\r\n\r\nMost of the built-in functions will use the object's name if it doesn't have an alias; but `this.alias` will have the value `null`, and so trying to use Replace on it will fail because null isn't a string. There are several pieces of built-in code which will create an alias by copying the name; so it could be that the bug only occurs if you haven't done one of those things.\r\nIn this case, I would suggest that you either make sure the object has an alias. Or even better, use `GetDisplayAlias` so that if someone else copies your code, it will automatically check for the most common mistake.\r\n\r\nSo the lines would be:\r\n```\r\nthis.alias = GetDisplayAlias (this) + \" (equipped)\"\r\n```\r\nin the first one, and\r\n```\r\nthis.alias = Replace(GetDisplayAlias (this), \" (equipped)\", \" \")\r\n```\r\nin the second.",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>I just tried again and the code works now, I don't what I was doing wrong, thank you!</p>\n</blockquote>\n<p>In that kind of situation, the most likely cause of bugs is if the armour doesn't have an alias.</p>\n<p>Most of the built-in functions will use the object's name if it doesn't have an alias; but <code>this.alias</code> will have the value <code>null</code>, and so trying to use Replace on it will fail because null isn't a string. There are several pieces of built-in code which will create an alias by copying the name; so it could be that the bug only occurs if you haven't done one of those things.<br>\nIn this case, I would suggest that you either make sure the object has an alias. Or even better, use <code>GetDisplayAlias</code> so that if someone else copies your code, it will automatically check for the most common mistake.</p>\n<p>So the lines would be:</p>\n<pre><code>this.alias = GetDisplayAlias (this) + \" (equipped)\"\n</code></pre>\n<p>in the first one, and</p>\n<pre><code>this.alias = Replace(GetDisplayAlias (this), \" (equipped)\", \" \")\n</code></pre>\n<p>in the second.</p>\n\n",
      "PostDate": "2024-05-09T22:16:13.234449Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "8a7139a3-6878-4c97-87bc-84b1e5830c08",
      "UserId": 652801,
      "Username": "Gng",
      "AvatarUrl": "https://i.imgur.com/w0pOzA9b.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Much appreciated. That's a nice tip.\r\nThe armor has an alias, I think that I did the Replace function wrong somehow.\r\n\r\n\r\n\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Much appreciated. That's a nice tip.<br>\nThe armor has an alias, I think that I did the Replace function wrong somehow.</p>\n\n",
      "PostDate": "2024-05-10T06:22:00.2610946Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "15ff9626-43ec-4d69-bd51-713addfe2260",
      "UserId": 620840,
      "Username": "grumbleputty",
      "AvatarUrl": "https://secure.gravatar.com/avatar/d91b27f903a0377edfe9429ae7819224?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I must be missing something in regards to Replace. After following the above steps using GetString on my variables, to make sure Replace was getting called with (string input, string old text, string new text), I still got an error. Even running the following test code (in the Web Editor) fails:\r\n\r\n```Replace (\"bananas are delicious\", \"bananas\", \"fishsticks\")```\r\n\r\nWhen the player hits that part of the script I get the following:\r\n\r\n**Error running script: Function not found: 'Replace'\r\nError running script: Object reference not set to an instance of an object.**\r\n\r\nAny thoughts on what I'm missing here?\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>I must be missing something in regards to Replace. After following the above steps using GetString on my variables, to make sure Replace was getting called with (string input, string old text, string new text), I still got an error. Even running the following test code (in the Web Editor) fails:</p>\n<p><code>Replace (\"bananas are delicious\", \"bananas\", \"fishsticks\")</code></p>\n<p>When the player hits that part of the script I get the following:</p>\n<p><strong>Error running script: Function not found: 'Replace'<br>\nError running script: Object reference not set to an instance of an object.</strong></p>\n<p>Any thoughts on what I'm missing here?</p>\n\n",
      "PostDate": "2024-07-07T15:31:55.9341274Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "fc78cfa4-6559-4e3b-9ace-84fa22946617",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "@grumbleputty\r\n\r\nAre you just putting that on a line by itself? I'm not sure what you expect it to do with the result.\r\n\r\nIf you want it to display the result, you'd do something like:\r\n```\r\nmsg (Replace (\"bananas are delicious\", \"bananas\", \"fishsticks\"))\r\n```\r\nor you could put the result into a variable:\r\n```\r\nsomevariable = Replace (\"bananas are delicious\", \"bananas\", \"fishsticks\")\r\n```\r\nor\r\n```\r\nplayer.motto = Replace (\"bananas are delicious\", \"bananas\", \"fishsticks\")\r\n```\r\n\r\nThe purpose of the `Replace function is to return a modified string. Now, it's weird that it gives an error message rather than just doing nothing; but that's how many built-in functions work for some reason.\r\n\r\nSo… do something with the replaced string, and it should work fine.",
      "EditableFormat": "markdown",
      "HTML": "<p>@grumbleputty</p>\n<p>Are you just putting that on a line by itself? I'm not sure what you expect it to do with the result.</p>\n<p>If you want it to display the result, you'd do something like:</p>\n<pre><code>msg (Replace (\"bananas are delicious\", \"bananas\", \"fishsticks\"))\n</code></pre>\n<p>or you could put the result into a variable:</p>\n<pre><code>somevariable = Replace (\"bananas are delicious\", \"bananas\", \"fishsticks\")\n</code></pre>\n<p>or</p>\n<pre><code>player.motto = Replace (\"bananas are delicious\", \"bananas\", \"fishsticks\")\n</code></pre>\n<p>The purpose of the `Replace function is to return a modified string. Now, it's weird that it gives an error message rather than just doing nothing; but that's how many built-in functions work for some reason.</p>\n<p>So… do something with the replaced string, and it should work fine.</p>\n\n",
      "PostDate": "2024-07-07T19:04:30.0309239Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "9e3652ce-883f-40e0-92ca-52f13ce6bc28",
      "UserId": 620840,
      "Username": "grumbleputty",
      "AvatarUrl": "https://secure.gravatar.com/avatar/d91b27f903a0377edfe9429ae7819224?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Oh...now I just feel silly",
      "EditableFormat": "markdown",
      "HTML": "<p>Oh...now I just feel silly</p>\n\n",
      "PostDate": "2024-07-07T20:25:51.5353586Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

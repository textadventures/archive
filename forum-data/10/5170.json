{
  "Topic": {
    "TopicId": "5170",
    "ForumId": "10",
    "Title": "Scripting a Fight",
    "LastUpdated": "2015-04-25T06:18:23+01:00",
    "ReplyCount": 3
  },
  "Posts": [
    {
      "PostId": "35773",
      "UserId": 0,
      "Username": "Lighthouse",
      "UserAvatar": null,
      "UserGravatar": "e634f87be74723d41cf24c1f5c6fd050",
      "EditableText": "I'm struggling to create a fight in my text based game. I don't want anything complicated: if you've ever played Zork, you know what I'm talking about. Just hitting the opponent until he dies, while receiving damage yourself. I don't even know if there is a way to script what I want to do. Right now, I have created a series of &quot;first time&quot; commands that give a probability of the opponent hitting you or missing you. The problem is, the fight is always the same amount of turns until it ends. It doesn't end when the opponents health is depleted, which is what I want. Also, it means that the opponent will only return an attack, so if you take a look at the room while in the fight your opponent will not attack. Is there a way to script what I want? Is there a way to give other entities health that can be decreased? Please help.",
      "EditableFormat": "bbcode",
      "HTML": "I'm struggling to create a fight in my text based game. I don't want anything complicated: if you've ever played Zork, you know what I'm talking about. Just hitting the opponent until he dies, while receiving damage yourself. I don't even know if there is a way to script what I want to do. Right now, I have created a series of &quot;first time&quot; commands that give a probability of the opponent hitting you or missing you. The problem is, the fight is always the same amount of turns until it ends. It doesn't end when the opponents health is depleted, which is what I want. Also, it means that the opponent will only return an attack, so if you take a look at the room while in the fight your opponent will not attack. Is there a way to script what I want? Is there a way to give other entities health that can be decreased? Please help.",
      "PostDate": "2015-04-24T21:42:28+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "35774",
      "UserId": 0,
      "Username": "The Pixie",
      "UserAvatar": null,
      "UserGravatar": "cfa37e927f96177bcf6053ae8f108f77",
      "EditableText": "Well first I am going to pimp my RPG library. It may be more than you want, but might be more than writing it all yourself.\n<!-- l --><a class=\"postlink-local\" href=\"http://forum.textadventures.co.uk/viewtopic.php?f=18&amp;t=4886\">viewtopic.php?f=18&amp;t=4886</a><!-- l -->\n\nAssuming you want to do it all yourself...\n\nYou need an attribute, let us call it &quot;hitpoints&quot;. You need to set it up on the player and any opponents. You can do that on the Attributes tab (as long as  this is with the off-line editor). Attributes are at the bottom, just click add, and type the name. Then set it to be Integer (i.e., a whole number), and set the value.\n\nSound like you already have an attack command. You can randomise it with the GetRandomInt function:\n<!-- m --><a class=\"postlink\" href=\"http://docs.textadventures.co.uk/quest/functions/getrandomint.html\">http://docs.textadventures.co.uk/quest/ ... omint.html</a><!-- m -->\n\nFor the opponent, you need a &quot;turn script&quot;. A turn script will fire every turn, so the opponent can attack even if the player is not attacking. There are various ways to set it up. Probably the easiest is to create a turn script for each opponent, and only set it going when that opponent starts to attack. Each turn the opponent will attack, just remember to stop it when the opponent is dead.\n\nThat is a brief overview that will hopefully get you started, but if you want more, we can see what we can do.",
      "EditableFormat": "bbcode",
      "HTML": "Well first I am going to pimp my RPG library. It may be more than you want, but might be more than writing it all yourself.<br/><!-- l --><a class=\"postlink-local\" href=\"http://forum.textadventures.co.uk/viewtopic.php?f=18&amp;t=4886\">viewtopic.php?f=18&amp;t=4886</a><!-- l --><br/><br/>Assuming you want to do it all yourself...<br/><br/>You need an attribute, let us call it &quot;hitpoints&quot;. You need to set it up on the player and any opponents. You can do that on the Attributes tab (as long as  this is with the off-line editor). Attributes are at the bottom, just click add, and type the name. Then set it to be Integer (i.e., a whole number), and set the value.<br/><br/>Sound like you already have an attack command. You can randomise it with the GetRandomInt function:<br/><!-- m --><a class=\"postlink\" href=\"http://docs.textadventures.co.uk/quest/functions/getrandomint.html\">http://docs.textadventures.co.uk/quest/ ... omint.html</a><!-- m --><br/><br/>For the opponent, you need a &quot;turn script&quot;. A turn script will fire every turn, so the opponent can attack even if the player is not attacking. There are various ways to set it up. Probably the easiest is to create a turn script for each opponent, and only set it going when that opponent starts to attack. Each turn the opponent will attack, just remember to stop it when the opponent is dead.<br/><br/>That is a brief overview that will hopefully get you started, but if you want more, we can see what we can do.",
      "PostDate": "2015-04-24T22:20:53+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "35777",
      "UserId": 0,
      "Username": "XanMag",
      "UserAvatar": "7161_1436827710.jpg",
      "UserGravatar": "4b45a3afd18077f76f6569225c422bdb",
      "EditableText": "Here I am again to offer my foolishness!!  You'll probably find Pixie's suggestions more to your liking but who knows...\n\nHere's my method and probably what I would toy with as a non-coder.  I'd create, say, 4-5 duplicate enemies.  Give each a percent of successful hit under an 'attack enemy' command and then create nested 'IF' statements that raise flags for a counter attack with a percentage success that decrease players health.  If your attack is successful, I'd move the hit mob, possibly after a counter attack, out of the room and replace it with an identical mob (maybe changing the name from mighty troll warrior to staggering troll warrior to bloody troll warrior to dead troll warrior (or whatever <!-- s:) --><img src=\"{SMILIES_PATH}/icon_smile.gif\" alt=\":)\" title=\"Smile\" /><!-- s:) -->) with a similar successful hit-flag-counter-replace script.  The last mob after a successful hit would leave the room to be replaced by a dead mob.  All hit mobs and replacing mobs would be stored in a dead room. Use the move object option.\n\nThis way, you could say a mob is killed after 4-5 successful hit attempts and each mob could potentially decrease your health rating WITHOUT dealing with creating HP's for one character/monster.  I'm terrible with integers and attributes and getting random values so I've established some non-conventional/non-coding work arounds.  Moving sh!t into and out of rooms has been a life saver to my game creation!! <!-- s:) --><img src=\"{SMILIES_PATH}/icon_smile.gif\" alt=\":)\" title=\"Smile\" /><!-- s:) -->\n\nGood luck and happy gaming.",
      "EditableFormat": "bbcode",
      "HTML": "Here I am again to offer my foolishness!!  You'll probably find Pixie's suggestions more to your liking but who knows...<br/><br/>Here's my method and probably what I would toy with as a non-coder.  I'd create, say, 4-5 duplicate enemies.  Give each a percent of successful hit under an 'attack enemy' command and then create nested 'IF' statements that raise flags for a counter attack with a percentage success that decrease players health.  If your attack is successful, I'd move the hit mob, possibly after a counter attack, out of the room and replace it with an identical mob (maybe changing the name from mighty troll warrior to staggering troll warrior to bloody troll warrior to dead troll warrior (or whatever <!-- s:) --><img src=\"{SMILIES_PATH}/icon_smile.gif\" alt=\":)\" title=\"Smile\" /><!-- s:) -->) with a similar successful hit-flag-counter-replace script.  The last mob after a successful hit would leave the room to be replaced by a dead mob.  All hit mobs and replacing mobs would be stored in a dead room. Use the move object option.<br/><br/>This way, you could say a mob is killed after 4-5 successful hit attempts and each mob could potentially decrease your health rating WITHOUT dealing with creating HP's for one character/monster.  I'm terrible with integers and attributes and getting random values so I've established some non-conventional/non-coding work arounds.  Moving sh!t into and out of rooms has been a life saver to my game creation!! <!-- s:) --><img src=\"{SMILIES_PATH}/icon_smile.gif\" alt=\":)\" title=\"Smile\" /><!-- s:) --><br/><br/>Good luck and happy gaming.",
      "PostDate": "2015-04-25T04:57:57+01:00",
      "LastEditDate": null
    },
    {
      "PostId": "35779",
      "UserId": 0,
      "Username": "HegemonKhan",
      "UserAvatar": null,
      "UserGravatar": "a96cf34d8d97c57de38f54ee22b1759b",
      "EditableText": "Pixie's Simple Combat Library is best for people new to this stuff (and~or want an 'open' combat system), but if you're more interested in a 'script-locked' (you're stuck in the battle sequence until you win, you lose, you run away, or monster runs away) combat system, you can take a look at my (using a variation of Pertex' Combat Library code ~ all credit goes to Pertex) combat code, though it is a bit more complex in design, but at least maybe it can help you see and get some ideas at doing combat:\n\n<!-- l --><a class=\"postlink-local\" href=\"http://forum.textadventures.co.uk/viewtopic.php?f=10&amp;t=3348&amp;start=120#p22483\">viewtopic.php?f=10&amp;t=3348&amp;start=120#p22483</a><!-- l -->\n\nand just search my posts for~on 'attributes' and~or 'if' scripts, as I got a lot of posts explaining these things, lol.\n\n-----------\n\nconceptually:\n\n1. both characters ( 'player' Player Object and 'orc' Object) need a 'life' Integer Attribute\n\n2. both characters ( 'player' Player Object and 'orc' Object) need a 'damage' Integer Attribute\n\n3. the 'orc' Object needs a 'dead' Boolean Attribute that is set to Value: false\n\n4. the 'orc' Object needs a 'fight' Verb\n\n5. inside the 'orc' Object's 'fight' Verb, you want this (in code) setup:\n\nwith my comments:\n\n[code:1ofncg47]// you check if the 'orc' is not dead (if so&#58; subsequently do battling scripts) or dead (if so&#58; subsequently msg that the orc is already dead ~ see the very bottom of this code block)&#58;\nif (orc&#46;dead = false) {\n  // you go first, attacking the orc&#58;\n  orc&#46;life = orc&#46;life - player&#46;damage\n  msg (&quot;You attack the orc, hitting it for &quot; + player&#46;damage + &quot; damage, leaving it with only &quot; + orc&#46;life + &quot; life left&#46;&quot;)\n  // you check if the orc is dead (via if it has 0 or less life)&#58;\n  if (orc&#46;life &lt;= 0) {\n    // you alter~re-set the 'orc' Object's 'dead' Boolean Attribute to now having the Value of 'true', making it be 'dead' &#58;\n    orc&#46;dead = true\n    msg (&quot;You killed the orc&#46;&quot;)\n  // if the orc is not dead (if it has more than 0 life remaining), it now attacks you&#58;\n  } else {\n    player&#46;life = player&#46;life - orc&#46;damage\n    msg (&quot;The orc attacks you for &quot; + orc&#46;damage + &quot; damage, leaving you with only &quot; + player&#46;life + &quot; left&#46;&quot;)\n    // we check if you're dead (via if your life is 0 or less), and if you are, we msg it and that the game is over, and lastly, we end the game&#58;\n    if (player&#46;life &lt;= 0) {\n      msg (&quot;You were killed by the orc&#46;&quot;)\n      msg (&quot;GAME OVER&quot;)\n      finish\n    // this below is to loop~continue the combat sequence until you or the orc is killed, locking you into the battle sequence, preventing you from doing anything else, until the battle is over&#58;\n    } else {\n      // this entire 'fight' scripting block would have to be put inside of a Function (which the Function would be called upon from within your 'orc' Object's 'fight' Verb), so that you can then use this here code line to 'call upon' this Function, to loop~run through it again\n    }\n  }\n// remember, we got to deal with if the orc is already dead (see the very top comment)&#58;\n} else if (orc&#46;dead = true) {\n  msg (&quot;The orc is already dead, silly&#46; You can't fight a dead rotting corpse!&quot;)\n}[/code:1ofncg47]\n\nwithout my comments, full code (using looping ~ as a Function):\n\n[code:1ofncg47]the 'orc' Object's 'fight' Script Attribute (GUI~Editor&#58; Verb) and the 'fight' Verb (the GUI~Editor automatically creates this for you)&#58;\n\n&lt;object name=&quot;orc&quot;&gt;\n  &lt;inherit name=&quot;editor_object&quot; /&gt;\n  &lt;parent type=&quot;object&quot;&gt;room&lt;/parent&gt;\n  &lt;fight type=&quot;script&quot;&gt;\n    orc_fight_function\n  &lt;/fight&gt;\n&lt;/object&gt;\n\n&lt;verb&gt;\n  &lt;property&gt;fight&lt;/property&gt;\n  &lt;pattern&gt;fight&lt;/pattern&gt;\n  &lt;defaultexpression&gt;You can't fight that!&lt;/defaultexpression&gt;\n&lt;/verb&gt;\n\nthe 'orc_fight_function' Function&#58;\n\n&lt;function name=&quot;orc_fight_function&quot;&gt;\n  if (orc&#46;dead = false) {\n    orc&#46;life = orc&#46;life - player&#46;damage\n    msg (&quot;You attack the orc, hitting it for &quot; + player&#46;damage + &quot; damage, leaving it with only &quot; + orc&#46;life + &quot; life left&#46;&quot;)\n    if (orc&#46;life &lt;= 0) {\n      orc&#46;dead = true\n      msg (&quot;You killed the orc&#46;&quot;)\n    } else {\n      player&#46;life = player&#46;life - orc&#46;damage\n      msg (&quot;The orc attacks you for &quot; + orc&#46;damage + &quot; damage, leaving you with only &quot; + player&#46;life + &quot; left&#46;&quot;)\n      if (player&#46;life &lt;= 0) {\n        msg (&quot;You were killed by the orc&#46;&quot;)\n        msg (&quot;GAME OVER&quot;)\n        finish\n      } else {\n        orc_fight_function\n      }\n    }\n  } else {\n    msg (&quot;The orc is already dead, silly&#46; You can't fight a dead rotting corpse!&quot;)\n  }\n&lt;/function&gt;[/code:1ofncg47]",
      "EditableFormat": "bbcode",
      "HTML": "Pixie's Simple Combat Library is best for people new to this stuff (and~or want an 'open' combat system), but if you're more interested in a 'script-locked' (you're stuck in the battle sequence until you win, you lose, you run away, or monster runs away) combat system, you can take a look at my (using a variation of Pertex' Combat Library code ~ all credit goes to Pertex) combat code, though it is a bit more complex in design, but at least maybe it can help you see and get some ideas at doing combat:<br/><br/><!-- l --><a class=\"postlink-local\" href=\"http://forum.textadventures.co.uk/viewtopic.php?f=10&amp;t=3348&amp;start=120#p22483\">viewtopic.php?f=10&amp;t=3348&amp;start=120#p22483</a><!-- l --><br/><br/>and just search my posts for~on 'attributes' and~or 'if' scripts, as I got a lot of posts explaining these things, lol.<br/><br/>-----------<br/><br/>conceptually:<br/><br/>1. both characters ( 'player' Player Object and 'orc' Object) need a 'life' Integer Attribute<br/><br/>2. both characters ( 'player' Player Object and 'orc' Object) need a 'damage' Integer Attribute<br/><br/>3. the 'orc' Object needs a 'dead' Boolean Attribute that is set to Value: false<br/><br/>4. the 'orc' Object needs a 'fight' Verb<br/><br/>5. inside the 'orc' Object's 'fight' Verb, you want this (in code) setup:<br/><br/>with my comments:<br/><br/><pre><code>// you check if the 'orc' is not dead (if so&#58; subsequently do battling scripts) or dead (if so&#58; subsequently msg that the orc is already dead ~ see the very bottom of this code block)&#58;<br/>if (orc&#46;dead = false) {<br/>  // you go first, attacking the orc&#58;<br/>  orc&#46;life = orc&#46;life - player&#46;damage<br/>  msg (&quot;You attack the orc, hitting it for &quot; + player&#46;damage + &quot; damage, leaving it with only &quot; + orc&#46;life + &quot; life left&#46;&quot;)<br/>  // you check if the orc is dead (via if it has 0 or less life)&#58;<br/>  if (orc&#46;life &lt;= 0) {<br/>    // you alter~re-set the 'orc' Object's 'dead' Boolean Attribute to now having the Value of 'true', making it be 'dead' &#58;<br/>    orc&#46;dead = true<br/>    msg (&quot;You killed the orc&#46;&quot;)<br/>  // if the orc is not dead (if it has more than 0 life remaining), it now attacks you&#58;<br/>  } else {<br/>    player&#46;life = player&#46;life - orc&#46;damage<br/>    msg (&quot;The orc attacks you for &quot; + orc&#46;damage + &quot; damage, leaving you with only &quot; + player&#46;life + &quot; left&#46;&quot;)<br/>    // we check if you're dead (via if your life is 0 or less), and if you are, we msg it and that the game is over, and lastly, we end the game&#58;<br/>    if (player&#46;life &lt;= 0) {<br/>      msg (&quot;You were killed by the orc&#46;&quot;)<br/>      msg (&quot;GAME OVER&quot;)<br/>      finish<br/>    // this below is to loop~continue the combat sequence until you or the orc is killed, locking you into the battle sequence, preventing you from doing anything else, until the battle is over&#58;<br/>    } else {<br/>      // this entire 'fight' scripting block would have to be put inside of a Function (which the Function would be called upon from within your 'orc' Object's 'fight' Verb), so that you can then use this here code line to 'call upon' this Function, to loop~run through it again<br/>    }<br/>  }<br/>// remember, we got to deal with if the orc is already dead (see the very top comment)&#58;<br/>} else if (orc&#46;dead = true) {<br/>  msg (&quot;The orc is already dead, silly&#46; You can't fight a dead rotting corpse!&quot;)<br/>}</code></pre><br/><br/>without my comments, full code (using looping ~ as a Function):<br/><br/><pre><code>the 'orc' Object's 'fight' Script Attribute (GUI~Editor&#58; Verb) and the 'fight' Verb (the GUI~Editor automatically creates this for you)&#58;<br/><br/>&lt;object name=&quot;orc&quot;&gt;<br/>  &lt;inherit name=&quot;editor_object&quot; /&gt;<br/>  &lt;parent type=&quot;object&quot;&gt;room&lt;/parent&gt;<br/>  &lt;fight type=&quot;script&quot;&gt;<br/>    orc_fight_function<br/>  &lt;/fight&gt;<br/>&lt;/object&gt;<br/><br/>&lt;verb&gt;<br/>  &lt;property&gt;fight&lt;/property&gt;<br/>  &lt;pattern&gt;fight&lt;/pattern&gt;<br/>  &lt;defaultexpression&gt;You can't fight that!&lt;/defaultexpression&gt;<br/>&lt;/verb&gt;<br/><br/>the 'orc_fight_function' Function&#58;<br/><br/>&lt;function name=&quot;orc_fight_function&quot;&gt;<br/>  if (orc&#46;dead = false) {<br/>    orc&#46;life = orc&#46;life - player&#46;damage<br/>    msg (&quot;You attack the orc, hitting it for &quot; + player&#46;damage + &quot; damage, leaving it with only &quot; + orc&#46;life + &quot; life left&#46;&quot;)<br/>    if (orc&#46;life &lt;= 0) {<br/>      orc&#46;dead = true<br/>      msg (&quot;You killed the orc&#46;&quot;)<br/>    } else {<br/>      player&#46;life = player&#46;life - orc&#46;damage<br/>      msg (&quot;The orc attacks you for &quot; + orc&#46;damage + &quot; damage, leaving you with only &quot; + player&#46;life + &quot; left&#46;&quot;)<br/>      if (player&#46;life &lt;= 0) {<br/>        msg (&quot;You were killed by the orc&#46;&quot;)<br/>        msg (&quot;GAME OVER&quot;)<br/>        finish<br/>      } else {<br/>        orc_fight_function<br/>      }<br/>    }<br/>  } else {<br/>    msg (&quot;The orc is already dead, silly&#46; You can't fight a dead rotting corpse!&quot;)<br/>  }<br/>&lt;/function&gt;</code></pre>",
      "PostDate": "2015-04-25T06:18:23+01:00",
      "LastEditDate": null
    }
  ]
}

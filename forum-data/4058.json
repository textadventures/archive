{
  "Topic": {
    "TopicId": "4058",
    "ForumId": "10",
    "Title": "Taking scenery objects",
    "LastUpdated": "2013-12-21T21:28:17+00:00",
    "ReplyCount": 8
  },
  "Posts": [
    {
      "PostId": "27150",
      "UserId": 0,
      "Username": "cdutton184",
      "UserAvatar": null,
      "UserGravatar": "61656e8ea5cb37d98f7308f4f3b9c814",
      "EditableText": "Alex, I've noticed an error recently. If you create scenery objects and TAKE them within the game they become visible objects. Very annoying. You can fix them by doing a Run Script on scenery objects TAKE tab and create a message for each one (which I've now done now for my last couple of games.)",
      "EditableFormat": "bbcode",
      "HTML": "Alex, I've noticed an error recently. If you create scenery objects and TAKE them within the game they become visible objects. Very annoying. You can fix them by doing a Run Script on scenery objects TAKE tab and create a message for each one (which I've now done now for my last couple of games.)",
      "PostDate": "2013-12-19T12:46:55+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "27152",
      "UserId": 0,
      "Username": "The Pixie",
      "UserAvatar": null,
      "UserGravatar": "cfa37e927f96177bcf6053ae8f108f77",
      "EditableText": "I think this is by design.",
      "EditableFormat": "bbcode",
      "HTML": "I think this is by design.",
      "PostDate": "2013-12-19T14:22:15+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "27153",
      "UserId": 0,
      "Username": "Alex",
      "UserAvatar": null,
      "UserGravatar": "188b72c5e13327f4fde3989dca7d7d53",
      "EditableText": "Yes, so you can see it in your inventory!\n\nI'm struggle to understand in what scenario you would want scenery objects to be taken anyway...",
      "EditableFormat": "bbcode",
      "HTML": "Yes, so you can see it in your inventory!<br/><br/>I'm struggle to understand in what scenario you would want scenery objects to be taken anyway...",
      "PostDate": "2013-12-19T15:21:08+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "27157",
      "UserId": 0,
      "Username": "privateer",
      "UserAvatar": null,
      "UserGravatar": "31fc3fff3ae1be07ecddb38ce98b83c4",
      "EditableText": "Alex, I think you might have misunderstood the problem. I mentioned it in an email to you a while back. If the player decides to ATTEMPT to take a scenery object, that object will cease to be a scenery object. For example:\n\nYou're standing next to a lake. The water looks cool and inviting.\n\nExam water (a scenery object)\n\n&quot;Deep and lovely&quot;\n\nGet water\n\n&quot;You can't take it&quot; (but now when you look at your location...)\n\nYou're standing next to a lake. The water looks cool and inviting. You can also see water. (suddenly the water is not scenery)\n\nAs Craig pointed out, you can circumvent this issue by making take a script. But if you like LOTS of scenery objects to make the game world nice and detailed, that's quite a chore!\n\nCheers.",
      "EditableFormat": "bbcode",
      "HTML": "Alex, I think you might have misunderstood the problem. I mentioned it in an email to you a while back. If the player decides to ATTEMPT to take a scenery object, that object will cease to be a scenery object. For example:<br/><br/>You're standing next to a lake. The water looks cool and inviting.<br/><br/>Exam water (a scenery object)<br/><br/>&quot;Deep and lovely&quot;<br/><br/>Get water<br/><br/>&quot;You can't take it&quot; (but now when you look at your location...)<br/><br/>You're standing next to a lake. The water looks cool and inviting. You can also see water. (suddenly the water is not scenery)<br/><br/>As Craig pointed out, you can circumvent this issue by making take a script. But if you like LOTS of scenery objects to make the game world nice and detailed, that's quite a chore!<br/><br/>Cheers.",
      "PostDate": "2013-12-19T15:34:06+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "27158",
      "UserId": 0,
      "Username": "Alex",
      "UserAvatar": null,
      "UserGravatar": "188b72c5e13327f4fde3989dca7d7d53",
      "EditableText": "OK if this is a bug then please add it to the issue tracker <!-- m --><a class=\"postlink\" href=\"https://quest.codeplex.com/workitem/list/advanced\">https://quest.codeplex.com/workitem/list/advanced</a><!-- m -->",
      "EditableFormat": "bbcode",
      "HTML": "OK if this is a bug then please add it to the issue tracker <!-- m --><a class=\"postlink\" href=\"https://quest.codeplex.com/workitem/list/advanced\">https://quest.codeplex.com/workitem/list/advanced</a><!-- m -->",
      "PostDate": "2013-12-19T15:35:50+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "27164",
      "UserId": 0,
      "Username": "cdutton184",
      "UserAvatar": null,
      "UserGravatar": "61656e8ea5cb37d98f7308f4f3b9c814",
      "EditableText": "It is a bug. I've played my older games and other games using version 5.3 onwards (that's when it started, it seems). Any game before that seems OK.\n\nThe reason for a GET (scenery object) would be due to a takeable scenery  object, described in the room description, required a response e.g. 'It's too heavy.' or 'It's fixed to the wall.' or 'You don't need it.', etc.\n\nIn someone else's game, for example, I tried GET GATE, and it appeared in the object list as 'You can see a gate2.'\n\nI'll report the bug if it hasn't been done be someone else already.",
      "EditableFormat": "bbcode",
      "HTML": "It is a bug. I've played my older games and other games using version 5.3 onwards (that's when it started, it seems). Any game before that seems OK.<br/><br/>The reason for a GET (scenery object) would be due to a takeable scenery  object, described in the room description, required a response e.g. 'It's too heavy.' or 'It's fixed to the wall.' or 'You don't need it.', etc.<br/><br/>In someone else's game, for example, I tried GET GATE, and it appeared in the object list as 'You can see a gate2.'<br/><br/>I'll report the bug if it hasn't been done be someone else already.",
      "PostDate": "2013-12-20T10:53:48+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "27168",
      "UserId": 0,
      "Username": "privateer",
      "UserAvatar": null,
      "UserGravatar": "31fc3fff3ae1be07ecddb38ce98b83c4",
      "EditableText": "I haven't reported it, so if you don't mind perhaps you would?",
      "EditableFormat": "bbcode",
      "HTML": "I haven't reported it, so if you don't mind perhaps you would?",
      "PostDate": "2013-12-20T20:34:55+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "27179",
      "UserId": 0,
      "Username": "Liam315",
      "UserAvatar": null,
      "UserGravatar": "ded290a24d340d761d42c897d08111aa",
      "EditableText": "Ahhhhhh. I've noticed this as well, I thought there was a problem in my code somewhere and I couldn't work out what was going wrong. Glad to know it's not just me.\n\n[quote=&quot;Alex&quot;:2i9e1qrt]I'm struggle to understand in what scenario you would want scenery objects to be taken anyway...[/quote:2i9e1qrt]\nThere are plenty of scenarios where you might want to do this. Masking the importance of an object for one so the description isn't just a bombardment of objects within a room shouting &quot;look at me, take me without thinking because you'll probably need me!&quot; Or an object you might not need but is fun to take anyway either for added realism or for some little bonus task. OK, that's only 2 scenarios but other people may have their reasons.\n\nEDIT: I've found the problem, it exists in the DoTake function. Where it has\n[code:2i9e1qrt]if (GetBoolean ( object , &quot;scenery&quot; )) {\n  object&#46;scenery = false\n}[/code:2i9e1qrt]\n\nIt's running that code indiscriminately whether the object is successfully taken or not.\n\nBy replacing DoTake with this you can stop it from happening while still changing the scenery attribute if the take is successful.\n[code:2i9e1qrt]prefix = &quot;&quot;\nif (ismultiple) {\n  prefix = GetDisplayAlias(object) + &quot;&#58; &quot;\n}\nif (object&#46;parent = game&#46;pov) {\n  msg (prefix + DynamicTemplate(&quot;AlreadyTaken&quot;, object))\n}\nelse if (not ListContains(ScopeReachable(), object)) {\n  msg (prefix + DynamicTemplate(&quot;ObjectNotOpen&quot;, GetBlockingObject(object)))\n}\nelse {\n  volume = 0\n  continue = true\n  foreach (obj, GetAllChildObjects(game&#46;pov)) {\n    if (HasInt(obj, &quot;volume&quot;)) {\n      volume = volume + obj&#46;volume\n    }\n  }\n  if (not Contains(game&#46;pov, object)) {\n    volume = volume + GetVolume(object,true)\n  }\n  if (HasInt(game&#46;pov, &quot;maxvolume&quot;)) {\n    if (volume &gt; game&#46;pov&#46;maxvolume) {\n      continue = false\n      if (HasString(game&#46;pov, &quot;containerfullmessage&quot;)) {\n        message = prefix + game&#46;pov&#46;containerfullmessage\n      }\n      else {\n        message = prefix + DynamicTemplate(&quot;FullInventory&quot;, object)\n      }\n    }\n  }\n  children = GetDirectChildren(game&#46;pov)\n  if (HasInt(game&#46;pov, &quot;maxobjects&quot;)) {\n    if (game&#46;pov&#46;maxobjects &gt; 0) {\n      if (ListCount(children) &gt;= game&#46;pov&#46;maxobjects) {\n        continue = false\n        if (HasString(game&#46;pov, &quot;containermaxobjects&quot;)) {\n          message = prefix + game&#46;pov&#46;containermaxobjects\n        }\n        else {\n          message = prefix + DynamicTemplate(&quot;MaxObjectsInInventory&quot;, object)\n        }\n      }\n    }\n  }\n  if (continue = false) {\n    msg (message)\n  }\n  else {\n    found = true\n    takemsg = object&#46;takemsg\n    switch (TypeOf(object, &quot;take&quot;)) {\n      case (&quot;script&quot;) {\n        if (ismultiple) {\n          msg (prefix)\n        }\n        do (object, &quot;take&quot;)\n        takemsg = &quot;&quot;\n      }\n      case (&quot;boolean&quot;) {\n        if (object&#46;take = true) {\n          object&#46;parent = game&#46;pov\n          if (takemsg = null) {\n            takemsg = DynamicTemplate(&quot;TakeSuccessful&quot;, object)\n          }\n        }\n        else {\n          found = false\n        }\n      }\n      case (&quot;string&quot;) {\n        object&#46;parent = game&#46;pov\n        takemsg = object&#46;take\n      }\n      default {\n        found = false\n      }\n    }\n    if (not found and takemsg = null) {\n      takemsg = DynamicTemplate(&quot;TakeUnsuccessful&quot;, object)\n    }\n    if (LengthOf(takemsg) &gt; 0) {\n      msg (prefix + takemsg)\n    }\n    if (HasScript(object, &quot;ontake&quot;)) {\n      do (object, &quot;ontake&quot;)\n    }\n  }\n}\nif (object&#46;parent = game&#46;pov) {\n  object&#46;scenery = false\n}[/code:2i9e1qrt]\n\nThe key part is at the bottom. I've taken the original code that I posted at the top out and at the very bottom of the script placed this. This is only a quick fix though, as it doesn't account for scenery objects being moved around the room, only if you take the object and it ends up in your inventory.\n\n[code:2i9e1qrt]if (object&#46;parent = game&#46;pov) {\n  object&#46;scenery = false\n}[/code:2i9e1qrt]\n\nHope this helps.",
      "EditableFormat": "bbcode",
      "HTML": "Ahhhhhh. I've noticed this as well, I thought there was a problem in my code somewhere and I couldn't work out what was going wrong. Glad to know it's not just me.<br/><br/><blockquote><cite>Alex wrote:</cite>I'm struggle to understand in what scenario you would want scenery objects to be taken anyway...</blockquote><br/>There are plenty of scenarios where you might want to do this. Masking the importance of an object for one so the description isn't just a bombardment of objects within a room shouting &quot;look at me, take me without thinking because you'll probably need me!&quot; Or an object you might not need but is fun to take anyway either for added realism or for some little bonus task. OK, that's only 2 scenarios but other people may have their reasons.<br/><br/>EDIT: I've found the problem, it exists in the DoTake function. Where it has<br/><pre><code>if (GetBoolean ( object , &quot;scenery&quot; )) {<br/>  object&#46;scenery = false<br/>}</code></pre><br/><br/>It's running that code indiscriminately whether the object is successfully taken or not.<br/><br/>By replacing DoTake with this you can stop it from happening while still changing the scenery attribute if the take is successful.<br/><pre><code>prefix = &quot;&quot;<br/>if (ismultiple) {<br/>  prefix = GetDisplayAlias(object) + &quot;&#58; &quot;<br/>}<br/>if (object&#46;parent = game&#46;pov) {<br/>  msg (prefix + DynamicTemplate(&quot;AlreadyTaken&quot;, object))<br/>}<br/>else if (not ListContains(ScopeReachable(), object)) {<br/>  msg (prefix + DynamicTemplate(&quot;ObjectNotOpen&quot;, GetBlockingObject(object)))<br/>}<br/>else {<br/>  volume = 0<br/>  continue = true<br/>  foreach (obj, GetAllChildObjects(game&#46;pov)) {<br/>    if (HasInt(obj, &quot;volume&quot;)) {<br/>      volume = volume + obj&#46;volume<br/>    }<br/>  }<br/>  if (not Contains(game&#46;pov, object)) {<br/>    volume = volume + GetVolume(object,true)<br/>  }<br/>  if (HasInt(game&#46;pov, &quot;maxvolume&quot;)) {<br/>    if (volume &gt; game&#46;pov&#46;maxvolume) {<br/>      continue = false<br/>      if (HasString(game&#46;pov, &quot;containerfullmessage&quot;)) {<br/>        message = prefix + game&#46;pov&#46;containerfullmessage<br/>      }<br/>      else {<br/>        message = prefix + DynamicTemplate(&quot;FullInventory&quot;, object)<br/>      }<br/>    }<br/>  }<br/>  children = GetDirectChildren(game&#46;pov)<br/>  if (HasInt(game&#46;pov, &quot;maxobjects&quot;)) {<br/>    if (game&#46;pov&#46;maxobjects &gt; 0) {<br/>      if (ListCount(children) &gt;= game&#46;pov&#46;maxobjects) {<br/>        continue = false<br/>        if (HasString(game&#46;pov, &quot;containermaxobjects&quot;)) {<br/>          message = prefix + game&#46;pov&#46;containermaxobjects<br/>        }<br/>        else {<br/>          message = prefix + DynamicTemplate(&quot;MaxObjectsInInventory&quot;, object)<br/>        }<br/>      }<br/>    }<br/>  }<br/>  if (continue = false) {<br/>    msg (message)<br/>  }<br/>  else {<br/>    found = true<br/>    takemsg = object&#46;takemsg<br/>    switch (TypeOf(object, &quot;take&quot;)) {<br/>      case (&quot;script&quot;) {<br/>        if (ismultiple) {<br/>          msg (prefix)<br/>        }<br/>        do (object, &quot;take&quot;)<br/>        takemsg = &quot;&quot;<br/>      }<br/>      case (&quot;boolean&quot;) {<br/>        if (object&#46;take = true) {<br/>          object&#46;parent = game&#46;pov<br/>          if (takemsg = null) {<br/>            takemsg = DynamicTemplate(&quot;TakeSuccessful&quot;, object)<br/>          }<br/>        }<br/>        else {<br/>          found = false<br/>        }<br/>      }<br/>      case (&quot;string&quot;) {<br/>        object&#46;parent = game&#46;pov<br/>        takemsg = object&#46;take<br/>      }<br/>      default {<br/>        found = false<br/>      }<br/>    }<br/>    if (not found and takemsg = null) {<br/>      takemsg = DynamicTemplate(&quot;TakeUnsuccessful&quot;, object)<br/>    }<br/>    if (LengthOf(takemsg) &gt; 0) {<br/>      msg (prefix + takemsg)<br/>    }<br/>    if (HasScript(object, &quot;ontake&quot;)) {<br/>      do (object, &quot;ontake&quot;)<br/>    }<br/>  }<br/>}<br/>if (object&#46;parent = game&#46;pov) {<br/>  object&#46;scenery = false<br/>}</code></pre><br/><br/>The key part is at the bottom. I've taken the original code that I posted at the top out and at the very bottom of the script placed this. This is only a quick fix though, as it doesn't account for scenery objects being moved around the room, only if you take the object and it ends up in your inventory.<br/><br/><pre><code>if (object&#46;parent = game&#46;pov) {<br/>  object&#46;scenery = false<br/>}</code></pre><br/><br/>Hope this helps.",
      "PostDate": "2013-12-21T14:26:23+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "27182",
      "UserId": 0,
      "Username": "Pertex",
      "UserAvatar": "5940_1369854251.gif",
      "UserGravatar": "4cc1e52f99452e841ecf4cbee9eadde9",
      "EditableText": "[quote=&quot;Liam315&quot;:3j37i5m0] This is only a quick fix though, as it doesn't account for scenery objects being moved around the room, only if you take the object and it ends up in your inventory.\n[/quote:3j37i5m0]\n\nI think you can't take care for the scenery flag for all commands. If I remember right the problem was taking and then dropping a scenery object (still remaining a scenery object). After dropping a scenery objects in any other room, it could happen that you could not find it any more. So the take command was changed to set scenery to false. But you will still have this problem if you move the object into the inventory by script. So I think the solution is something like this:\n\n[code:3j37i5m0]\n        if (LengthOf(takemsg) &gt; 0) {\n          msg (prefix + takemsg)\n        }\n      \n        if (HasScript(object, &quot;ontake&quot;)) {\n          do (object, &quot;ontake&quot;)\n        }\n        \n        if (found and GetBoolean (object, &quot;scenery&quot;) and object&#46;parent = game&#46;pov) {\n            object&#46;scenery = false\n        }\n      }\n    }\n[/code:3j37i5m0]",
      "EditableFormat": "bbcode",
      "HTML": "<blockquote><cite>Liam315 wrote:</cite> This is only a quick fix though, as it doesn't account for scenery objects being moved around the room, only if you take the object and it ends up in your inventory.<br/></blockquote><br/><br/>I think you can't take care for the scenery flag for all commands. If I remember right the problem was taking and then dropping a scenery object (still remaining a scenery object). After dropping a scenery objects in any other room, it could happen that you could not find it any more. So the take command was changed to set scenery to false. But you will still have this problem if you move the object into the inventory by script. So I think the solution is something like this:<br/><br/><pre><code><br/>        if (LengthOf(takemsg) &gt; 0) {<br/>          msg (prefix + takemsg)<br/>        }<br/>      <br/>        if (HasScript(object, &quot;ontake&quot;)) {<br/>          do (object, &quot;ontake&quot;)<br/>        }<br/>        <br/>        if (found and GetBoolean (object, &quot;scenery&quot;) and object&#46;parent = game&#46;pov) {<br/>            object&#46;scenery = false<br/>        }<br/>      }<br/>    }<br/></code></pre>",
      "PostDate": "2013-12-21T21:28:17+00:00",
      "LastEditDate": null
    }
  ]
}

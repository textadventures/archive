{
  "Topic": {
    "TopicId": "lxmex1fwpu2itl8tfidcvg",
    "ForumId": "18",
    "Title": "Combining Followers with PathLib OR A Feeble Attempt by Richard Headkid",
    "LastUpdated": "2017-07-15T00:29:08.7393856Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "2ad6628d-0de8-45c7-a308-061c9f506f54",
      "UserId": 301690,
      "Username": "Richard Headkid",
      "AvatarUrl": "http://i.imgur.com/WUGXS8yb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Hello, all!\r\n\r\nUPDATE: This didn't work out very well. See Pixie's guide here:\r\n\r\nhttp://docs.textadventures.co.uk/quest/follower.html\r\n\r\n---\r\nEDIT:\r\n\r\nSorry, HK! I'll post the fix once I get it going. (Whatever I had going on interfered with the map, and I thought it best to take it down than risk causing anyone problems.)",
      "EditableFormat": "markdown",
      "HTML": "<p>Hello, all!</p>\n<p>UPDATE: This didn't work out very well. See Pixie's guide here:</p>\n<p>http://docs.textadventures.co.uk/quest/follower.html</p>\n<hr>\n<p>EDIT:</p>\n<p>Sorry, HK! I'll post the fix once I get it going. (Whatever I had going on interfered with the map, and I thought it best to take it down than risk causing anyone problems.)</p>\n\n",
      "PostDate": "2017-07-15T00:29:08.7393856Z",
      "LastEditDate": "2017-08-06T09:01:40.3643597Z",
      "link": null
    },
    {
      "PostId": "e1258d60-9547-4f50-9bd7-2e08c6c94a6e",
      "UserId": 247325,
      "Username": "hegemonkhan",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a96cf34d8d97c57de38f54ee22b1759b?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "awesome, thank you for posting this, will be of great help to a lot of people, we need a lot more public guides/libraries/codes for people to be able to use! As quest is such a good engine/software/program... but we've not made as many publically available guides/libraries/codes as we should have over the years.",
      "EditableFormat": "markdown",
      "HTML": "<p>awesome, thank you for posting this, will be of great help to a lot of people, we need a lot more public guides/libraries/codes for people to be able to use! As quest is such a good engine/software/program... but we've not made as many publically available guides/libraries/codes as we should have over the years.</p>\n\n",
      "PostDate": "2017-08-05T15:15:09.8252891Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "d39974d9-eb16-4024-b012-c9c6f94d789e",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "http://i.imgur.com/FOIjtApb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Okay, I've got it working now.\r\n\r\n---\r\n#### **Command:** Asking it to follow\r\n**Command Pattern:** \r\n```\r\nask #object1# to follow #object2#;tell #object1# to follow #object2#;#object1#, follow #object2#\r\n```\r\n\r\n**script**\r\n```\r\nif (not object2.gender = \"it\") {\r\n  if (HasAttribute(object1, \"shadowing\")) {\r\n    if (object1.shadowing = object2) {\r\n      if (object2 = player) {\r\n        msg (object1.alias + \" doubles the effort to follow you.\")\r\n      }\r\n      else {\r\n        msg (object1.alias + \" doubles the effort to follow \" + object2.alias + \".\")\r\n      }\r\n    }\r\n    else {\r\n      object1b = object1\r\n      unfollow (object1, 0)\r\n      object1 = object1b\r\n      object1.shadowing = object2\r\n      if (object2 = player) {\r\n        msg (object1.alias + \" begins to follow you.\")\r\n      }\r\n      else {\r\n        msg (object1.alias + \" begins to follow \" + object2.alias + \".\")\r\n      }\r\n      if (not (HasAttribute(object2, \"followers\"))) {\r\n        object2.followers = NewObjectList()\r\n      }\r\n      list add (object2.followers, object1)\r\n    }\r\n  }\r\n  else {\r\n    object1.shadowing = object2\r\n    if (object2 = player) {\r\n      msg (object1.alias + \" begins to follow you.\")\r\n    }\r\n    else {\r\n      msg (object1.alias + \" begins to follow \" + object2.alias + \".\")\r\n    }\r\n    if (not HasAttribute(object2, \"followers\")) {\r\n      object2.followers = NewObjectList()\r\n    }\r\n    list add (object2.followers, object1)\r\n  }\r\n}\r\nelse {\r\n  msg (object1.alias + \" can't follow an inanimate object.\")\r\n}\r\n```\r\n\r\n---\r\n#### **Command:** Ask it to stop following\r\n**Command Pattern:**\r\n```\r\nask #object1# to stop;ask #object1# to stay;ask #object1# to wait;#object1#, stay;#object1#, wait;#object1#, stop\r\n```\r\n\r\n**script**\r\n```\r\nif ((HasAttribute(object1, \"shadowing\"))) {\r\n  foreach (o, AllObjects()) {\r\n    if (HasAttribute(o, \"followers\")) {\r\n      msg (o)\r\n      msg (o.followers)\r\n      list remove (o.followers, object1)\r\n    }\r\n  }\r\n  if (object1.shadowing = player) {\r\n    msg ((GetDisplayName(object1)) + \" stops following you.\")\r\n  }\r\n  else {\r\n    // msg (\"IS shadowing:\")\r\n    // msg (object1.shadowing)\r\n    msg ((GetDisplayName(object1)) + \" stops following \" + GetDisplayName(object1.shadowing) + \".\")\r\n  }\r\n  object1.shadowing = null\r\n}\r\nelse {\r\n  msg ((CapFirst(object1.alias)) + \" freezes in place.\")\r\n}\r\n```\r\n\r\n---\r\n**Script when entering a room**\r\n```\r\nrh_last_room_shadowers\r\n```\r\n\r\n---\r\n**Turn script: followers** ***THIS REQUIRES PATHLIB!!!***\r\n```\r\nforeach (o, AllObjects()) {\r\n  if (HasAttribute(o, \"shadowing\")) {\r\n    npc = o\r\n    // msg (o)\r\n    targetroom = player.parent\r\n    if (npc.parent <> targetroom) {\r\n      list = PathLib_GetPath(npc.parent, targetroom)\r\n      if (list <> null) {\r\n        exit = list[0]\r\n        npc.parent = exit.to\r\n        if (npc.parent <> targetroom) {\r\n          msg ((CapFirst(GetDisplayName(npc))) +\" is in \"+(GetDisplayName(npc.parent))+\", and headed your way.\")\r\n        }\r\n        else {\r\n          diralias = ReverseDirection(exit.alias)\r\n          if (diralias = \"out\") {\r\n            msg (GetDisplayName(npc) + \" arrives from the outside.\")\r\n          }\r\n          else if (diralias = \"in\") {\r\n            msg (GetDisplayName(npc) + \" arrives from the inside.\")\r\n          }\r\n          else if (diralias = \"up\") {\r\n            msg (GetDisplayName(npc) + \" arrives from above.\")\r\n          }\r\n          else if (diralias = \"down\") {\r\n            msg (GetDisplayName(npc) + \" arrives from below.\")\r\n          }\r\n          else {\r\n            msg (GetDisplayName(npc) + \" arrives from the \" + diralias + \".\")\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n---\r\n**turn script: followers_entering**\r\n\r\n```\r\nforeach (o, AllObjects()) {\r\n  if (HasAttribute(o, \"shadowing\")) {\r\n    if (not o.lastroom = player.lastroom) {\r\n      msg (\"Different last room. \" + o)\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n---\r\nHere's a link to [PathLib](https://gist.githubusercontent.com/KVonGit/ef664a6074f554decdc2938af46461d2/raw/039779814fa529724e088597a9ae45bf7f9c4f8f/PathLib.aslx).  (This is the file I'm using with these scripts.)\r\n\r\nI can't remember if I altered Jay's library or not. \r\n\r\nHere's the link to the original PathLib source: http://textadventures.co.uk/forum/samples/topic/3214/path-library\r\n\r\n\r\n---\r\nHere's a link to my port in progress. I haven't copied over all the details of the game yet, but the followers do follow you correctly.\r\n\r\nNOTE: You'll probably see testing messages print occasionally. \r\n\r\n\r\nhttp://textadventures.co.uk/games/view/rr9vezzxkeaovamsaqgxcw/they-call-ya-mister-quest-prototype-in-progress\r\n\r\n\r\nHere's the original, complete version: http://textadventures.co.uk/games/view/ktujzrqu90akwfqz4uarnw/they-call-ya-mister-original-glulx-version",
      "EditableFormat": "markdown",
      "HTML": "<p>Okay, I've got it working now.</p>\n<hr>\n<h4><strong>Command:</strong> Asking it to follow</h4>\n<p><strong>Command Pattern:</strong></p>\n<pre><code>ask #object1# to follow #object2#;tell #object1# to follow #object2#;#object1#, follow #object2#\n</code></pre>\n<p><strong>script</strong></p>\n<pre><code>if (not object2.gender = \"it\") {\n  if (HasAttribute(object1, \"shadowing\")) {\n    if (object1.shadowing = object2) {\n      if (object2 = player) {\n        msg (object1.alias + \" doubles the effort to follow you.\")\n      }\n      else {\n        msg (object1.alias + \" doubles the effort to follow \" + object2.alias + \".\")\n      }\n    }\n    else {\n      object1b = object1\n      unfollow (object1, 0)\n      object1 = object1b\n      object1.shadowing = object2\n      if (object2 = player) {\n        msg (object1.alias + \" begins to follow you.\")\n      }\n      else {\n        msg (object1.alias + \" begins to follow \" + object2.alias + \".\")\n      }\n      if (not (HasAttribute(object2, \"followers\"))) {\n        object2.followers = NewObjectList()\n      }\n      list add (object2.followers, object1)\n    }\n  }\n  else {\n    object1.shadowing = object2\n    if (object2 = player) {\n      msg (object1.alias + \" begins to follow you.\")\n    }\n    else {\n      msg (object1.alias + \" begins to follow \" + object2.alias + \".\")\n    }\n    if (not HasAttribute(object2, \"followers\")) {\n      object2.followers = NewObjectList()\n    }\n    list add (object2.followers, object1)\n  }\n}\nelse {\n  msg (object1.alias + \" can't follow an inanimate object.\")\n}\n</code></pre>\n<hr>\n<h4><strong>Command:</strong> Ask it to stop following</h4>\n<p><strong>Command Pattern:</strong></p>\n<pre><code>ask #object1# to stop;ask #object1# to stay;ask #object1# to wait;#object1#, stay;#object1#, wait;#object1#, stop\n</code></pre>\n<p><strong>script</strong></p>\n<pre><code>if ((HasAttribute(object1, \"shadowing\"))) {\n  foreach (o, AllObjects()) {\n    if (HasAttribute(o, \"followers\")) {\n      msg (o)\n      msg (o.followers)\n      list remove (o.followers, object1)\n    }\n  }\n  if (object1.shadowing = player) {\n    msg ((GetDisplayName(object1)) + \" stops following you.\")\n  }\n  else {\n    // msg (\"IS shadowing:\")\n    // msg (object1.shadowing)\n    msg ((GetDisplayName(object1)) + \" stops following \" + GetDisplayName(object1.shadowing) + \".\")\n  }\n  object1.shadowing = null\n}\nelse {\n  msg ((CapFirst(object1.alias)) + \" freezes in place.\")\n}\n</code></pre>\n<hr>\n<p><strong>Script when entering a room</strong></p>\n<pre><code>rh_last_room_shadowers\n</code></pre>\n<hr>\n<p><strong>Turn script: followers</strong> <strong><em>THIS REQUIRES PATHLIB!!!</em></strong></p>\n<pre><code>foreach (o, AllObjects()) {\n  if (HasAttribute(o, \"shadowing\")) {\n    npc = o\n    // msg (o)\n    targetroom = player.parent\n    if (npc.parent &lt;&gt; targetroom) {\n      list = PathLib_GetPath(npc.parent, targetroom)\n      if (list &lt;&gt; null) {\n        exit = list[0]\n        npc.parent = exit.to\n        if (npc.parent &lt;&gt; targetroom) {\n          msg ((CapFirst(GetDisplayName(npc))) +\" is in \"+(GetDisplayName(npc.parent))+\", and headed your way.\")\n        }\n        else {\n          diralias = ReverseDirection(exit.alias)\n          if (diralias = \"out\") {\n            msg (GetDisplayName(npc) + \" arrives from the outside.\")\n          }\n          else if (diralias = \"in\") {\n            msg (GetDisplayName(npc) + \" arrives from the inside.\")\n          }\n          else if (diralias = \"up\") {\n            msg (GetDisplayName(npc) + \" arrives from above.\")\n          }\n          else if (diralias = \"down\") {\n            msg (GetDisplayName(npc) + \" arrives from below.\")\n          }\n          else {\n            msg (GetDisplayName(npc) + \" arrives from the \" + diralias + \".\")\n          }\n        }\n      }\n    }\n  }\n}\n</code></pre>\n<hr>\n<p><strong>turn script: followers_entering</strong></p>\n<pre><code>foreach (o, AllObjects()) {\n  if (HasAttribute(o, \"shadowing\")) {\n    if (not o.lastroom = player.lastroom) {\n      msg (\"Different last room. \" + o)\n    }\n  }\n}\n</code></pre>\n<hr>\n<p>Here's a link to <a href=\"https://gist.githubusercontent.com/KVonGit/ef664a6074f554decdc2938af46461d2/raw/039779814fa529724e088597a9ae45bf7f9c4f8f/PathLib.aslx\">PathLib</a>.  (This is the file I'm using with these scripts.)</p>\n<p>I can't remember if I altered Jay's library or not.</p>\n<p>Here's the link to the original PathLib source: http://textadventures.co.uk/forum/samples/topic/3214/path-library</p>\n<hr>\n<p>Here's a link to my port in progress. I haven't copied over all the details of the game yet, but the followers do follow you correctly.</p>\n<p>NOTE: You'll probably see testing messages print occasionally.</p>\n<p>http://textadventures.co.uk/games/view/rr9vezzxkeaovamsaqgxcw/they-call-ya-mister-quest-prototype-in-progress</p>\n<p>Here's the original, complete version: http://textadventures.co.uk/games/view/ktujzrqu90akwfqz4uarnw/they-call-ya-mister-original-glulx-version</p>\n\n",
      "PostDate": "2017-08-10T18:10:45.2430316Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

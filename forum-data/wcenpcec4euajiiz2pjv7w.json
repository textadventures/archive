{
  "Topic": {
    "TopicId": "wcenpcec4euajiiz2pjv7w",
    "ForumId": "10",
    "Title": "Calling javascript functions?",
    "LastUpdated": "2020-07-28T12:13:20.8739477Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "f3bb60f9-a517-4271-98fe-8a613fd07a69",
      "UserId": 394357,
      "Username": "questspidey2",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a632dc376e48dfbd7294f239e847767b?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I'm not able to find in the documentation how to utilize javascript. For example, how would I go about printing a message which is the result of a javascript function?\r\nI'm trying:  msg (JS.test())\r\nAnd in my javascript file, I have a function named test() which returns a string.\r\n\r\nBut I receive the following error:\r\nError running script: Error compiling expression 'JS.test()': FunctionCallElement: Could find not function 'JS___DOT___test()'\r\nI've tried excluding the JS, no luck either.\r\nThanks for any help!!!",
      "EditableFormat": "markdown",
      "HTML": "<p>I'm not able to find in the documentation how to utilize javascript. For example, how would I go about printing a message which is the result of a javascript function?<br>\nI'm trying:  msg (JS.test())<br>\nAnd in my javascript file, I have a function named test() which returns a string.</p>\n<p>But I receive the following error:<br>\nError running script: Error compiling expression 'JS.test()': FunctionCallElement: Could find not function 'JS___DOT___test()'<br>\nI've tried excluding the JS, no luck either.<br>\nThanks for any help!!!</p>\n\n",
      "PostDate": "2020-07-28T12:13:20.8739477Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "a98aa6f7-5956-4339-bcaf-87849fe28595",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "You can call a javascript function, but you can't get it to return a value. This is because when a command is sent to the backend, Quest passes it to HandleCommand and then waits for that to return; batching up all the javascript functions that would be called in response (including the implicit `JS.addText` calls generated by `msg`), and then returns them to the JS on the frontend to run. So any function you call using the `JS.` syntax will be queued to run *after your function finishes*.\r\n\r\nIf you want to pass values from JS back to Quest, you need to use a callback. The javascript function `ASLEvent` takes 2 parameters: the name of a Quest function, and a string parameter.\r\n\r\nSo in this case, you would do:\r\n```\r\nJS.eval(\"ASLEvent('TestResponse', test());\")\r\n```\r\nand create a function to print the message passed back:\r\n```\r\n<function name=\"TestResponse\" parameters=\"param\">\r\n  msg (param)\r\n</function>\r\n```\r\n(although unless your test() function returns a string that contains text processor commands, you'd likely want to do:\r\n```\r\nJS.eval(\"addTextAndScroll(test())\")\r\n```\r\n)",
      "EditableFormat": "markdown",
      "HTML": "<p>You can call a javascript function, but you can't get it to return a value. This is because when a command is sent to the backend, Quest passes it to HandleCommand and then waits for that to return; batching up all the javascript functions that would be called in response (including the implicit <code>JS.addText</code> calls generated by <code>msg</code>), and then returns them to the JS on the frontend to run. So any function you call using the <code>JS.</code> syntax will be queued to run <em>after your function finishes</em>.</p>\n<p>If you want to pass values from JS back to Quest, you need to use a callback. The javascript function <code>ASLEvent</code> takes 2 parameters: the name of a Quest function, and a string parameter.</p>\n<p>So in this case, you would do:</p>\n<pre><code>JS.eval(\"ASLEvent('TestResponse', test());\")\n</code></pre>\n<p>and create a function to print the message passed back:</p>\n<pre><code>&lt;function name=\"TestResponse\" parameters=\"param\"&gt;\n  msg (param)\n&lt;/function&gt;\n</code></pre>\n<p>(although unless your test() function returns a string that contains text processor commands, you'd likely want to do:</p>\n<pre><code>JS.eval(\"addTextAndScroll(test())\")\n</code></pre>\n<p>)</p>\n\n",
      "PostDate": "2020-07-28T14:00:00.5906609Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "f2ee981d-c066-49cc-a0cb-d2e0e81e59e3",
      "UserId": 394357,
      "Username": "questspidey2",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a632dc376e48dfbd7294f239e847767b?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Awesome info, I will try this out. Thanks for your time!",
      "EditableFormat": "markdown",
      "HTML": "<p>Awesome info, I will try this out. Thanks for your time!</p>\n\n",
      "PostDate": "2020-07-28T14:12:08.7306178Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

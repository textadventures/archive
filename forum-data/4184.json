{
  "Topic": {
    "TopicId": "4184",
    "ForumId": "10",
    "Title": "Can a surface tell you when it's empty?",
    "LastUpdated": "2014-02-10T15:02:18+00:00",
    "ReplyCount": 3
  },
  "Posts": [
    {
      "PostId": "27800",
      "UserId": 0,
      "Username": "Anj Avraam",
      "UserAvatar": null,
      "UserGravatar": "6139ba47c403eacf3230c107dca4c953",
      "EditableText": "Hi, I've been experimenting with various methods for doing this and I'm stuck. All I seem to do is create weird and wonderful errors.\n\nI have created a bed which is a 'surface' and on it is a pillow, a quilt and a sheet. \n\nI want the game to know when the bed is empty, and give the player the message, &quot;The bed has been stripped.&quot;\n\nIn all there could potentially be three states the bed can be in:\n1) Untouched (i.e. all objects in their original positions) = &quot;made&quot;\n2) Things moved (i.e. anything has been taken or put/the original state is different but it still has objects on it) = &quot;unmade&quot;\n3) Stripped (i.e. no objects on the bed except the container/surface/scenery part of the bed) = &quot;stripped&quot;\n\nAnd ideally I'd have messages for these different states. I've tried using flags, using 'if', using scripts in the container description, and I've scoured the forum to see if this is already dealt with but haven't found my answer yet. If anyone could help I would be grateful!",
      "EditableFormat": "bbcode",
      "HTML": "Hi, I've been experimenting with various methods for doing this and I'm stuck. All I seem to do is create weird and wonderful errors.<br/><br/>I have created a bed which is a 'surface' and on it is a pillow, a quilt and a sheet. <br/><br/>I want the game to know when the bed is empty, and give the player the message, &quot;The bed has been stripped.&quot;<br/><br/>In all there could potentially be three states the bed can be in:<br/>1) Untouched (i.e. all objects in their original positions) = &quot;made&quot;<br/>2) Things moved (i.e. anything has been taken or put/the original state is different but it still has objects on it) = &quot;unmade&quot;<br/>3) Stripped (i.e. no objects on the bed except the container/surface/scenery part of the bed) = &quot;stripped&quot;<br/><br/>And ideally I'd have messages for these different states. I've tried using flags, using 'if', using scripts in the container description, and I've scoured the forum to see if this is already dealt with but haven't found my answer yet. If anyone could help I would be grateful!",
      "PostDate": "2014-02-09T19:14:43+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "27801",
      "UserId": 0,
      "Username": "HegemonKhan",
      "UserAvatar": null,
      "UserGravatar": "a96cf34d8d97c57de38f54ee22b1759b",
      "EditableText": "You're on the right track, just missing (or unaware of) a few extra steps (coding lines) that are needed, hehe.\n\n1. <!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/Category:All_Functions_and_Script_Commands\">http://quest5.net/wiki/Category:All_Fun ... t_Commands</a><!-- m --> (page 1, range: A-S)\n2. <!-- m --><a class=\"postlink\" href=\"http://quest5.net/w/index.php?title=Category:All_Functions_and_Script_Commands&amp;pagefrom=SetExitLightstrength#mw-pages\">http://quest5.net/w/index.php?title=Cat ... h#mw-pages</a><!-- m --> (page 2, range: S-Z)\n\nthere's quite a few ways to do this... hmm...\n\nyou're dealing with whether an Object &quot;contains or has&quot; other Objects, so you'll need:\n\n1. &quot;if...&quot; Script ( <!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/If\">http://quest5.net/wiki/If</a><!-- m --> )\n\n2. &quot;HasObject&quot; Script ( <!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/HasObject\">http://quest5.net/wiki/HasObject</a><!-- m --> ) or &quot;Contains&quot; Script ( <!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/Contains\">http://quest5.net/wiki/Contains</a><!-- m --> ) or &quot;ContainsAccessible&quot; Script ( <!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/ContainsAccessible\">http://quest5.net/wiki/ContainsAccessible</a><!-- m --> ) or &quot;ContainsReachable&quot; Script ( <!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/ContainsReachable\">http://quest5.net/wiki/ContainsReachable</a><!-- m --> ) or &quot;ContainsVisible&quot; Script ( <!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/ContainsVisible\">http://quest5.net/wiki/ContainsVisible</a><!-- m --> )\n\n3. (optional) 1-3 Boolean Attributes (Booleans are same as Flags) or a &quot;String List&quot; Attribute or an &quot;Object List&quot; Attribute:\n\nBooleans:\n\n&quot;stripped&quot;\n&quot;unmade&quot;\n&quot;made&quot;\n\n~OR~\n\nString List:\n\n&quot;bed_string_list&quot;\n&quot;stripped&quot;, &quot;unmade&quot;, and &quot;made&quot;\n\nObject List:\n\n(I'm still having trouble with understanding them currently)\n\n4. A &quot;search&quot; (custom) Verb or using a scripted (Run as script)  &quot;Look at&quot; (built-in) Verb\n\n-------------------\n\nso for one example:\n\nObject: room\n-&gt; Object: bed\n-&gt;-&gt; Verb: search\n\n&quot;search&quot; Verb:\n\nif (Contains (room.bed, pillow) and Contains (room.bed, quilt) and Contains (room.bed, sheet) = true) {\n-&gt; // whatever script\n} else if (Contains (room.bed, pillow) or Contains (room.bed, quilt) or Contains (room.bed, sheet) = true) {\n-&gt; // whatever script\n} else if (Contains (room.bed, pillow) and Contains (room.bed, quilt) and Contains (room.bed, sheet) = false) {\n-&gt; // whatever script\n}\n\n---------------\n\nerr... my bad...\n\nI didn't notice these specifics of yours:\n\n2) Things moved (i.e. anything has been taken or put/the original state is different but it still has objects on it) = &quot;unmade&quot;\n3) Stripped (i.e. no objects on the bed except the container/surface/scenery part of the bed) = &quot;stripped&quot;\n\nthis stuff is a bit more complicated to implement... hmm...\n\n2) Things moved (i.e. anything has been taken or put/the original state is different but it still has objects on it) = &quot;unmade&quot;:\n\nyou'll have to work with Object Lists...\n\n<!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/Using_Lists\">http://quest5.net/wiki/Using_Lists</a><!-- m -->\n<!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/Objectlist\">http://quest5.net/wiki/Objectlist</a><!-- m -->\n<!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/GetAllChildObjects\">http://quest5.net/wiki/GetAllChildObjects</a><!-- m -->\n<!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/GetDirectChildren\">http://quest5.net/wiki/GetDirectChildren</a><!-- m -->\n\nif (not GetDirectChildren (room.bed) = null and Contains (room.bed, pillow) and Contains (room.bed, quilt) and Contains (room.bed, sheet) = false) {\n-&gt; // whatever script\n}\n\n3) Stripped (i.e. no objects on the bed except the container/surface/scenery part of the bed) = &quot;stripped&quot;:\n\nyou'll have to do a &quot;foreach&quot; + &quot;checking&quot; scripting...\n\nforeach (object_x, room.bed) {\n-&gt; if (HasBoolean (object_x.scenery) = false) {\n-&gt;-&gt; if (\n\n... err... this is too complicated for my brain at the moment... maybe later I can think clearly on this...",
      "EditableFormat": "bbcode",
      "HTML": "You're on the right track, just missing (or unaware of) a few extra steps (coding lines) that are needed, hehe.<br/><br/>1. <!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/Category:All_Functions_and_Script_Commands\">http://quest5.net/wiki/Category:All_Fun ... t_Commands</a><!-- m --> (page 1, range: A-S)<br/>2. <!-- m --><a class=\"postlink\" href=\"http://quest5.net/w/index.php?title=Category:All_Functions_and_Script_Commands&amp;pagefrom=SetExitLightstrength#mw-pages\">http://quest5.net/w/index.php?title=Cat ... h#mw-pages</a><!-- m --> (page 2, range: S-Z)<br/><br/>there's quite a few ways to do this... hmm...<br/><br/>you're dealing with whether an Object &quot;contains or has&quot; other Objects, so you'll need:<br/><br/>1. &quot;if...&quot; Script ( <!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/If\">http://quest5.net/wiki/If</a><!-- m --> )<br/><br/>2. &quot;HasObject&quot; Script ( <!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/HasObject\">http://quest5.net/wiki/HasObject</a><!-- m --> ) or &quot;Contains&quot; Script ( <!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/Contains\">http://quest5.net/wiki/Contains</a><!-- m --> ) or &quot;ContainsAccessible&quot; Script ( <!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/ContainsAccessible\">http://quest5.net/wiki/ContainsAccessible</a><!-- m --> ) or &quot;ContainsReachable&quot; Script ( <!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/ContainsReachable\">http://quest5.net/wiki/ContainsReachable</a><!-- m --> ) or &quot;ContainsVisible&quot; Script ( <!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/ContainsVisible\">http://quest5.net/wiki/ContainsVisible</a><!-- m --> )<br/><br/>3. (optional) 1-3 Boolean Attributes (Booleans are same as Flags) or a &quot;String List&quot; Attribute or an &quot;Object List&quot; Attribute:<br/><br/>Booleans:<br/><br/>&quot;stripped&quot;<br/>&quot;unmade&quot;<br/>&quot;made&quot;<br/><br/>~OR~<br/><br/>String List:<br/><br/>&quot;bed_string_list&quot;<br/>&quot;stripped&quot;, &quot;unmade&quot;, and &quot;made&quot;<br/><br/>Object List:<br/><br/>(I'm still having trouble with understanding them currently)<br/><br/>4. A &quot;search&quot; (custom) Verb or using a scripted (Run as script)  &quot;Look at&quot; (built-in) Verb<br/><br/>-------------------<br/><br/>so for one example:<br/><br/>Object: room<br/>-&gt; Object: bed<br/>-&gt;-&gt; Verb: search<br/><br/>&quot;search&quot; Verb:<br/><br/>if (Contains (room.bed, pillow) and Contains (room.bed, quilt) and Contains (room.bed, sheet) = true) {<br/>-&gt; // whatever script<br/>} else if (Contains (room.bed, pillow) or Contains (room.bed, quilt) or Contains (room.bed, sheet) = true) {<br/>-&gt; // whatever script<br/>} else if (Contains (room.bed, pillow) and Contains (room.bed, quilt) and Contains (room.bed, sheet) = false) {<br/>-&gt; // whatever script<br/>}<br/><br/>---------------<br/><br/>err... my bad...<br/><br/>I didn't notice these specifics of yours:<br/><br/>2) Things moved (i.e. anything has been taken or put/the original state is different but it still has objects on it) = &quot;unmade&quot;<br/>3) Stripped (i.e. no objects on the bed except the container/surface/scenery part of the bed) = &quot;stripped&quot;<br/><br/>this stuff is a bit more complicated to implement... hmm...<br/><br/>2) Things moved (i.e. anything has been taken or put/the original state is different but it still has objects on it) = &quot;unmade&quot;:<br/><br/>you'll have to work with Object Lists...<br/><br/><!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/Using_Lists\">http://quest5.net/wiki/Using_Lists</a><!-- m --><br/><!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/Objectlist\">http://quest5.net/wiki/Objectlist</a><!-- m --><br/><!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/GetAllChildObjects\">http://quest5.net/wiki/GetAllChildObjects</a><!-- m --><br/><!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/GetDirectChildren\">http://quest5.net/wiki/GetDirectChildren</a><!-- m --><br/><br/>if (not GetDirectChildren (room.bed) = null and Contains (room.bed, pillow) and Contains (room.bed, quilt) and Contains (room.bed, sheet) = false) {<br/>-&gt; // whatever script<br/>}<br/><br/>3) Stripped (i.e. no objects on the bed except the container/surface/scenery part of the bed) = &quot;stripped&quot;:<br/><br/>you'll have to do a &quot;foreach&quot; + &quot;checking&quot; scripting...<br/><br/>foreach (object_x, room.bed) {<br/>-&gt; if (HasBoolean (object_x.scenery) = false) {<br/>-&gt;-&gt; if (<br/><br/>... err... this is too complicated for my brain at the moment... maybe later I can think clearly on this...",
      "PostDate": "2014-02-09T21:27:51+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "27802",
      "UserId": 0,
      "Username": "george",
      "UserAvatar": null,
      "UserGravatar": "dc6fe8e6172303d85249a13c9a49c1ff",
      "EditableText": "I think I would put a state attribute on the bed that was a function. Here's a minimal example:\n\n[code:chighe07]\n&lt;!--Saved by Quest 5&#46;4&#46;4873&#46;16527--&gt;\n&lt;asl version=&quot;540&quot;&gt;\n  &lt;include ref=&quot;English&#46;aslx&quot; /&gt;\n  &lt;include ref=&quot;Core&#46;aslx&quot; /&gt;\n  &lt;game name=&quot;unmade bed&quot;&gt;\n    &lt;gameid&gt;a659c68e-97c1-4d30-9c8d-8c229e1b08e2&lt;/gameid&gt;\n    &lt;version&gt;1&#46;0&lt;/version&gt;\n    &lt;firstpublished&gt;2014&lt;/firstpublished&gt;\n  &lt;/game&gt;\n  &lt;object name=&quot;room&quot;&gt;\n    &lt;inherit name=&quot;editor_room&quot; /&gt;\n    &lt;object name=&quot;player&quot;&gt;\n      &lt;inherit name=&quot;editor_object&quot; /&gt;\n      &lt;inherit name=&quot;editor_player&quot; /&gt;\n    &lt;/object&gt;\n    &lt;object name=&quot;bed&quot;&gt;\n      &lt;inherit name=&quot;editor_object&quot; /&gt;\n      &lt;state type=&quot;script&quot;&gt;\n        myfunc\n      &lt;/state&gt;\n      &lt;baz type=&quot;script&quot;&gt;\n        invoke (this&#46;state)\n      &lt;/baz&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n  &lt;verb&gt;\n    &lt;property&gt;baz&lt;/property&gt;\n    &lt;pattern&gt;baz&lt;/pattern&gt;\n    &lt;defaultexpression&gt;&quot;You can't baz &quot; + object&#46;article + &quot;&#46;&quot;&lt;/defaultexpression&gt;\n  &lt;/verb&gt;\n  &lt;function name=&quot;myfunc&quot; type=&quot;string&quot;&gt;\n    msg (&quot;Hello it's myfunc&quot;)\n  &lt;/function&gt;\n&lt;/asl&gt;[/code:chighe07]\n\nYour function ('myfunc') would calculate the state of the bed and return the result as strings, either &quot;made&quot;, &quot;unmade&quot;, or &quot;stripped&quot;. When you wanted to print a message to the player concerning the bed, you would invoke(bed.state) and use the result as you like, for example in a switch/case. \n\n<!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/Switch\">http://quest5.net/wiki/Switch</a><!-- m -->\n\nFor the situation where the bed is 'unmade', you might want to put an attribute, for example [b:chighe07]in_place[/b:chighe07], on each bed item, that's true or false. \n\nThen when you calculate the state of the bed (by looking at it with GetDirectChildren as HK linked to in his post), you can also test if each item is in_place to determine if the bed is made. If an item is not in_place, the bed isn't made.\n\n[b:chighe07]side note[/b:chighe07]: This is an interesting question, because as I was playing with it I discovered that I couldn't find the source of GetDirectChildren. Normally Quest functions are findable in the desktop editor (with Filter -&gt; Show library elements). The best I could do was finding it in the source here, \n\n<!-- m --><a class=\"postlink\" href=\"http://quest.codeplex.com/SourceControl/latest#WorldModel/WorldModel/Elements.cs\">http://quest.codeplex.com/SourceControl ... lements.cs</a><!-- m -->",
      "EditableFormat": "bbcode",
      "HTML": "I think I would put a state attribute on the bed that was a function. Here's a minimal example:<br/><br/><pre><code><br/>&lt;!--Saved by Quest 5&#46;4&#46;4873&#46;16527--&gt;<br/>&lt;asl version=&quot;540&quot;&gt;<br/>  &lt;include ref=&quot;English&#46;aslx&quot; /&gt;<br/>  &lt;include ref=&quot;Core&#46;aslx&quot; /&gt;<br/>  &lt;game name=&quot;unmade bed&quot;&gt;<br/>    &lt;gameid&gt;a659c68e-97c1-4d30-9c8d-8c229e1b08e2&lt;/gameid&gt;<br/>    &lt;version&gt;1&#46;0&lt;/version&gt;<br/>    &lt;firstpublished&gt;2014&lt;/firstpublished&gt;<br/>  &lt;/game&gt;<br/>  &lt;object name=&quot;room&quot;&gt;<br/>    &lt;inherit name=&quot;editor_room&quot; /&gt;<br/>    &lt;object name=&quot;player&quot;&gt;<br/>      &lt;inherit name=&quot;editor_object&quot; /&gt;<br/>      &lt;inherit name=&quot;editor_player&quot; /&gt;<br/>    &lt;/object&gt;<br/>    &lt;object name=&quot;bed&quot;&gt;<br/>      &lt;inherit name=&quot;editor_object&quot; /&gt;<br/>      &lt;state type=&quot;script&quot;&gt;<br/>        myfunc<br/>      &lt;/state&gt;<br/>      &lt;baz type=&quot;script&quot;&gt;<br/>        invoke (this&#46;state)<br/>      &lt;/baz&gt;<br/>    &lt;/object&gt;<br/>  &lt;/object&gt;<br/>  &lt;verb&gt;<br/>    &lt;property&gt;baz&lt;/property&gt;<br/>    &lt;pattern&gt;baz&lt;/pattern&gt;<br/>    &lt;defaultexpression&gt;&quot;You can't baz &quot; + object&#46;article + &quot;&#46;&quot;&lt;/defaultexpression&gt;<br/>  &lt;/verb&gt;<br/>  &lt;function name=&quot;myfunc&quot; type=&quot;string&quot;&gt;<br/>    msg (&quot;Hello it's myfunc&quot;)<br/>  &lt;/function&gt;<br/>&lt;/asl&gt;</code></pre><br/><br/>Your function ('myfunc') would calculate the state of the bed and return the result as strings, either &quot;made&quot;, &quot;unmade&quot;, or &quot;stripped&quot;. When you wanted to print a message to the player concerning the bed, you would invoke(bed.state) and use the result as you like, for example in a switch/case. <br/><br/><!-- m --><a class=\"postlink\" href=\"http://quest5.net/wiki/Switch\">http://quest5.net/wiki/Switch</a><!-- m --><br/><br/>For the situation where the bed is 'unmade', you might want to put an attribute, for example <span style=\"font-weight:bold;\">in_place</span>, on each bed item, that's true or false. <br/><br/>Then when you calculate the state of the bed (by looking at it with GetDirectChildren as HK linked to in his post), you can also test if each item is in_place to determine if the bed is made. If an item is not in_place, the bed isn't made.<br/><br/><span style=\"font-weight:bold;\">side note</span>: This is an interesting question, because as I was playing with it I discovered that I couldn't find the source of GetDirectChildren. Normally Quest functions are findable in the desktop editor (with Filter -&gt; Show library elements). The best I could do was finding it in the source here, <br/><br/><!-- m --><a class=\"postlink\" href=\"http://quest.codeplex.com/SourceControl/latest#WorldModel/WorldModel/Elements.cs\">http://quest.codeplex.com/SourceControl ... lements.cs</a><!-- m -->",
      "PostDate": "2014-02-09T22:11:17+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "27804",
      "UserId": 0,
      "Username": "Anj Avraam",
      "UserAvatar": null,
      "UserGravatar": "6139ba47c403eacf3230c107dca4c953",
      "EditableText": "Thank you both, HegemonKhan and george. Both extremely helpful replies.\n\nI will now work through these options and hopefully will return with news of my success soon!",
      "EditableFormat": "bbcode",
      "HTML": "Thank you both, HegemonKhan and george. Both extremely helpful replies.<br/><br/>I will now work through these options and hopefully will return with news of my success soon!",
      "PostDate": "2014-02-10T15:02:18+00:00",
      "LastEditDate": null
    }
  ]
}

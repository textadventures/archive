{
  "Topic": {
    "TopicId": "wd_jll59uk2pdygb-d_rka",
    "ForumId": "15",
    "Title": "Noob to JS - Locks & Unlocking",
    "LastUpdated": "2020-12-22T14:36:45.0586556Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "a4fda301-aaea-40e2-b00a-7aacfc8e3a5c",
      "UserId": 131825,
      "Username": "Davewoody55",
      "AvatarUrl": "https://i.imgur.com/mFPLvINb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Hey All - Sorry if this is really stupid question, or it's the wrong place...\r\n\r\nI've just started working through the tutorial for QuestJS.  Quite the challenge for me but thought it would be fun to give it a go over the holidays.   All was fine up until the lockable objects bit.\r\n\r\nAm I right in thinking that with the code, I should be able to unlock the glass cabinet? \r\n```\r\ncreateItem(\"glass_cabinet\", CONTAINER(true), LOCKED_WITH(\"cabinet_key\"), {\r\n\tloc:\"lounge\",\r\n\ttransparent:true,\r\n\texamine:\"A cabinet with a glass front\",\r\n\t\r\n});\r\ncreateItem(\"cabinet_key\", KEY(), { \r\n  loc:\"garage\",\r\n  examine: \"A small brass key.\"\r\n});\r\n```\r\n I fear I may have missed something as I keep getting the error  ReferenceError: no_key is not defined.\r\n\r\nDoes anyone know if there is there something else I need to set up?\r\n\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Hey All - Sorry if this is really stupid question, or it's the wrong place...</p>\n<p>I've just started working through the tutorial for QuestJS.  Quite the challenge for me but thought it would be fun to give it a go over the holidays.   All was fine up until the lockable objects bit.</p>\n<p>Am I right in thinking that with the code, I should be able to unlock the glass cabinet?</p>\n<pre><code>createItem(\"glass_cabinet\", CONTAINER(true), LOCKED_WITH(\"cabinet_key\"), {\n\tloc:\"lounge\",\n\ttransparent:true,\n\texamine:\"A cabinet with a glass front\",\n\t\n});\ncreateItem(\"cabinet_key\", KEY(), { \n  loc:\"garage\",\n  examine: \"A small brass key.\"\n});\n</code></pre>\n<p>I fear I may have missed something as I keep getting the error  ReferenceError: no_key is not defined.</p>\n<p>Does anyone know if there is there something else I need to set up?</p>\n\n",
      "PostDate": "2020-12-22T14:36:45.0586556Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "b18b2651-7b9e-4b77-b592-d09c9fc27c4e",
      "UserId": 301690,
      "Username": "Richard Headkid",
      "AvatarUrl": "http://i.imgur.com/WUGXS8yb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Hello.\r\n\r\nThat's all you need.\r\n\r\nIf the player is holding the KEY (in this case the \"cabinet_key\" item), the glass cabinet can be opened.  (It will say you unlocked it first.)\r\n\r\n---\r\nThis is a blank game with your code snippet added (although I changed the location of the key to the lounge):\r\n\r\n---\r\n[![image](https://user-images.githubusercontent.com/30656341/102906292-09e92b80-443a-11eb-80e6-4bbe5ec7adee.png)](https://user-images.githubusercontent.com/30656341/102906292-09e92b80-443a-11eb-80e6-4bbe5ec7adee.png)",
      "EditableFormat": "markdown",
      "HTML": "<p>Hello.</p>\n<p>That's all you need.</p>\n<p>If the player is holding the KEY (in this case the \"cabinet_key\" item), the glass cabinet can be opened.  (It will say you unlocked it first.)</p>\n<hr>\n<p>This is a blank game with your code snippet added (although I changed the location of the key to the lounge):</p>\n<hr>\n<p><a href=\"https://user-images.githubusercontent.com/30656341/102906292-09e92b80-443a-11eb-80e6-4bbe5ec7adee.png\"><img src=\"https://user-images.githubusercontent.com/30656341/102906292-09e92b80-443a-11eb-80e6-4bbe5ec7adee.png\" alt=\"image\"></a></p>\n\n",
      "PostDate": "2020-12-22T15:44:01.5224844Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "4889a934-cfae-4709-8d8c-93f50e65274a",
      "UserId": 301690,
      "Username": "Richard Headkid",
      "AvatarUrl": "http://i.imgur.com/WUGXS8yb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> I fear I may have missed something as I keep getting the error ReferenceError: no_key is not defined.\r\n\r\nWhoops! I didn't see that the first time I read your post.\r\n\r\nIt sounds like you need to add this to your code (but it was in my version of QuestJS (v0.3) already):\r\n\r\n```\r\nlang.no_key = \"{nv:char:do:true} have the right key.\";\r\n```\r\n\r\n---\r\nTo check, hit \\<F12> to open your dev console, then just enter: ```lang.no_key```.  If it returns 'undefined', you need to add the line of code above to your game.\r\n\r\nHere's what it looks like in by browser:\r\n\r\n[![image](https://user-images.githubusercontent.com/30656341/102906798-c3e09780-443a-11eb-9c04-ca743ccdda1e.png)](https://user-images.githubusercontent.com/30656341/102906798-c3e09780-443a-11eb-9c04-ca743ccdda1e.png)",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>I fear I may have missed something as I keep getting the error ReferenceError: no_key is not defined.</p>\n</blockquote>\n<p>Whoops! I didn't see that the first time I read your post.</p>\n<p>It sounds like you need to add this to your code (but it was in my version of QuestJS (v0.3) already):</p>\n<pre><code>lang.no_key = \"{nv:char:do:true} have the right key.\";\n</code></pre>\n<hr>\n<p>To check, hit &lt;F12&gt; to open your dev console, then just enter: <code>lang.no_key</code>.  If it returns 'undefined', you need to add the line of code above to your game.</p>\n<p>Here's what it looks like in by browser:</p>\n<p><a href=\"https://user-images.githubusercontent.com/30656341/102906798-c3e09780-443a-11eb-9c04-ca743ccdda1e.png\"><img src=\"https://user-images.githubusercontent.com/30656341/102906798-c3e09780-443a-11eb-9c04-ca743ccdda1e.png\" alt=\"image\"></a></p>\n\n",
      "PostDate": "2020-12-22T15:48:55.2177339Z",
      "LastEditDate": "2020-12-22T15:49:29.516222Z",
      "link": null
    },
    {
      "PostId": "cb650128-25c4-4225-ba0d-8b625ba7ed18",
      "UserId": 131825,
      "Username": "Davewoody55",
      "AvatarUrl": "https://i.imgur.com/mFPLvINb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thanks Richard - Makes sense.  \r\n\r\nI'll try re-downloading the zip files and starting from scratch.  Clearly something has gone astray somewhere.  I always get no_key not defined error when trying to unlock an object/door.",
      "EditableFormat": "markdown",
      "HTML": "<p>Thanks Richard - Makes sense.</p>\n<p>I'll try re-downloading the zip files and starting from scratch.  Clearly something has gone astray somewhere.  I always get no_key not defined error when trying to unlock an object/door.</p>\n\n",
      "PostDate": "2020-12-22T15:50:07.780627Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "394f7220-6cfa-4939-9a85-080ccc3ed4e6",
      "UserId": 131825,
      "Username": "Davewoody55",
      "AvatarUrl": "https://i.imgur.com/mFPLvINb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Ah! that's interesting, I can open the cabinet when carrying the key if I use \"open cabinet\".\r\n\r\nIf I use \"unlock cabinet\" instead then I get the error message.\r\n\r\n\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Ah! that's interesting, I can open the cabinet when carrying the key if I use \"open cabinet\".</p>\n<p>If I use \"unlock cabinet\" instead then I get the error message.</p>\n\n",
      "PostDate": "2020-12-22T16:08:05.536057Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "e586d834-e9a1-4da7-994f-0d0f475d3948",
      "UserId": 301690,
      "Username": "Richard Headkid",
      "AvatarUrl": "http://i.imgur.com/WUGXS8yb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "O-ho!\r\n\r\nYou found a bug!\r\n\r\nIf you open your \"lib/_templates.js\" file, go down to line 643 (or somewhere around there, depending on your version), you will find this:\r\n\r\n```js\r\n    unlock:function(isMultiple, char) {\r\n      const tpParams = {char:char, container:this}\r\n      if (!this.locked) {\r\n        msg(lang.already, tpParams);\r\n        return false;\r\n      }\r\n      if (!this.testKeys(char, false)) {\r\n        msg(no_key, tpParams);\r\n        return false;\r\n      }\r\n      msg(unlock_successful, tpParams);\r\n      this.locked = false;\r\n      return true;\r\n    },\r\n```\r\n---\r\nOne line in there is the culprit: ```msg(no_key, tpParams);```\r\n\r\nThat should be ```msg(no_key, tpParams);```, and I should have noticed your error just said \"no_key\" rather than \"lang.no_key\".  (Doh!)\r\n\r\n\r\n---\r\nThe whole ```unlock``` bit should be this:\r\n\r\n```js\r\n    unlock:function(isMultiple, char) {\r\n      const tpParams = {char:char, container:this}\r\n      if (!this.locked) {\r\n        msg(lang.already, tpParams);\r\n        return false;\r\n      }\r\n      if (!this.testKeys(char, false)) {\r\n        msg(lang.no_key, tpParams);\r\n        return false;\r\n      }\r\n      msg(unlock_successful, tpParams);\r\n      this.locked = false;\r\n      return true;\r\n    },\r\n```\r\n\r\n---\r\nNormally, I would advise redefining the function in your own code, but this is set as a ```const```, which means it will just throw an error if you try to modify it.  Therefore, I believe editing the actual file is the only solution.",
      "EditableFormat": "markdown",
      "HTML": "<p>O-ho!</p>\n<p>You found a bug!</p>\n<p>If you open your \"lib/_templates.js\" file, go down to line 643 (or somewhere around there, depending on your version), you will find this:</p>\n<pre><code>    unlock:function(isMultiple, char) {\n      const tpParams = {char:char, container:this}\n      if (!this.locked) {\n        msg(lang.already, tpParams);\n        return false;\n      }\n      if (!this.testKeys(char, false)) {\n        msg(no_key, tpParams);\n        return false;\n      }\n      msg(unlock_successful, tpParams);\n      this.locked = false;\n      return true;\n    },\n</code></pre>\n<hr>\n<p>One line in there is the culprit: <code>msg(no_key, tpParams);</code></p>\n<p>That should be <code>msg(no_key, tpParams);</code>, and I should have noticed your error just said \"no_key\" rather than \"lang.no_key\".  (Doh!)</p>\n<hr>\n<p>The whole <code>unlock</code> bit should be this:</p>\n<pre><code>    unlock:function(isMultiple, char) {\n      const tpParams = {char:char, container:this}\n      if (!this.locked) {\n        msg(lang.already, tpParams);\n        return false;\n      }\n      if (!this.testKeys(char, false)) {\n        msg(lang.no_key, tpParams);\n        return false;\n      }\n      msg(unlock_successful, tpParams);\n      this.locked = false;\n      return true;\n    },\n</code></pre>\n<hr>\n<p>Normally, I would advise redefining the function in your own code, but this is set as a <code>const</code>, which means it will just throw an error if you try to modify it.  Therefore, I believe editing the actual file is the only solution.</p>\n\n",
      "PostDate": "2020-12-22T16:21:10.9850202Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "e141f5ca-7fe0-421e-92df-266ce1cbf403",
      "UserId": 131825,
      "Username": "Davewoody55",
      "AvatarUrl": "https://i.imgur.com/mFPLvINb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "A-ha!!!  I See!!!  Phew - for a while I thought I was going crazy. LOL",
      "EditableFormat": "markdown",
      "HTML": "<p>A-ha!!!  I See!!!  Phew - for a while I thought I was going crazy. LOL</p>\n\n",
      "PostDate": "2020-12-22T16:27:53.1601714Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "de9793b6-c832-4858-81bd-32c6d05818f7",
      "UserId": 301690,
      "Username": "Richard Headkid",
      "AvatarUrl": "http://i.imgur.com/WUGXS8yb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "PS\r\n\r\nThat bug has already been fixed in the file which is currently on GitHub, but it is not updated in the version 0.3 zip on there.\r\n\r\nI assume all updates will be in the upcoming version 0.4 zip file.",
      "EditableFormat": "markdown",
      "HTML": "<p>PS</p>\n<p>That bug has already been fixed in the file which is currently on GitHub, but it is not updated in the version 0.3 zip on there.</p>\n<p>I assume all updates will be in the upcoming version 0.4 zip file.</p>\n\n",
      "PostDate": "2020-12-22T16:30:51.1359054Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "bec06f52-cd80-47ac-8d7d-05c00b9e1dcc",
      "UserId": 301690,
      "Username": "Richard Headkid",
      "AvatarUrl": "http://i.imgur.com/WUGXS8yb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> for a while I thought I was going crazy\r\n\r\nHeck; I think that all the time!  (That I'm going crazy, not that you're going crazy.)",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>for a while I thought I was going crazy</p>\n</blockquote>\n<p>Heck; I think that all the time!  (That I'm going crazy, not that you're going crazy.)</p>\n\n",
      "PostDate": "2020-12-22T16:32:52.0421885Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "dae35b4d-c17e-4a94-b774-321954c40ec4",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I found a bunch of missing language bits recently that are on GitHub, but not in the zip file yet. Give it 24 hours I will put out version 0.4 with the updates.",
      "EditableFormat": "markdown",
      "HTML": "<p>I found a bunch of missing language bits recently that are on GitHub, but not in the zip file yet. Give it 24 hours I will put out version 0.4 with the updates.</p>\n\n",
      "PostDate": "2020-12-22T18:11:25.3941083Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "6fa0af2f-2c3d-4551-a880-814957472440",
      "UserId": 131825,
      "Username": "Davewoody55",
      "AvatarUrl": "https://i.imgur.com/mFPLvINb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "No problem - Loving that doors can be in two rooms at once. This is a whole new world! :)",
      "EditableFormat": "markdown",
      "HTML": "<p>No problem - Loving that doors can be in two rooms at once. This is a whole new world! :)</p>\n\n",
      "PostDate": "2020-12-22T18:46:48.9112093Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "c6be3fe2-a6f9-4a88-b386-9df000a937b0",
      "UserId": 301690,
      "Username": "Richard Headkid",
      "AvatarUrl": "http://i.imgur.com/WUGXS8yb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> Loving that doors can be in two rooms at once. This is a whole new world!\r\n\r\nI second that emotion!",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>Loving that doors can be in two rooms at once. This is a whole new world!</p>\n</blockquote>\n<p>I second that emotion!</p>\n\n",
      "PostDate": "2020-12-22T20:02:29.8210953Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "3bbdf229-d05a-4ac3-b279-11a0f933fa01",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Version 0.4 is now available.",
      "EditableFormat": "markdown",
      "HTML": "<p>Version 0.4 is now available.</p>\n\n",
      "PostDate": "2020-12-23T09:50:54.2094779Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

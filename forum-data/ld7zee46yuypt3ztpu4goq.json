{
  "Topic": {
    "TopicId": "ld7zee46yuypt3ztpu4goq",
    "ForumId": "16",
    "Title": "Getting Quest 5.7 certified",
    "LastUpdated": "2017-03-30T12:32:15.3574969Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "82c90b05-ed29-4029-b6ae-99cacbe250d0",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Quest 5.7 is nearly ready for release, but I have hit an issue which I thought I would offer for discussion. This is only about the desktop version.\r\n\r\nWhen you install software on a Windows PC you get a \"User Account Control\" message, asking you to confirm that you really want to install it. This has a friendly form, which you will see if you install Quest 5.6, and a scary form, with bright orange and a warning triangle, saying the publisher is untrusted.\r\n\r\nAlex was certified as an open source developer with Certum, originally for free, recently for €14. I would have no problem paying that, but now Certum are charging €135 (including a USB reader). Another company will do it for $84 apparently, but still not a trivial amount. I had no idea I would have to pay that sort of money to keep Quest going (and neither did Alex!). There are also various hoops to jump through to prove I am me.\r\n\r\nSo I could ask for donations. I have a suspicion that would get the money with no problem, but that would involve setting up some way to donate, so more hassle.\r\n\r\nOr not bother. Does it matter if it has the scary warning? I doubt most of the regulars here would worry, but the real issue is how it will impact on new users. I would guess most people try the web version first, and I imagine that would help build trust.\r\n\r\nDo I release 5.7 with the scary warning and see how it goes and look at a better solution for 5.8 if it seems to have a bad impact (and how do we measure that)?",
      "EditableFormat": "markdown",
      "HTML": "<p>Quest 5.7 is nearly ready for release, but I have hit an issue which I thought I would offer for discussion. This is only about the desktop version.</p>\n<p>When you install software on a Windows PC you get a \"User Account Control\" message, asking you to confirm that you really want to install it. This has a friendly form, which you will see if you install Quest 5.6, and a scary form, with bright orange and a warning triangle, saying the publisher is untrusted.</p>\n<p>Alex was certified as an open source developer with Certum, originally for free, recently for €14. I would have no problem paying that, but now Certum are charging €135 (including a USB reader). Another company will do it for $84 apparently, but still not a trivial amount. I had no idea I would have to pay that sort of money to keep Quest going (and neither did Alex!). There are also various hoops to jump through to prove I am me.</p>\n<p>So I could ask for donations. I have a suspicion that would get the money with no problem, but that would involve setting up some way to donate, so more hassle.</p>\n<p>Or not bother. Does it matter if it has the scary warning? I doubt most of the regulars here would worry, but the real issue is how it will impact on new users. I would guess most people try the web version first, and I imagine that would help build trust.</p>\n<p>Do I release 5.7 with the scary warning and see how it goes and look at a better solution for 5.8 if it seems to have a bad impact (and how do we measure that)?</p>\n\n",
      "PostDate": "2017-03-30T12:32:15.3574969Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "43d53d9e-3cfa-4360-97b0-0fde09d045ce",
      "UserId": 25543,
      "Username": "Silver",
      "AvatarUrl": "https://secure.gravatar.com/avatar/13024be5ccbb463906b024d5bd3cb5e8?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Just go with the scary warning and ask the web admin to update the blurb on the download page giving people a heads up about it. \r\nObvs I'd donate if you decide to go that route. ",
      "EditableFormat": "markdown",
      "HTML": "<p>Just go with the scary warning and ask the web admin to update the blurb on the download page giving people a heads up about it.<br>\nObvs I'd donate if you decide to go that route.</p>\n\n",
      "PostDate": "2017-03-30T13:27:55.9353493Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "36306627-88b2-4b56-857d-25f1707d941f",
      "UserId": 56551,
      "Username": "XanMag",
      "AvatarUrl": "https://secure.gravatar.com/avatar/4b45a3afd18077f76f6569225c422bdb?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "^ditto",
      "EditableFormat": "markdown",
      "HTML": "<p>^ditto</p>\n\n",
      "PostDate": "2017-03-30T14:21:20.441882Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "58b90941-73bd-4efb-b56b-073db50dc3f3",
      "UserId": 247325,
      "Username": "hegemonkhan",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a96cf34d8d97c57de38f54ee22b1759b?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I'd definately post this information on the website (explain the situation with the money needed to be 'officially trusted/certified' and explain what the 'officially trusted/certified' is even about, and how it relates to the person's computer's UAC warning), and just go with the non-trusted/certified, and see if it becomes an issue of people worrying about not having that 'trusted/certified' official-label/guarantee, and if it does... then can go about how to pay/fund it... if you don't mind the hassle of it...",
      "EditableFormat": "markdown",
      "HTML": "<p>I'd definately post this information on the website (explain the situation with the money needed to be 'officially trusted/certified' and explain what the 'officially trusted/certified' is even about, and how it relates to the person's computer's UAC warning), and just go with the non-trusted/certified, and see if it becomes an issue of people worrying about not having that 'trusted/certified' official-label/guarantee, and if it does... then can go about how to pay/fund it... if you don't mind the hassle of it...</p>\n\n",
      "PostDate": "2017-03-30T20:18:04.1441344Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "ded8b3ec-2070-45bc-af4e-676542d15140",
      "UserId": 260569,
      "Username": "DarkLizerd",
      "AvatarUrl": "http://i.imgur.com/BXvaaIub.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Is/does Quest 5.7 have better error messaging???\r\nAt least a line number for an error message???\r\n\r\nI just used Outlook as a spell checker to correct my bad spelling...\r\nBetween correcting description misspelling, and a cat that likes to walk on my keyboard...\r\nI now got the dreaded...\r\n\"failed to load game due to the following errors:\r\nError: Object reference not set to an instance of an object\"\r\nI assume that means I have a room exit to a room that does not exist...\r\nor something similar...\r\n(somewhere in 500 lines of code!!!)\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Is/does Quest 5.7 have better error messaging???<br>\nAt least a line number for an error message???</p>\n<p>I just used Outlook as a spell checker to correct my bad spelling...<br>\nBetween correcting description misspelling, and a cat that likes to walk on my keyboard...<br>\nI now got the dreaded...<br>\n\"failed to load game due to the following errors:<br>\nError: Object reference not set to an instance of an object\"<br>\nI assume that means I have a room exit to a room that does not exist...<br>\nor something similar...<br>\n(somewhere in 500 lines of code!!!)</p>\n\n",
      "PostDate": "2017-03-31T05:21:28.4543247Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "b3437686-55c6-46c4-82aa-349419032868",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I think we have a solution (thanks to Luis).\r\n\r\nDarkLizerd, some error messages are improved, in particular in the text processor. However, this update does not change the underlying C# or Visual Basic, as I have yet to get my head round that. When you find the error, let me know what caused it, so I can reproduce it and perhaps sort it for 5.8.",
      "EditableFormat": "markdown",
      "HTML": "<p>I think we have a solution (thanks to Luis).</p>\n<p>DarkLizerd, some error messages are improved, in particular in the text processor. However, this update does not change the underlying C# or Visual Basic, as I have yet to get my head round that. When you find the error, let me know what caused it, so I can reproduce it and perhaps sort it for 5.8.</p>\n\n",
      "PostDate": "2017-03-31T07:21:35.0173149Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "a48bdd31-6106-443c-af70-b5ba006e861d",
      "UserId": 260569,
      "Username": "DarkLizerd",
      "AvatarUrl": "http://i.imgur.com/BXvaaIub.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I know VB.... \r\nAny chance I could help there?\r\nI've re-read every line 3 times... nothing seems to be out of place.\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>I know VB....<br>\nAny chance I could help there?<br>\nI've re-read every line 3 times... nothing seems to be out of place.</p>\n\n",
      "PostDate": "2017-03-31T08:36:21.890617Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "7acb9363-a39c-4366-a013-0cdad305ca73",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "You need to know .NET, using C# and VB. If you do, then sure! They is a guide to getting going here:\r\nhttps://github.com/ThePix/quest/wiki/Quest-Source-Code\r\n\r\nTo trouble-shoot, I would back up your game, then cut chunks out of it. Delete the commands, and see if it will load. Delete a few rooms, and see if it will load. Delete a few more. Etc. Then delete functions. Each step you need to also delete any reference to the things you delete, eg exits goings to the rooms you are deleting. Eventually you should find it loads okay, and you will know it was in the bit you just deleted.",
      "EditableFormat": "markdown",
      "HTML": "<p>You need to know .NET, using C# and VB. If you do, then sure! They is a guide to getting going here:<br>\nhttps://github.com/ThePix/quest/wiki/Quest-Source-Code</p>\n<p>To trouble-shoot, I would back up your game, then cut chunks out of it. Delete the commands, and see if it will load. Delete a few rooms, and see if it will load. Delete a few more. Etc. Then delete functions. Each step you need to also delete any reference to the things you delete, eg exits goings to the rooms you are deleting. Eventually you should find it loads okay, and you will know it was in the bit you just deleted.</p>\n\n",
      "PostDate": "2017-03-31T13:47:38.2972324Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "5cd2ffa8-ceef-4e6f-98ae-d8691eb809d6",
      "UserId": 260569,
      "Username": "DarkLizerd",
      "AvatarUrl": "http://i.imgur.com/BXvaaIub.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Sorry... just VB6... Never dove into VB.net...\r\nAnd thanks, I'll try \"deleting\" exits and find out that way...\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Sorry... just VB6... Never dove into VB.net...<br>\nAnd thanks, I'll try \"deleting\" exits and find out that way...</p>\n\n",
      "PostDate": "2017-03-31T19:33:10.0927346Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "69670839-8d81-40f6-8b29-83e1a90bdc11",
      "UserId": 260569,
      "Username": "DarkLizerd",
      "AvatarUrl": "http://i.imgur.com/BXvaaIub.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I think I may have found it...\r\n\"white spaces\"\r\nSpace= h20\r\nbut outlook inserted \"other white spaces\" that replaced h20...\r\nIE: hc2 ha0 \r\ncan't see them, but they trip-up quest...\r\nI will need some time to replace all the spaces to see if that works...\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>I think I may have found it...<br>\n\"white spaces\"<br>\nSpace= h20<br>\nbut outlook inserted \"other white spaces\" that replaced h20...<br>\nIE: hc2 ha0<br>\ncan't see them, but they trip-up quest...<br>\nI will need some time to replace all the spaces to see if that works...</p>\n\n",
      "PostDate": "2017-03-31T20:35:18.5751627Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "48546ebe-ac5a-4e00-8656-a55d7d59130e",
      "UserId": 260569,
      "Username": "DarkLizerd",
      "AvatarUrl": "http://i.imgur.com/BXvaaIub.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Either the white spaces was the issue, or a room that got deleted...\r\nBetween coping and pasting between 2 copies of my game, I got it working again....\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Either the white spaces was the issue, or a room that got deleted...<br>\nBetween coping and pasting between 2 copies of my game, I got it working again....</p>\n\n",
      "PostDate": "2017-04-01T07:57:04.7089149Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "a9844d72-1b66-4477-af28-5d52a1467bc9",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Good (though it wouldf have been useful to know exactly what caused it).",
      "EditableFormat": "markdown",
      "HTML": "<p>Good (though it wouldf have been useful to know exactly what caused it).</p>\n\n",
      "PostDate": "2017-04-01T08:19:58.3178614Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "c805e0be-225b-423e-8059-00e3095650c4",
      "UserId": 260569,
      "Username": "DarkLizerd",
      "AvatarUrl": "http://i.imgur.com/BXvaaIub.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I think, if Quest would have loaded my game, despite the error, I may have noticed the missing room...\r\nCould that feature be added to Quest 5.8???\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>I think, if Quest would have loaded my game, despite the error, I may have noticed the missing room...<br>\nCould that feature be added to Quest 5.8???</p>\n\n",
      "PostDate": "2017-04-01T20:17:12.8806277Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "cb819092-2ff1-46aa-a627-633acedaabb8",
      "UserId": 277074,
      "Username": "Dcoder",
      "AvatarUrl": "https://secure.gravatar.com/avatar/6bf915571362451733db8730696fe55d?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I'd just go with the scary warning, and tell newcomers not to freak out about it.",
      "EditableFormat": "markdown",
      "HTML": "<p>I'd just go with the scary warning, and tell newcomers not to freak out about it.</p>\n\n",
      "PostDate": "2017-04-04T12:43:31.2242654Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "f5c3c050-12f8-4b63-9276-52a3e7da1883",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "We may well be going for the scary warning. I have been trying to get a certificate from KSoft/Comodo, and after paying the money, they are now demanding certified copies of my passport, utilities bill and phone bill, and also to register my company with Dun and Bradstreet. \r\n\r\nETA: In fairness to KSoft, they responded quickly admitting that Comodo had \"made the individual validation requirements very difficult\" and have refunded my money.",
      "EditableFormat": "markdown",
      "HTML": "<p>We may well be going for the scary warning. I have been trying to get a certificate from KSoft/Comodo, and after paying the money, they are now demanding certified copies of my passport, utilities bill and phone bill, and also to register my company with Dun and Bradstreet.</p>\n<p>ETA: In fairness to KSoft, they responded quickly admitting that Comodo had \"made the individual validation requirements very difficult\" and have refunded my money.</p>\n\n",
      "PostDate": "2017-04-04T13:18:46.0103929Z",
      "LastEditDate": "2017-04-07T07:54:39.4174482Z",
      "link": null
    },
    {
      "PostId": "379bc38e-7b22-4727-9664-293d8967c7e1",
      "UserId": 306785,
      "Username": "Roger Hågensen",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Why not do it the proper way?\r\n\r\nDoes Quest need administrated/elevated privileges? Does Quest perform administrative tasks? No?\r\n\r\nInstall Quest into C:\\Users\\[usernamehere]\\AppData\\Local\\Programs\\Quest\\ for example. (do not use that url directly though, please use the correct API calls to get the local folder of the current user).\r\nNo need for elevation, no scary warning prompts.\r\n\r\nMicrosoft created the UAC primarily to force developers to stop requiring admin privileges.\r\n\r\nFor WIndows 7 and later see https://msdn.microsoft.com/en-us/library/windows/desktop/bb762188\r\nFOLDERID_UserProgramFiles \t{5CD7AEE2-2219-4A67-B85D-6C9CE15660CB} will give you the path to %LocalAppData%\\Programs\r\n\r\nFor Windows Vista and older see https://msdn.microsoft.com/en-us/library/windows/desktop/bb762188 for more info, the CSIDL you are looking for is {F1B32785-6FBA-4FCF-9D55-7B8E7F157091} also known as %LOCALAPPDATA% or %USERPROFILE%\\AppData\\Local\r\nAnd just make a application folder under that.\r\n\r\nI avoid software that require elevation, even I do not need a elevated user most the working day. And most programs that require elevation tend to install under the wrong user, so that the shortcuts etc. are on the admin account rather than the current user account that I'm actually using daily.\r\n\r\nIf a administrator wishes to install it elevated they can simply right click the installer and manually do that. You can even detect  that and offer to install at the Known folder for all users, or simply just prompt the admin for the path.\r\n\r\nMy suggestion, default to the appdata local folder, but let the user choose another location if they want.\r\n\r\nPS! Make sure the manifest for the installer is set to  requestedExecutionLevel level=\"asInvoker\"\r\n\r\nPPS! A object code signing certificate only have two advantages, it provides a way to check if the file has been manipulated (you can post CRC32 and MD5  and SHA1 and SHA256 and SHA512 hashes of the installer on the download page and people can check themselves if they are worried. The other advantage is that you probably won't get the \"this files was downloaded from the internet\"  but that should go away once enough people have downloaded it (as Microsoft's virus checker will get a report back from Microsoft that the installer file is \"widespread\" and no known issues). The textadventures.co.uk site has https and so does github so \"safe\" download is not an issue either.\r\n\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Why not do it the proper way?</p>\n<p>Does Quest need administrated/elevated privileges? Does Quest perform administrative tasks? No?</p>\n<p>Install Quest into C:\\Users[usernamehere]\\AppData\\Local\\Programs\\Quest\\ for example. (do not use that url directly though, please use the correct API calls to get the local folder of the current user).<br>\nNo need for elevation, no scary warning prompts.</p>\n<p>Microsoft created the UAC primarily to force developers to stop requiring admin privileges.</p>\n<p>For WIndows 7 and later see https://msdn.microsoft.com/en-us/library/windows/desktop/bb762188<br>\nFOLDERID_UserProgramFiles \t{5CD7AEE2-2219-4A67-B85D-6C9CE15660CB} will give you the path to %LocalAppData%\\Programs</p>\n<p>For Windows Vista and older see https://msdn.microsoft.com/en-us/library/windows/desktop/bb762188 for more info, the CSIDL you are looking for is {F1B32785-6FBA-4FCF-9D55-7B8E7F157091} also known as %LOCALAPPDATA% or %USERPROFILE%\\AppData\\Local<br>\nAnd just make a application folder under that.</p>\n<p>I avoid software that require elevation, even I do not need a elevated user most the working day. And most programs that require elevation tend to install under the wrong user, so that the shortcuts etc. are on the admin account rather than the current user account that I'm actually using daily.</p>\n<p>If a administrator wishes to install it elevated they can simply right click the installer and manually do that. You can even detect  that and offer to install at the Known folder for all users, or simply just prompt the admin for the path.</p>\n<p>My suggestion, default to the appdata local folder, but let the user choose another location if they want.</p>\n<p>PS! Make sure the manifest for the installer is set to  requestedExecutionLevel level=\"asInvoker\"</p>\n<p>PPS! A object code signing certificate only have two advantages, it provides a way to check if the file has been manipulated (you can post CRC32 and MD5  and SHA1 and SHA256 and SHA512 hashes of the installer on the download page and people can check themselves if they are worried. The other advantage is that you probably won't get the \"this files was downloaded from the internet\"  but that should go away once enough people have downloaded it (as Microsoft's virus checker will get a report back from Microsoft that the installer file is \"widespread\" and no known issues). The textadventures.co.uk site has https and so does github so \"safe\" download is not an issue either.</p>\n\n",
      "PostDate": "2017-05-09T23:55:49.0687805Z",
      "LastEditDate": "2017-06-02T22:01:47.9942621Z",
      "link": null
    },
    {
      "PostId": "727aada9-4a1d-4fee-ac3d-94b2147f1be0",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Roger Hågensen, interesting suggest. That is not the proper way, however, Appdata is for data, not software. That is not to say developers do not use it for software, and that may be an option.\r\n\r\nI have recently installed JRuby and Libre Office, two big open source projects, and both have the scary orange warning when installing, and so I am less bothered about this than I was.",
      "EditableFormat": "markdown",
      "HTML": "<p>Roger Hågensen, interesting suggest. That is not the proper way, however, Appdata is for data, not software. That is not to say developers do not use it for software, and that may be an option.</p>\n<p>I have recently installed JRuby and Libre Office, two big open source projects, and both have the scary orange warning when installing, and so I am less bothered about this than I was.</p>\n\n",
      "PostDate": "2017-05-27T10:19:18.9084518Z",
      "LastEditDate": "2017-05-27T10:39:37.9724056Z",
      "link": null
    },
    {
      "PostId": "8e57f26a-b1e4-4fd3-a053-b71046230f55",
      "UserId": 306785,
      "Username": "Roger Hågensen",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "@The PIxie\r\nAppData is the proper location, as per. [ Microsoft themselves](https://msdn.microsoft.com/en-us/library/windows/desktop/dd765197), \r\n\r\nI do notice I stated the wrong path though. It should be %LocalAppData%\\Programs (I'll edit the post above)\r\nBut I blame that on me not finding the CSIDL (which does not exist for this as per user program install is only added to Windows 7 and later. With prior version of Windows it's OK to just make a application folder in %LocalAppData% \r\n\r\n\r\nJRuby and Libre Office probably ask for admin access due to Java, however they do not need to do that as Java could be run from the application's folder as well. With later Windows versions you can't go all bonkers with filetypes/handlers anyway (Windows 10 will ensure the user has to set up such instead)\r\nThere is no reason why LIbre Office should require admin access to be installed (does it require root access on Linux too?)\r\nAdmin/root access is bad behaviour, especially if the software is not part of/integrate with the OS directly, Anti Virus or Firewalls or security software  can understand. But word processing, nope.\r\nAnd half the software that demand admin on install screw things up anyway, the shortcut icons in the startmenu and desktop end up on the admin desktop and not under my actual user (which I installed from).\r\n\r\nThis stuff isn't hard to do, I'm a dev and it's easy to do with something like NSIS3.\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>@The PIxie<br>\nAppData is the proper location, as per. <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd765197\"> Microsoft themselves</a>,</p>\n<p>I do notice I stated the wrong path though. It should be %LocalAppData%\\Programs (I'll edit the post above)<br>\nBut I blame that on me not finding the CSIDL (which does not exist for this as per user program install is only added to Windows 7 and later. With prior version of Windows it's OK to just make a application folder in %LocalAppData%</p>\n<p>JRuby and Libre Office probably ask for admin access due to Java, however they do not need to do that as Java could be run from the application's folder as well. With later Windows versions you can't go all bonkers with filetypes/handlers anyway (Windows 10 will ensure the user has to set up such instead)<br>\nThere is no reason why LIbre Office should require admin access to be installed (does it require root access on Linux too?)<br>\nAdmin/root access is bad behaviour, especially if the software is not part of/integrate with the OS directly, Anti Virus or Firewalls or security software  can understand. But word processing, nope.<br>\nAnd half the software that demand admin on install screw things up anyway, the shortcut icons in the startmenu and desktop end up on the admin desktop and not under my actual user (which I installed from).</p>\n<p>This stuff isn't hard to do, I'm a dev and it's easy to do with something like NSIS3.</p>\n\n",
      "PostDate": "2017-06-02T21:56:28.8988447Z",
      "LastEditDate": "2017-06-02T22:11:38.1678172Z",
      "link": null
    },
    {
      "PostId": "48813fdf-4fd7-4f18-9608-57ac10dce32a",
      "UserId": 306785,
      "Username": "Roger Hågensen",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Just to put my mouth where my foot is, this is NSIS3 script used for a actively used program/installer.\r\n\r\nNote! The formatting on this forum is going bonkers with this, but it seems to be just the layout, the text seems unharmed so just copy'n'paste it all into notepad and save it as something.nsi and it should work.\r\n\r\nThe NSIS script uses FileFunc.nsh and LogicLib.nsh and WinVer.nsh but these are bundled with NSIS3.\r\n\r\n\r\n<code>;GridStream Player Installer\r\n\r\nUnicode true\r\nSetCompressor /SOLID lzma\r\nCRCCheck on\r\nXPStyle on\r\nSetFont $(^Font) 9\r\n\r\nIcon \"GridStream Player Installer.ico\"\r\nUninstallIcon \"GridStream Player Installer.ico\"\r\n\r\n!define COMPANYNAME \"GridStream Productions\"\r\n!define COMPANYSITE \"http://www.gridstream.org/\"\r\n!define PROGRAMNAME \"GridStream Player\"\r\n!define AUTHORNAME \"Roger Hågensen\"\r\n!define PROGRAMID \"{77585712-e0d0-11e1-b641-0008c7a4704e}\"\r\n!define DISKSPACE 2048\r\n\r\n!define APPUSERID \"${PROGRAMID}\"\r\n\r\n!define FILEVERSION 5.1.0.16\r\n!define YEAR 2017\r\n\r\nRequestExecutionLevel user\r\n\r\n!define HKREGISTRY \"HKCU\"\r\n!define UNINSTALLKEY \"Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\${PROGRAMID}\"\r\n\r\n!include \"WordFunc.nsh\"\r\n!insertmacro VersionCompare\r\n!insertmacro un.VersionCompare\r\n\r\n!define HWND_TOPMOST -1\r\n!define SWP_NOSIZE   0x0001\r\n!define SWP_NOMOVE   0x0002\r\n\r\nVIProductVersion \"${FILEVERSION}\"\r\nVIAddVersionKey \"ProductName\" \"${PROGRAMNAME} Installer\"\r\nVIAddVersionKey \"CompanyName\" \"${COMPANYNAME}\"\r\nVIAddVersionKey \"LegalCopyright\" \"© ${YEAR} ${AUTHORNAME}, ${COMPANYNAME}\"\r\nVIAddVersionKey \"FileDescription\" \"Installer for ${PROGRAMNAME}\"\r\nVIAddVersionKey \"FileVersion\" \"${FILEVERSION}\"\r\nVIAddVersionKey \"ProductVersion\" \"${FILEVERSION}\"\r\n\r\nInstallColors /windows\r\n\r\nCaption \"${PROGRAMNAME} Installer\"\r\nName \"${PROGRAMNAME}\"\r\nOutFile \"${PROGRAMNAME} Installer.exe\"\r\nInstallDirRegKey ${HKREGISTRY} ${UNINSTALLKEY} \"InstallLocation\"\r\n\r\n!define FOLDERID_UserProgramFiles \"{5CD7AEE2-2219-4A67-B85D-6C9CE15660CB}\"\r\n!define KF_FLAG_CREATE 0x00008000\r\n!include FileFunc.nsh\r\n!include LogicLib.nsh\r\n\r\n!include WinVer.nsh\r\n\r\nVar isupdate\r\nVar runprogram\r\nVar installpath\r\n\r\nShowInstDetails show\r\nShowUninstDetails show\r\n\r\nBrandingText \"Version ${FILEVERSION}\"\r\n\r\nSubCaption 0 \" \"\r\nSubCaption 1 \" \"\r\nSubCaption 2 \" \"\r\nSubCaption 3 \" \"\r\nSubCaption 4 \" \"\r\nUninstallSubCaption 0 \" \"\r\nUninstallSubCaption 1 \" \"\r\nUninstallSubCaption 2 \" \"\r\n\r\nCompletedText \"Done!\"\r\n\r\nUninstallText \"Ready to begin the removal!\" \"Uninstall:\"\r\n\r\nSpaceTexts none none\r\n\r\nComponentText \"Ready to begin the installation!\" \" \" \"Optional action(s):\"\r\n\r\nPage components skipIfUpdate\r\nPage instfiles\r\nUninstPage uninstConfirm\r\nUninstPage instfiles\r\n\r\n!define sysGetDiskFreeSpaceEx 'kernel32::GetDiskFreeSpaceEx(t, *l, *l, *l) i'\r\n\r\nfunction FreeDiskSpace\r\n\tSystem::Call '${sysGetDiskFreeSpaceEx}(r0,.,,.r1)'\r\n\t; convert the large integer byte values into manageable kb\r\n\tSystem::Int64Op $1 / 1024\r\n\t; Return the free space\r\n\tPop $1\r\nfunctionend\r\n\r\nFunction .onInit\r\n\t;Our default for installpath. (UserProgramFiles is %LOCALAPPDATA%\\Programs by default, so we use that as our default)\r\n\tStrCpy $0 \"$LOCALAPPDATA\\Programs\"\r\n\tStrCpy $installpath \"$LOCALAPPDATA\\Programs\"\r\n\r\n\t;Make sure we don't overwrite $INSTDIR if specified on the command line or from InstallDirRegKey\r\n\t${If} $INSTDIR == \"\"\r\n\t\t${If} ${AtLeastWin2000}\r\n\t\t\t${If} ${AtLeastWin7}\r\n\t\t\t\t;Windows 7 has a per-user programfiles \"known\" folder and this could be a non-default location!\r\n\t\t\t\tSystem::Call 'Shell32::SHGetKnownFolderPath(g \"${FOLDERID_UserProgramFiles}\",i ${KF_FLAG_CREATE},i0,*i.r2)i.r1'\r\n\t\t\t\t${If} $1 == 0\r\n\t\t\t\t\tSystem::Call '*$2(&w${NSIS_MAX_STRLEN} .r1)'\r\n\t\t\t\t\tStrCpy $0 $1\r\n\t\t\t\t\tSystem::Call 'Ole32::CoTaskMemFree(ir2)'\r\n\t\t\t\t${EndIf}\r\n\t\t\t${EndIf}\r\n\t\t${Else}\r\n\t\t\t;We only support Windows 2000 or later.\r\n\t\t\tMessageBox MB_OK|MB_ICONINFORMATION|MB_TOPMOST \"Windows 2000 or later required!\" /SD IDOK\r\n\t\t\tQuit\r\n\t\t${EndIf}\r\n\t\tStrCpy $INSTDIR \"$0\\${PROGRAMID}\"\r\n\t\tStrCpy $installpath $0\r\n\t${Else}\r\n\t\tIfFileExists \"$INSTDIR\\${PROGRAMNAME}.exe\" InstallCheckVersion\r\n\t\tGoto InstallClean\r\n\t\tInstallCheckVersion:\r\n\t\tGetDLLVersion \"$INSTDIR\\${PROGRAMNAME}.exe\" $R0 $R1\r\n\t\tIntOp $R2 $R0 >> 16\r\n\t\tIntOp $R2 $R2 & 0x0000FFFF ; $R2 now contains major version\r\n\t\tIntOp $R3 $R0 & 0x0000FFFF ; $R3 now contains minor version\r\n\t\tIntOp $R4 $R1 >> 16\r\n\t\tIntOp $R4 $R4 & 0x0000FFFF ; $R4 now contains release\r\n\t\tIntOp $R5 $R1 & 0x0000FFFF ; $R5 now contains build\r\n\t\tStrCpy $R0 \"$R2.$R3.$R4.$R5\" ; $0 now contains a string like \"1.2.0.192\"\r\n\t\t${VersionCompare} \"${FILEVERSION}\" \"$R0\" $R0\r\n\t\tStrCmp $R0 \"0\" 0 InstallVersionSameNot\r\n\t\tMessageBox MB_YESNO|MB_ICONQUESTION|MB_TOPMOST \"This version is currently installed!$\\r$\\rRe-Install v${FILEVERSION}?\" /SD IDNO IDYES InstallReInstall\r\n\t\tQuit\r\n\t\tInstallVersionSameNot:\r\n\t\tStrCmp $R0 \"2\" 0 InstallVersionNewerNot\r\n\t\tMessageBox MB_OK|MB_ICONINFORMATION|MB_TOPMOST \"The version installed is more recent!\" /SD IDOK\r\n\t\tQuit\r\n\t\tInstallVersionNewerNot:\r\n\t\tInstallReInstall:\r\n\t\tStrCpy $isupdate \"true\"\r\n\t${EndIf}\r\n\tInstallClean:\r\n\r\n\tSystem::Call 'kernel32::OpenMutex(i 0x100000, b 0, t\"${PROGRAMID}\") i .r0 ?e'\r\n\tSystem::Call 'kernel32::CloseHandle(i $0)'\r\n\tPop $0\r\n\t${If} $0 == 127\r\n\t\tStrCpy $runprogram \"true\"\r\n\t\tMessageBox MB_OKCANCEL|MB_ICONEXCLAMATION|MB_TOPMOST \"${PROGRAMNAME} is running. Please close it before continuing!\" /SD IDCANCEL IDOK InstallProgramNotRunning\r\n\t\tQuit\r\n\t\tInstallProgramNotRunning:\r\n\t\tGoto InstallClean\r\n\t${EndIf}\r\n\r\n\tIfFileExists \"$INSTDIR\" FolderExists\r\n\tCreateDirectory \"$INSTDIR\"\r\n\tFolderExists:\r\n\tStrCpy $0 \"$INSTDIR\"\r\n\tCall FreeDiskSpace\r\n\tStrCpy $2 ${DISKSPACE}\r\n\tSystem::Int64Op $1 > $2\r\n\tPop $2\r\n\tIntCmp $2 1 InstallCleanOk\r\n\tMessageBox MB_OK|MB_ICONEXCLAMATION|MB_TOPMOST \"Not enough disk space! (${DISKSPACE} KB needed)\" /SD IDOK\r\n\tQuit\r\n\tInstallCleanOk:\r\nFunctionEnd\r\n\r\nFunction .onInstSuccess\r\n\tStrCmp $runprogram \"true\" 0 InstallSkipRunProgram\r\n\texec \"$INSTDIR\\${PROGRAMNAME}.exe\"\r\n\tInstallSkipRunProgram:\r\nFunctionEnd\r\n\r\nFunction skipIfUpdate\r\n\tStrCmp $isupdate \"true\" 0 +2\r\n\tAbort\r\nFunctionEnd\r\n\r\nFunction .onGUIInit\r\n\tSystem::Call \"User32::SetWindowPos(i, i, i, i, i, i, i) b ($HWNDPARENT, ${HWND_TOPMOST}, 0, 0, 0, 0, ${SWP_NOMOVE}|${SWP_NOSIZE})\"\r\nFunctionEnd\r\n\r\nFunction un.onGUIInit\r\n\tSystem::Call \"User32::SetWindowPos(i, i, i, i, i, i, i) b ($HWNDPARENT, ${HWND_TOPMOST}, 0, 0, 0, 0, ${SWP_NOMOVE}|${SWP_NOSIZE})\"\r\nFunctionEnd\r\n\r\nSection \"-hidden GridStream Player\"\r\n\tSectionIn RO\r\n\r\n\tIfFileExists \"$INSTDIR\\${PROGRAMNAME}.exe\" 0 InstallStarting\r\n\tRMDir /r /REBOOTOK \"$INSTDIR\"\r\n\tIfErrors 0 +3\r\n\tMessageBox MB_OK|MB_ICONEXCLAMATION|MB_TOPMOST \"Unable to remove old installation!\" /SD IDOK\r\n\tQuit\r\n\tInstallStarting:\r\n\r\n\tSetOutPath \"$INSTDIR\"\r\n\tFile /a /r \"${PROGRAMNAME}\\*.*\"\r\n\tWriteUninstaller \"$INSTDIR\\${PROGRAMNAME} Uninstaller.exe\"\r\n\r\n\t${GetSize} \"$INSTDIR\" \"/S=0K\" $0 $1 $2\r\n\tIntFmt $0 \"0x%08X\" $0\r\n\tWriteRegDWORD ${HKREGISTRY} ${UNINSTALLKEY} \"EstimatedSize\" \"$0\"\r\n\r\n\tWriteRegStr ${HKREGISTRY} ${UNINSTALLKEY} \"DisplayName\" \"${PROGRAMNAME}\"\r\n\tWriteRegStr ${HKREGISTRY} ${UNINSTALLKEY} \"Publisher\" \"${COMPANYNAME}\"\r\n\tWriteRegExpandStr ${HKREGISTRY} ${UNINSTALLKEY} \"UninstallString\" '\"$INSTDIR\\${PROGRAMNAME} Uninstaller.exe\"'\r\n\tWriteRegExpandStr ${HKREGISTRY} ${UNINSTALLKEY} \"InstallLocation\" \"$INSTDIR\"\r\n\tWriteRegExpandStr ${HKREGISTRY} ${UNINSTALLKEY} \"DisplayIcon\" \"$INSTDIR\\${PROGRAMNAME}.exe,0\"\r\n\tWriteRegStr ${HKREGISTRY} ${UNINSTALLKEY} \"DisplayVersion\" \"${FILEVERSION}\"\r\n\tWriteRegDWORD ${HKREGISTRY} ${UNINSTALLKEY} \"NoModify\" 1\r\n\tWriteRegDWORD ${HKREGISTRY} ${UNINSTALLKEY} \"NoRepair\" 1\r\n\tWriteRegStr ${HKREGISTRY} ${UNINSTALLKEY} \"HelpLink\" \"${COMPANYSITE}\"\r\n\tWriteRegStr ${HKREGISTRY} ${UNINSTALLKEY} \"ProductID\" \"${PROGRAMID}\"\r\n\r\n\tCreateShortCut \"$SMPROGRAMS\\${PROGRAMNAME}.lnk\" \"$INSTDIR\\${PROGRAMNAME}.exe\" \"\" \"$INSTDIR\\${PROGRAMNAME}.exe\" 0\r\n\r\n\tStrCmp $isupdate \"true\" 0 InstallSkipDesktopShortcutUpdate\r\n\tIfFileExists \"$DESKTOP\\${PROGRAMNAME}.lnk\" 0 InstallSkipDesktopShortcutUpdate\r\n\tCreateShortCut \"$DESKTOP\\${PROGRAMNAME}.lnk\" \"$INSTDIR\\${PROGRAMNAME}.exe\" \"\" \"$INSTDIR\\${PROGRAMNAME}.exe\" 0\r\n\tInstallSkipDesktopShortcutUpdate:\r\nSectionEnd\r\n\r\nSection /o \"Create a desktop shortcut\"\r\n\tCreateShortCut \"$DESKTOP\\${PROGRAMNAME}.lnk\" \"$INSTDIR\\${PROGRAMNAME}.exe\" \"\" \"$INSTDIR\\${PROGRAMNAME}.exe\" 0\r\nSectionEnd\r\n\r\nSection /o \"Start program after installation\"\r\n\tStrCpy $runprogram \"true\"\r\nSectionEnd\r\n\r\nFunction un.onInit\r\nFunctionEnd\r\n\r\nSection \"Uninstall\"\r\n\tUnInstall:\r\n\r\n\tSystem::Call 'kernel32::OpenMutex(i 0x100000, b 0, t\"${PROGRAMID}\") i .r0 ?e'\r\n\tSystem::Call 'kernel32::CloseHandle(i $0)'\r\n\tPop $0\r\n\t${If} $0 == 127\r\n\t\tMessageBox MB_OKCANCEL|MB_ICONEXCLAMATION|MB_TOPMOST \"${PROGRAMNAME} is running. Please close it before continuing!\" /SD IDCANCEL IDOK UnInstallProgramNotRunning\r\n\t\tQuit\r\n\t\tUnInstallProgramNotRunning:\r\n\t\tGoto UnInstall\r\n\t${EndIf}\r\n\r\n\tIfFileExists \"$APPDATA\\${PROGRAMID}\" 0 UnInstallKeepPreferences\r\n\tMessageBox MB_YESNO|MB_ICONQUESTION|MB_TOPMOST \"Keep ${PROGRAMNAME} preferences?\" /SD IDYES IDYES UnInstallKeepPreferences\r\n\tRMDir /r /REBOOTOK \"$APPDATA\\${PROGRAMID}\"\r\n\tUnInstallKeepPreferences:\r\n\tRMDir /r /REBOOTOK \"$INSTDIR\"\r\n\tIfErrors 0 +3\r\n\tMessageBox MB_OK|MB_ICONEXCLAMATION|MB_TOPMOST \"Unable to remove installation!\" /SD IDOK\r\n\tQuit\r\n\tDelete \"$DESKTOP\\${PROGRAMNAME}.lnk\"\r\n\tDelete \"$SMPROGRAMS\\${PROGRAMNAME}.lnk\"\r\n\tDeleteRegKey ${HKREGISTRY} ${UNINSTALLKEY}\r\nSectionEnd\r\n</code>\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Just to put my mouth where my foot is, this is NSIS3 script used for a actively used program/installer.</p>\n<p>Note! The formatting on this forum is going bonkers with this, but it seems to be just the layout, the text seems unharmed so just copy'n'paste it all into notepad and save it as something.nsi and it should work.</p>\n<p>The NSIS script uses FileFunc.nsh and LogicLib.nsh and WinVer.nsh but these are bundled with NSIS3.</p>\n<p><code>;GridStream Player Installer</code></p><code>\n<p>Unicode true<br>\nSetCompressor /SOLID lzma<br>\nCRCCheck on<br>\nXPStyle on<br>\nSetFont $(^Font) 9</p>\n<p>Icon \"GridStream Player Installer.ico\"<br>\nUninstallIcon \"GridStream Player Installer.ico\"</p>\n<p>!define COMPANYNAME \"GridStream Productions\"<br>\n!define COMPANYSITE \"http://www.gridstream.org/\"<br>\n!define PROGRAMNAME \"GridStream Player\"<br>\n!define AUTHORNAME \"Roger Hågensen\"<br>\n!define PROGRAMID \"{77585712-e0d0-11e1-b641-0008c7a4704e}\"<br>\n!define DISKSPACE 2048</p>\n<p>!define APPUSERID \"${PROGRAMID}\"</p>\n<p>!define FILEVERSION 5.1.0.16<br>\n!define YEAR 2017</p>\n<p>RequestExecutionLevel user</p>\n<p>!define HKREGISTRY \"HKCU\"<br>\n!define UNINSTALLKEY \"Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall${PROGRAMID}\"</p>\n<p>!include \"WordFunc.nsh\"<br>\n!insertmacro VersionCompare<br>\n!insertmacro un.VersionCompare</p>\n<p>!define HWND_TOPMOST -1<br>\n!define SWP_NOSIZE   0x0001<br>\n!define SWP_NOMOVE   0x0002</p>\n<p>VIProductVersion \"${FILEVERSION}\"<br>\nVIAddVersionKey \"ProductName\" \"${PROGRAMNAME} Installer\"<br>\nVIAddVersionKey \"CompanyName\" \"${COMPANYNAME}\"<br>\nVIAddVersionKey \"LegalCopyright\" \"© ${YEAR} ${AUTHORNAME}, ${COMPANYNAME}\"<br>\nVIAddVersionKey \"FileDescription\" \"Installer for ${PROGRAMNAME}\"<br>\nVIAddVersionKey \"FileVersion\" \"${FILEVERSION}\"<br>\nVIAddVersionKey \"ProductVersion\" \"${FILEVERSION}\"</p>\n<p>InstallColors /windows</p>\n<p>Caption \"${PROGRAMNAME} Installer\"<br>\nName \"${PROGRAMNAME}\"<br>\nOutFile \"${PROGRAMNAME} Installer.exe\"<br>\nInstallDirRegKey ${HKREGISTRY} ${UNINSTALLKEY} \"InstallLocation\"</p>\n<p>!define FOLDERID_UserProgramFiles \"{5CD7AEE2-2219-4A67-B85D-6C9CE15660CB}\"<br>\n!define KF_FLAG_CREATE 0x00008000<br>\n!include FileFunc.nsh<br>\n!include LogicLib.nsh</p>\n<p>!include WinVer.nsh</p>\n<p>Var isupdate<br>\nVar runprogram<br>\nVar installpath</p>\n<p>ShowInstDetails show<br>\nShowUninstDetails show</p>\n<p>BrandingText \"Version ${FILEVERSION}\"</p>\n<p>SubCaption 0 \" \"<br>\nSubCaption 1 \" \"<br>\nSubCaption 2 \" \"<br>\nSubCaption 3 \" \"<br>\nSubCaption 4 \" \"<br>\nUninstallSubCaption 0 \" \"<br>\nUninstallSubCaption 1 \" \"<br>\nUninstallSubCaption 2 \" \"</p>\n<p>CompletedText \"Done!\"</p>\n<p>UninstallText \"Ready to begin the removal!\" \"Uninstall:\"</p>\n<p>SpaceTexts none none</p>\n<p>ComponentText \"Ready to begin the installation!\" \" \" \"Optional action(s):\"</p>\n<p>Page components skipIfUpdate<br>\nPage instfiles<br>\nUninstPage uninstConfirm<br>\nUninstPage instfiles</p>\n<p>!define sysGetDiskFreeSpaceEx 'kernel32::GetDiskFreeSpaceEx(t, *l, *l, *l) i'</p>\n<p>function FreeDiskSpace<br>\nSystem::Call '${sysGetDiskFreeSpaceEx}(r0,.,,.r1)'<br>\n; convert the large integer byte values into manageable kb<br>\nSystem::Int64Op $1 / 1024<br>\n; Return the free space<br>\nPop $1<br>\nfunctionend</p>\n<p>Function .onInit<br>\n;Our default for installpath. (UserProgramFiles is %LOCALAPPDATA%\\Programs by default, so we use that as our default)<br>\nStrCpy $0 \"$LOCALAPPDATA\\Programs\"<br>\nStrCpy $installpath \"$LOCALAPPDATA\\Programs\"</p>\n<pre><code>;Make sure we don't overwrite $INSTDIR if specified on the command line or from InstallDirRegKey\n${If} $INSTDIR == \"\"\n\t${If} ${AtLeastWin2000}\n\t\t${If} ${AtLeastWin7}\n\t\t\t;Windows 7 has a per-user programfiles \"known\" folder and this could be a non-default location!\n\t\t\tSystem::Call 'Shell32::SHGetKnownFolderPath(g \"${FOLDERID_UserProgramFiles}\",i ${KF_FLAG_CREATE},i0,*i.r2)i.r1'\n\t\t\t${If} $1 == 0\n\t\t\t\tSystem::Call '*$2(&amp;w${NSIS_MAX_STRLEN} .r1)'\n\t\t\t\tStrCpy $0 $1\n\t\t\t\tSystem::Call 'Ole32::CoTaskMemFree(ir2)'\n\t\t\t${EndIf}\n\t\t${EndIf}\n\t${Else}\n\t\t;We only support Windows 2000 or later.\n\t\tMessageBox MB_OK|MB_ICONINFORMATION|MB_TOPMOST \"Windows 2000 or later required!\" /SD IDOK\n\t\tQuit\n\t${EndIf}\n\tStrCpy $INSTDIR \"$0\\${PROGRAMID}\"\n\tStrCpy $installpath $0\n${Else}\n\tIfFileExists \"$INSTDIR\\${PROGRAMNAME}.exe\" InstallCheckVersion\n\tGoto InstallClean\n\tInstallCheckVersion:\n\tGetDLLVersion \"$INSTDIR\\${PROGRAMNAME}.exe\" $R0 $R1\n\tIntOp $R2 $R0 &gt;&gt; 16\n\tIntOp $R2 $R2 &amp; 0x0000FFFF ; $R2 now contains major version\n\tIntOp $R3 $R0 &amp; 0x0000FFFF ; $R3 now contains minor version\n\tIntOp $R4 $R1 &gt;&gt; 16\n\tIntOp $R4 $R4 &amp; 0x0000FFFF ; $R4 now contains release\n\tIntOp $R5 $R1 &amp; 0x0000FFFF ; $R5 now contains build\n\tStrCpy $R0 \"$R2.$R3.$R4.$R5\" ; $0 now contains a string like \"1.2.0.192\"\n\t${VersionCompare} \"${FILEVERSION}\" \"$R0\" $R0\n\tStrCmp $R0 \"0\" 0 InstallVersionSameNot\n\tMessageBox MB_YESNO|MB_ICONQUESTION|MB_TOPMOST \"This version is currently installed!$\\r$\\rRe-Install v${FILEVERSION}?\" /SD IDNO IDYES InstallReInstall\n\tQuit\n\tInstallVersionSameNot:\n\tStrCmp $R0 \"2\" 0 InstallVersionNewerNot\n\tMessageBox MB_OK|MB_ICONINFORMATION|MB_TOPMOST \"The version installed is more recent!\" /SD IDOK\n\tQuit\n\tInstallVersionNewerNot:\n\tInstallReInstall:\n\tStrCpy $isupdate \"true\"\n${EndIf}\nInstallClean:\n\nSystem::Call 'kernel32::OpenMutex(i 0x100000, b 0, t\"${PROGRAMID}\") i .r0 ?e'\nSystem::Call 'kernel32::CloseHandle(i $0)'\nPop $0\n${If} $0 == 127\n\tStrCpy $runprogram \"true\"\n\tMessageBox MB_OKCANCEL|MB_ICONEXCLAMATION|MB_TOPMOST \"${PROGRAMNAME} is running. Please close it before continuing!\" /SD IDCANCEL IDOK InstallProgramNotRunning\n\tQuit\n\tInstallProgramNotRunning:\n\tGoto InstallClean\n${EndIf}\n\nIfFileExists \"$INSTDIR\" FolderExists\nCreateDirectory \"$INSTDIR\"\nFolderExists:\nStrCpy $0 \"$INSTDIR\"\nCall FreeDiskSpace\nStrCpy $2 ${DISKSPACE}\nSystem::Int64Op $1 &gt; $2\nPop $2\nIntCmp $2 1 InstallCleanOk\nMessageBox MB_OK|MB_ICONEXCLAMATION|MB_TOPMOST \"Not enough disk space! (${DISKSPACE} KB needed)\" /SD IDOK\nQuit\nInstallCleanOk:\n</code></pre>\n<p>FunctionEnd</p>\n<p>Function .onInstSuccess<br>\nStrCmp $runprogram \"true\" 0 InstallSkipRunProgram<br>\nexec \"$INSTDIR${PROGRAMNAME}.exe\"<br>\nInstallSkipRunProgram:<br>\nFunctionEnd</p>\n<p>Function skipIfUpdate<br>\nStrCmp $isupdate \"true\" 0 +2<br>\nAbort<br>\nFunctionEnd</p>\n<p>Function .onGUIInit<br>\nSystem::Call \"User32::SetWindowPos(i, i, i, i, i, i, i) b ($HWNDPARENT, ${HWND_TOPMOST}, 0, 0, 0, 0, ${SWP_NOMOVE}|${SWP_NOSIZE})\"<br>\nFunctionEnd</p>\n<p>Function un.onGUIInit<br>\nSystem::Call \"User32::SetWindowPos(i, i, i, i, i, i, i) b ($HWNDPARENT, ${HWND_TOPMOST}, 0, 0, 0, 0, ${SWP_NOMOVE}|${SWP_NOSIZE})\"<br>\nFunctionEnd</p>\n<p>Section \"-hidden GridStream Player\"<br>\nSectionIn RO</p>\n<pre><code>IfFileExists \"$INSTDIR\\${PROGRAMNAME}.exe\" 0 InstallStarting\nRMDir /r /REBOOTOK \"$INSTDIR\"\nIfErrors 0 +3\nMessageBox MB_OK|MB_ICONEXCLAMATION|MB_TOPMOST \"Unable to remove old installation!\" /SD IDOK\nQuit\nInstallStarting:\n\nSetOutPath \"$INSTDIR\"\nFile /a /r \"${PROGRAMNAME}\\*.*\"\nWriteUninstaller \"$INSTDIR\\${PROGRAMNAME} Uninstaller.exe\"\n\n${GetSize} \"$INSTDIR\" \"/S=0K\" $0 $1 $2\nIntFmt $0 \"0x%08X\" $0\nWriteRegDWORD ${HKREGISTRY} ${UNINSTALLKEY} \"EstimatedSize\" \"$0\"\n\nWriteRegStr ${HKREGISTRY} ${UNINSTALLKEY} \"DisplayName\" \"${PROGRAMNAME}\"\nWriteRegStr ${HKREGISTRY} ${UNINSTALLKEY} \"Publisher\" \"${COMPANYNAME}\"\nWriteRegExpandStr ${HKREGISTRY} ${UNINSTALLKEY} \"UninstallString\" '\"$INSTDIR\\${PROGRAMNAME} Uninstaller.exe\"'\nWriteRegExpandStr ${HKREGISTRY} ${UNINSTALLKEY} \"InstallLocation\" \"$INSTDIR\"\nWriteRegExpandStr ${HKREGISTRY} ${UNINSTALLKEY} \"DisplayIcon\" \"$INSTDIR\\${PROGRAMNAME}.exe,0\"\nWriteRegStr ${HKREGISTRY} ${UNINSTALLKEY} \"DisplayVersion\" \"${FILEVERSION}\"\nWriteRegDWORD ${HKREGISTRY} ${UNINSTALLKEY} \"NoModify\" 1\nWriteRegDWORD ${HKREGISTRY} ${UNINSTALLKEY} \"NoRepair\" 1\nWriteRegStr ${HKREGISTRY} ${UNINSTALLKEY} \"HelpLink\" \"${COMPANYSITE}\"\nWriteRegStr ${HKREGISTRY} ${UNINSTALLKEY} \"ProductID\" \"${PROGRAMID}\"\n\nCreateShortCut \"$SMPROGRAMS\\${PROGRAMNAME}.lnk\" \"$INSTDIR\\${PROGRAMNAME}.exe\" \"\" \"$INSTDIR\\${PROGRAMNAME}.exe\" 0\n\nStrCmp $isupdate \"true\" 0 InstallSkipDesktopShortcutUpdate\nIfFileExists \"$DESKTOP\\${PROGRAMNAME}.lnk\" 0 InstallSkipDesktopShortcutUpdate\nCreateShortCut \"$DESKTOP\\${PROGRAMNAME}.lnk\" \"$INSTDIR\\${PROGRAMNAME}.exe\" \"\" \"$INSTDIR\\${PROGRAMNAME}.exe\" 0\nInstallSkipDesktopShortcutUpdate:\n</code></pre>\n<p>SectionEnd</p>\n<p>Section /o \"Create a desktop shortcut\"<br>\nCreateShortCut \"$DESKTOP${PROGRAMNAME}.lnk\" \"$INSTDIR${PROGRAMNAME}.exe\" \"\" \"$INSTDIR${PROGRAMNAME}.exe\" 0<br>\nSectionEnd</p>\n<p>Section /o \"Start program after installation\"<br>\nStrCpy $runprogram \"true\"<br>\nSectionEnd</p>\n<p>Function un.onInit<br>\nFunctionEnd</p>\n<p>Section \"Uninstall\"<br>\nUnInstall:</p>\n<pre><code>System::Call 'kernel32::OpenMutex(i 0x100000, b 0, t\"${PROGRAMID}\") i .r0 ?e'\nSystem::Call 'kernel32::CloseHandle(i $0)'\nPop $0\n${If} $0 == 127\n\tMessageBox MB_OKCANCEL|MB_ICONEXCLAMATION|MB_TOPMOST \"${PROGRAMNAME} is running. Please close it before continuing!\" /SD IDCANCEL IDOK UnInstallProgramNotRunning\n\tQuit\n\tUnInstallProgramNotRunning:\n\tGoto UnInstall\n${EndIf}\n\nIfFileExists \"$APPDATA\\${PROGRAMID}\" 0 UnInstallKeepPreferences\nMessageBox MB_YESNO|MB_ICONQUESTION|MB_TOPMOST \"Keep ${PROGRAMNAME} preferences?\" /SD IDYES IDYES UnInstallKeepPreferences\nRMDir /r /REBOOTOK \"$APPDATA\\${PROGRAMID}\"\nUnInstallKeepPreferences:\nRMDir /r /REBOOTOK \"$INSTDIR\"\nIfErrors 0 +3\nMessageBox MB_OK|MB_ICONEXCLAMATION|MB_TOPMOST \"Unable to remove installation!\" /SD IDOK\nQuit\nDelete \"$DESKTOP\\${PROGRAMNAME}.lnk\"\nDelete \"$SMPROGRAMS\\${PROGRAMNAME}.lnk\"\nDeleteRegKey ${HKREGISTRY} ${UNINSTALLKEY}\n</code></pre>\n</code><p><code>SectionEnd<br>\n</code></p>\n\n",
      "PostDate": "2017-06-02T22:25:24.7688164Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

{
  "Topic": {
    "TopicId": "amz3-wqxieo25sjlrnwlqw",
    "ForumId": "18",
    "Title": "INFOCOM-Style Inventory Command (Revisited)",
    "LastUpdated": "2021-05-29T20:14:05.200126Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "788e3351-1d3e-48b5-b87b-af6a20df5d23",
      "UserId": 518866,
      "Username": "K.V.",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a97688aadc8152436180b511021e94a7?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "![image](https://user-images.githubusercontent.com/30656341/120083670-f187d780-c08f-11eb-9252-10db7e6e982c.png)\r\n\r\n\r\n---\r\n## New Command\r\n\r\n```\r\n<command name=\"custom_inventory_cmd\">\r\n    <pattern type=\"string\">^i$|^inv$|^inventory$</pattern>\r\n    <synonyms type=\"stringlist\">\r\n      <value>i</value>\r\n      <value>inv</value>\r\n      <value>inventory</value>\r\n    </synonyms>\r\n    <script>\r\n      list = FormatObjectList (Template (\"CarryingListHeader\"), game.pov, Template (\"And\"), \".\")\r\n      if (list = \"\") {\r\n        msg (\"You are empty-handed.\")\r\n      }\r\n      else {\r\n        CustomInventory\r\n      }\r\n    </script>\r\n  </command>\r\n```\r\n\r\n\r\n---\r\n## New Functions\r\n\r\n```\r\n<function name=\"CustomInventory\"><![CDATA[\r\n    msg (\"You have:\")\r\n    stuff = GetDirectChildren(game.pov)\r\n    stuff = ListExclude(stuff, hangover)\r\n    stuff = ListExclude (stuff, no_tea)\r\n    indents = 1\r\n    foreach (o, stuff) {\r\n      worn = \"\"\r\n      if (GetBoolean(o, \"worn\")) {\r\n        worn = \" (being worn)\"\r\n      }\r\n      msg (Spaces(indents) + GetDisplayName(o) + worn)\r\n      PrintContentsWithIndents (o, indents)\r\n    }\r\n  ]]></function>\r\n```\r\n\r\n```\r\n  <function name=\"PrintContentsWithIndents \" parameters=\"o, indents\"><![CDATA[\r\n    if (GetBoolean (o, \"feature_container\") and (GetBoolean(o, \"isopen\") or GetBoolean (o, \"transparent\"))) {\r\n      stuff = GetDirectChildren (o)\r\n      stuff = ListExclude(stuff, FilterByAttribute (stuff, \"scenery\", true))\r\n      stuff = FilterByAttribute (stuff, \"visible\", true)\r\n      if (ListCount (stuff) > 0) {\r\n        msg (Spaces(indents) + \"It looks like \" + GetDefiniteName(o) + \" contains:\")\r\n        indents = indents + 1\r\n        foreach (obj, stuff) {\r\n          msg (Spaces(indents) + GetDisplayName(obj))\r\n          PrintContentsWithIndents (obj, indents)\r\n        }\r\n      }\r\n    }\r\n  ]]></function>\r\n```\r\n\r\n---\r\n## Modified functions\r\n\r\n```\r\n<function name=\"_SetGarmentAlias\" parameters=\"object\"><![CDATA[\r\n    ext = GetDescriptor(object)\r\n    // object.alias = object.display + ext\r\n    if (HasString(object, \"listalias\")) {\r\n      if (StartsWith(object.listalias, \"<span style=\\\"color:blue\\\">\")) {\r\n        object.listalias = null\r\n        do (object, \"colourmylistalias\")\r\n      }\r\n      else {\r\n        object.listalias = object.original_listalias + ext\r\n      }\r\n    }\r\n  ]]></function>\r\n```\r\n\r\n```\r\n<function name=\"GetDefiniteName\" parameters=\"obj\" type=\"string\">\r\n    result = GetDisplayAlias(obj)\r\n    if (not DoesInherit(obj, \"namedmale\") and not DoesInherit(obj, \"namedfemale\") and not result = \"me\" and not result = \"you\" and GetBoolean(obj, \"usedefaultprefix\")) {\r\n      result = \"the \" + result\r\n    }\r\n    return (result)\r\n  </function>\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p><img src=\"https://user-images.githubusercontent.com/30656341/120083670-f187d780-c08f-11eb-9252-10db7e6e982c.png\" alt=\"image\"></p>\n<hr>\n<h2>New Command</h2>\n<pre><code>&lt;command name=\"custom_inventory_cmd\"&gt;\n    &lt;pattern type=\"string\"&gt;^i$|^inv$|^inventory$&lt;/pattern&gt;\n    &lt;synonyms type=\"stringlist\"&gt;\n      &lt;value&gt;i&lt;/value&gt;\n      &lt;value&gt;inv&lt;/value&gt;\n      &lt;value&gt;inventory&lt;/value&gt;\n    &lt;/synonyms&gt;\n    &lt;script&gt;\n      list = FormatObjectList (Template (\"CarryingListHeader\"), game.pov, Template (\"And\"), \".\")\n      if (list = \"\") {\n        msg (\"You are empty-handed.\")\n      }\n      else {\n        CustomInventory\n      }\n    &lt;/script&gt;\n  &lt;/command&gt;\n</code></pre>\n<hr>\n<h2>New Functions</h2>\n<pre><code>&lt;function name=\"CustomInventory\"&gt;&lt;![CDATA[\n    msg (\"You have:\")\n    stuff = GetDirectChildren(game.pov)\n    stuff = ListExclude(stuff, hangover)\n    stuff = ListExclude (stuff, no_tea)\n    indents = 1\n    foreach (o, stuff) {\n      worn = \"\"\n      if (GetBoolean(o, \"worn\")) {\n        worn = \" (being worn)\"\n      }\n      msg (Spaces(indents) + GetDisplayName(o) + worn)\n      PrintContentsWithIndents (o, indents)\n    }\n  ]]&gt;&lt;/function&gt;\n</code></pre>\n<pre><code>  &lt;function name=\"PrintContentsWithIndents \" parameters=\"o, indents\"&gt;&lt;![CDATA[\n    if (GetBoolean (o, \"feature_container\") and (GetBoolean(o, \"isopen\") or GetBoolean (o, \"transparent\"))) {\n      stuff = GetDirectChildren (o)\n      stuff = ListExclude(stuff, FilterByAttribute (stuff, \"scenery\", true))\n      stuff = FilterByAttribute (stuff, \"visible\", true)\n      if (ListCount (stuff) &gt; 0) {\n        msg (Spaces(indents) + \"It looks like \" + GetDefiniteName(o) + \" contains:\")\n        indents = indents + 1\n        foreach (obj, stuff) {\n          msg (Spaces(indents) + GetDisplayName(obj))\n          PrintContentsWithIndents (obj, indents)\n        }\n      }\n    }\n  ]]&gt;&lt;/function&gt;\n</code></pre>\n<hr>\n<h2>Modified functions</h2>\n<pre><code>&lt;function name=\"_SetGarmentAlias\" parameters=\"object\"&gt;&lt;![CDATA[\n    ext = GetDescriptor(object)\n    // object.alias = object.display + ext\n    if (HasString(object, \"listalias\")) {\n      if (StartsWith(object.listalias, \"&lt;span style=\\\"color:blue\\\"&gt;\")) {\n        object.listalias = null\n        do (object, \"colourmylistalias\")\n      }\n      else {\n        object.listalias = object.original_listalias + ext\n      }\n    }\n  ]]&gt;&lt;/function&gt;\n</code></pre>\n<pre><code>&lt;function name=\"GetDefiniteName\" parameters=\"obj\" type=\"string\"&gt;\n    result = GetDisplayAlias(obj)\n    if (not DoesInherit(obj, \"namedmale\") and not DoesInherit(obj, \"namedfemale\") and not result = \"me\" and not result = \"you\" and GetBoolean(obj, \"usedefaultprefix\")) {\n      result = \"the \" + result\n    }\n    return (result)\n  &lt;/function&gt;\n</code></pre>\n\n",
      "PostDate": "2021-05-29T20:14:05.200126Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

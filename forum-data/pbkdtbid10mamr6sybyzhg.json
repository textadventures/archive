{
  "Topic": {
    "TopicId": "pbkdtbid10mamr6sybyzhg",
    "ForumId": "18",
    "Title": "Quest - Online SAVE Command (FIX)",
    "LastUpdated": "2018-04-15T20:15:45.4611466Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "c22147e9-db72-4c9f-bd6a-e25b607d8f78",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I am posting this again because I've had a few people message me concerning this recently.\r\n\r\n---\r\nWhen saving a game online, the text will not be saved when using the SAVE command. (Everything works fine when you click the 'Save' button, though.)\r\n\r\nThis is a fix. When entering SAVE, this will check for the online player, then it will call the appropriate save function. This way, the text will be saved either way.  (I got the ```OnlineCheck``` code from Pixie.)\r\n\r\n```\r\n  <function name=\"OnlineCheck\" type=\"boolean\"><![CDATA[\r\n    s = \" \" + 0.1\r\n    return (Instr(s, \",\") > 0)\r\n  ]]></function>\r\n  ```\r\n  ```\r\n  <command name=\"savecmd\">\r\n    <pattern>save</pattern>\r\n    <script><![CDATA[\r\n      if(OnlineCheck()){\r\n        JS.saveGame()\r\n      }\r\n      else{\r\n        request (RequestSave, \"\")\r\n      }\r\n    ]]></script>\r\n  </command>\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p>I am posting this again because I've had a few people message me concerning this recently.</p>\n<hr>\n<p>When saving a game online, the text will not be saved when using the SAVE command. (Everything works fine when you click the 'Save' button, though.)</p>\n<p>This is a fix. When entering SAVE, this will check for the online player, then it will call the appropriate save function. This way, the text will be saved either way.  (I got the <code>OnlineCheck</code> code from Pixie.)</p>\n<pre><code>  &lt;function name=\"OnlineCheck\" type=\"boolean\"&gt;&lt;![CDATA[\n    s = \" \" + 0.1\n    return (Instr(s, \",\") &gt; 0)\n  ]]&gt;&lt;/function&gt;\n</code></pre>\n<pre><code>&lt;command name=\"savecmd\"&gt;\n  &lt;pattern&gt;save&lt;/pattern&gt;\n  &lt;script&gt;&lt;![CDATA[\n    if(OnlineCheck()){\n      JS.saveGame()\n    }\n    else{\n      request (RequestSave, \"\")\n    }\n  ]]&gt;&lt;/script&gt;\n&lt;/command&gt;\n</code></pre>\n\n",
      "PostDate": "2018-04-15T20:15:45.4611466Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "419e644a-fe31-4b31-be61-b580e94c7fb8",
      "UserId": 924,
      "Username": "Pertex",
      "AvatarUrl": "https://secure.gravatar.com/avatar/4cc1e52f99452e841ecf4cbee9eadde9?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "will this be corrected in the next Quest version?",
      "EditableFormat": "markdown",
      "HTML": "<p>will this be corrected in the next Quest version?</p>\n\n",
      "PostDate": "2018-04-16T11:19:26.1469932Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "90200e5a-aac3-4d2e-892a-fd9438bfdbc5",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I had no idea this was an issue.\r\n\r\nI am slightly worried about `OnlineCheck`; it is basically a hack, being based on bizarre behaviour in the web player that ideally would get corrected. I am sure there must be some other way to check, perhaps some JavaScript variable we could set in the web player and see if it exists. These things tend to be hard to test.",
      "EditableFormat": "markdown",
      "HTML": "<p>I had no idea this was an issue.</p>\n<p>I am slightly worried about <code>OnlineCheck</code>; it is basically a hack, being based on bizarre behaviour in the web player that ideally would get corrected. I am sure there must be some other way to check, perhaps some JavaScript variable we could set in the web player and see if it exists. These things tend to be hard to test.</p>\n\n",
      "PostDate": "2018-04-16T13:20:35.6952864Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "6204b8f5-d48c-46bb-bc8f-a16690dccc21",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "1\\. There is a  built-in JS boolean variable in playerweb.js called  ```webPlayer```.\r\n\r\n2\\. When clicking the save button online, it runs this JS:\r\n\r\n```\r\nsaveGame();\r\nafterSave();\r\n```\r\n\r\n\r\n---\r\nUsing that stuff, this does the job:\r\n```\r\n  <command name=\"save_cmd\">\r\n    <pattern>save</pattern>\r\n    <script>\r\n      game.notarealturn = true\r\n      game.suppressturnscripts = true\r\n      JS.eval (\"if(webPlayer){saveGame(); afterSave();scrollToEnd();}else{ASLEvent('DoLocalSave', '');};\")\r\n    </script>\r\n  </command>\r\n```\r\n```\r\n  <function name=\"DoLocalSave\" parameters=\"bool\">\r\n    request (RequestSave, \"\")\r\n  </function>\r\n```\r\n\r\n---\r\nTester:\r\n\r\nhttp://textadventures.co.uk/games/view/dwifgxmjakwcsk2zotidiw/online-saves",
      "EditableFormat": "markdown",
      "HTML": "<p>1. There is a  built-in JS boolean variable in playerweb.js called  <code>webPlayer</code>.</p>\n<p>2. When clicking the save button online, it runs this JS:</p>\n<pre><code>saveGame();\nafterSave();\n</code></pre>\n<hr>\n<p>Using that stuff, this does the job:</p>\n<pre><code>  &lt;command name=\"save_cmd\"&gt;\n    &lt;pattern&gt;save&lt;/pattern&gt;\n    &lt;script&gt;\n      game.notarealturn = true\n      game.suppressturnscripts = true\n      JS.eval (\"if(webPlayer){saveGame(); afterSave();scrollToEnd();}else{ASLEvent('DoLocalSave', '');};\")\n    &lt;/script&gt;\n  &lt;/command&gt;\n</code></pre>\n<pre><code>  &lt;function name=\"DoLocalSave\" parameters=\"bool\"&gt;\n    request (RequestSave, \"\")\n  &lt;/function&gt;\n</code></pre>\n<hr>\n<p>Tester:</p>\n<p>http://textadventures.co.uk/games/view/dwifgxmjakwcsk2zotidiw/online-saves</p>\n\n",
      "PostDate": "2018-04-16T15:07:19.5255861Z",
      "LastEditDate": "2018-04-16T23:03:09.7506149Z",
      "link": null
    },
    {
      "PostId": "0c1606ff-f916-45ee-9e60-97cc09d86d61",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Whoops.  I was mistaken.  The ```webPlayer``` variable is declared in **WebPlayer/player.js** on line 2, not in **playerweb.js**.",
      "EditableFormat": "markdown",
      "HTML": "<p>Whoops.  I was mistaken.  The <code>webPlayer</code> variable is declared in <strong>WebPlayer/player.js</strong> on line 2, not in <strong>playerweb.js</strong>.</p>\n\n",
      "PostDate": "2018-04-16T22:54:58.8638808Z",
      "LastEditDate": "2018-04-17T11:47:09.6760855Z",
      "link": null
    },
    {
      "PostId": "92de6a1c-30a0-4710-8a3e-b0c2e6524498",
      "UserId": 924,
      "Username": "Pertex",
      "AvatarUrl": "https://secure.gravatar.com/avatar/4cc1e52f99452e841ecf4cbee9eadde9?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "What exactly is'webplayer'? Do you want to check if you have an online connection or if the mobile player is used? I have written two Javascript functions for it:\r\n```\r\nfunction testOnline() {\r\n    var check = false;\r\n\tif( window.location.hostname != \"local\") {\r\n\t\tcheck=true;\r\n\t} \r\n\tASLEvent(\"checkOnline\", check);\r\n\treturn false;\r\n}\r\n\r\nfunction testMobile() {\r\n    var check = false;\r\n    var elem = document.getElementById('tabButton');\r\n    if (elem!=null){\r\n      check=true;\r\n    }\r\n    ASLEvent(\"checkMobile\", check); \r\n    return false;\r\n}\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p>What exactly is'webplayer'? Do you want to check if you have an online connection or if the mobile player is used? I have written two Javascript functions for it:</p>\n<pre><code>function testOnline() {\n    var check = false;\n\tif( window.location.hostname != \"local\") {\n\t\tcheck=true;\n\t} \n\tASLEvent(\"checkOnline\", check);\n\treturn false;\n}\n\nfunction testMobile() {\n    var check = false;\n    var elem = document.getElementById('tabButton');\n    if (elem!=null){\n      check=true;\n    }\n    ASLEvent(\"checkMobile\", check); \n    return false;\n}\n</code></pre>\n\n",
      "PostDate": "2018-04-17T07:27:34.089418Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "6ec07b57-7a55-499e-9891-2a39a58bb042",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> What exactly is'webplayer'? \r\n\r\n```webPlayer``` is an existing JS boolean variable in **WebPlayer/player.js** on line 2.  \r\n\r\nIf the player is playing online, ```webPlayer``` will be set to \"True\", so the ```testOnline()``` function could just be:```function testOnline(){return webPlayer;}```.\r\n\r\nI once set up a JS function which set a game attribute the first time SAVE was entered.  This only ran once.  After that, the scripts checked ```game.isonline``` instead of using JS to check ```webPlayer```.  This was error-prone, because sometimes things go wrong during the initial check (remember that we ARE talking about the web player, which is known to be quite error-prone).  I found that using JS to check for ```webPlayer``` before every save is the safest way to do this.  (I've been adding this to my games for about 5 months.)\r\n\r\n---\r\nRecently, Dcoder was having problems with doubles online.  Apparently, the ```.``` is changed to a ```,``` when a double is converted to a string via concatenation.  Upon seeing this, Pixie (jokingly) pointed out that we could do this:\r\n\r\n```\r\n  <function name=\"OnlineCheck\" type=\"boolean\"><![CDATA[\r\n    s = \" \" + 0.1\r\n    return (Instr(s, \",\") > 0)\r\n  ]]></function>\r\n```\r\n\r\nI laughed at the time, but I've been using this instead of running a JS function (which calls an ASLEvent that calls a Save request) ever since, and it always works correctly. \r\n\r\n\r\n---\r\n> if the mobile player is used?\r\n\r\nThat ```testMobile()``` function looks a lot like this:\r\nhttp://textadventures.co.uk/forum/samples/topic/bzmjia3zd0qtrmaw72tkxq/check-if-player-is-on-a-mobile-device\r\n\r\nA pull request which includes the JS function ```isMobilePlayer()``` was recently merged.  So, Quest 5.8 will have this feature already, unless something is changed before it is released.\r\n\r\nI honestly think ```testMobile()``` may be superior to ```isMobilePlayer()```, by the way.  (Both work when tested, though.)\r\n\r\n---\r\n...but it doesn't matter if the game is being played in the mobile browser as far as entering SAVE is concerned.  It only matters if the player is using the desktop player or the web player.\r\n\r\nIf the player is online, **WebPlayer/player.js** will be loaded and ```webPlayer``` will be ```True```.\r\n\r\n---\r\n[This code](http://textadventures.co.uk/forum/samples/topic/pbkdtbid10mamr6sybyzhg/quest-online-save-command-fix#6204b8f5-d48c-46bb-bc8f-a16690dccc21) works (you can play the test game to which I linked to test it out), but I bet the code posted by Pertex works just as well.\r\n\r\nIt doesn't matter to me which code is used, as long as something is done to fix the issue.  [INSERT SMILEY FACE HERE]",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>What exactly is'webplayer'?</p>\n</blockquote>\n<p><code>webPlayer</code> is an existing JS boolean variable in <strong>WebPlayer/player.js</strong> on line 2.</p>\n<p>If the player is playing online, <code>webPlayer</code> will be set to \"True\", so the <code>testOnline()</code> function could just be:<code>function testOnline(){return webPlayer;}</code>.</p>\n<p>I once set up a JS function which set a game attribute the first time SAVE was entered.  This only ran once.  After that, the scripts checked <code>game.isonline</code> instead of using JS to check <code>webPlayer</code>.  This was error-prone, because sometimes things go wrong during the initial check (remember that we ARE talking about the web player, which is known to be quite error-prone).  I found that using JS to check for <code>webPlayer</code> before every save is the safest way to do this.  (I've been adding this to my games for about 5 months.)</p>\n<hr>\n<p>Recently, Dcoder was having problems with doubles online.  Apparently, the <code>.</code> is changed to a <code>,</code> when a double is converted to a string via concatenation.  Upon seeing this, Pixie (jokingly) pointed out that we could do this:</p>\n<pre><code>  &lt;function name=\"OnlineCheck\" type=\"boolean\"&gt;&lt;![CDATA[\n    s = \" \" + 0.1\n    return (Instr(s, \",\") &gt; 0)\n  ]]&gt;&lt;/function&gt;\n</code></pre>\n<p>I laughed at the time, but I've been using this instead of running a JS function (which calls an ASLEvent that calls a Save request) ever since, and it always works correctly.</p>\n<hr>\n<blockquote>\n<p>if the mobile player is used?</p>\n</blockquote>\n<p>That <code>testMobile()</code> function looks a lot like this:<br>\nhttp://textadventures.co.uk/forum/samples/topic/bzmjia3zd0qtrmaw72tkxq/check-if-player-is-on-a-mobile-device</p>\n<p>A pull request which includes the JS function <code>isMobilePlayer()</code> was recently merged.  So, Quest 5.8 will have this feature already, unless something is changed before it is released.</p>\n<p>I honestly think <code>testMobile()</code> may be superior to <code>isMobilePlayer()</code>, by the way.  (Both work when tested, though.)</p>\n<hr>\n<p>...but it doesn't matter if the game is being played in the mobile browser as far as entering SAVE is concerned.  It only matters if the player is using the desktop player or the web player.</p>\n<p>If the player is online, <strong>WebPlayer/player.js</strong> will be loaded and <code>webPlayer</code> will be <code>True</code>.</p>\n<hr>\n<p><a href=\"http://textadventures.co.uk/forum/samples/topic/pbkdtbid10mamr6sybyzhg/quest-online-save-command-fix#6204b8f5-d48c-46bb-bc8f-a16690dccc21\">This code</a> works (you can play the test game to which I linked to test it out), but I bet the code posted by Pertex works just as well.</p>\n<p>It doesn't matter to me which code is used, as long as something is done to fix the issue.  [INSERT SMILEY FACE HERE]</p>\n\n",
      "PostDate": "2018-04-17T12:16:38.0809727Z",
      "LastEditDate": "2018-04-17T13:03:36.8441961Z",
      "link": null
    },
    {
      "PostId": "a5667454-b723-4ca8-b077-d4dd0ce6cd4c",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "The code in this post is not so good.\r\n\r\nSee my next post.\r\n\r\n---\r\n<details><summary>OLD CODE</summary>\r\n\r\nOf course, the best solution would probably be adding this to **WebPlayer/Mobile/playermobile.js**:\r\n\r\n```\r\nvar mobilePlayer = true;\r\n```\r\n\r\n\r\nThen we could just do:\r\n\r\n```\r\nif (webPlayer){\r\n  console.log(\"The player is playing online!\");\r\n  if (mobilePlayer){\r\n    console.log(\"...and the player is on a mobile device, so no panes or location bar!\");\r\n  }\r\n}else{\r\n  console.log(\"The player is using the desktop version of Quest.  (Thank goodness!)\");\r\n}\r\n```\r\n\r\n---\r\nThe ```webPlayer``` variable is already in the code.\r\n\r\nHere's a test game to test that out:\r\n\r\n\r\nhttp://textadventures.co.uk/games/view/wvlh6nzhq0ubvwdjtgnnua/mobile-play-sound\r\n\r\n```\r\n<!--Saved by Quest 5.7.6615.29455-->\r\n<asl version=\"550\">\r\n  <include ref=\"English.aslx\" />\r\n  <include ref=\"Core.aslx\" />\r\n  <game name=\"Check for webPlayer\">\r\n    <gameid>f88391ff-8cb4-4515-b525-c90dce715193</gameid>\r\n    <version>1.0</version>\r\n    <firstpublished>2018</firstpublished>\r\n    <menufont>Georgia, serif</menufont>\r\n  </game>\r\n  <object name=\"room\">\r\n    <inherit name=\"editor_room\" />\r\n    <description><![CDATA[{command: webPlayer check}<br/><br/><hr/><br/><code><br/>JS.eval (\"webPlayer ? alert('You are playing online.') : alert('You are using the desktop player.');\")<br/></code><br/><hr/>]]></description>\r\n    <object name=\"player\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"editor_player\" />\r\n    </object>\r\n  </object>\r\n  <command name=\"webplayer_check_cmd\">\r\n    <pattern>webplayer;web player;player;web;webplayer check;web player check;test;testing</pattern>\r\n    <script>\r\n      JS.eval (\"webPlayer ? alert('You are playing online.') : alert('You are using the desktop player.');\")\r\n    </script>\r\n  </command>\r\n</asl>\r\n```\r\n\r\n</details>",
      "EditableFormat": "markdown",
      "HTML": "<p>The code in this post is not so good.</p>\n<p>See my next post.</p>\n<hr>\n<details><summary>OLD CODE</summary>\n<p>Of course, the best solution would probably be adding this to <strong>WebPlayer/Mobile/playermobile.js</strong>:</p>\n<pre><code>var mobilePlayer = true;\n</code></pre>\n<p>Then we could just do:</p>\n<pre><code>if (webPlayer){\n  console.log(\"The player is playing online!\");\n  if (mobilePlayer){\n    console.log(\"...and the player is on a mobile device, so no panes or location bar!\");\n  }\n}else{\n  console.log(\"The player is using the desktop version of Quest.  (Thank goodness!)\");\n}\n</code></pre>\n<hr>\n<p>The <code>webPlayer</code> variable is already in the code.</p>\n<p>Here's a test game to test that out:</p>\n<p>http://textadventures.co.uk/games/view/wvlh6nzhq0ubvwdjtgnnua/mobile-play-sound</p>\n<pre><code>&lt;!--Saved by Quest 5.7.6615.29455--&gt;\n&lt;asl version=\"550\"&gt;\n  &lt;include ref=\"English.aslx\" /&gt;\n  &lt;include ref=\"Core.aslx\" /&gt;\n  &lt;game name=\"Check for webPlayer\"&gt;\n    &lt;gameid&gt;f88391ff-8cb4-4515-b525-c90dce715193&lt;/gameid&gt;\n    &lt;version&gt;1.0&lt;/version&gt;\n    &lt;firstpublished&gt;2018&lt;/firstpublished&gt;\n    &lt;menufont&gt;Georgia, serif&lt;/menufont&gt;\n  &lt;/game&gt;\n  &lt;object name=\"room\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;description&gt;&lt;![CDATA[{command: webPlayer check}&lt;br/&gt;&lt;br/&gt;&lt;hr/&gt;&lt;br/&gt;&lt;code&gt;&lt;br/&gt;JS.eval (\"webPlayer ? alert('You are playing online.') : alert('You are using the desktop player.');\")&lt;br/&gt;&lt;/code&gt;&lt;br/&gt;&lt;hr/&gt;]]&gt;&lt;/description&gt;\n    &lt;object name=\"player\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"editor_player\" /&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n  &lt;command name=\"webplayer_check_cmd\"&gt;\n    &lt;pattern&gt;webplayer;web player;player;web;webplayer check;web player check;test;testing&lt;/pattern&gt;\n    &lt;script&gt;\n      JS.eval (\"webPlayer ? alert('You are playing online.') : alert('You are using the desktop player.');\")\n    &lt;/script&gt;\n  &lt;/command&gt;\n&lt;/asl&gt;\n</code></pre>\n</details>\n\n",
      "PostDate": "2018-04-25T05:47:37.9590265Z",
      "LastEditDate": "2018-04-25T06:32:36.5122Z",
      "link": null
    },
    {
      "PostId": "67ec4fca-8b8c-4463-abf6-048e3d6e2af9",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "**UPDATE**\r\n\r\nI don't know if I've said this already (and I'm too lazy to ready through my posts), but the best thing to do would be adding ```var mobilePlayer = true;```to **WebPlayer/Mobile/mobileplayer.js**\r\n\r\n\r\nThe most efficient way I've found beyond that change to the source code is described below.\r\n\r\n---\r\n\r\nI added code (stolen from Pertex) to check for the mobile player.\r\n\r\nThis will return true if the mobile player setup is loaded ```(typeof($('#tabButton').html()) != 'undefined')```\r\n\r\nI think this might be the most efficient version of a function to check for the mobile player's display settings being set up (unless ```var mobilePlayer = true;``` were simply added to **WebPlayer/Mobile/mobileplayer.js**):\r\n\r\n```\r\n function mobilePlayerCheck(){\r\n    return (typeof($('#tabButton').html()) != 'undefined');\r\n};\r\n```\r\n\r\n---\r\nI updated the test game:\r\nhttp://textadventures.co.uk/games/view/dobiqko6m0enqgfs8zxefw/check-for-webplayer\r\n\r\nIt works correctly on all of my devices.\r\n```\r\n<!--Saved by Quest 5.7.6615.29455-->\r\n<asl version=\"550\">\r\n  <include ref=\"English.aslx\" />\r\n  <include ref=\"Core.aslx\" />\r\n  <game name=\"Check for webPlayer\">\r\n    <gameid>f88391ff-8cb4-4515-b525-c90dce715193</gameid>\r\n    <version>3.0</version>\r\n    <firstpublished>2018</firstpublished>\r\n    <menufont>Georgia, serif</menufont>\r\n  </game>\r\n  <object name=\"room\">\r\n    <inherit name=\"editor_room\" />\r\n    <description><![CDATA[{command: webPlayer check}<br/><br/><hr/><code>JS.eval (\"webPlayer ? addTextAndScroll('You are playing online.') : addTextAndScroll('You are using the desktop player.');\")</code><hr/><br/><br/>{command: mobilePlayer check}<br/><br/><hr/><code>JS.eval (\"if(typeof(mobilePlayerCheck)=='undefined'){ function mobilePlayerCheck(){return (typeof($('#tabButton').html()) != 'undefined');}}\")<br/>JS.eval (\"mobilePlayerCheck() ? addTextAndScroll('You are using a mobile device.') : addTextAndScroll('You are not using a mobile device.');\")</code><hr/>]]></description>\r\n    <object name=\"player\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"editor_player\" />\r\n    </object>\r\n  </object>\r\n  <command name=\"webplayer_check_cmd\">\r\n    <pattern>webplayer;web player;player;web;webplayer check;web player check;test;testing</pattern>\r\n    <script>\r\n      JS.eval (\"webPlayer ? addTextAndScroll('You are playing online.') : addTextAndScroll('You are using the desktop player.');\")\r\n    </script>\r\n  </command>\r\n  <command name=\"mobile_player_check\">\r\n    <pattern>mobile player;mobile check;mobileplayer;mobileplayer check;testing;test</pattern>\r\n    <script>\r\n      JS.eval (\"if(typeof(mobilePlayerCheck)=='undefined'){ function mobilePlayerCheck(){return (typeof($('#tabButton').html()) != 'undefined');}}\")\r\n      JS.eval (\"mobilePlayerCheck() ? addTextAndScroll('You are using a mobile device.') : addTextAndScroll('You are not using a mobile device.');\")\r\n    </script>\r\n  </command>\r\n</asl>\r\n\r\n```\r\n\r\n---\r\nThe only catch would be a player who opened the game in a mobile browser, opened the settings, then switched to desktop view.\r\n\r\nThe mobile browser rules would still apply, which would effect sounds the text formatting (and who knows what else).\r\n\r\nI've tried to do this on my tablet before, and it makes it very difficult to play a game.  Every time you send a command, it zooms in on the new text output and you have to zoom back out to see the entire page again. \r\n\r\nI think this would be acceptable.  If someone is switching to desktop view in a mobile browser, they're asking for trouble anyway!",
      "EditableFormat": "markdown",
      "HTML": "<p><strong>UPDATE</strong></p>\n<p>I don't know if I've said this already (and I'm too lazy to ready through my posts), but the best thing to do would be adding <code>var mobilePlayer = true;</code>to <strong>WebPlayer/Mobile/mobileplayer.js</strong></p>\n<p>The most efficient way I've found beyond that change to the source code is described below.</p>\n<hr>\n<p>I added code (stolen from Pertex) to check for the mobile player.</p>\n<p>This will return true if the mobile player setup is loaded <code>(typeof($('#tabButton').html()) != 'undefined')</code></p>\n<p>I think this might be the most efficient version of a function to check for the mobile player's display settings being set up (unless <code>var mobilePlayer = true;</code> were simply added to <strong>WebPlayer/Mobile/mobileplayer.js</strong>):</p>\n<pre><code> function mobilePlayerCheck(){\n    return (typeof($('#tabButton').html()) != 'undefined');\n};\n</code></pre>\n<hr>\n<p>I updated the test game:<br>\nhttp://textadventures.co.uk/games/view/dobiqko6m0enqgfs8zxefw/check-for-webplayer</p>\n<p>It works correctly on all of my devices.</p>\n<pre><code>&lt;!--Saved by Quest 5.7.6615.29455--&gt;\n&lt;asl version=\"550\"&gt;\n  &lt;include ref=\"English.aslx\" /&gt;\n  &lt;include ref=\"Core.aslx\" /&gt;\n  &lt;game name=\"Check for webPlayer\"&gt;\n    &lt;gameid&gt;f88391ff-8cb4-4515-b525-c90dce715193&lt;/gameid&gt;\n    &lt;version&gt;3.0&lt;/version&gt;\n    &lt;firstpublished&gt;2018&lt;/firstpublished&gt;\n    &lt;menufont&gt;Georgia, serif&lt;/menufont&gt;\n  &lt;/game&gt;\n  &lt;object name=\"room\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;description&gt;&lt;![CDATA[{command: webPlayer check}&lt;br/&gt;&lt;br/&gt;&lt;hr/&gt;&lt;code&gt;JS.eval (\"webPlayer ? addTextAndScroll('You are playing online.') : addTextAndScroll('You are using the desktop player.');\")&lt;/code&gt;&lt;hr/&gt;&lt;br/&gt;&lt;br/&gt;{command: mobilePlayer check}&lt;br/&gt;&lt;br/&gt;&lt;hr/&gt;&lt;code&gt;JS.eval (\"if(typeof(mobilePlayerCheck)=='undefined'){ function mobilePlayerCheck(){return (typeof($('#tabButton').html()) != 'undefined');}}\")&lt;br/&gt;JS.eval (\"mobilePlayerCheck() ? addTextAndScroll('You are using a mobile device.') : addTextAndScroll('You are not using a mobile device.');\")&lt;/code&gt;&lt;hr/&gt;]]&gt;&lt;/description&gt;\n    &lt;object name=\"player\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"editor_player\" /&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n  &lt;command name=\"webplayer_check_cmd\"&gt;\n    &lt;pattern&gt;webplayer;web player;player;web;webplayer check;web player check;test;testing&lt;/pattern&gt;\n    &lt;script&gt;\n      JS.eval (\"webPlayer ? addTextAndScroll('You are playing online.') : addTextAndScroll('You are using the desktop player.');\")\n    &lt;/script&gt;\n  &lt;/command&gt;\n  &lt;command name=\"mobile_player_check\"&gt;\n    &lt;pattern&gt;mobile player;mobile check;mobileplayer;mobileplayer check;testing;test&lt;/pattern&gt;\n    &lt;script&gt;\n      JS.eval (\"if(typeof(mobilePlayerCheck)=='undefined'){ function mobilePlayerCheck(){return (typeof($('#tabButton').html()) != 'undefined');}}\")\n      JS.eval (\"mobilePlayerCheck() ? addTextAndScroll('You are using a mobile device.') : addTextAndScroll('You are not using a mobile device.');\")\n    &lt;/script&gt;\n  &lt;/command&gt;\n&lt;/asl&gt;\n\n</code></pre>\n<hr>\n<p>The only catch would be a player who opened the game in a mobile browser, opened the settings, then switched to desktop view.</p>\n<p>The mobile browser rules would still apply, which would effect sounds the text formatting (and who knows what else).</p>\n<p>I've tried to do this on my tablet before, and it makes it very difficult to play a game.  Every time you send a command, it zooms in on the new text output and you have to zoom back out to see the entire page again.</p>\n<p>I think this would be acceptable.  If someone is switching to desktop view in a mobile browser, they're asking for trouble anyway!</p>\n\n",
      "PostDate": "2018-04-25T06:30:51.3930224Z",
      "LastEditDate": "2018-04-25T07:03:16.8010444Z",
      "link": null
    }
  ]
}

{
  "Topic": {
    "TopicId": "bs3pqmygmes9x0qo3g_cdw",
    "ForumId": "10",
    "Title": "My first move in the game is messing up the map",
    "LastUpdated": "2019-12-16T04:24:45.74531Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "adfcec1b-2057-4b66-9091-88637d142a61",
      "UserId": 451204,
      "Username": "wdalphin",
      "AvatarUrl": "https://i.imgur.com/gIhq4Adb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Hi again,\r\n\r\nSo I've got the map active, and have been adjusting the size and positions of the rooms so they look more like the layout of a house. Rather than stepping from one plain-looking square to another, you go from a narrow hallway into a larger room. Everything was fine, but somewhere along the way, something got mucked up.\r\n\r\nWhen I start now, I'm in a narrow, 1x3 hallway. If I move east, I move into a 2x2 square 1 step north of the hallway. If I move west, I go into a 4x4 large room. If I go south, I go into another 4x4 large room. Everything was working fine, with lines marking the walls and such...\r\n\r\nbut for some reason now if I move west first, it seems that the large room to the west erases my 1x3 hallway. If I go back east, my little yellow marker dot is in a black, empty space rather than a white room (this is white on black). Every other room lines up correctly from this point on, but my starting hallway is essentially gone. This **ONLY** happens if my first move is west. If I move east, south, out, etc, the 1x3 room remains visible and the map builds up like it should. I can even go west and the 4x4 room does not screw up the rest of the map. **This only happens if my first move is into the west room**. I can look, search, so any sort of things I want, but the moment I move out of the room, if it's to the west, I lose the 1x3 starter room.\r\n\r\nAnd I have no idea why.\r\n\r\nI've checked the exits, there are no special scripts related to going west first. The fact that I can go in there after going anywhere else and it doesn't muck up has me utterly baffled.\r\n\r\nBasically, THIS is what it's supposed to look like\r\nVVVVVVVVVVVV\r\n\r\n╔════╦■╦══╗\r\n║                               ║\r\n║              ║   ╠══╝\r\n║              ║   ║\r\n╠═       ═╣   ║\r\n\r\nBut what I get is THIS\r\nVVVVVVVVVVVVVVVVV\r\n\r\n╔════╗   ╔══╗\r\n║              ║   ║       ║\r\n║              ║   ╚══╝\r\n║              ║   \r\n╠═       ═╝ ",
      "EditableFormat": "markdown",
      "HTML": "<p>Hi again,</p>\n<p>So I've got the map active, and have been adjusting the size and positions of the rooms so they look more like the layout of a house. Rather than stepping from one plain-looking square to another, you go from a narrow hallway into a larger room. Everything was fine, but somewhere along the way, something got mucked up.</p>\n<p>When I start now, I'm in a narrow, 1x3 hallway. If I move east, I move into a 2x2 square 1 step north of the hallway. If I move west, I go into a 4x4 large room. If I go south, I go into another 4x4 large room. Everything was working fine, with lines marking the walls and such...</p>\n<p>but for some reason now if I move west first, it seems that the large room to the west erases my 1x3 hallway. If I go back east, my little yellow marker dot is in a black, empty space rather than a white room (this is white on black). Every other room lines up correctly from this point on, but my starting hallway is essentially gone. This <strong>ONLY</strong> happens if my first move is west. If I move east, south, out, etc, the 1x3 room remains visible and the map builds up like it should. I can even go west and the 4x4 room does not screw up the rest of the map. <strong>This only happens if my first move is into the west room</strong>. I can look, search, so any sort of things I want, but the moment I move out of the room, if it's to the west, I lose the 1x3 starter room.</p>\n<p>And I have no idea why.</p>\n<p>I've checked the exits, there are no special scripts related to going west first. The fact that I can go in there after going anywhere else and it doesn't muck up has me utterly baffled.</p>\n<p>Basically, THIS is what it's supposed to look like<br>\nVVVVVVVVVVVV</p>\n<p>╔════╦■╦══╗<br>\n║&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;║<br>\n║&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;║&nbsp;&nbsp;&nbsp;╠══╝<br>\n║&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;║&nbsp;&nbsp;&nbsp;║<br>\n╠═&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;═╣&nbsp;&nbsp;&nbsp;║</p>\n<p>But what I get is THIS<br>\nVVVVVVVVVVVVVVVVV</p>\n<p>╔════╗&nbsp;&nbsp;&nbsp;╔══╗<br>\n║&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;║&nbsp;&nbsp;&nbsp;║&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;║<br>\n║&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;║&nbsp;&nbsp;&nbsp;╚══╝<br>\n║&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;║&nbsp;&nbsp;&nbsp;<br>\n╠═&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;═╝&nbsp;</p>\n\n",
      "PostDate": "2019-12-16T04:24:45.74531Z",
      "LastEditDate": "2019-12-17T01:11:38.3150344Z",
      "link": null
    },
    {
      "PostId": "31bff982-a47d-4070-8326-c4ade1a79e56",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "That's bizarre, and I can't think of any reason why it could happen.\r\n\r\nCould you maybe share a link to the game, so someone else could take a look over the code and try to guess what could be causing this?",
      "EditableFormat": "markdown",
      "HTML": "<p>That's bizarre, and I can't think of any reason why it could happen.</p>\n<p>Could you maybe share a link to the game, so someone else could take a look over the code and try to guess what could be causing this?</p>\n\n",
      "PostDate": "2019-12-16T07:57:36.1763177Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "fea91818-1b6d-42f0-bee9-a2be37fe657c",
      "UserId": 451204,
      "Username": "wdalphin",
      "AvatarUrl": "https://i.imgur.com/gIhq4Adb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Sure, I've put the code up in my DropBox: https://www.dropbox.com/s/wif7dymyg3xitjb/Jack%20Monster.aslx?dl=0\r\n\r\nMind you, this is a work in progress, lots of experimentation, teaching myself how to use Quest, so you'll probably find a lot of \"huh?\" kind of stuff in there and missing room descriptions and such.",
      "EditableFormat": "markdown",
      "HTML": "<p>Sure, I've put the code up in my DropBox: https://www.dropbox.com/s/wif7dymyg3xitjb/Jack%20Monster.aslx?dl=0</p>\n<p>Mind you, this is a work in progress, lots of experimentation, teaching myself how to use Quest, so you'll probably find a lot of \"huh?\" kind of stuff in there and missing room descriptions and such.</p>\n\n",
      "PostDate": "2019-12-17T01:29:52.7664438Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "bcea93c9-94f3-4540-9cb2-f1b9004a5979",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I've looked through it, and I can't see the issue. Completely stumped on this one.\r\n\r\nIf I get time later I might try creating a copy of the game so that I can take a look using the javascript debugger, but that's likely to be a very involved process. Hopefully there's someone else with the desktop version of Quest who might take a look at it.",
      "EditableFormat": "markdown",
      "HTML": "<p>I've looked through it, and I can't see the issue. Completely stumped on this one.</p>\n<p>If I get time later I might try creating a copy of the game so that I can take a look using the javascript debugger, but that's likely to be a very involved process. Hopefully there's someone else with the desktop version of Quest who might take a look at it.</p>\n\n",
      "PostDate": "2019-12-17T09:41:52.759654Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "8221c47d-1b4a-4051-a0a4-390fe78b006e",
      "UserId": 260569,
      "Username": "DarkLizerd",
      "AvatarUrl": "https://i.imgur.com/vjdH3t6b.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I see something, but someone else will need to explain it...\r\nWhen you move west first, the room is offset to the left by 1.\r\nWhen you go other directions, it is lined up with the room to the south.\r\nDoes this help?\r\nI don't have much experience with maps, but something is moving the room.\r\n\r\nActually, if you start the player to _NE, then the room is offset to the left by 1.\r\nWhere is the info that set the X and Y location for the room?\r\nThis could be what is causing the problem.\r\n\r\nOK, what ever room you start in is offset left by 1 when you move west.\r\nBut NOT when you move other directions first.\r\nDoes this help?",
      "EditableFormat": "markdown",
      "HTML": "<p>I see something, but someone else will need to explain it...<br>\nWhen you move west first, the room is offset to the left by 1.<br>\nWhen you go other directions, it is lined up with the room to the south.<br>\nDoes this help?<br>\nI don't have much experience with maps, but something is moving the room.</p>\n<p>Actually, if you start the player to _NE, then the room is offset to the left by 1.<br>\nWhere is the info that set the X and Y location for the room?<br>\nThis could be what is causing the problem.</p>\n<p>OK, what ever room you start in is offset left by 1 when you move west.<br>\nBut NOT when you move other directions first.<br>\nDoes this help?</p>\n\n",
      "PostDate": "2019-12-18T04:18:25.0677103Z",
      "LastEditDate": "2019-12-18T04:58:06.5157081Z",
      "link": null
    },
    {
      "PostId": "7cecc922-8e23-4171-b61c-8d8cfd561e9b",
      "UserId": 260569,
      "Username": "DarkLizerd",
      "AvatarUrl": "https://i.imgur.com/vjdH3t6b.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "If you resize room_NE (to the west), you can see how the first room is hidden under the west room.\r\nWhy??? I don't know.\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>If you resize room_NE (to the west), you can see how the first room is hidden under the west room.<br>\nWhy??? I don't know.</p>\n\n",
      "PostDate": "2019-12-18T05:13:55.1356071Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "a3c5b728-5396-46ce-a060-8ee7f45f29b4",
      "UserId": 277074,
      "Username": "Dcoder",
      "AvatarUrl": "https://i.imgur.com/O07mlRtb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Sounds like any starting room is moved 1 to the west, rather than the player?",
      "EditableFormat": "markdown",
      "HTML": "<p>Sounds like any starting room is moved 1 to the west, rather than the player?</p>\n\n",
      "PostDate": "2019-12-18T05:41:51.5262392Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "0d3ebbbd-0819-416e-af49-1a17d431baed",
      "UserId": 451204,
      "Username": "wdalphin",
      "AvatarUrl": "https://i.imgur.com/gIhq4Adb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thank you to you all for taking a look!",
      "EditableFormat": "markdown",
      "HTML": "<p>Thank you to you all for taking a look!</p>\n\n",
      "PostDate": "2019-12-22T02:25:32.2454468Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "655ecac9-9a39-4db2-afc1-1a4698519861",
      "UserId": 451204,
      "Username": "wdalphin",
      "AvatarUrl": "https://i.imgur.com/gIhq4Adb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "So... I found a workaround. It's not a solution, because it doesn't explain what's causing the first room to end up under the second room if you move west, but it makes it so it won't happen:\r\n\r\nI made my player's starting room the front porch. \r\n\r\nNow, the only option for first movement is to go in. And because of this, no matter which way you go after, the map does not screw up anymore.\r\n\r\nI should note that I tried adjust the exit to the NW room to have a grid_length of 1, and this fixed the initial problem, but caused a larger one where every subsequent entry into the room from the east caused it to misalign 1 grid space further west with each try. Still baffling.",
      "EditableFormat": "markdown",
      "HTML": "<p>So... I found a workaround. It's not a solution, because it doesn't explain what's causing the first room to end up under the second room if you move west, but it makes it so it won't happen:</p>\n<p>I made my player's starting room the front porch.</p>\n<p>Now, the only option for first movement is to go in. And because of this, no matter which way you go after, the map does not screw up anymore.</p>\n<p>I should note that I tried adjust the exit to the NW room to have a grid_length of 1, and this fixed the initial problem, but caused a larger one where every subsequent entry into the room from the east caused it to misalign 1 grid space further west with each try. Still baffling.</p>\n\n",
      "PostDate": "2019-12-22T02:45:03.0182258Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "9bff9122-a707-491f-8f5d-2c128d5ca2cd",
      "UserId": 260569,
      "Username": "DarkLizerd",
      "AvatarUrl": "https://i.imgur.com/vjdH3t6b.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Could it be that since the player \"jumps\" to the first room, Quest doesn't know which way the player moved?\r\nHow about  just opening a 1 way door to the first room?\r\n\r\nAlso, a general map question, How does Quest know where each room is, relative to the other rooms?\r\nMainly regarding rooms that are not the classic same-size, grid aligned rooms.\r\n  ",
      "EditableFormat": "markdown",
      "HTML": "<p>Could it be that since the player \"jumps\" to the first room, Quest doesn't know which way the player moved?<br>\nHow about  just opening a 1 way door to the first room?</p>\n<p>Also, a general map question, How does Quest know where each room is, relative to the other rooms?<br>\nMainly regarding rooms that are not the classic same-size, grid aligned rooms.</p>\n\n",
      "PostDate": "2019-12-22T03:53:32.5496377Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "af77385d-1510-46c0-aa6a-1b3d11d7e3dc",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> Also, a general map question, How does Quest know where each room is, relative to the other rooms?\r\n\r\nWhen the player enters a room, Quest looks at all exits from that room.\r\n* Exit's `x` coordinate is:\r\n    * north/south: room `x` plus half of room width (to put it in the middle of the side)\r\n    * west: room's `x` coordinate\r\n    * east: room's `y` coordinate\r\n* Destination room's `x` coordinate is:\r\n    * north/south: exit's `x`coordinate, minus half the width of the destination room (so the exit is in the centre of the N/S wall)\r\n    * west: exit's `x` coord, minus exit's grid_length, minus width of the destination room\r\n    * east: exit's `x` coord plus exit's grid_length\r\nThe same is done for the `y` coords\r\n\r\n\r\nI've manually looked through the code in that game, and tried to work out the numbers in my head. I can't see how it's messing up the positions.\r\nIf I had the game in the editor, I'd try making a function to display the coordinates, and see what it shows before and after visiting different rooms. Something like:\r\n```\r\ncoords = NewObjectList()\r\nlist add (coords, Floor_1_N)\r\nlist add (coords, Floor_1_NW)\r\nlist add (coords, GetObject(GetExitByLink(Floor_1_N, Floor_1_NW)))\r\nlist add (coords, GetObject(GetExitByLink(Floor_1_NW, Floor_1_N)))\r\nforeach (room, coords) {\r\n  dict = Grid_GetPlayerCoordinatesForRoom(player, room)\r\n  result = \"Coordinates for \"+room.name+\" (\"+GetDisplayAlias(room)+\")<ul>\"\r\n  foreach (key, dict) {\r\n    result = result + \"<li>\"+key+\": \"+DictionaryItem(dict, key)+\"</li>\"\r\n  }\r\n  msg (result+\"</ul>\")\r\n}\r\n```\r\n\r\nRunning that before entering the hallway, after entering the hallway, and after entering the room would give a little more information, maybe giving us a clue why it's going wrong.\r\n\r\nIf the room appears correctly if it's not the first one you enter, perhaps it would be worth looking at the coordinates in that case too.",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>Also, a general map question, How does Quest know where each room is, relative to the other rooms?</p>\n</blockquote>\n<p>When the player enters a room, Quest looks at all exits from that room.</p>\n<ul>\n<li>Exit's <code>x</code> coordinate is:\n<ul>\n<li>north/south: room <code>x</code> plus half of room width (to put it in the middle of the side)</li>\n<li>west: room's <code>x</code> coordinate</li>\n<li>east: room's <code>y</code> coordinate</li>\n</ul>\n</li>\n<li>Destination room's <code>x</code> coordinate is:\n<ul>\n<li>north/south: exit's <code>x</code>coordinate, minus half the width of the destination room (so the exit is in the centre of the N/S wall)</li>\n<li>west: exit's <code>x</code> coord, minus exit's grid_length, minus width of the destination room</li>\n<li>east: exit's <code>x</code> coord plus exit's grid_length<br>\nThe same is done for the <code>y</code> coords</li>\n</ul>\n</li>\n</ul>\n<p>I've manually looked through the code in that game, and tried to work out the numbers in my head. I can't see how it's messing up the positions.<br>\nIf I had the game in the editor, I'd try making a function to display the coordinates, and see what it shows before and after visiting different rooms. Something like:</p>\n<pre><code>coords = NewObjectList()\nlist add (coords, Floor_1_N)\nlist add (coords, Floor_1_NW)\nlist add (coords, GetObject(GetExitByLink(Floor_1_N, Floor_1_NW)))\nlist add (coords, GetObject(GetExitByLink(Floor_1_NW, Floor_1_N)))\nforeach (room, coords) {\n  dict = Grid_GetPlayerCoordinatesForRoom(player, room)\n  result = \"Coordinates for \"+room.name+\" (\"+GetDisplayAlias(room)+\")&lt;ul&gt;\"\n  foreach (key, dict) {\n    result = result + \"&lt;li&gt;\"+key+\": \"+DictionaryItem(dict, key)+\"&lt;/li&gt;\"\n  }\n  msg (result+\"&lt;/ul&gt;\")\n}\n</code></pre>\n<p>Running that before entering the hallway, after entering the hallway, and after entering the room would give a little more information, maybe giving us a clue why it's going wrong.</p>\n<p>If the room appears correctly if it's not the first one you enter, perhaps it would be worth looking at the coordinates in that case too.</p>\n\n",
      "PostDate": "2019-12-22T11:42:00.728772Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "62226716-a39e-4eb3-a08a-1dfee0c96cc8",
      "UserId": 451204,
      "Username": "wdalphin",
      "AvatarUrl": "https://i.imgur.com/gIhq4Adb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I'll try this code out today and post what results I get. Thanks for your continued research, folks!",
      "EditableFormat": "markdown",
      "HTML": "<p>I'll try this code out today and post what results I get. Thanks for your continued research, folks!</p>\n\n",
      "PostDate": "2019-12-22T15:20:27.3484764Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "d91e69e2-0b21-4864-9518-c7dbfb3227bc",
      "UserId": 451204,
      "Username": "wdalphin",
      "AvatarUrl": "https://i.imgur.com/gIhq4Adb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Well this just got weirder.\r\n\r\nI put the code in the \"**Before entering**\" for the north hallway. I put the code in \"**After entering**\" the north hallway. I put the code in \"**After entering**\" the living room.\r\n\r\nAnd the map no longer broke. It showed me the coordinates, but more importantly, the map worked. Here's what it gave me:\r\n\r\n```\r\nCoordinates for Floor_1_N (North Hallway)\r\nx: 0\r\ny: 0\r\nz: 0\r\ngrid_isdrawn: True\r\n\r\nCoordinates for Floor_1_NW (Living Room)\r\nx: -4\r\ny: 0\r\nz: 0\r\n\r\nCoordinates for exit3 (west)\r\nx: 0\r\ny: 2\r\nend_x: 0\r\nend_y: 2\r\n\r\nCoordinates for exit1 (east)\r\n```\r\n Note that the living room is adjusted -4 in the x direction, and the west exit's x coordinate is 0.\r\n\r\nThe map looked fine.\r\n\r\nSo I took the code out, and the map went back to being broken again. At this point I said to myself, \"so something in the code is affecting the outcome.\" and I put the code in bit by bit. Apparently, something about the code in the \"**Before entering**\" the north hallway is affecting how the map works, because here are the coordinates I get when it's gone:\r\n\r\n```\r\nCoordinates for Floor_1_N (North Hallway)\r\nx: 0\r\ny: 0\r\nz: 0\r\ngrid_isdrawn: True\r\n\r\nCoordinates for Floor_1_NW (Living Room)\r\nx: -3\r\ny: 0\r\nz: 0\r\n\r\nCoordinates for exit3 (west)\r\nx: 1\r\ny: 2\r\nend_x: 1\r\nend_y: 2\r\n\r\nCoordinates for exit1 (east)\r\n```\r\nNow the living room is offset by -3, which is causing it to overlap the hallway, and the exit to it is offset by 1.\r\n\r\nI took out the **After entering** code for both rooms, left the **Before entering** code in, but removed the part where it posts the results in a message, and somehow simply gathering the information is enough to fix the problem, but I don't know why. I tried removing the foreach loop and it broke. I stripped the code down until I found a single line that fixes everything:\r\n\r\n```\r\ndict = Grid_GetPlayerCoordinatesForRoom(player, room)\r\n```\r\n\r\nWith just this line in the **Before entering** script, the map functions properly.",
      "EditableFormat": "markdown",
      "HTML": "<p>Well this just got weirder.</p>\n<p>I put the code in the \"<strong>Before entering</strong>\" for the north hallway. I put the code in \"<strong>After entering</strong>\" the north hallway. I put the code in \"<strong>After entering</strong>\" the living room.</p>\n<p>And the map no longer broke. It showed me the coordinates, but more importantly, the map worked. Here's what it gave me:</p>\n<pre><code>Coordinates for Floor_1_N (North Hallway)\nx: 0\ny: 0\nz: 0\ngrid_isdrawn: True\n\nCoordinates for Floor_1_NW (Living Room)\nx: -4\ny: 0\nz: 0\n\nCoordinates for exit3 (west)\nx: 0\ny: 2\nend_x: 0\nend_y: 2\n\nCoordinates for exit1 (east)\n</code></pre>\n<p>Note that the living room is adjusted -4 in the x direction, and the west exit's x coordinate is 0.</p>\n<p>The map looked fine.</p>\n<p>So I took the code out, and the map went back to being broken again. At this point I said to myself, \"so something in the code is affecting the outcome.\" and I put the code in bit by bit. Apparently, something about the code in the \"<strong>Before entering</strong>\" the north hallway is affecting how the map works, because here are the coordinates I get when it's gone:</p>\n<pre><code>Coordinates for Floor_1_N (North Hallway)\nx: 0\ny: 0\nz: 0\ngrid_isdrawn: True\n\nCoordinates for Floor_1_NW (Living Room)\nx: -3\ny: 0\nz: 0\n\nCoordinates for exit3 (west)\nx: 1\ny: 2\nend_x: 1\nend_y: 2\n\nCoordinates for exit1 (east)\n</code></pre>\n<p>Now the living room is offset by -3, which is causing it to overlap the hallway, and the exit to it is offset by 1.</p>\n<p>I took out the <strong>After entering</strong> code for both rooms, left the <strong>Before entering</strong> code in, but removed the part where it posts the results in a message, and somehow simply gathering the information is enough to fix the problem, but I don't know why. I tried removing the foreach loop and it broke. I stripped the code down until I found a single line that fixes everything:</p>\n<pre><code>dict = Grid_GetPlayerCoordinatesForRoom(player, room)\n</code></pre>\n<p>With just this line in the <strong>Before entering</strong> script, the map functions properly.</p>\n\n",
      "PostDate": "2019-12-22T15:44:54.2537395Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "ea1b41a2-062e-4aaa-80e7-ed43b5a19227",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "That's strange. I wonder if the code that generates the initial coordinates for the first room (well, the hallway you're teleporting them into, which isn't connected to the actual start room by an exit) behaves differently depending if the room already has a coordinate dictionary.\r\n\r\nI'll have to look into that later.\r\n\r\n(Does creating an invisible exit leading from \"room\" to \"Floor_1_N\" in any compass direction also fix the issue?)",
      "EditableFormat": "markdown",
      "HTML": "<p>That's strange. I wonder if the code that generates the initial coordinates for the first room (well, the hallway you're teleporting them into, which isn't connected to the actual start room by an exit) behaves differently depending if the room already has a coordinate dictionary.</p>\n<p>I'll have to look into that later.</p>\n<p>(Does creating an invisible exit leading from \"room\" to \"Floor_1_N\" in any compass direction also fix the issue?)</p>\n\n",
      "PostDate": "2019-12-22T16:27:27.3265073Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "7b3c7041-7443-4bdf-b617-d351c85c48cf",
      "UserId": 451204,
      "Username": "wdalphin",
      "AvatarUrl": "https://i.imgur.com/gIhq4Adb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I actually stopped starting the player out in the \"intro\" room and just plopped them right down in the north hallway and it still did this. I can't say when this began unfortunately because the idea of a shaped map that fits with the expected dimensions of the individual rooms was something new I was just toying with when I discovered the problem.",
      "EditableFormat": "markdown",
      "HTML": "<p>I actually stopped starting the player out in the \"intro\" room and just plopped them right down in the north hallway and it still did this. I can't say when this began unfortunately because the idea of a shaped map that fits with the expected dimensions of the individual rooms was something new I was just toying with when I discovered the problem.</p>\n\n",
      "PostDate": "2019-12-22T17:12:37.610678Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

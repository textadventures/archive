{
  "Topic": {
    "TopicId": "612",
    "ForumId": "10",
    "Title": "Repeating unwanted line -- sometimes",
    "LastUpdated": "2005-01-02T20:28:21+00:00",
    "ReplyCount": 2
  },
  "Posts": [
    {
      "PostId": "4747",
      "UserId": 0,
      "Username": "steve the gaming guy",
      "UserAvatar": null,
      "UserGravatar": "6577a0affcb6ea711c75baf052ffd08a",
      "EditableText": "Alex,\n\nI've included a portion of the code in the game I'm working on and hopefully you can tell me what's happening.   I apologize for the length of it but it's as short as I could get it for this question.\n\nBasically, I have a room (mountain2) where the player gets hungry and after each turn, a statement is supposed to display at the end showing the player is hungry.\n\nWhen \"look\" is typed, it displays the room description and the correct \"hunger\" line.  But if you look at objects in the room such as \"look at branch\", it displays the description of the branch but then it displays the line that the player is hungry two times in a row.  I don't understand why this is happening.  If you have any thoughts, please let me know.\n\n[code:2unhl4us]\n' &quot;King's Quest V - text adventure&quot;\n' Created with QDK 3&#46;53 - UNREGISTERED VERSION\n\n!include &lt;Typelib&#46;qlb&gt;\n\ndefine game &lt;King's Quest V - text adventure&gt;\n\tasl-version &lt;350&gt;\n\tgametype singleplayer\n\tstart &lt;mountain&gt;\n\tgame author &lt;Steve Lingle&gt;\n\tgame info &lt;Created with QDK 3&#46;53 - UNREGISTERED EVALUATION VERSION&#46;&gt;\n\tstartscript give &lt;lamb1&gt;\n\tcommand &lt;eat #@object#&gt; &#123;\n\t\tif &#40; #object# = lamb1 &#41; then do &lt;lamb&gt; else msg &lt;Graham does not want to eat the #@object#&#46;&gt;\n\t&#125;\n\tdefine variable &lt;hunger&gt;\n\t\ttype numeric\n\t\tvalue &lt;5&gt;\n\tend define\nend define\n\ndefine synonyms\n\ttake = get\nend define\n\ndefine room &lt;mountain&gt;\n\tprefix &lt;the&gt;\n\tlook &lt;There is not much too see up in this part of the snow peaked mountains&#46;  The path leads on to the north&#46;&gt;\n\tnorth &lt;mountain2&gt;\n\twest &lt;Town Path&gt;\nend define\n\ndefine room &lt;mountain2&gt;\n\talias &lt;mountain&gt;\n\tprefix &lt;the&gt;\n\tlook &lt;There is not much too see up in this part of the snow peaked mountains&#46;  The path ends abruptly at the edge of the mountain&#46;|nAbove on the side of a cliff, Graham can see a tree branch protruding from the snow covered plateau and a bit of rock jutting outwardly a few feet from the tree branch&#46;|nJust above these seems to be a sturdy place to stand if there were only some way to reach it&#46;&gt;\n\tsouth &lt;mountain&gt;\n\tafterturn &#123;\n\t\tif got &lt;lamb1&gt; then flag on &lt;hungry&gt; else flag off &lt;hungry&gt;\n\t\tif flag &lt;hungry&gt; then &#123;\n\t\t\tdec &lt;hunger; 1&gt;\n\t\t\tmsg &lt;The height in altitude causes Graham to feel extreme hunger&#46;  He better find something to eat soon&#46;|n&gt;\n\t\t\tif &#40; %hunger% = 0 &#41; then &#123;\n\t\t\t\tmsg &lt;Graham feels the final pain of hunger within him and he passes out&#46;|n|nHe will soon perish before he regains consciousness&#46;|n&gt;\n\t\t\t\twait &lt;press any key&gt;\n\t\t\t\tmsg &lt;If only Graham had found something to eat&#46;|n|nhint - there are two items Graham could have eaten&#46;  One item is correct whereas Graham will only eat part of it and the remaining bit of food will be used elsewhere&#46;  The other item of food would be eaten by Graham completely thereby rendering a future puzzle without a solution&#46;|nPlease play again, but choose wisely&#46;&#46;&#46;|n&gt;\n\t\t\t\twait &lt;press any key&gt;\n\t\t\t\tplayerlose\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;\n\n\tdefine object &lt;branch&gt;\n\t\talt &lt;tree branch&gt;\n\t\tlook &lt;A tree branch protrudes out from the snow covered area above Graham&#46;&gt;\n\t\ttake msg &lt;The tree branch is too high for Graham to reach by hand&#46;|n&gt;\n\t\tprefix &lt;the&gt;\n\t\tarticle &lt;it&gt;\n\tend define\n\n\tdefine object &lt;rock2&gt;\n\t\talias &lt;rock&gt;\n\t\talt &lt;rock&gt;\n\t\tlook &lt;A piece of the mountain rock sticks out from the mountain side a few feet from the tree branch&#46;&gt;\n\t\ttake msg &lt;The piece of rock is too high for Graham to reach by hand&#46;|n&gt;\n\t\tprefix &lt;the&gt;\n\t\tarticle &lt;it&gt;\n\tend define\n\nend define\n\ndefine room &lt;inven room&gt;\n\n\tdefine object &lt;cloak&gt;\n\t\tlook &lt;A high-quality blue cloak is on display near the front of the Tailor's shop&#46;&gt;\n\t\ttake msg &lt;You must speak with the sales clerk directly in order to purchase this cloak&#46;&gt;\n\t\texamine &lt;This blue cloak looks like it would keep its owner very warm in a cold place&#46;&gt;\n\t\tprefix &lt;a&gt;\n\t\tarticle &lt;it&gt;\n\t\tgender &lt;it&gt;\n\t\tdrop nowhere\n\t\ttype &lt;TLTobject&gt;\n\t\ttype &lt;TLTcoat&gt;\n\t\tproperties &lt;not takeable; noTake=You must speak with the sales clerk directly in order to purchase this cloak&#46;; wearmessage=Graham puts on the blue cloak and feels much warmer&#46;; unwearmessage=Graham takes off the cloak&#46;&gt;\n\t\taction &lt;take&gt; msg &lt;Graham must speak with the sales clerk directly about the cloak&#46;|n&gt;\n\tend define\n\n\tdefine object &lt;lamb1&gt;\n\t\talias &lt;leg of lamb&gt;\n\t\talt &lt;leg; lamb&gt;\n\t\tlook &lt;The leg of lamb looks delicious&#46;&gt;\n\t\ttake &#123;\n\t\t\tmsg &lt;Graham takes the leg of lamb and closes the door to the pantry&#46;&gt;\n\t\t\tgive &lt;lamb1&gt;\n\t\t\tinc &lt;Score; 2&gt;\n\t\t&#125;\n\t\tprefix &lt;the&gt;\n\t\tgender &lt;it&gt;\n\t\tdrop nowhere\n\tend define\n\n\tdefine object &lt;lamb2&gt;\n\t\talias &lt;half leg of lamb&gt;\n\t\talt &lt;leg; half; lamb&gt;\n\t\tlook &lt;The leg of lamb looks delicious&#46;  Half of it has been eaten&#46;&gt;\n\t\tprefix &lt;the&gt;\n\t\tgender &lt;it&gt;\n\t\tdrop nowhere\n\tend define\n\nend define\n\ndefine procedure &lt;lamb&gt;\n\tif &#40; #object# = lamb1 &#41; and flag &lt;hungry&gt; then &#123;\n\t\tmsg &lt;Graham eats half of the leg of lamb but decides to save the other half for later&#46;&gt;\n\t\tlose &lt;lamb1&gt;\n\t\tmove &lt;lamb1; inven room&gt;\n\t\tgive &lt;lamb2&gt;\n\t\tflag off &lt;hungry&gt;\n\t\tinc &lt;Score; 2&gt;\n\t&#125;\n\telse msg &lt;Graham is not hungry right now&#46;&gt;\n\t\nend define\n\ndefine text &lt;intro&gt;\n\nend define\n\ndefine text &lt;win&gt;\n\nend define\n\ndefine text &lt;lose&gt;\n\n~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~\nPlease try again&#46;  If you've saved the game, please restart by clicking &quot;restart&quot; in the lower righthand corner of the screen&#46;\n~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~\nend define\n[/code:2unhl4us][/code]",
      "EditableFormat": "bbcode",
      "HTML": "Alex,<br/><br/>I've included a portion of the code in the game I'm working on and hopefully you can tell me what's happening.   I apologize for the length of it but it's as short as I could get it for this question.<br/><br/>Basically, I have a room (mountain2) where the player gets hungry and after each turn, a statement is supposed to display at the end showing the player is hungry.<br/><br/>When \"look\" is typed, it displays the room description and the correct \"hunger\" line.  But if you look at objects in the room such as \"look at branch\", it displays the description of the branch but then it displays the line that the player is hungry two times in a row.  I don't understand why this is happening.  If you have any thoughts, please let me know.<br/><br/><pre><code><br/>' &quot;King's Quest V - text adventure&quot;<br/>' Created with QDK 3&#46;53 - UNREGISTERED VERSION<br/><br/>!include &lt;Typelib&#46;qlb&gt;<br/><br/>define game &lt;King's Quest V - text adventure&gt;<br/>\tasl-version &lt;350&gt;<br/>\tgametype singleplayer<br/>\tstart &lt;mountain&gt;<br/>\tgame author &lt;Steve Lingle&gt;<br/>\tgame info &lt;Created with QDK 3&#46;53 - UNREGISTERED EVALUATION VERSION&#46;&gt;<br/>\tstartscript give &lt;lamb1&gt;<br/>\tcommand &lt;eat #@object#&gt; &#123;<br/>\t\tif &#40; #object# = lamb1 &#41; then do &lt;lamb&gt; else msg &lt;Graham does not want to eat the #@object#&#46;&gt;<br/>\t&#125;<br/>\tdefine variable &lt;hunger&gt;<br/>\t\ttype numeric<br/>\t\tvalue &lt;5&gt;<br/>\tend define<br/>end define<br/><br/>define synonyms<br/>\ttake = get<br/>end define<br/><br/>define room &lt;mountain&gt;<br/>\tprefix &lt;the&gt;<br/>\tlook &lt;There is not much too see up in this part of the snow peaked mountains&#46;  The path leads on to the north&#46;&gt;<br/>\tnorth &lt;mountain2&gt;<br/>\twest &lt;Town Path&gt;<br/>end define<br/><br/>define room &lt;mountain2&gt;<br/>\talias &lt;mountain&gt;<br/>\tprefix &lt;the&gt;<br/>\tlook &lt;There is not much too see up in this part of the snow peaked mountains&#46;  The path ends abruptly at the edge of the mountain&#46;|nAbove on the side of a cliff, Graham can see a tree branch protruding from the snow covered plateau and a bit of rock jutting outwardly a few feet from the tree branch&#46;|nJust above these seems to be a sturdy place to stand if there were only some way to reach it&#46;&gt;<br/>\tsouth &lt;mountain&gt;<br/>\tafterturn &#123;<br/>\t\tif got &lt;lamb1&gt; then flag on &lt;hungry&gt; else flag off &lt;hungry&gt;<br/>\t\tif flag &lt;hungry&gt; then &#123;<br/>\t\t\tdec &lt;hunger; 1&gt;<br/>\t\t\tmsg &lt;The height in altitude causes Graham to feel extreme hunger&#46;  He better find something to eat soon&#46;|n&gt;<br/>\t\t\tif &#40; %hunger% = 0 &#41; then &#123;<br/>\t\t\t\tmsg &lt;Graham feels the final pain of hunger within him and he passes out&#46;|n|nHe will soon perish before he regains consciousness&#46;|n&gt;<br/>\t\t\t\twait &lt;press any key&gt;<br/>\t\t\t\tmsg &lt;If only Graham had found something to eat&#46;|n|nhint - there are two items Graham could have eaten&#46;  One item is correct whereas Graham will only eat part of it and the remaining bit of food will be used elsewhere&#46;  The other item of food would be eaten by Graham completely thereby rendering a future puzzle without a solution&#46;|nPlease play again, but choose wisely&#46;&#46;&#46;|n&gt;<br/>\t\t\t\twait &lt;press any key&gt;<br/>\t\t\t\tplayerlose<br/>\t\t\t&#125;<br/>\t\t&#125;<br/>\t&#125;<br/><br/>\tdefine object &lt;branch&gt;<br/>\t\talt &lt;tree branch&gt;<br/>\t\tlook &lt;A tree branch protrudes out from the snow covered area above Graham&#46;&gt;<br/>\t\ttake msg &lt;The tree branch is too high for Graham to reach by hand&#46;|n&gt;<br/>\t\tprefix &lt;the&gt;<br/>\t\tarticle &lt;it&gt;<br/>\tend define<br/><br/>\tdefine object &lt;rock2&gt;<br/>\t\talias &lt;rock&gt;<br/>\t\talt &lt;rock&gt;<br/>\t\tlook &lt;A piece of the mountain rock sticks out from the mountain side a few feet from the tree branch&#46;&gt;<br/>\t\ttake msg &lt;The piece of rock is too high for Graham to reach by hand&#46;|n&gt;<br/>\t\tprefix &lt;the&gt;<br/>\t\tarticle &lt;it&gt;<br/>\tend define<br/><br/>end define<br/><br/>define room &lt;inven room&gt;<br/><br/>\tdefine object &lt;cloak&gt;<br/>\t\tlook &lt;A high-quality blue cloak is on display near the front of the Tailor's shop&#46;&gt;<br/>\t\ttake msg &lt;You must speak with the sales clerk directly in order to purchase this cloak&#46;&gt;<br/>\t\texamine &lt;This blue cloak looks like it would keep its owner very warm in a cold place&#46;&gt;<br/>\t\tprefix &lt;a&gt;<br/>\t\tarticle &lt;it&gt;<br/>\t\tgender &lt;it&gt;<br/>\t\tdrop nowhere<br/>\t\ttype &lt;TLTobject&gt;<br/>\t\ttype &lt;TLTcoat&gt;<br/>\t\tproperties &lt;not takeable; noTake=You must speak with the sales clerk directly in order to purchase this cloak&#46;; wearmessage=Graham puts on the blue cloak and feels much warmer&#46;; unwearmessage=Graham takes off the cloak&#46;&gt;<br/>\t\taction &lt;take&gt; msg &lt;Graham must speak with the sales clerk directly about the cloak&#46;|n&gt;<br/>\tend define<br/><br/>\tdefine object &lt;lamb1&gt;<br/>\t\talias &lt;leg of lamb&gt;<br/>\t\talt &lt;leg; lamb&gt;<br/>\t\tlook &lt;The leg of lamb looks delicious&#46;&gt;<br/>\t\ttake &#123;<br/>\t\t\tmsg &lt;Graham takes the leg of lamb and closes the door to the pantry&#46;&gt;<br/>\t\t\tgive &lt;lamb1&gt;<br/>\t\t\tinc &lt;Score; 2&gt;<br/>\t\t&#125;<br/>\t\tprefix &lt;the&gt;<br/>\t\tgender &lt;it&gt;<br/>\t\tdrop nowhere<br/>\tend define<br/><br/>\tdefine object &lt;lamb2&gt;<br/>\t\talias &lt;half leg of lamb&gt;<br/>\t\talt &lt;leg; half; lamb&gt;<br/>\t\tlook &lt;The leg of lamb looks delicious&#46;  Half of it has been eaten&#46;&gt;<br/>\t\tprefix &lt;the&gt;<br/>\t\tgender &lt;it&gt;<br/>\t\tdrop nowhere<br/>\tend define<br/><br/>end define<br/><br/>define procedure &lt;lamb&gt;<br/>\tif &#40; #object# = lamb1 &#41; and flag &lt;hungry&gt; then &#123;<br/>\t\tmsg &lt;Graham eats half of the leg of lamb but decides to save the other half for later&#46;&gt;<br/>\t\tlose &lt;lamb1&gt;<br/>\t\tmove &lt;lamb1; inven room&gt;<br/>\t\tgive &lt;lamb2&gt;<br/>\t\tflag off &lt;hungry&gt;<br/>\t\tinc &lt;Score; 2&gt;<br/>\t&#125;<br/>\telse msg &lt;Graham is not hungry right now&#46;&gt;<br/>\t<br/>end define<br/><br/>define text &lt;intro&gt;<br/><br/>end define<br/><br/>define text &lt;win&gt;<br/><br/>end define<br/><br/>define text &lt;lose&gt;<br/><br/>~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~<br/>Please try again&#46;  If you've saved the game, please restart by clicking &quot;restart&quot; in the lower righthand corner of the screen&#46;<br/>~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~<br/>end define<br/></code></pre></code></pre>",
      "PostDate": "2005-01-02T03:03:47+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "4750",
      "UserId": 0,
      "Username": "Alex",
      "UserAvatar": null,
      "UserGravatar": "188b72c5e13327f4fde3989dca7d7d53",
      "EditableText": "I'll take a look into this in more detail later (not sitting in front of a computer with Quest on it at the moment), but do you get the same problem if Typelib is not included?",
      "EditableFormat": "bbcode",
      "HTML": "I'll take a look into this in more detail later (not sitting in front of a computer with Quest on it at the moment), but do you get the same problem if Typelib is not included?",
      "PostDate": "2005-01-02T11:00:37+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "4754",
      "UserId": 0,
      "Username": "steve the gaming guy",
      "UserAvatar": null,
      "UserGravatar": "6577a0affcb6ea711c75baf052ffd08a",
      "EditableText": "[quote=&quot;Alex&quot;:2meomim2]I'll take a look into this in more detail later (not sitting in front of a computer with Quest on it at the moment), but do you get the same problem if Typelib is not included?[/quote:2meomim2]\nHmm, I don't know.  I was hoping it's not a typelib problem.  I'll look into it though.  I have typelib because two items in my game are to be worn and the setup works pretty good with that.  \nBut again,...I'll look into it\n\nthanks!\n\nUPDATE\n\nDrat, I guess it IS typelib.  I'm not sure why that is the problem but I took it out and the lines no longer repeat.  Oh well.  I guess I'll just have to deal with it.",
      "EditableFormat": "bbcode",
      "HTML": "<blockquote><cite>Alex wrote:</cite>I'll take a look into this in more detail later (not sitting in front of a computer with Quest on it at the moment), but do you get the same problem if Typelib is not included?</blockquote><br/>Hmm, I don't know.  I was hoping it's not a typelib problem.  I'll look into it though.  I have typelib because two items in my game are to be worn and the setup works pretty good with that.  <br/>But again,...I'll look into it<br/><br/>thanks!<br/><br/>UPDATE<br/><br/>Drat, I guess it IS typelib.  I'm not sure why that is the problem but I took it out and the lines no longer repeat.  Oh well.  I guess I'll just have to deal with it.",
      "PostDate": "2005-01-02T20:28:21+00:00",
      "LastEditDate": null
    }
  ]
}

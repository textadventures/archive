{
  "Topic": {
    "TopicId": "6kyvcbwg8kiitj9oq9mrow",
    "ForumId": "10",
    "Title": "What is the best way to code a night and day system?",
    "LastUpdated": "2024-11-14T00:39:51.3128357Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "a7d0033d-f1d3-461d-9df5-f95b89bc529c",
      "UserId": 286484,
      "Username": "Thickar",
      "AvatarUrl": "https://secure.gravatar.com/avatar/434855216bf750dd1c371f6f5006c8e5?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I am making a game where you move around a town either day or night. The character locations and interactions change from night to day. An example would be the town librarian who is at her job during the day and at the bar at night. And her dialogue and actions change between locations.\r\nSo first question, how to I code the day-night change? I don't want it to be based on a timer so I was hoping to do a number of turns.  Second, when it comes to the character's coding and location changes between locations, should I do it be creating separate objects for the characters with one for the night and one for day, and when the time shifts for example when it is night, the day character is moved to a room while the night object is moved from that room to its assigned location? Or can someone think of a better way?",
      "EditableFormat": "markdown",
      "HTML": "<p>I am making a game where you move around a town either day or night. The character locations and interactions change from night to day. An example would be the town librarian who is at her job during the day and at the bar at night. And her dialogue and actions change between locations.<br>\nSo first question, how to I code the day-night change? I don't want it to be based on a timer so I was hoping to do a number of turns.  Second, when it comes to the character's coding and location changes between locations, should I do it be creating separate objects for the characters with one for the night and one for day, and when the time shifts for example when it is night, the day character is moved to a room while the night object is moved from that room to its assigned location? Or can someone think of a better way?</p>\n\n",
      "PostDate": "2024-11-14T00:39:51.3128357Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "bb766aac-ab55-401a-99de-6c6d63fbb8a4",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "If you just want day and night (and don't want to worry about what time it is), you could just use a turnscript to count turns. You could set it up as a simple framework, so that adding new objects to the system is as simple as possible.\r\n\r\nI'd suggest making a turnscript called `daynight`, doing something like this:\r\n```\r\nfirsttime {\r\n  this.turncount = 0\r\n  this.mode = \"day\"\r\n}\r\notherwise {\r\nthis.turncount = (this.turncount + 1) % 28\r\nif (this.turncount = 0) {\r\n  if (this.mode = \"day\") {\r\n    this.mode = \"night\"\r\n    msg (\"The sun sets\")\r\n  }\r\n  else {\r\n    this.mode = \"day\"\r\n    msg (\"The sun rises\")\r\n  }\r\n}\r\nif (this.turncount = 0) {\r\n  foreach (object, AllObjects()) {\r\n    if (HasObject (object, this.mode + \"version\")) {\r\n      alternate = GetObject (object, this.mode + \"version\")\r\n      alternate.visible = object.visible\r\n      alternate.parent = object.parent\r\n      object.parent = null\r\n    }\r\n    if (HasBoolean (object, this.mode + \"visible\")) {\r\n      object.visible = GetBoolean (object, this.mode + \"visible\")\r\n    }\r\n    if (HasObject (object, this.mode + \"location\")) {\r\n      object.parent = GetObject (object, this.mode + \"location\")\r\n    }\r\n    if (HasScript (object, this.mode + \"script\")) {\r\n      do (object, this.mode + \"script\")\r\n    }\r\n  }\r\n}\r\n```\r\nIn this example, it will change every 28 turns… you can just change the number for a longer or shorter cycle.\r\n\r\nThis would make moving objects around easier. You can give any object a few attributes to make it change when the day/night changes.\r\n* If an object has an attribute `dayversion` (or `nightversion`), those objects will swap places when it becomes day (or night)\r\n* If an object has an attribute `dayvisible` set to `false`, the object will be hidden when the sun comes up. If it has an attribute `nightvisible` set to true, it will become visible again when it becomes night.\r\n* If an object has an attribute `nightlocation` which points to a room, it will automatically be moved to that room at night.\r\n* If an object has a script attribute `dayscript`, that script will be run whenever it becomes day. You can use this to change any other details about the object.\r\n\r\nSo if an NPC just moves to a different location at night, you could just give them `daylocation` and `nightlocation` attributes, and not worry about it. If there's an NPC whose house you can't get into (so you only see them during the day), you could use `dayvisible` and `nightvisible` to make them go away. If an object only has a couple of things that need to be changed, you could use `dayscript` and `nightscript` to make those changes.\r\n\r\nAnd if they behave completely differently, it might be easier to have two objects for the day and night versions. Then the NPC objects for the day would have a `nightversion` attribute which refers to the night version, and vice versa. When it becomes night, the night version will appear and the day version will disappear automatically.\r\n\r\nFor some simple objects, you might not need to use any of this. For example, in a factory room, you could have the description like:\r\n```\r\nThere are machines everywhere. {if daynight.mode=day:Workers scurry in all directions, and the place is a hive of activity.}{else:The beams creak softly in the darkness, machines standing idle while they wait for the morning workers to arrive.}\r\n```\r\n\r\nHope that's helpful.",
      "EditableFormat": "markdown",
      "HTML": "<p>If you just want day and night (and don't want to worry about what time it is), you could just use a turnscript to count turns. You could set it up as a simple framework, so that adding new objects to the system is as simple as possible.</p>\n<p>I'd suggest making a turnscript called <code>daynight</code>, doing something like this:</p>\n<pre><code>firsttime {\n  this.turncount = 0\n  this.mode = \"day\"\n}\notherwise {\nthis.turncount = (this.turncount + 1) % 28\nif (this.turncount = 0) {\n  if (this.mode = \"day\") {\n    this.mode = \"night\"\n    msg (\"The sun sets\")\n  }\n  else {\n    this.mode = \"day\"\n    msg (\"The sun rises\")\n  }\n}\nif (this.turncount = 0) {\n  foreach (object, AllObjects()) {\n    if (HasObject (object, this.mode + \"version\")) {\n      alternate = GetObject (object, this.mode + \"version\")\n      alternate.visible = object.visible\n      alternate.parent = object.parent\n      object.parent = null\n    }\n    if (HasBoolean (object, this.mode + \"visible\")) {\n      object.visible = GetBoolean (object, this.mode + \"visible\")\n    }\n    if (HasObject (object, this.mode + \"location\")) {\n      object.parent = GetObject (object, this.mode + \"location\")\n    }\n    if (HasScript (object, this.mode + \"script\")) {\n      do (object, this.mode + \"script\")\n    }\n  }\n}\n</code></pre>\n<p>In this example, it will change every 28 turns… you can just change the number for a longer or shorter cycle.</p>\n<p>This would make moving objects around easier. You can give any object a few attributes to make it change when the day/night changes.</p>\n<ul>\n<li>If an object has an attribute <code>dayversion</code> (or <code>nightversion</code>), those objects will swap places when it becomes day (or night)</li>\n<li>If an object has an attribute <code>dayvisible</code> set to <code>false</code>, the object will be hidden when the sun comes up. If it has an attribute <code>nightvisible</code> set to true, it will become visible again when it becomes night.</li>\n<li>If an object has an attribute <code>nightlocation</code> which points to a room, it will automatically be moved to that room at night.</li>\n<li>If an object has a script attribute <code>dayscript</code>, that script will be run whenever it becomes day. You can use this to change any other details about the object.</li>\n</ul>\n<p>So if an NPC just moves to a different location at night, you could just give them <code>daylocation</code> and <code>nightlocation</code> attributes, and not worry about it. If there's an NPC whose house you can't get into (so you only see them during the day), you could use <code>dayvisible</code> and <code>nightvisible</code> to make them go away. If an object only has a couple of things that need to be changed, you could use <code>dayscript</code> and <code>nightscript</code> to make those changes.</p>\n<p>And if they behave completely differently, it might be easier to have two objects for the day and night versions. Then the NPC objects for the day would have a <code>nightversion</code> attribute which refers to the night version, and vice versa. When it becomes night, the night version will appear and the day version will disappear automatically.</p>\n<p>For some simple objects, you might not need to use any of this. For example, in a factory room, you could have the description like:</p>\n<pre><code>There are machines everywhere. {if daynight.mode=day:Workers scurry in all directions, and the place is a hive of activity.}{else:The beams creak softly in the darkness, machines standing idle while they wait for the morning workers to arrive.}\n</code></pre>\n<p>Hope that's helpful.</p>\n\n",
      "PostDate": "2024-11-14T10:03:36.5714749Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "d3019783-62bc-4a83-82bb-9d5d8c29b82f",
      "UserId": 652801,
      "Username": "Gng",
      "AvatarUrl": "https://i.imgur.com/w0pOzA9b.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I have an object called \"timers\" and for every exit or action or fight I have:\r\n```\r\ntimers.time = timers.time + integer\r\n```\r\nThe integer is specific for each action so I have a lot of flexibility.\r\nAnd then after time reaches a certain number in changedtime attribute:\r\n```\r\nIf (timers.time > 1200){\r\n  timers.partofday = 5\r\n//night\r\n// msg: it's night etc. etc. \r\n}\r\nElse if (timers.time > 1020){\r\n  timers.partofday = 4\r\n//evening\r\n}\r\nElse if (timers.time > 600){\r\n  timers.partofday = 3\r\n//noon\r\n}\r\nElse if (timers.time > 360){\r\n  timers.partofday = 2\r\n//morning\r\n}\r\nElse {\r\n  timers.partofday = 1\r\n//midnight\r\n}\r\n```\r\nIn each object description I have different scripts based on timers.partofday",
      "EditableFormat": "markdown",
      "HTML": "<p>I have an object called \"timers\" and for every exit or action or fight I have:</p>\n<pre><code>timers.time = timers.time + integer\n</code></pre>\n<p>The integer is specific for each action so I have a lot of flexibility.<br>\nAnd then after time reaches a certain number in changedtime attribute:</p>\n<pre><code>If (timers.time &gt; 1200){\n  timers.partofday = 5\n//night\n// msg: it's night etc. etc. \n}\nElse if (timers.time &gt; 1020){\n  timers.partofday = 4\n//evening\n}\nElse if (timers.time &gt; 600){\n  timers.partofday = 3\n//noon\n}\nElse if (timers.time &gt; 360){\n  timers.partofday = 2\n//morning\n}\nElse {\n  timers.partofday = 1\n//midnight\n}\n</code></pre>\n<p>In each object description I have different scripts based on timers.partofday</p>\n\n",
      "PostDate": "2024-11-14T17:48:34.1049225Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "5fedad5a-8dee-46ef-bdc8-13df6d48b23c",
      "UserId": 286484,
      "Username": "Thickar",
      "AvatarUrl": "https://secure.gravatar.com/avatar/434855216bf750dd1c371f6f5006c8e5?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thanks I have two more questions for Mrange. Is it possible to disable and enable the turn script through code? Because certain interactions in the came I don't want to move time regardless of turns.\r\nSecond, how can I manually switch time of day by code? That would be useful for say adding a sleep function to the character so people don't have to wait to get the interactions they seek?\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Thanks I have two more questions for Mrange. Is it possible to disable and enable the turn script through code? Because certain interactions in the came I don't want to move time regardless of turns.<br>\nSecond, how can I manually switch time of day by code? That would be useful for say adding a sleep function to the character so people don't have to wait to get the interactions they seek?</p>\n\n",
      "PostDate": "2024-11-14T23:35:49.5703987Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "fba76658-dd17-40ac-8830-a24634e10ca6",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> Is it possible to disable and enable the turn script through code? Because certain interactions in the came I don't want to move time regardless of turns.\r\n\r\nYes. You can use:\r\n* `daynight.enabled = true`\r\n* `daynight.enabled = false`\r\n\r\nThese will just stop the timer from advancing.\r\n\r\n> Second, how can I manually switch time of day by code? That would be useful for say adding a sleep function to the character so people don't have to wait to get the interactions they seek?\r\n\r\nOK… this is slightly awkward given the way I coded that example (trying to keep it simple).\r\n\r\nIf you just want to skip ahead to dawn, it would simply be:\r\n```\r\ndaynight.turncount = -1\r\n```\r\nWhich forces a day/night transition this turn.\r\n\r\nIf you want to skip to some time that isn't a transition between modes (like three turns before dawn), you would have to run the script manually to force a transition. For example, to sleep until the middle of the day:\r\n\r\n```\r\nif (daynight.mode = \"night\") {\r\n  daynight.turncount = -1\r\n  do (daynight, \"script\")\r\n}\r\ndaynight.turncount = 14\r\n```\r\n\r\nOr if you wanted some action to take more time than usual, you could include this in a command/verb:\r\n```\r\nfor (i, 1, 5) {\r\n  do (daynight, \"script\")\r\n}\r\n```\r\nwhich just causes the timer to go forward 5 turns, handling dawn or dusk if necessary.\r\n\r\nDoes one of those do what you need?\r\nIf you're after something more advanced, it's not too hard to make a full time system (so that you can do things like waiting until a certain time). The one I write here was just intended as a simplified version, which doesn't provide too much functionality.\r\n\r\n<hr style=\"border-top: 1px dotted navy\"/>\r\n\r\nAnd a little optimisation in case you're using the web editor, to make NPCs easier to handle. In your start script, you could put:\r\n```\r\nforeach (obj, AllObjects ()) {\r\n  if (EndsWith (obj.name, \"_day\")) {\r\n    night = GetObject (Replace (obj.name, \"_day\", \"_night\"))\r\n    if (not night = null) {\r\n      night.dayversion = obj\r\n      obj.nightversion = night\r\n    }\r\n  }\r\n}\r\n```\r\nWith that, you could create objects named, (for example) `barman_day` and `barman_night` and they will automatically switch places without having to add the attributes manually.",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>Is it possible to disable and enable the turn script through code? Because certain interactions in the came I don't want to move time regardless of turns.</p>\n</blockquote>\n<p>Yes. You can use:</p>\n<ul>\n<li><code>daynight.enabled = true</code></li>\n<li><code>daynight.enabled = false</code></li>\n</ul>\n<p>These will just stop the timer from advancing.</p>\n<blockquote>\n<p>Second, how can I manually switch time of day by code? That would be useful for say adding a sleep function to the character so people don't have to wait to get the interactions they seek?</p>\n</blockquote>\n<p>OK… this is slightly awkward given the way I coded that example (trying to keep it simple).</p>\n<p>If you just want to skip ahead to dawn, it would simply be:</p>\n<pre><code>daynight.turncount = -1\n</code></pre>\n<p>Which forces a day/night transition this turn.</p>\n<p>If you want to skip to some time that isn't a transition between modes (like three turns before dawn), you would have to run the script manually to force a transition. For example, to sleep until the middle of the day:</p>\n<pre><code>if (daynight.mode = \"night\") {\n  daynight.turncount = -1\n  do (daynight, \"script\")\n}\ndaynight.turncount = 14\n</code></pre>\n<p>Or if you wanted some action to take more time than usual, you could include this in a command/verb:</p>\n<pre><code>for (i, 1, 5) {\n  do (daynight, \"script\")\n}\n</code></pre>\n<p>which just causes the timer to go forward 5 turns, handling dawn or dusk if necessary.</p>\n<p>Does one of those do what you need?<br>\nIf you're after something more advanced, it's not too hard to make a full time system (so that you can do things like waiting until a certain time). The one I write here was just intended as a simplified version, which doesn't provide too much functionality.</p>\n<hr style=\"border-top: 1px dotted navy\">\n<p>And a little optimisation in case you're using the web editor, to make NPCs easier to handle. In your start script, you could put:</p>\n<pre><code>foreach (obj, AllObjects ()) {\n  if (EndsWith (obj.name, \"_day\")) {\n    night = GetObject (Replace (obj.name, \"_day\", \"_night\"))\n    if (not night = null) {\n      night.dayversion = obj\n      obj.nightversion = night\n    }\n  }\n}\n</code></pre>\n<p>With that, you could create objects named, (for example) <code>barman_day</code> and <code>barman_night</code> and they will automatically switch places without having to add the attributes manually.</p>\n\n",
      "PostDate": "2024-11-15T09:45:13.075939Z",
      "LastEditDate": "2024-11-15T09:51:14.1615828Z",
      "link": null
    }
  ]
}

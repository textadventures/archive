{
  "Topic": {
    "TopicId": "5621",
    "ForumId": "10",
    "Title": "Pulling an object from a container at random",
    "LastUpdated": "2015-11-14T10:23:18+00:00",
    "ReplyCount": 4
  },
  "Posts": [
    {
      "PostId": "38686",
      "UserId": 0,
      "Username": "afrotoast",
      "UserAvatar": null,
      "UserGravatar": "d8f5f23dfb4df278f3499835fb600b7a",
      "EditableText": "Hi guys! Stumbled into another little problem I can't quite wrap my head around.\n\nI've got a &quot;container&quot; object, and I want to make it such that the player can &quot;take from&quot; the container, and will pull out one of &quot;item1&quot;, &quot;item2&quot;, or &quot;item3&quot; at random.\n\nI have it set up to roll a number from 1 to 3, then pull an item depending on what it rolls.\n\nThat worked fine, until I realized that if you pulled &quot;item1&quot; on your first roll, and you rolled 1 again, you'd get the message that you're getting &quot;item1&quot;, but because you already have it, nothing happens.\n\nThe problem is that the system i have makes it possible for you to land on a dice roll you've gotten before. I'm not sure how to get the container to &quot;roll again&quot; if the item doesn't exist.\n\nI have a few ideas for how it might be fixed but I couldn't figure out if it was possible to do it in quest.\n\n[list:1dh53twq]1: have the script pick one item randomly from whatever is inside the container each time. Depending on what it picks it prints a corresponding message (you got item1!)\n2: have the script roll again if the item doesn't exist in the container\n3: instead of using a dice roll, the script just checks if it contains &quot;item(wildcard)&quot; and pulls one at random.[/list:u:1dh53twq]\n\nAgain, I was just trying to think logically about how i could make it work, but I don't know if quest has any function like this.\n\nIf it matters, I have the container tied to a counter, and it deletes itself after rolling three times. Each time you roll it does &quot;container.stacksize - 1&quot; and if &quot;container.stacksize = 1&quot; when you roll it, it removes itself after giving you the last item.\n\n/: maybe i've been staring at this too long but I can't tell if i'm missing something stupidly obvious here.",
      "EditableFormat": "bbcode",
      "HTML": "Hi guys! Stumbled into another little problem I can't quite wrap my head around.<br/><br/>I've got a &quot;container&quot; object, and I want to make it such that the player can &quot;take from&quot; the container, and will pull out one of &quot;item1&quot;, &quot;item2&quot;, or &quot;item3&quot; at random.<br/><br/>I have it set up to roll a number from 1 to 3, then pull an item depending on what it rolls.<br/><br/>That worked fine, until I realized that if you pulled &quot;item1&quot; on your first roll, and you rolled 1 again, you'd get the message that you're getting &quot;item1&quot;, but because you already have it, nothing happens.<br/><br/>The problem is that the system i have makes it possible for you to land on a dice roll you've gotten before. I'm not sure how to get the container to &quot;roll again&quot; if the item doesn't exist.<br/><br/>I have a few ideas for how it might be fixed but I couldn't figure out if it was possible to do it in quest.<br/><br/>[list]1: have the script pick one item randomly from whatever is inside the container each time. Depending on what it picks it prints a corresponding message (you got item1!)<br/>2: have the script roll again if the item doesn't exist in the container<br/>3: instead of using a dice roll, the script just checks if it contains &quot;item(wildcard)&quot; and pulls one at random.[/list:u]<br/><br/>Again, I was just trying to think logically about how i could make it work, but I don't know if quest has any function like this.<br/><br/>If it matters, I have the container tied to a counter, and it deletes itself after rolling three times. Each time you roll it does &quot;container.stacksize - 1&quot; and if &quot;container.stacksize = 1&quot; when you roll it, it removes itself after giving you the last item.<br/><br/>/: maybe i've been staring at this too long but I can't tell if i'm missing something stupidly obvious here.",
      "PostDate": "2015-11-14T08:21:27+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "38687",
      "UserId": 0,
      "Username": "HegemonKhan",
      "UserAvatar": null,
      "UserGravatar": "a96cf34d8d97c57de38f54ee22b1759b",
      "EditableText": "you can use this Function:\n\n<!-- m --><a class=\"postlink\" href=\"http://docs.textadventures.co.uk/quest/functions/contains.html\">http://docs.textadventures.co.uk/quest/ ... tains.html</a><!-- m -->\n\nand these Functions too:\n\n<!-- m --><a class=\"postlink\" href=\"http://docs.textadventures.co.uk/quest/functions/getdirectchildren.html\">http://docs.textadventures.co.uk/quest/ ... ldren.html</a><!-- m -->\n<!-- m --><a class=\"postlink\" href=\"http://docs.textadventures.co.uk/quest/functions/getallchildobjects.html\">http://docs.textadventures.co.uk/quest/ ... jects.html</a><!-- m -->\n\nand these Scripts too:\n\n<!-- m --><a class=\"postlink\" href=\"http://docs.textadventures.co.uk/quest/scripts/do.html\">http://docs.textadventures.co.uk/quest/scripts/do.html</a><!-- m -->\n(you can use either one, generally they're the same thing)\n<!-- m --><a class=\"postlink\" href=\"http://docs.textadventures.co.uk/quest/scripts/invoke.html\">http://docs.textadventures.co.uk/quest/ ... nvoke.html</a><!-- m -->\n\n-------------------------\n\nfor an example:\n\nuse these GUI~Editor Scripts to do code lines below:\n\nrun as script -&gt; add new script -&gt; output -&gt; &quot;print a message&quot; Script -&gt; print [MESSAGE] type_in_what_you_want\n\nrun as script -&gt; add new script -&gt; scripts -&gt; 'if' Script -&gt; if [EXPRESSION] type_in_the_rest___see_below*\n\n* but it's too hard to explain what parenthesis to type in, and what parenthesis to not type in... hmm... this is what you'll type in:\nnot GetDirectChildren(chest1) = null\nrandom_selection = GetRandomInt(1,3)\nrandom_selection = 1\nContains(chest1, sword1)\netc etc etc\n\nrun as script -&gt; add new script -&gt; variables -&gt; 'set a variable or attribute' Script -&gt; (see below)\n\nset variable type_in_the_rest___see_below = [EXPRESSION] type_in_the_rest___see_below\n\nand... I'm not sure how'd you do the 'invoke' (nor 'do' ), in the GUI~Editor... hopefully you can figure this out...\n\n[code:1v1pjsei]// chest1\n// -&gt; sword1\n// -&gt; candy1\n// -&gt; potion1\n\n// the 'chest' container Object's 'take' Verb's scriptings (add new scripts)&#58;\n\nif (not GetDirectChildren(chest1) = null)\n{\n  random_selection = GetRandomInt(1,3)\n  if (random_selection = 1)\n  {\n    if (Contains(chest1, sword1))\n    {\n      MoveObject(sword1, player)\n      msg (&quot;You take the sword from the chest&#46;&quot;)\n    }\n    else\n    {\n      msg (&quot;The sword has already been taken from the chest&#46;&quot;)\n      msg (&quot;You try again to search the chest&#46;&quot;)\n      invoke (chest1&#46;take)\n    }\n  }\n  else if (random_selection = 2)\n  {\n    if (Contains(chest1, candy1))\n    {\n      MoveObject(candy1, player)\n      msg (&quot;You take the candy from the chest&#46;&quot;)\n    }\n    else\n    {\n      msg (&quot;The candy has already been taken from the chest&#46;&quot;)\n      msg (&quot;You try again to search the chest&#46;&quot;)\n      invoke (chest1&#46;take)\n    }\n  }\n  else if (random_selection = 3)\n  {\n    if (Contains(chest1, potion))\n    {\n      MoveObject(potion, player)\n      msg (&quot;You take the potion from the chest&#46;&quot;)\n    }\n    else\n    {\n      msg (&quot;The potion has already been taken from the chest&#46;&quot;)\n      msg (&quot;You try again to search the chest&#46;&quot;)\n      invoke (chest1&#46;take)\n    }\n  }\n}\nelse\n{\n  msg (&quot;The chest is empty&#46;&quot;)\n}[/code:1v1pjsei]\n\nthis is not the best design... but let's not care about that... until we need to, you're just learning the basics right now... we'll deal with better design (code efficiency), later.",
      "EditableFormat": "bbcode",
      "HTML": "you can use this Function:<br/><br/><!-- m --><a class=\"postlink\" href=\"http://docs.textadventures.co.uk/quest/functions/contains.html\">http://docs.textadventures.co.uk/quest/ ... tains.html</a><!-- m --><br/><br/>and these Functions too:<br/><br/><!-- m --><a class=\"postlink\" href=\"http://docs.textadventures.co.uk/quest/functions/getdirectchildren.html\">http://docs.textadventures.co.uk/quest/ ... ldren.html</a><!-- m --><br/><!-- m --><a class=\"postlink\" href=\"http://docs.textadventures.co.uk/quest/functions/getallchildobjects.html\">http://docs.textadventures.co.uk/quest/ ... jects.html</a><!-- m --><br/><br/>and these Scripts too:<br/><br/><!-- m --><a class=\"postlink\" href=\"http://docs.textadventures.co.uk/quest/scripts/do.html\">http://docs.textadventures.co.uk/quest/scripts/do.html</a><!-- m --><br/>(you can use either one, generally they're the same thing)<br/><!-- m --><a class=\"postlink\" href=\"http://docs.textadventures.co.uk/quest/scripts/invoke.html\">http://docs.textadventures.co.uk/quest/ ... nvoke.html</a><!-- m --><br/><br/>-------------------------<br/><br/>for an example:<br/><br/>use these GUI~Editor Scripts to do code lines below:<br/><br/>run as script -&gt; add new script -&gt; output -&gt; &quot;print a message&quot; Script -&gt; print [MESSAGE] type_in_what_you_want<br/><br/>run as script -&gt; add new script -&gt; scripts -&gt; 'if' Script -&gt; if [EXPRESSION] type_in_the_rest___see_below*<br/><br/>* but it's too hard to explain what parenthesis to type in, and what parenthesis to not type in... hmm... this is what you'll type in:<br/>not GetDirectChildren(chest1) = null<br/>random_selection = GetRandomInt(1,3)<br/>random_selection = 1<br/>Contains(chest1, sword1)<br/>etc etc etc<br/><br/>run as script -&gt; add new script -&gt; variables -&gt; 'set a variable or attribute' Script -&gt; (see below)<br/><br/>set variable type_in_the_rest___see_below = [EXPRESSION] type_in_the_rest___see_below<br/><br/>and... I'm not sure how'd you do the 'invoke' (nor 'do' ), in the GUI~Editor... hopefully you can figure this out...<br/><br/><pre><code>// chest1<br/>// -&gt; sword1<br/>// -&gt; candy1<br/>// -&gt; potion1<br/><br/>// the 'chest' container Object's 'take' Verb's scriptings (add new scripts)&#58;<br/><br/>if (not GetDirectChildren(chest1) = null)<br/>{<br/>  random_selection = GetRandomInt(1,3)<br/>  if (random_selection = 1)<br/>  {<br/>    if (Contains(chest1, sword1))<br/>    {<br/>      MoveObject(sword1, player)<br/>      msg (&quot;You take the sword from the chest&#46;&quot;)<br/>    }<br/>    else<br/>    {<br/>      msg (&quot;The sword has already been taken from the chest&#46;&quot;)<br/>      msg (&quot;You try again to search the chest&#46;&quot;)<br/>      invoke (chest1&#46;take)<br/>    }<br/>  }<br/>  else if (random_selection = 2)<br/>  {<br/>    if (Contains(chest1, candy1))<br/>    {<br/>      MoveObject(candy1, player)<br/>      msg (&quot;You take the candy from the chest&#46;&quot;)<br/>    }<br/>    else<br/>    {<br/>      msg (&quot;The candy has already been taken from the chest&#46;&quot;)<br/>      msg (&quot;You try again to search the chest&#46;&quot;)<br/>      invoke (chest1&#46;take)<br/>    }<br/>  }<br/>  else if (random_selection = 3)<br/>  {<br/>    if (Contains(chest1, potion))<br/>    {<br/>      MoveObject(potion, player)<br/>      msg (&quot;You take the potion from the chest&#46;&quot;)<br/>    }<br/>    else<br/>    {<br/>      msg (&quot;The potion has already been taken from the chest&#46;&quot;)<br/>      msg (&quot;You try again to search the chest&#46;&quot;)<br/>      invoke (chest1&#46;take)<br/>    }<br/>  }<br/>}<br/>else<br/>{<br/>  msg (&quot;The chest is empty&#46;&quot;)<br/>}</code></pre><br/><br/>this is not the best design... but let's not care about that... until we need to, you're just learning the basics right now... we'll deal with better design (code efficiency), later.",
      "PostDate": "2015-11-14T08:50:21+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "38689",
      "UserId": 0,
      "Username": "afrotoast",
      "UserAvatar": null,
      "UserGravatar": "d8f5f23dfb4df278f3499835fb600b7a",
      "EditableText": "Hmm, will it be possible to have the script automatically roll again instead of printing a negative message? It seems weird for the player to &quot;take from container&quot; but then get a message that the item they grabbed has already been taken. If its not possible that's fine as well, I'm sure I can think of a better way to write the whole thing once i take some time away from staring at tiny words and numbers.",
      "EditableFormat": "bbcode",
      "HTML": "Hmm, will it be possible to have the script automatically roll again instead of printing a negative message? It seems weird for the player to &quot;take from container&quot; but then get a message that the item they grabbed has already been taken. If its not possible that's fine as well, I'm sure I can think of a better way to write the whole thing once i take some time away from staring at tiny words and numbers.",
      "PostDate": "2015-11-14T09:08:48+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "38690",
      "UserId": 0,
      "Username": "HegemonKhan",
      "UserAvatar": null,
      "UserGravatar": "a96cf34d8d97c57de38f54ee22b1759b",
      "EditableText": "I just edited my previous post, sorry (I like to edit a lot... annoying for people reading my posts). I included what you just asked about now.\n\n-----------------\n\na better, but way more advanced, design, would use lists+dictionaries, which you can see an example of here:\n\nbe warned though, Lists are quite a step up in understanding (you need to understand Attributes and 'if' Scripting before you should try tackling lists), and dictionaries are even harder.\n\n<!-- l --><a class=\"postlink-local\" href=\"http://forum.textadventures.co.uk/viewtopic.php?f=18&amp;t=5138\">viewtopic.php?f=18&amp;t=5138</a><!-- l -->\n\n(this is poor code, as this was me learning list+dictionary usage, and at that time I didn't code some parts well, as I over-complicated some parts, I've gotten better, but haven't went back and fixed up this code to be better coded yet)\n\n--------------\n\nand if you want to try to understand lists+dictionaries:\n\n<!-- l --><a class=\"postlink-local\" href=\"http://forum.textadventures.co.uk/viewtopic.php?f=18&amp;t=5137\">viewtopic.php?f=18&amp;t=5137</a><!-- l -->",
      "EditableFormat": "bbcode",
      "HTML": "I just edited my previous post, sorry (I like to edit a lot... annoying for people reading my posts). I included what you just asked about now.<br/><br/>-----------------<br/><br/>a better, but way more advanced, design, would use lists+dictionaries, which you can see an example of here:<br/><br/>be warned though, Lists are quite a step up in understanding (you need to understand Attributes and 'if' Scripting before you should try tackling lists), and dictionaries are even harder.<br/><br/><!-- l --><a class=\"postlink-local\" href=\"http://forum.textadventures.co.uk/viewtopic.php?f=18&amp;t=5138\">viewtopic.php?f=18&amp;t=5138</a><!-- l --><br/><br/>(this is poor code, as this was me learning list+dictionary usage, and at that time I didn't code some parts well, as I over-complicated some parts, I've gotten better, but haven't went back and fixed up this code to be better coded yet)<br/><br/>--------------<br/><br/>and if you want to try to understand lists+dictionaries:<br/><br/><!-- l --><a class=\"postlink-local\" href=\"http://forum.textadventures.co.uk/viewtopic.php?f=18&amp;t=5137\">viewtopic.php?f=18&amp;t=5137</a><!-- l -->",
      "PostDate": "2015-11-14T09:19:23+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "38695",
      "UserId": 0,
      "Username": "The Pixie",
      "UserAvatar": null,
      "UserGravatar": "cfa37e927f96177bcf6053ae8f108f77",
      "EditableText": "Do this:\n[code:2ziosidi]objectlist = GetDirectChildren (container)\nif (ListCount(objectlist) = 0) {\n  msg(&quot;The container is empty&quot;)\n}\nelse {\n  index = GetRandomInt(0, ListCount(objectlist) - 1)\n  obj = ObjectListItem(lst, index)\n  obj&#46;parent = player\n  msg(&quot;You take &quot; + obj&#46;name + &quot; from the container&#46;&quot;)\n}[/code:2ziosidi]\nFirst get the list of objects currently in the container. If there is nothing in the container, display a message, otherwise: Pick a number at random, and get that object. Move it to the player, and tell her it happened.\n\nNote that if the player does it a second time, it will select from the contents of the container at that moment, so will only pick items not already removed. The player can add items, and those can be taken at random too.",
      "EditableFormat": "bbcode",
      "HTML": "Do this:<br/><pre><code>objectlist = GetDirectChildren (container)<br/>if (ListCount(objectlist) = 0) {<br/>  msg(&quot;The container is empty&quot;)<br/>}<br/>else {<br/>  index = GetRandomInt(0, ListCount(objectlist) - 1)<br/>  obj = ObjectListItem(lst, index)<br/>  obj&#46;parent = player<br/>  msg(&quot;You take &quot; + obj&#46;name + &quot; from the container&#46;&quot;)<br/>}</code></pre><br/>First get the list of objects currently in the container. If there is nothing in the container, display a message, otherwise: Pick a number at random, and get that object. Move it to the player, and tell her it happened.<br/><br/>Note that if the player does it a second time, it will select from the contents of the container at that moment, so will only pick items not already removed. The player can add items, and those can be taken at random too.",
      "PostDate": "2015-11-14T10:23:18+00:00",
      "LastEditDate": null
    }
  ]
}

{
  "Topic": {
    "TopicId": "xt6ygagkse_5ax-ucu1u4w",
    "ForumId": "24",
    "Title": "Variable drift?",
    "LastUpdated": "2021-10-28T10:31:11.4361272Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "70c974ad-9933-4e84-9db3-f569979c3a60",
      "UserId": 251768,
      "Username": "Bluevoss",
      "AvatarUrl": "https://i.imgur.com/6mfIIbhb.gif",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I've got a large game I'm working on - 120,000 lines of code so far. Every so often in tried-n-tested routines, I'll see incomprehensible events occur - as if variables are changing inexplicably. I've added debug statements and carefully checked my variable names (to make sure I don't have any capital letters or are using them elsewheres). And when I run the game, I can see if fail (using debug to navigate) every so often.\r\n\r\nI did delete the index.html file and haven't seen it fail since then. Anyone have anything they can add to this?\r\n\r\nAnyone know any limits to number of variables, length of variable names, that sort of thing?",
      "EditableFormat": "markdown",
      "HTML": "<p>I've got a large game I'm working on - 120,000 lines of code so far. Every so often in tried-n-tested routines, I'll see incomprehensible events occur - as if variables are changing inexplicably. I've added debug statements and carefully checked my variable names (to make sure I don't have any capital letters or are using them elsewheres). And when I run the game, I can see if fail (using debug to navigate) every so often.</p>\n<p>I did delete the index.html file and haven't seen it fail since then. Anyone have anything they can add to this?</p>\n<p>Anyone know any limits to number of variables, length of variable names, that sort of thing?</p>\n\n",
      "PostDate": "2021-10-28T10:31:11.4361272Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "7e1a5ed8-b491-44d5-87a5-c1718d743d06",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I don't think variables should drift, but attributes are kept in a LocalStorage; which in practice imposes a limit of 5MB. Whether it prompts the user to allow more space or just drops the least-recently-used ones depends on the browser.\r\n\r\n(note that if you're playing Squiffy games online, this 5MB limit will be shared between all saved games on the same site. They're stored in a single dictionary, where the keys are made by appending the attribute name to the game ID. This means that playing a game which uses a very large number of attributes could cause the older ones from a completely different game being dropped. And the algorithm for deciding which ones to drop isn't constant between browsers - it could depend on any combination of how recently they were used, how recently they were changed, the size of the value, and other undocumented criteria)\r\n\r\nThis is one of the reasons I would try to avoid using attributes unless necessary; or deleting them when they're no longer needed.",
      "EditableFormat": "markdown",
      "HTML": "<p>I don't think variables should drift, but attributes are kept in a LocalStorage; which in practice imposes a limit of 5MB. Whether it prompts the user to allow more space or just drops the least-recently-used ones depends on the browser.</p>\n<p>(note that if you're playing Squiffy games online, this 5MB limit will be shared between all saved games on the same site. They're stored in a single dictionary, where the keys are made by appending the attribute name to the game ID. This means that playing a game which uses a very large number of attributes could cause the older ones from a completely different game being dropped. And the algorithm for deciding which ones to drop isn't constant between browsers - it could depend on any combination of how recently they were used, how recently they were changed, the size of the value, and other undocumented criteria)</p>\n<p>This is one of the reasons I would try to avoid using attributes unless necessary; or deleting them when they're no longer needed.</p>\n\n",
      "PostDate": "2021-10-28T19:54:37.7586878Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "6c03a6f1-d97a-4b6b-a040-bd1c51939fa1",
      "UserId": 208122,
      "Username": "IFforClassroom",
      "AvatarUrl": "https://secure.gravatar.com/avatar/9683526b9b2547bc86419ed8a2454df1?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "That's horrifying! But I'd rather know than not. Thanks, you two. **Is there even a way to delete attributes?** \r\n\r\nI usually @unset them if they're getting in the way, but that just makes them false. Though I guess, false is smaller than something like ```@set style_Handwriting=<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"><div style=\"color:black; font-weight:900; font-size:30px; line-height:1.44; font-family:Comic Sans MS, Comic Sans, cursive; max-width:auto; max-height:auto; background-repeat: repeat-y; background-size: auto; background-image: url('./Handwriting2.png');\"\">```",
      "EditableFormat": "markdown",
      "HTML": "<p>That's horrifying! But I'd rather know than not. Thanks, you two. <strong>Is there even a way to delete attributes?</strong></p>\n<p>I usually @unset them if they're getting in the way, but that just makes them false. Though I guess, false is smaller than something like <code>@set style_Handwriting=&lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;&lt;div style=\"color:black; font-weight:900; font-size:30px; line-height:1.44; font-family:Comic Sans MS, Comic Sans, cursive; max-width:auto; max-height:auto; background-repeat: repeat-y; background-size: auto; background-image: url('./Handwriting2.png');\"\"&gt;</code></p>\n\n",
      "PostDate": "2021-10-29T00:51:22.0586519Z",
      "LastEditDate": "2021-10-29T00:52:53.2013228Z",
      "link": null
    },
    {
      "PostId": "31c444e4-a125-4faf-89b5-c73c498e0107",
      "UserId": 251768,
      "Username": "Bluevoss",
      "AvatarUrl": "https://i.imgur.com/6mfIIbhb.gif",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "mrangel - Hmmm. Thinking this over. But you said they delete the oldest first, right? Why would they delete the current ones that are actively being used?\r\n\r\nAlso, I'm seeing this when I do a build. But I think I see it when the game has been going on for a while. I've had on/off problems with it.\r\n\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>mrangel - Hmmm. Thinking this over. But you said they delete the oldest first, right? Why would they delete the current ones that are actively being used?</p>\n<p>Also, I'm seeing this when I do a build. But I think I see it when the game has been going on for a while. I've had on/off problems with it.</p>\n\n",
      "PostDate": "2021-10-29T01:25:39.4775811Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "ce99dd34-20ae-4357-97ca-cf907fa32272",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> But you said they delete the oldest first, right?\r\n\r\nThe browser can choose which ones to drop based on whatever criteria the developers choose. In theory oldest is a good metric; in practice they're more likely to try weighing size against some formula to determine the probability that some value will be used again.",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>But you said they delete the oldest first, right?</p>\n</blockquote>\n<p>The browser can choose which ones to drop based on whatever criteria the developers choose. In theory oldest is a good metric; in practice they're more likely to try weighing size against some formula to determine the probability that some value will be used again.</p>\n\n",
      "PostDate": "2021-10-29T02:36:05.4734858Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "ba2710f4-17d4-48d7-b1bc-8dcc943428db",
      "UserId": 251768,
      "Username": "Bluevoss",
      "AvatarUrl": "https://i.imgur.com/6mfIIbhb.gif",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Ugh, so no firm control over what gets deleted. Well, good to know. At least that might explain some of the curious issues I've had.\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Ugh, so no firm control over what gets deleted. Well, good to know. At least that might explain some of the curious issues I've had.</p>\n\n",
      "PostDate": "2021-10-29T14:29:13.9821683Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "f348cfcd-b737-417e-a1f7-0f8940b9eb4c",
      "UserId": 208122,
      "Username": "IFforClassroom",
      "AvatarUrl": "https://secure.gravatar.com/avatar/9683526b9b2547bc86419ed8a2454df1?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I don't have my computer right now but would anything remotely like ```squiffy.removeItem(\"attribute\");``` maybe work?",
      "EditableFormat": "markdown",
      "HTML": "<p>I don't have my computer right now but would anything remotely like <code>squiffy.removeItem(\"attribute\");</code> maybe work?</p>\n\n",
      "PostDate": "2021-10-29T14:48:34.2409604Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "e6bb4e73-6786-4674-baf2-1f76750273e4",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "> I don't have my computer right now but would anything remotely like squiffy.removeItem(\"attribute\"); maybe work?\r\n\r\nDon't think there is such a function. You'd want to implement it by something like:\r\n```\r\n    squiffy.removeAttribute = function (attr) {\r\n        if (squiffy.ui.settings.persist && window.localStorage) {\r\n            window.localStorage.removeItem(squiffy.story.id + '-' + attr);\r\n        }\r\n        else {\r\n            delete squiffy.storageFallback[attr];\r\n        }\r\n    };\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>I don't have my computer right now but would anything remotely like squiffy.removeItem(\"attribute\"); maybe work?</p>\n</blockquote>\n<p>Don't think there is such a function. You'd want to implement it by something like:</p>\n<pre><code>    squiffy.removeAttribute = function (attr) {\n        if (squiffy.ui.settings.persist &amp;&amp; window.localStorage) {\n            window.localStorage.removeItem(squiffy.story.id + '-' + attr);\n        }\n        else {\n            delete squiffy.storageFallback[attr];\n        }\n    };\n</code></pre>\n\n",
      "PostDate": "2021-10-29T22:00:08.8377894Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

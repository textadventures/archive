{
  "Topic": {
    "TopicId": "dsm3qslrtkooijastlxgga",
    "ForumId": "10",
    "Title": "Reading from a file",
    "LastUpdated": "2017-11-30T21:28:43.1574746Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "3de48ab4-8c04-40db-bfc5-a0d3134da1ad",
      "UserId": 301690,
      "Username": "Richard Headkid",
      "AvatarUrl": "http://i.imgur.com/WUGXS8yb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Let's say you want Quest to read the information from a file in the game's folder.\r\n\r\n---\r\nI created a file named README.txt.\r\n\r\nThe contents:\r\n\r\n<samp>\r\nHello, Quest!\r\n</samp>\r\n\r\n---\r\n\r\nThe game's code:\r\n\r\n```\r\n<!--Saved by Quest 5.7.6404.15496-->\r\n<asl version=\"550\">\r\n  <include ref=\"English.aslx\" />\r\n  <include ref=\"Core.aslx\" />\r\n  <game name=\"Read from a file\">\r\n    <gameid>0872edb9-52ea-4bfb-ab02-79fead46bb02</gameid>\r\n    <version>1.0</version>\r\n    <firstpublished>2017</firstpublished>\r\n  </game>\r\n  <object name=\"room\">\r\n    <inherit name=\"editor_room\" />\r\n    <description type=\"script\">\r\n      msg (GetFileData(\"README.txt\"))\r\n    </description>\r\n    <object name=\"player\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"editor_player\" />\r\n    </object>\r\n  </object>\r\n</asl>\r\n```\r\n\r\n---\r\nThe output:\r\n\r\n![image](https://user-images.githubusercontent.com/30656341/33455722-91099ba0-d5e2-11e7-8901-b401b496c900.png)\r\n\r\n---\r\n\r\nNow, I'll change the contents of the file to this:\r\n\r\n<samp>\r\nHello, Quest!\r\n\r\n\\<h1>THIS IS A HEADER!\\</h1>\r\n\r\n</samp>\r\n\r\n---\r\n![image](https://user-images.githubusercontent.com/30656341/33455788-c6f2cdb8-d5e2-11e7-900b-66c82166576f.png)\r\n\r\n---\r\nNOTE:  I don't think Quest can read a file from the hard drive that isn't in the game's folder.  I am experimenting with that next, but it seems like I've read a post by Pixie saying that exact thing.  (I think it concerned the Save/Load system.)",
      "EditableFormat": "markdown",
      "HTML": "<p>Let's say you want Quest to read the information from a file in the game's folder.</p>\n<hr>\n<p>I created a file named README.txt.</p>\n<p>The contents:</p>\n<samp>\nHello, Quest!\n</samp>\n<hr>\n<p>The game's code:</p>\n<pre><code>&lt;!--Saved by Quest 5.7.6404.15496--&gt;\n&lt;asl version=\"550\"&gt;\n  &lt;include ref=\"English.aslx\" /&gt;\n  &lt;include ref=\"Core.aslx\" /&gt;\n  &lt;game name=\"Read from a file\"&gt;\n    &lt;gameid&gt;0872edb9-52ea-4bfb-ab02-79fead46bb02&lt;/gameid&gt;\n    &lt;version&gt;1.0&lt;/version&gt;\n    &lt;firstpublished&gt;2017&lt;/firstpublished&gt;\n  &lt;/game&gt;\n  &lt;object name=\"room\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;description type=\"script\"&gt;\n      msg (GetFileData(\"README.txt\"))\n    &lt;/description&gt;\n    &lt;object name=\"player\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"editor_player\" /&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n&lt;/asl&gt;\n</code></pre>\n<hr>\n<p>The output:</p>\n<p><img src=\"https://user-images.githubusercontent.com/30656341/33455722-91099ba0-d5e2-11e7-8901-b401b496c900.png\" alt=\"image\"></p>\n<hr>\n<p>Now, I'll change the contents of the file to this:</p>\n<samp>\nHello, Quest!\n<p>&lt;h1&gt;THIS IS A HEADER!&lt;/h1&gt;</p>\n</samp>\n<hr>\n<p><img src=\"https://user-images.githubusercontent.com/30656341/33455788-c6f2cdb8-d5e2-11e7-900b-66c82166576f.png\" alt=\"image\"></p>\n<hr>\n<p>NOTE:  I don't think Quest can read a file from the hard drive that isn't in the game's folder.  I am experimenting with that next, but it seems like I've read a post by Pixie saying that exact thing.  (I think it concerned the Save/Load system.)</p>\n\n",
      "PostDate": "2017-11-30T21:28:43.1574746Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "9b955b26-dd7f-499e-ac0e-230e2f813730",
      "UserId": 1346,
      "Username": "The Pixie",
      "AvatarUrl": "https://secure.gravatar.com/avatar/cfa37e927f96177bcf6053ae8f108f77?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I am not sure if you can read from another directory or not, but just don't!\r\n\r\nWhen you publish the game Quest will only include files in the current folder (actually, library files from elsewhere will be included).\r\n\r\nAlso, it will only include games with specific file extensions (or rather, that match specific patterns). You can modify `game.publishfileextensions` to include your .txt file, but by default it will not be included.\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>I am not sure if you can read from another directory or not, but just don't!</p>\n<p>When you publish the game Quest will only include files in the current folder (actually, library files from elsewhere will be included).</p>\n<p>Also, it will only include games with specific file extensions (or rather, that match specific patterns). You can modify <code>game.publishfileextensions</code> to include your .txt file, but by default it will not be included.</p>\n\n",
      "PostDate": "2017-11-30T21:41:12.2963853Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "0decf0f6-350f-45c7-9858-1c5a446f3046",
      "UserId": 301690,
      "Username": "Richard Headkid",
      "AvatarUrl": "http://i.imgur.com/WUGXS8yb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": ">I am not sure if you can read from another directory or not, but just don't!\r\n\r\nBoom.  Sage advice.\r\n\r\n(It didn't work anyway, kids. )\r\n\r\n---\r\n>Also, it will only include games with specific file extensions (or rather, that match specific patterns). You can modify game.publishfileextensions to include your .txt file, but by default it will not be included.\r\n\r\nGood looking out!\r\n\r\nThis is what Quest includes by default:\r\n```\r\n<publishfileextensions>*.jpg;*.jpeg;*.png;*.gif;*.js;*.wav;*.mp3;*.htm;*.html;*.svg </publishfileextensions>\r\n```\r\n\r\n---\r\nNOTE:  \r\n\r\nI just renamed README.txt as README.html, and everything works just the same.  (It's just reading the text.  If there's HTML code, it will be displayed as coded.  If not, it will display plain text.)\r\n\r\n---\r\nmsg (GetFileData(\"README.html\"))\r\n\r\n---\r\nNow, I wonder if it can read from an online file...\r\n\r\n(It seems like the answer is no, but I'm bored.   Be right back.)\r\n",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>I am not sure if you can read from another directory or not, but just don't!</p>\n</blockquote>\n<p>Boom.  Sage advice.</p>\n<p>(It didn't work anyway, kids. )</p>\n<hr>\n<blockquote>\n<p>Also, it will only include games with specific file extensions (or rather, that match specific patterns). You can modify game.publishfileextensions to include your .txt file, but by default it will not be included.</p>\n</blockquote>\n<p>Good looking out!</p>\n<p>This is what Quest includes by default:</p>\n<pre><code>&lt;publishfileextensions&gt;*.jpg;*.jpeg;*.png;*.gif;*.js;*.wav;*.mp3;*.htm;*.html;*.svg &lt;/publishfileextensions&gt;\n</code></pre>\n<hr>\n<p>NOTE:</p>\n<p>I just renamed README.txt as README.html, and everything works just the same.  (It's just reading the text.  If there's HTML code, it will be displayed as coded.  If not, it will display plain text.)</p>\n<hr>\n<p>msg (GetFileData(\"README.html\"))</p>\n<hr>\n<p>Now, I wonder if it can read from an online file...</p>\n<p>(It seems like the answer is no, but I'm bored.   Be right back.)</p>\n\n",
      "PostDate": "2017-11-30T21:55:50.3808172Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "b4564381-8159-4522-acb5-3c7bcfbd27ce",
      "UserId": 260569,
      "Username": "DarkLizerd",
      "AvatarUrl": "https://i.imgur.com/vjdH3t6b.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Nice!!!\r\nI assume there is a way to read the file info into a variable, like \"result\", then process that for needed info...\r\nI'm thinking of a game where by completing several \"missions\" you get promotions for new ships (space based) and accedd for new missions...\r\nGetFileData() should have a counter command PutFileData()...\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Nice!!!<br>\nI assume there is a way to read the file info into a variable, like \"result\", then process that for needed info...<br>\nI'm thinking of a game where by completing several \"missions\" you get promotions for new ships (space based) and accedd for new missions...<br>\nGetFileData() should have a counter command PutFileData()...</p>\n\n",
      "PostDate": "2017-12-01T03:13:20.466849Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "a15e1d04-0dac-4636-a09d-9112edde6e86",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "http://i.imgur.com/FOIjtApb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Heck yeah, there is. (It's in Pixie's Quest, too. I'll go find it.  Be right back.)",
      "EditableFormat": "markdown",
      "HTML": "<p>Heck yeah, there is. (It's in Pixie's Quest, too. I'll go find it.  Be right back.)</p>\n\n",
      "PostDate": "2017-12-01T04:02:47.7762082Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "150c4b90-bb5f-4299-a204-900b663b6e5e",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "http://i.imgur.com/FOIjtApb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Here you go:\r\n\r\nhttp://textadventures.co.uk/forum/quest/topic/np4q-x6_je_uw_aqk27zpq/creating-content-from-a-text-file-im-bringing-it-back",
      "EditableFormat": "markdown",
      "HTML": "<p>Here you go:</p>\n<p>http://textadventures.co.uk/forum/quest/topic/np4q-x6_je_uw_aqk27zpq/creating-content-from-a-text-file-im-bringing-it-back</p>\n\n",
      "PostDate": "2017-12-01T04:07:55.196941Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "89c6ea0d-e5db-4ecd-b9f9-c3d3d0a1e15a",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "http://i.imgur.com/FOIjtApb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "```\r\n  <function name=\"LoadFile\" parameters=\"filename\">\r\n    s = GetFileData (filename)\r\n    current_object = null\r\n    game.setUp = false\r\n    foreach (line, Split(s, \"\\n\")) {\r\n      line = Crop(line)\r\n      if (not line = \"\" and not StartsWith(line, \"#\")) {\r\n        bits = Split(line, \"=\")\r\n        if (StringListItem(bits, 0) = \"new\") {\r\n          if (ListCount(bits) = 2) {\r\n            create (StringListItem(bits, 1))\r\n            current_object = GetObject(StringListItem(bits, 1))\r\n          }\r\n          else {\r\n            create (StringListItem(bits, 2), StringListItem(bits, 1))\r\n            current_object = GetObject(StringListItem(bits, 2))\r\n          }\r\n        }\r\n        else if (StringListItem(bits, 0) = \"find\") {\r\n          current_object = GetObject(StringListItem(bits, 1))\r\n          if (current_object = null) {\r\n            error (\"Failed to find \" + StringListItem(bits, 1) + \" in the game world. Things will go badly...\")\r\n          }\r\n        }\r\n        else if (StringListItem(bits, 0) = \"exit\") {\r\n          create exit (StringListItem(bits, 2), null, null, null, StringListItem(bits, 1))\r\n          current_object = GetObject(StringListItem(bits, 2))\r\n        }\r\n        else if (StringListItem(bits, 0) = \"parent\") {\r\n          newParent = StringListItem(bits, 1)\r\n          if (newParent = \"game.pov\") {\r\n            current_object.parent = game.pov.name\r\n            game.setUp = true\r\n            list remove (bits, \"game.pov\")\r\n            list add (bits, game.pov.name)\r\n          }\r\n          else if (newParent = \"game.pov.parent\") {\r\n            current_object.parent = game.pov.parent.name\r\n            game.setUp = true\r\n            list remove (bits, \"game.pov.parent\")\r\n            list add (bits, game.pov.parent.name)\r\n          }\r\n          else if (newParent = \"here\") {\r\n            current_object.parent = game.pov.parent.name\r\n            game.setUp = true\r\n            list remove (bits, \"here\")\r\n            list add (bits, game.pov.parent.name)\r\n          }\r\n          else if (newParent = \"player.parent\") {\r\n            current_object.parent = player.parent.name\r\n            game.setUp = true\r\n            list remove (bits, \"player.parent\")\r\n            list add (bits, player.parent.name)\r\n          }\r\n          current_object.parent = GetObject(StringListItem(bits, 1))\r\n          if (current_object.parent = null) {\r\n            error (\"Failed to find \" + StringListItem(bits, 1) + \" in the game world. Things will go badly...\")\r\n          }\r\n        }\r\n        else if (StringListItem(bits, 0) = \"to\") {\r\n          current_object.to = GetObject(StringListItem(bits, 1))\r\n          if (current_object.to = null) {\r\n            error (\"Failed to find \" + StringListItem(bits, 1) + \" in the game world. Things will go badly...\")\r\n          }\r\n        }\r\n        else {\r\n          if (LCase(StringListItem(bits, 1)) = \"false\") {\r\n            set (current_object, StringListItem(bits, 0), false)\r\n          }\r\n          else if (LCase(StringListItem(bits, 1)) = \"true\") {\r\n            set (current_object, StringListItem(bits, 0), true)\r\n          }\r\n          else if (IsInt(StringListItem(bits, 1))) {\r\n            set (current_object, StringListItem(bits, 0), ToInt(StringListItem(bits, 1)))\r\n          }\r\n          if (not game.setUp) {\r\n            set (current_object, StringListItem(bits, 0), StringListItem(bits, 1))\r\n          }\r\n          else {\r\n            set (current_object, StringListItem(bits, 0), game.pov)\r\n          }\r\n        }\r\n      }\r\n    }\r\n    msg (\"Done.\")\r\n  </function>\r\n```\r\n\r\n```\r\n  <function name=\"Crop\" parameters=\"s\" type=\"string\"><![CDATA[\r\n    start = 1\r\n    end = LengthOf(s)\r\n    for (i, 1, LengthOf(s)) {\r\n      if (Asc(Mid(s, i, 1)) < 33) {\r\n        if (start = i) {\r\n          start = i + 1\r\n        }\r\n      }\r\n      else {\r\n        end = i\r\n      }\r\n    }\r\n    return (Mid(s, start, end - start + 1))\r\n  ]]></function>\r\n```\r\n\r\n```\r\n  <command name=\"px_update\">\r\n    <pattern>load #text#</pattern>\r\n    <script>\r\n      LoadFile (text)\r\n    </script>\r\n  </command>\r\n\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<pre><code>  &lt;function name=\"LoadFile\" parameters=\"filename\"&gt;\n    s = GetFileData (filename)\n    current_object = null\n    game.setUp = false\n    foreach (line, Split(s, \"\\n\")) {\n      line = Crop(line)\n      if (not line = \"\" and not StartsWith(line, \"#\")) {\n        bits = Split(line, \"=\")\n        if (StringListItem(bits, 0) = \"new\") {\n          if (ListCount(bits) = 2) {\n            create (StringListItem(bits, 1))\n            current_object = GetObject(StringListItem(bits, 1))\n          }\n          else {\n            create (StringListItem(bits, 2), StringListItem(bits, 1))\n            current_object = GetObject(StringListItem(bits, 2))\n          }\n        }\n        else if (StringListItem(bits, 0) = \"find\") {\n          current_object = GetObject(StringListItem(bits, 1))\n          if (current_object = null) {\n            error (\"Failed to find \" + StringListItem(bits, 1) + \" in the game world. Things will go badly...\")\n          }\n        }\n        else if (StringListItem(bits, 0) = \"exit\") {\n          create exit (StringListItem(bits, 2), null, null, null, StringListItem(bits, 1))\n          current_object = GetObject(StringListItem(bits, 2))\n        }\n        else if (StringListItem(bits, 0) = \"parent\") {\n          newParent = StringListItem(bits, 1)\n          if (newParent = \"game.pov\") {\n            current_object.parent = game.pov.name\n            game.setUp = true\n            list remove (bits, \"game.pov\")\n            list add (bits, game.pov.name)\n          }\n          else if (newParent = \"game.pov.parent\") {\n            current_object.parent = game.pov.parent.name\n            game.setUp = true\n            list remove (bits, \"game.pov.parent\")\n            list add (bits, game.pov.parent.name)\n          }\n          else if (newParent = \"here\") {\n            current_object.parent = game.pov.parent.name\n            game.setUp = true\n            list remove (bits, \"here\")\n            list add (bits, game.pov.parent.name)\n          }\n          else if (newParent = \"player.parent\") {\n            current_object.parent = player.parent.name\n            game.setUp = true\n            list remove (bits, \"player.parent\")\n            list add (bits, player.parent.name)\n          }\n          current_object.parent = GetObject(StringListItem(bits, 1))\n          if (current_object.parent = null) {\n            error (\"Failed to find \" + StringListItem(bits, 1) + \" in the game world. Things will go badly...\")\n          }\n        }\n        else if (StringListItem(bits, 0) = \"to\") {\n          current_object.to = GetObject(StringListItem(bits, 1))\n          if (current_object.to = null) {\n            error (\"Failed to find \" + StringListItem(bits, 1) + \" in the game world. Things will go badly...\")\n          }\n        }\n        else {\n          if (LCase(StringListItem(bits, 1)) = \"false\") {\n            set (current_object, StringListItem(bits, 0), false)\n          }\n          else if (LCase(StringListItem(bits, 1)) = \"true\") {\n            set (current_object, StringListItem(bits, 0), true)\n          }\n          else if (IsInt(StringListItem(bits, 1))) {\n            set (current_object, StringListItem(bits, 0), ToInt(StringListItem(bits, 1)))\n          }\n          if (not game.setUp) {\n            set (current_object, StringListItem(bits, 0), StringListItem(bits, 1))\n          }\n          else {\n            set (current_object, StringListItem(bits, 0), game.pov)\n          }\n        }\n      }\n    }\n    msg (\"Done.\")\n  &lt;/function&gt;\n</code></pre>\n<pre><code>  &lt;function name=\"Crop\" parameters=\"s\" type=\"string\"&gt;&lt;![CDATA[\n    start = 1\n    end = LengthOf(s)\n    for (i, 1, LengthOf(s)) {\n      if (Asc(Mid(s, i, 1)) &lt; 33) {\n        if (start = i) {\n          start = i + 1\n        }\n      }\n      else {\n        end = i\n      }\n    }\n    return (Mid(s, start, end - start + 1))\n  ]]&gt;&lt;/function&gt;\n</code></pre>\n<pre><code>  &lt;command name=\"px_update\"&gt;\n    &lt;pattern&gt;load #text#&lt;/pattern&gt;\n    &lt;script&gt;\n      LoadFile (text)\n    &lt;/script&gt;\n  &lt;/command&gt;\n\n</code></pre>\n\n",
      "PostDate": "2017-12-01T04:16:39.2364386Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "a962239a-7d45-4038-914e-ba4b25382567",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "http://i.imgur.com/FOIjtApb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "You can load a file like this example.\r\n\r\n```find=``` just finds an existing object you want to change attributes on.\r\n\r\n```new=``` creates a new object, of course.\r\n\r\nEverything else should be familiar.\r\n\r\nPixie created all this, by the way.  I just added a couple of tweaks to his code.\r\n\r\n\r\n\r\n```\r\nnew=kv_special_item_1\r\nalias=black shard of &infin;\r\nlook=It's the black shard, which is the most powerful of them all!\r\nparent=game.pov\r\n\r\nfind=kv_green_shard\r\nparent=game.pov\r\n\r\nnew=thingy\r\nparent=game.pov.parent\r\n\r\nnew=anotherThing\r\nparent=player.parent\r\n\r\nnew=thing3\r\nparent=here\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p>You can load a file like this example.</p>\n<p><code>find=</code> just finds an existing object you want to change attributes on.</p>\n<p><code>new=</code> creates a new object, of course.</p>\n<p>Everything else should be familiar.</p>\n<p>Pixie created all this, by the way.  I just added a couple of tweaks to his code.</p>\n<pre><code>new=kv_special_item_1\nalias=black shard of &amp;infin;\nlook=It's the black shard, which is the most powerful of them all!\nparent=game.pov\n\nfind=kv_green_shard\nparent=game.pov\n\nnew=thingy\nparent=game.pov.parent\n\nnew=anotherThing\nparent=player.parent\n\nnew=thing3\nparent=here\n</code></pre>\n\n",
      "PostDate": "2017-12-01T04:19:30.0510819Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "53baae06-d9ae-4524-bfd0-97854f9d89dc",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "http://i.imgur.com/FOIjtApb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": ">GetFileData() should have a counter command PutFileData()\r\n\r\nI can build you a version of Quest where Log doesn't print the date and time at the beginning of each entry.\r\n\r\nYou could then just use Log(\"whatever you want to save on a line to the .txt file\") in place of PutFileData().\r\n\r\n(I can do that.  I'll damned if I can figure out how to call a function that Quest can't already call, though.  I've been trying to figure out how to make it so I can call the Restart function forever!)",
      "EditableFormat": "markdown",
      "HTML": "<blockquote>\n<p>GetFileData() should have a counter command PutFileData()</p>\n</blockquote>\n<p>I can build you a version of Quest where Log doesn't print the date and time at the beginning of each entry.</p>\n<p>You could then just use Log(\"whatever you want to save on a line to the .txt file\") in place of PutFileData().</p>\n<p>(I can do that.  I'll damned if I can figure out how to call a function that Quest can't already call, though.  I've been trying to figure out how to make it so I can call the Restart function forever!)</p>\n\n",
      "PostDate": "2017-12-01T05:38:32.199077Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

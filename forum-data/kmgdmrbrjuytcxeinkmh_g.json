{
  "Topic": {
    "TopicId": "kmgdmrbrjuytcxeinkmh_g",
    "ForumId": "10",
    "Title": "Description displaying twice?",
    "LastUpdated": "2019-06-12T02:34:00.6516766Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "0d7e03c1-5eae-48c7-8bf0-d3c7d7c3064c",
      "UserId": 422639,
      "Username": "Mikalhvi",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I am sure this question has been asked before, but I came by here on the forums just to ask, simply because while going through the list of script commands and settings, I couldn't find anything that supported what I'm trying to do.\r\n\r\nI'm trying to create a description for a room, that when you first enter/spawn into a room, it gives you an in-depth description, and then afterwards only displays a short summary of the room.\r\n\r\nI thought I had it figured out with the room's \"before/after first visit\" options under the scripts tab, but it displays both the \"first visit\" and short message description for other visits, at the same time.\r\n\r\nIs there some way I can set up a multi-purpose script that detects if the player has been in any room before, and then triggers the appropriate description? Or do I have to create an individual script, tracker, or other command to do that?",
      "EditableFormat": "markdown",
      "HTML": "<p>I am sure this question has been asked before, but I came by here on the forums just to ask, simply because while going through the list of script commands and settings, I couldn't find anything that supported what I'm trying to do.</p>\n<p>I'm trying to create a description for a room, that when you first enter/spawn into a room, it gives you an in-depth description, and then afterwards only displays a short summary of the room.</p>\n<p>I thought I had it figured out with the room's \"before/after first visit\" options under the scripts tab, but it displays both the \"first visit\" and short message description for other visits, at the same time.</p>\n<p>Is there some way I can set up a multi-purpose script that detects if the player has been in any room before, and then triggers the appropriate description? Or do I have to create an individual script, tracker, or other command to do that?</p>\n\n",
      "PostDate": "2019-06-12T02:34:00.6516766Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "2cb4888c-8f84-41fe-aa20-a979a31f226f",
      "UserId": 142763,
      "Username": "Forgewright",
      "AvatarUrl": "http://i.imgur.com/Ea6HecZb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "The room is lit by torches. {once: Large wooden beams run across the ceiling. Tables are placed in a row.}\r\nAdd the above to the room description either in the text box or in a script.\r\nThe {once: whatever text} will only print the text in brackets once and the rest will show every time you enter the room.",
      "EditableFormat": "markdown",
      "HTML": "<p>The room is lit by torches. {once: Large wooden beams run across the ceiling. Tables are placed in a row.}<br>\nAdd the above to the room description either in the text box or in a script.<br>\nThe {once: whatever text} will only print the text in brackets once and the rest will show every time you enter the room.</p>\n\n",
      "PostDate": "2019-06-12T03:15:53.393348Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "88138f3b-9377-4a7f-8799-097754cf4a2c",
      "UserId": 422639,
      "Username": "Mikalhvi",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thank you for the help. So, it seems like for the starting room, I can't successfully use both the \"after entering the room\" and \"after entering the room for the first time\", since it displays both, but I could use the above code you gave me as a sort of work-around.\r\n\r\nDo you know if that a preexisting issue with the Quest programming, or is it intentional?",
      "EditableFormat": "markdown",
      "HTML": "<p>Thank you for the help. So, it seems like for the starting room, I can't successfully use both the \"after entering the room\" and \"after entering the room for the first time\", since it displays both, but I could use the above code you gave me as a sort of work-around.</p>\n<p>Do you know if that a preexisting issue with the Quest programming, or is it intentional?</p>\n\n",
      "PostDate": "2019-06-12T04:16:28.5767222Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "382cc2e8-bbf2-4740-81dd-1015918a2ad7",
      "UserId": 924,
      "Username": "Pertex",
      "AvatarUrl": "https://secure.gravatar.com/avatar/4cc1e52f99452e841ecf4cbee9eadde9?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "You can use the visited attribute to check whether the room has already been entered.\r\n\r\nif (player.parent.visited) then ...\r\n\r\nPerhaps the best way is to overwrite and expanse the showRoomDescription function",
      "EditableFormat": "markdown",
      "HTML": "<p>You can use the visited attribute to check whether the room has already been entered.</p>\n<p>if (player.parent.visited) then ...</p>\n<p>Perhaps the best way is to overwrite and expanse the showRoomDescription function</p>\n\n",
      "PostDate": "2019-06-12T07:09:19.2104822Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "911ef7e9-8d95-49fb-b50d-416807cd0c90",
      "UserId": 304102,
      "Username": "Doctor Agon",
      "AvatarUrl": "http://i.imgur.com/Lzd3mOwb.jpg",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Not sure if this is what you want, but, K.V. did come up with a library, 'verbosity', which allowed the adventure writer to display the room description in the following ways \r\n\r\nEntering SUPERBRIEF or SHORT will not display any room descriptions (except for the room name, the objects list, and the exits list), even if you haven't visited the room.\r\nEntering BRIEF will not display room descriptions in rooms you have visited before\r\nEntering VERBOSE or LONG will display all room descriptions\r\n\r\nhttp://textadventures.co.uk/forum/samples/topic/y-ykeodite2pubg28rd-_q/infocom-style-room-descriptions\r\n\r\nI've checked the link on the page for the library, but it appears to be broken. If KV is around, maybe he can post the code.\r\n",
      "EditableFormat": "markdown",
      "HTML": "<p>Not sure if this is what you want, but, K.V. did come up with a library, 'verbosity', which allowed the adventure writer to display the room description in the following ways</p>\n<p>Entering SUPERBRIEF or SHORT will not display any room descriptions (except for the room name, the objects list, and the exits list), even if you haven't visited the room.<br>\nEntering BRIEF will not display room descriptions in rooms you have visited before<br>\nEntering VERBOSE or LONG will display all room descriptions</p>\n<p>http://textadventures.co.uk/forum/samples/topic/y-ykeodite2pubg28rd-_q/infocom-style-room-descriptions</p>\n<p>I've checked the link on the page for the library, but it appears to be broken. If KV is around, maybe he can post the code.</p>\n\n",
      "PostDate": "2019-06-12T08:07:19.6112016Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "92607d91-59d2-499a-aadc-60e6981eb5c9",
      "UserId": 301690,
      "Username": "Richard Headkid",
      "AvatarUrl": "http://i.imgur.com/WUGXS8yb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "This is version 2 of VerbosityLib.  It was designed to work with Quest 5.7.2, and I can't remember if I tested it out with Quest 5.8.\r\n\r\nIn fact, Pixie was considering including this code in Quest 5.8, and I can't remember if he did that.  **(EDIT: I searched on GitHub, and I don't see this code in Quest 5.8.  If there is an issue with 5.8, it will be something to do with my modified ```ShowRoomDescription()```.)**\r\n\r\nBasically, I can't remember anything!  [Maniacal Laugh #5]\r\n\r\n---\r\nAnyway, here's the code (which will need to be pasted into a blank document, then saved as VerbosityLib.aslx\"):\r\n\r\n<details>\r\n\r\n```\r\n<!-- \r\n    VerbosityLib\r\n    version 2\r\n-->\r\n\r\n<library>\r\n  <function name=\"ShowRoomDescription\"><![CDATA[\r\n    if (not GetBoolean (game, \"verboseonly \")){\r\n      if (GetBoolean(game,\"brief_descriptions\")) {\r\n        if (game.pov.parent.visited) {\r\n          if ((player.currentcommand = \"l\") or player.currentcommand = \"look\") {\r\n            if (not GetBoolean(game, \"alwayslook\")) {\r\n              game.autodescription_description = 0\r\n            }\r\n            else {\r\n              // Do nothing\r\n            }\r\n          }\r\n          else {\r\n            game.autodescription_description = 0\r\n          }\r\n        }\r\n      }\r\n    }\r\n    isDark = CheckDarkness()\r\n    if (isDark) {\r\n      descriptionfield = \"darkroomdescription\"\r\n    }\r\n    else {\r\n      descriptionfield = \"description\"\r\n    }\r\n    if (game.autodescription) {\r\n      desc = \"\"\r\n      for (i, 1, 4) {\r\n        if (i = game.autodescription_youarein) {\r\n          if (game.autodescription_youarein_useprefix) {\r\n            youarein = game.pov.parent.descprefix\r\n            desc = AddDescriptionLine (desc, youarein + \" \" + GetDisplayName(game.pov.parent) + \".\")\r\n          }\r\n          else {\r\n            desc = AddDescriptionLine (desc, \"<b>\" + CapFirst(GetDisplayName(game.pov.parent)) + \"</b>\")\r\n          }\r\n          if (game.autodescription_youarein_newline) {\r\n            msg (desc + \"<br/>\")\r\n            desc = \"\"\r\n          }\r\n        }\r\n        if (i = game.autodescription_youcansee) {\r\n          objects = FormatObjectList(game.pov.parent.objectslistprefix, GetNonTransparentParent(game.pov.parent), Template(\"And\"), \".\")\r\n          desc = AddDescriptionLine(desc, objects)\r\n          if (game.autodescription_youcansee_newline) {\r\n            msg (desc + \"<br/>\")\r\n            desc = \"\"\r\n          }\r\n        }\r\n        if (i = game.autodescription_youcango) {\r\n          exits = FormatExitList(game.pov.parent.exitslistprefix, GetExitsList(), Template(\"Or\"), \".\")\r\n          desc = AddDescriptionLine(desc, exits)\r\n          if (game.autodescription_youcango_newline) {\r\n            msg (desc + \"<br/>\")\r\n            desc = \"\"\r\n          }\r\n        }\r\n        if (i = game.autodescription_description) {\r\n          if (HasScript(game.pov.parent, descriptionfield)) {\r\n            if (LengthOf(desc) > 0) {\r\n              msg (desc)\r\n              desc = \"\"\r\n            }\r\n            do (game.pov.parent, descriptionfield)\r\n            if (game.autodescription_description_newline) {\r\n              msg (\"\")\r\n            }\r\n          }\r\n          else {\r\n            desc = AddDescriptionLine(desc, GetRoomDescription())\r\n            if (game.autodescription_description_newline) {\r\n              msg (desc + \"<br/>\")\r\n              desc = \"\"\r\n            }\r\n          }\r\n        }\r\n      }\r\n      if (LengthOf(desc) > 0) {\r\n        msg (desc)\r\n      }\r\n    }\r\n    else {\r\n      if (HasScript(game.pov.parent, descriptionfield)) {\r\n        do (game.pov.parent, descriptionfield)\r\n      }\r\n      else {\r\n        fulldesc = GetRoomDescription()\r\n        if (LengthOf(fulldesc) > 0) {\r\n          msg (fulldesc)\r\n        }\r\n      }\r\n    }\r\n    if (GetBoolean(game,\"brief_descriptions\")) {\r\n      game.autodescription_description = game.autodescription_descriptionBak\r\n    }\r\n  ]]></function>\r\n\r\n  <command name=\"brief_cmd\">\r\n    <pattern>brief</pattern>\r\n    <script><![CDATA[\r\n\t  if (not GetBoolean (game, \"verboseonly \")){\r\n        if (not GetBoolean(game, \"brief_descriptions\")) {\r\n          game.notarealturn = true\r\n          game.brief_descriptions = true\r\n          game.autodescription_description = game.autodescription_descriptionBak\r\n        }\r\n      msg (\"Room Descriptions are now set to \\\"BRIEF\\\".  Room descriptions will only print if you haven't visited a room yet.<br/>\")\r\n\t  }\r\n\t  else {\r\n\t    msg(\"This game does not support BRIEF or SUPERBRIEF settings.  Room descriptions will always print.<br/>\")\r\n\t  }\r\n    ]]></script>\r\n  </command>\r\n\r\n  <command name=\"superbrief_cmd\">\r\n    <pattern>superbrief;short</pattern>\r\n    <script><![CDATA[\r\n\t  if (not GetBoolean (game, \"verboseonly \")){\r\n        game.notarealturn = true\r\n        game.autodescription_description = 0\r\n        msg (\"Room Descriptions are now set to \\\"SUPERBRIEF\\\".  Room descriptions will not print (even if you haven't visited the room before).<br/>\")\r\n\t  }\r\n\t  else {\r\n\t    msg (\"This game does not support BRIEF or SUPERBRIEF settings.  Room descriptions will always print.<br/>\")\r\n\t  }\r\n    ]]></script>\r\n  </command>\r\n\r\n  <command name=\"verbose_cmd\">\r\n    <pattern>verbose;long</pattern>\r\n    <script><![CDATA[\r\n\t  if (not GetBoolean (game, \"verboseonly \")){\r\n        game.notarealturn = true\r\n        game.autodescription_description = game.autodescription_descriptionBak\r\n        game.brief_descriptions = false\r\n        msg (\"Room Descriptions are now set to \\\"VERBOSE\\\".  Room descriptions will always print.<br/>\")\r\n\t  }\r\n\t  else {\r\n\t    msg (\"This game does not support BRIEF or SUPERBRIEF settings.  Room descriptions will always print.<br/>\")\r\n\t  }\r\n    ]]></script>\r\n  </command>\r\n  \r\n  <editor>\r\n\t<tab>\r\n\t  <parent>_GameEditor</parent>\r\n\t  <caption>Verbosity Settings</caption>\r\n\t  <appliesto>game</appliesto>\r\n\t  <control>\r\n\t\t<controltype>checkbox</controltype>\r\n\t\t<caption>Always print room descriptions</caption>\r\n\t\t<attribute>verboseonly</attribute>\r\n\t  </control>\r\n\t  <control>\r\n\t\t<onlydisplayif>not GetBoolean(game,\"verboseonly\")</onlydisplayif>\r\n\t\t<controltype>checkbox</controltype>\r\n\t\t<caption>Always print room descriptions when player enters LOOK</caption>\r\n\t\t<attribute>verboseonly</attribute>\r\n\t  </control>\r\n\t</tab>\r\n  </editor>\r\n</library>\r\n```\r\n\r\n</details> ",
      "EditableFormat": "markdown",
      "HTML": "<p>This is version 2 of VerbosityLib.  It was designed to work with Quest 5.7.2, and I can't remember if I tested it out with Quest 5.8.</p>\n<p>In fact, Pixie was considering including this code in Quest 5.8, and I can't remember if he did that.  <strong>(EDIT: I searched on GitHub, and I don't see this code in Quest 5.8.  If there is an issue with 5.8, it will be something to do with my modified <code>ShowRoomDescription()</code>.)</strong></p>\n<p>Basically, I can't remember anything!  [Maniacal Laugh #5]</p>\n<hr>\n<p>Anyway, here's the code (which will need to be pasted into a blank document, then saved as VerbosityLib.aslx\"):</p>\n<details>\n<pre><code>&lt;!-- \n    VerbosityLib\n    version 2\n--&gt;\n\n&lt;library&gt;\n  &lt;function name=\"ShowRoomDescription\"&gt;&lt;![CDATA[\n    if (not GetBoolean (game, \"verboseonly \")){\n      if (GetBoolean(game,\"brief_descriptions\")) {\n        if (game.pov.parent.visited) {\n          if ((player.currentcommand = \"l\") or player.currentcommand = \"look\") {\n            if (not GetBoolean(game, \"alwayslook\")) {\n              game.autodescription_description = 0\n            }\n            else {\n              // Do nothing\n            }\n          }\n          else {\n            game.autodescription_description = 0\n          }\n        }\n      }\n    }\n    isDark = CheckDarkness()\n    if (isDark) {\n      descriptionfield = \"darkroomdescription\"\n    }\n    else {\n      descriptionfield = \"description\"\n    }\n    if (game.autodescription) {\n      desc = \"\"\n      for (i, 1, 4) {\n        if (i = game.autodescription_youarein) {\n          if (game.autodescription_youarein_useprefix) {\n            youarein = game.pov.parent.descprefix\n            desc = AddDescriptionLine (desc, youarein + \" \" + GetDisplayName(game.pov.parent) + \".\")\n          }\n          else {\n            desc = AddDescriptionLine (desc, \"&lt;b&gt;\" + CapFirst(GetDisplayName(game.pov.parent)) + \"&lt;/b&gt;\")\n          }\n          if (game.autodescription_youarein_newline) {\n            msg (desc + \"&lt;br/&gt;\")\n            desc = \"\"\n          }\n        }\n        if (i = game.autodescription_youcansee) {\n          objects = FormatObjectList(game.pov.parent.objectslistprefix, GetNonTransparentParent(game.pov.parent), Template(\"And\"), \".\")\n          desc = AddDescriptionLine(desc, objects)\n          if (game.autodescription_youcansee_newline) {\n            msg (desc + \"&lt;br/&gt;\")\n            desc = \"\"\n          }\n        }\n        if (i = game.autodescription_youcango) {\n          exits = FormatExitList(game.pov.parent.exitslistprefix, GetExitsList(), Template(\"Or\"), \".\")\n          desc = AddDescriptionLine(desc, exits)\n          if (game.autodescription_youcango_newline) {\n            msg (desc + \"&lt;br/&gt;\")\n            desc = \"\"\n          }\n        }\n        if (i = game.autodescription_description) {\n          if (HasScript(game.pov.parent, descriptionfield)) {\n            if (LengthOf(desc) &gt; 0) {\n              msg (desc)\n              desc = \"\"\n            }\n            do (game.pov.parent, descriptionfield)\n            if (game.autodescription_description_newline) {\n              msg (\"\")\n            }\n          }\n          else {\n            desc = AddDescriptionLine(desc, GetRoomDescription())\n            if (game.autodescription_description_newline) {\n              msg (desc + \"&lt;br/&gt;\")\n              desc = \"\"\n            }\n          }\n        }\n      }\n      if (LengthOf(desc) &gt; 0) {\n        msg (desc)\n      }\n    }\n    else {\n      if (HasScript(game.pov.parent, descriptionfield)) {\n        do (game.pov.parent, descriptionfield)\n      }\n      else {\n        fulldesc = GetRoomDescription()\n        if (LengthOf(fulldesc) &gt; 0) {\n          msg (fulldesc)\n        }\n      }\n    }\n    if (GetBoolean(game,\"brief_descriptions\")) {\n      game.autodescription_description = game.autodescription_descriptionBak\n    }\n  ]]&gt;&lt;/function&gt;\n\n  &lt;command name=\"brief_cmd\"&gt;\n    &lt;pattern&gt;brief&lt;/pattern&gt;\n    &lt;script&gt;&lt;![CDATA[\n\t  if (not GetBoolean (game, \"verboseonly \")){\n        if (not GetBoolean(game, \"brief_descriptions\")) {\n          game.notarealturn = true\n          game.brief_descriptions = true\n          game.autodescription_description = game.autodescription_descriptionBak\n        }\n      msg (\"Room Descriptions are now set to \\\"BRIEF\\\".  Room descriptions will only print if you haven't visited a room yet.&lt;br/&gt;\")\n\t  }\n\t  else {\n\t    msg(\"This game does not support BRIEF or SUPERBRIEF settings.  Room descriptions will always print.&lt;br/&gt;\")\n\t  }\n    ]]&gt;&lt;/script&gt;\n  &lt;/command&gt;\n\n  &lt;command name=\"superbrief_cmd\"&gt;\n    &lt;pattern&gt;superbrief;short&lt;/pattern&gt;\n    &lt;script&gt;&lt;![CDATA[\n\t  if (not GetBoolean (game, \"verboseonly \")){\n        game.notarealturn = true\n        game.autodescription_description = 0\n        msg (\"Room Descriptions are now set to \\\"SUPERBRIEF\\\".  Room descriptions will not print (even if you haven't visited the room before).&lt;br/&gt;\")\n\t  }\n\t  else {\n\t    msg (\"This game does not support BRIEF or SUPERBRIEF settings.  Room descriptions will always print.&lt;br/&gt;\")\n\t  }\n    ]]&gt;&lt;/script&gt;\n  &lt;/command&gt;\n\n  &lt;command name=\"verbose_cmd\"&gt;\n    &lt;pattern&gt;verbose;long&lt;/pattern&gt;\n    &lt;script&gt;&lt;![CDATA[\n\t  if (not GetBoolean (game, \"verboseonly \")){\n        game.notarealturn = true\n        game.autodescription_description = game.autodescription_descriptionBak\n        game.brief_descriptions = false\n        msg (\"Room Descriptions are now set to \\\"VERBOSE\\\".  Room descriptions will always print.&lt;br/&gt;\")\n\t  }\n\t  else {\n\t    msg (\"This game does not support BRIEF or SUPERBRIEF settings.  Room descriptions will always print.&lt;br/&gt;\")\n\t  }\n    ]]&gt;&lt;/script&gt;\n  &lt;/command&gt;\n  \n  &lt;editor&gt;\n\t&lt;tab&gt;\n\t  &lt;parent&gt;_GameEditor&lt;/parent&gt;\n\t  &lt;caption&gt;Verbosity Settings&lt;/caption&gt;\n\t  &lt;appliesto&gt;game&lt;/appliesto&gt;\n\t  &lt;control&gt;\n\t\t&lt;controltype&gt;checkbox&lt;/controltype&gt;\n\t\t&lt;caption&gt;Always print room descriptions&lt;/caption&gt;\n\t\t&lt;attribute&gt;verboseonly&lt;/attribute&gt;\n\t  &lt;/control&gt;\n\t  &lt;control&gt;\n\t\t&lt;onlydisplayif&gt;not GetBoolean(game,\"verboseonly\")&lt;/onlydisplayif&gt;\n\t\t&lt;controltype&gt;checkbox&lt;/controltype&gt;\n\t\t&lt;caption&gt;Always print room descriptions when player enters LOOK&lt;/caption&gt;\n\t\t&lt;attribute&gt;verboseonly&lt;/attribute&gt;\n\t  &lt;/control&gt;\n\t&lt;/tab&gt;\n  &lt;/editor&gt;\n&lt;/library&gt;\n</code></pre>\n</details> \n\n",
      "PostDate": "2019-06-12T23:59:42.5834713Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}

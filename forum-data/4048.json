{
  "Topic": {
    "TopicId": "4048",
    "ForumId": "10",
    "Title": "Problem with custom Gamebook mode",
    "LastUpdated": "2013-12-15T17:49:01+00:00",
    "ReplyCount": 4
  },
  "Posts": [
    {
      "PostId": "27100",
      "UserId": 0,
      "Username": "Strainer",
      "UserAvatar": null,
      "UserGravatar": "d85d349b8c257786ac40bb20c228e86d",
      "EditableText": "Hello dear community!\n\nI have just recently picked up Quest and mostly spent my time finding out about the scripting language and reading through the tutorials and wiki.\n\nI am planning to write an engine to support character stats and random rolls on different traits of the character, similar to a pen&amp;paper RPG. I want to implement these functions in a gamebook-like mode though, but I found that the native Gamebook mode lacks an important funciton for this project, object handling. (As it seems, rooms are just objects in a gamebook file, maybe that's why).\n\nFor this reason, I decided to write a simple function to take over the Linking of pages and go from there, unfortunately, I couldn't get my function to work.\n\nI would appreciate any help on this, I also think I have done things a little complicated, any tips highly appreciated.\n\nThe function is called &quot;ShowLinks&quot; and reads like this\n\n[code:217paf00]\nChoices&#46;Choice1 = Choice1\nChoices&#46;Choice1Room = Choice1Room\nChoices&#46;Choice2 = Choice2\nChoices&#46;Choice2Room = Choice2Room\nChoices&#46;Choice3 = Choice3\nChoices&#46;Choice3Room = Choice3Room\nChoices&#46;Choice4 = Choice4\nChoices&#46;Choice4Room = Choice4Room\nChoices = NewStringList ()\nlist add (Choices, Choice1)\nif (not Choice2 = &quot;&quot;) {\n}\nlist add (Choices, Choice2)\nif (not Choice3 = &quot;&quot;) {\n}\nlist add (Choices, Choice3)\nif (not Choice4 = &quot;&quot;) {\n}\nlist add (Choices, Choice4)\nmsg (&quot;&quot;)\nShowMenu (MenuCaption, Choices, false) {\n  msg (result)\n  msg (Choices&#46;Choice1Room)\n  if (result = Choices&#46;Choice1) {\n    ClearScreen\n    MoveObject (player, Choices&#46;Choice1Room)\n  }\n  else if (result = &quot;Choice2&quot;) {\n    ClearScreen\n    MoveObject (player, Choice2Room)\n  }\n  else if (result = &quot;Choice3&quot;) {\n    ClearScreen\n    MoveObject (player, Choice3Room)\n  }\n  else if (result = &quot;Choice4&quot;) {\n    ClearScreen\n    MoveObject (player, Choice4Room)\n  }\n}[/code:217paf00]\n\nEdit: I have found the error, which wasn't actually in the function, but the code that called it:\n\nShowLinks (&quot;Do you want to...&quot;, &quot;do A.&quot;, room1, &quot;do B.&quot;, room1, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;)\n\nI had room1 written as &quot;room1&quot; which was the whole error, seems like I have to store it as the object, not as a string.\n\nEdit2: Another question I had: Could I define standard values for a function, so I don't have to declare &quot;&quot; for the choices I don't need? I would like to make this function as flexible as possible, so supporting a variable number of choices is probably the right way to go, but writing 10 choices would require me to write something like ShowLinks (&quot;What you want...&quot;, &quot;do A.&quot;, room1, &quot;do B.&quot;, room2, &quot;do C.&quot;, room3, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;). This kinda eliminiates the purpose of it being easy or user-friendly.",
      "EditableFormat": "bbcode",
      "HTML": "Hello dear community!<br/><br/>I have just recently picked up Quest and mostly spent my time finding out about the scripting language and reading through the tutorials and wiki.<br/><br/>I am planning to write an engine to support character stats and random rolls on different traits of the character, similar to a pen&amp;paper RPG. I want to implement these functions in a gamebook-like mode though, but I found that the native Gamebook mode lacks an important funciton for this project, object handling. (As it seems, rooms are just objects in a gamebook file, maybe that's why).<br/><br/>For this reason, I decided to write a simple function to take over the Linking of pages and go from there, unfortunately, I couldn't get my function to work.<br/><br/>I would appreciate any help on this, I also think I have done things a little complicated, any tips highly appreciated.<br/><br/>The function is called &quot;ShowLinks&quot; and reads like this<br/><br/><pre><code><br/>Choices&#46;Choice1 = Choice1<br/>Choices&#46;Choice1Room = Choice1Room<br/>Choices&#46;Choice2 = Choice2<br/>Choices&#46;Choice2Room = Choice2Room<br/>Choices&#46;Choice3 = Choice3<br/>Choices&#46;Choice3Room = Choice3Room<br/>Choices&#46;Choice4 = Choice4<br/>Choices&#46;Choice4Room = Choice4Room<br/>Choices = NewStringList ()<br/>list add (Choices, Choice1)<br/>if (not Choice2 = &quot;&quot;) {<br/>}<br/>list add (Choices, Choice2)<br/>if (not Choice3 = &quot;&quot;) {<br/>}<br/>list add (Choices, Choice3)<br/>if (not Choice4 = &quot;&quot;) {<br/>}<br/>list add (Choices, Choice4)<br/>msg (&quot;&quot;)<br/>ShowMenu (MenuCaption, Choices, false) {<br/>  msg (result)<br/>  msg (Choices&#46;Choice1Room)<br/>  if (result = Choices&#46;Choice1) {<br/>    ClearScreen<br/>    MoveObject (player, Choices&#46;Choice1Room)<br/>  }<br/>  else if (result = &quot;Choice2&quot;) {<br/>    ClearScreen<br/>    MoveObject (player, Choice2Room)<br/>  }<br/>  else if (result = &quot;Choice3&quot;) {<br/>    ClearScreen<br/>    MoveObject (player, Choice3Room)<br/>  }<br/>  else if (result = &quot;Choice4&quot;) {<br/>    ClearScreen<br/>    MoveObject (player, Choice4Room)<br/>  }<br/>}</code></pre><br/><br/>Edit: I have found the error, which wasn't actually in the function, but the code that called it:<br/><br/>ShowLinks (&quot;Do you want to...&quot;, &quot;do A.&quot;, room1, &quot;do B.&quot;, room1, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;)<br/><br/>I had room1 written as &quot;room1&quot; which was the whole error, seems like I have to store it as the object, not as a string.<br/><br/>Edit2: Another question I had: Could I define standard values for a function, so I don't have to declare &quot;&quot; for the choices I don't need? I would like to make this function as flexible as possible, so supporting a variable number of choices is probably the right way to go, but writing 10 choices would require me to write something like ShowLinks (&quot;What you want...&quot;, &quot;do A.&quot;, room1, &quot;do B.&quot;, room2, &quot;do C.&quot;, room3, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;). This kinda eliminiates the purpose of it being easy or user-friendly.<div><a href=\"/attachment/795\">CoreNewMenu.aslx</a></div><div><a href=\"/attachment/794\">Test.aslx</a></div>",
      "PostDate": "2013-12-14T02:53:45+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "27102",
      "UserId": 0,
      "Username": "jaynabonne",
      "UserAvatar": "6579_1344778256.jpg",
      "UserGravatar": "379859a7f1952a65399fc63997e68f0b",
      "EditableText": "Since you found the first problem, I won't go into that... <!-- s:) --><img src=\"{SMILIES_PATH}/icon_smile.gif\" alt=\":)\" title=\"Smile\" /><!-- s:) -->\n\nFor the second question, I'd like to propose a solution. There is a fairly simple way to go using dictionaries. ShowMenu can take a dictionary instead of a list of strings. The name/value pairs correspond to the result and displayed text respectively. In this case, the key/result string is the name of the room, and the value/displayed text is whatever you want to display. You can then easily use GetObject to get the room from its name when an item is chosen.\n\nIt does mean that things will be more data-driven (you create dictionaries to hold choices instead of function parameters), but I think that's cleaner anyway, to be honest.\n\nThe function is called ChooseRoom, and it's quite simple:\n\n[code:tn3esbdv]  &lt;function name=&quot;ChooseRoom&quot; parameters=&quot;caption, choices&quot;&gt;\n    ShowMenu (caption, choices, false) {\n      ClearScreen\n      MoveObject (player, GetObject(result))\n    }\n  &lt;/function&gt;[/code:tn3esbdv]\nYou just need to pass in a dictionary with the choices. A full code example follows. I attached the dictionary to the current room to keep it encapsulated. It's up to you how you want to organize the data. <!-- s:) --><img src=\"{SMILIES_PATH}/icon_smile.gif\" alt=\":)\" title=\"Smile\" /><!-- s:) --> Let me know if you have any questions.\n\n[code:tn3esbdv]&lt;!--Saved by Quest 5&#46;4&#46;4873&#46;16527--&gt;\n&lt;asl version=&quot;540&quot;&gt;\n  &lt;include ref=&quot;English&#46;aslx&quot; /&gt;\n  &lt;include ref=&quot;Core&#46;aslx&quot; /&gt;\n  &lt;game name=&quot;EasyGamebook&quot;&gt;\n    &lt;gameid&gt;4e12284d-c554-45d8-93b1-8e91d047f697&lt;/gameid&gt;\n    &lt;version&gt;1&#46;0&lt;/version&gt;\n    &lt;firstpublished&gt;2013&lt;/firstpublished&gt;\n  &lt;/game&gt;\n  &lt;object name=&quot;room&quot;&gt;\n    &lt;inherit name=&quot;editor_room&quot; /&gt;\n    &lt;choices type=&quot;stringdictionary&quot;&gt;\n      &lt;item&gt;\n        &lt;key&gt;Room 1&lt;/key&gt;\n        &lt;value&gt;Head to the kitchen&lt;/value&gt;\n      &lt;/item&gt;\n      &lt;item&gt;\n        &lt;key&gt;Room 2&lt;/key&gt;\n        &lt;value&gt;Go downstairs&lt;/value&gt;\n      &lt;/item&gt;\n    &lt;/choices&gt;\n    &lt;enter type=&quot;script&quot;&gt;\n      ChooseRoom (&quot;What would you like to do?&quot;, player&#46;parent&#46;choices)\n    &lt;/enter&gt;\n    &lt;object name=&quot;player&quot;&gt;\n      &lt;inherit name=&quot;editor_object&quot; /&gt;\n      &lt;inherit name=&quot;editor_player&quot; /&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n  &lt;object name=&quot;Room 1&quot;&gt;\n    &lt;inherit name=&quot;editor_room&quot; /&gt;\n    &lt;description type=&quot;string&quot;&gt;&lt;/description&gt;\n    &lt;alias&gt;the kitchen&lt;/alias&gt;\n    &lt;usedefaultprefix type=&quot;boolean&quot;&gt;false&lt;/usedefaultprefix&gt;\n  &lt;/object&gt;\n  &lt;object name=&quot;Room 2&quot;&gt;\n    &lt;inherit name=&quot;editor_room&quot; /&gt;\n    &lt;alias&gt;the basement&lt;/alias&gt;\n    &lt;usedefaultprefix type=&quot;boolean&quot;&gt;false&lt;/usedefaultprefix&gt;\n  &lt;/object&gt;\n  &lt;function name=&quot;ChooseRoom&quot; parameters=&quot;caption, choices&quot;&gt;\n    ShowMenu (caption, choices, false) {\n      ClearScreen\n      MoveObject (player, GetObject(result))\n    }\n  &lt;/function&gt;\n&lt;/asl&gt;[/code:tn3esbdv]",
      "EditableFormat": "bbcode",
      "HTML": "Since you found the first problem, I won't go into that... <!-- s:) --><img src=\"{SMILIES_PATH}/icon_smile.gif\" alt=\":)\" title=\"Smile\" /><!-- s:) --><br/><br/>For the second question, I'd like to propose a solution. There is a fairly simple way to go using dictionaries. ShowMenu can take a dictionary instead of a list of strings. The name/value pairs correspond to the result and displayed text respectively. In this case, the key/result string is the name of the room, and the value/displayed text is whatever you want to display. You can then easily use GetObject to get the room from its name when an item is chosen.<br/><br/>It does mean that things will be more data-driven (you create dictionaries to hold choices instead of function parameters), but I think that's cleaner anyway, to be honest.<br/><br/>The function is called ChooseRoom, and it's quite simple:<br/><br/><pre><code>  &lt;function name=&quot;ChooseRoom&quot; parameters=&quot;caption, choices&quot;&gt;<br/>    ShowMenu (caption, choices, false) {<br/>      ClearScreen<br/>      MoveObject (player, GetObject(result))<br/>    }<br/>  &lt;/function&gt;</code></pre><br/>You just need to pass in a dictionary with the choices. A full code example follows. I attached the dictionary to the current room to keep it encapsulated. It's up to you how you want to organize the data. <!-- s:) --><img src=\"{SMILIES_PATH}/icon_smile.gif\" alt=\":)\" title=\"Smile\" /><!-- s:) --> Let me know if you have any questions.<br/><br/><pre><code>&lt;!--Saved by Quest 5&#46;4&#46;4873&#46;16527--&gt;<br/>&lt;asl version=&quot;540&quot;&gt;<br/>  &lt;include ref=&quot;English&#46;aslx&quot; /&gt;<br/>  &lt;include ref=&quot;Core&#46;aslx&quot; /&gt;<br/>  &lt;game name=&quot;EasyGamebook&quot;&gt;<br/>    &lt;gameid&gt;4e12284d-c554-45d8-93b1-8e91d047f697&lt;/gameid&gt;<br/>    &lt;version&gt;1&#46;0&lt;/version&gt;<br/>    &lt;firstpublished&gt;2013&lt;/firstpublished&gt;<br/>  &lt;/game&gt;<br/>  &lt;object name=&quot;room&quot;&gt;<br/>    &lt;inherit name=&quot;editor_room&quot; /&gt;<br/>    &lt;choices type=&quot;stringdictionary&quot;&gt;<br/>      &lt;item&gt;<br/>        &lt;key&gt;Room 1&lt;/key&gt;<br/>        &lt;value&gt;Head to the kitchen&lt;/value&gt;<br/>      &lt;/item&gt;<br/>      &lt;item&gt;<br/>        &lt;key&gt;Room 2&lt;/key&gt;<br/>        &lt;value&gt;Go downstairs&lt;/value&gt;<br/>      &lt;/item&gt;<br/>    &lt;/choices&gt;<br/>    &lt;enter type=&quot;script&quot;&gt;<br/>      ChooseRoom (&quot;What would you like to do?&quot;, player&#46;parent&#46;choices)<br/>    &lt;/enter&gt;<br/>    &lt;object name=&quot;player&quot;&gt;<br/>      &lt;inherit name=&quot;editor_object&quot; /&gt;<br/>      &lt;inherit name=&quot;editor_player&quot; /&gt;<br/>    &lt;/object&gt;<br/>  &lt;/object&gt;<br/>  &lt;object name=&quot;Room 1&quot;&gt;<br/>    &lt;inherit name=&quot;editor_room&quot; /&gt;<br/>    &lt;description type=&quot;string&quot;&gt;&lt;/description&gt;<br/>    &lt;alias&gt;the kitchen&lt;/alias&gt;<br/>    &lt;usedefaultprefix type=&quot;boolean&quot;&gt;false&lt;/usedefaultprefix&gt;<br/>  &lt;/object&gt;<br/>  &lt;object name=&quot;Room 2&quot;&gt;<br/>    &lt;inherit name=&quot;editor_room&quot; /&gt;<br/>    &lt;alias&gt;the basement&lt;/alias&gt;<br/>    &lt;usedefaultprefix type=&quot;boolean&quot;&gt;false&lt;/usedefaultprefix&gt;<br/>  &lt;/object&gt;<br/>  &lt;function name=&quot;ChooseRoom&quot; parameters=&quot;caption, choices&quot;&gt;<br/>    ShowMenu (caption, choices, false) {<br/>      ClearScreen<br/>      MoveObject (player, GetObject(result))<br/>    }<br/>  &lt;/function&gt;<br/>&lt;/asl&gt;</code></pre>",
      "PostDate": "2013-12-14T19:29:25+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "27106",
      "UserId": 0,
      "Username": "Strainer",
      "UserAvatar": null,
      "UserGravatar": "d85d349b8c257786ac40bb20c228e86d",
      "EditableText": "Thank you very much, this is indeed very useful and I will use your method from now on. I will now also try to work on a randomizing function, similar to the one developed for gamebooks here: [url:255r04js]http&#58;//forum&#46;textadventures&#46;co&#46;uk/viewtopic&#46;php?f=18&amp;t=4025[/url:255r04js]\n\nThanks again for your insight, I would have probably never come up with such a nice solution, the need to define the links in the attributes is no problem for me, I think it just adds to the ease of reading the code.",
      "EditableFormat": "bbcode",
      "HTML": "Thank you very much, this is indeed very useful and I will use your method from now on. I will now also try to work on a randomizing function, similar to the one developed for gamebooks here: <a href=\"http&#58;//forum&#46;textadventures&#46;co&#46;uk/viewtopic&#46;php?f=18&amp;t=4025\" rel=\"nofollow\">http&#58;//forum&#46;textadventures&#46;co&#46;uk/viewtopic&#46;php?f=18&amp;t=4025</a><br/><br/>Thanks again for your insight, I would have probably never come up with such a nice solution, the need to define the links in the attributes is no problem for me, I think it just adds to the ease of reading the code.",
      "PostDate": "2013-12-15T15:24:00+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "27110",
      "UserId": 0,
      "Username": "Entropic Pen",
      "UserAvatar": null,
      "UserGravatar": "e5f002e803b6ffc8146a20f6f4777d33",
      "EditableText": "All ya had to do was ask!  I do have a function that can randomize items in a stringlist with a special delimiter that I'm sure we can adapt to Text Adventures.  Though that can't happen anytime soon since I can't access the Internet with my laptop.",
      "EditableFormat": "bbcode",
      "HTML": "All ya had to do was ask!  I do have a function that can randomize items in a stringlist with a special delimiter that I'm sure we can adapt to Text Adventures.  Though that can't happen anytime soon since I can't access the Internet with my laptop.",
      "PostDate": "2013-12-15T17:06:11+00:00",
      "LastEditDate": null
    },
    {
      "PostId": "27111",
      "UserId": 0,
      "Username": "Entropic Pen",
      "UserAvatar": null,
      "UserGravatar": "e5f002e803b6ffc8146a20f6f4777d33",
      "EditableText": "UPDATE 12/16/13:  Now there is a fourth parameter which you can choose to randomize the options or not, which should save some coding on creating two different functions:\n\n[code:3f70cc00]\n&lt;function name=&quot;rand_pagemenu&quot; parameters=&quot;choices, destinations, delimiter, randomizer&quot;&gt;\n    game&#46;return_list = NewStringList()\n    game&#46;location_list = NewStringList()\n    link_list = Split(choices,delimiter)\n    room_list = Split(destinations,delimiter)\n    if (randomizer = true) {\n      for (o, 0, ListCount(link_list) -1, 1) {\n        rand_link = GetRandomInt(0,ListCount(link_list)-1)\n        choosen_link = ListItem(link_list,rand_link)\n        choosen_page = ListItem(room_list,rand_link)\n        list remove (link_list, choosen_link)\n        list remove (room_list, choosen_page)\n        list add (game&#46;return_list, choosen_link)\n        list add (game&#46;location_list, choosen_page)\n      }\n    }\n    else {\n      foreach (o, link_list) {\n        list add (game&#46;return_list, o)\n      }\n      foreach (o, room_list) {\n        list add (game&#46;location_list, o)\n      }\n    }\n    ShowMenu (&quot;&quot;, game&#46;return_list, false) {\n      intItem = 0\n      gotItem = 0\n      foreach (o, game&#46;return_list) {\n        if (o = result) {\n          gotItem = intItem\n        }\n        intItem = intItem +1\n      }\n      location_in_question = ListItem(game&#46;location_list,gotItem)\n      MoveObject (player, GetObject(location_in_question))\n    }\n  &lt;/function&gt;\n[/code:3f70cc00]\n\nAfter that, you'll set up a &quot;Call Function&quot; at the end of a room script like:\n[code:3f70cc00]rand_pagemenu (&quot;(Page 2)&#58;(Page 3)&#58;(Page 4)&quot;, &quot;room2&#58;room3&#58;room4&quot;, &quot;&#58;&quot;, true)[/code:3f70cc00]\n1st Parameter = Link display\n2nd Parameter = list of room objects\n3rd Parameter = Delimiter (what separates the items in the first and second parameters).\n4th Parameter = Whether you want the page links to be randomized or not.\ntrue = randomize\nfalse = don't randomize",
      "EditableFormat": "bbcode",
      "HTML": "UPDATE 12/16/13:  Now there is a fourth parameter which you can choose to randomize the options or not, which should save some coding on creating two different functions:<br/><br/><pre><code><br/>&lt;function name=&quot;rand_pagemenu&quot; parameters=&quot;choices, destinations, delimiter, randomizer&quot;&gt;<br/>    game&#46;return_list = NewStringList()<br/>    game&#46;location_list = NewStringList()<br/>    link_list = Split(choices,delimiter)<br/>    room_list = Split(destinations,delimiter)<br/>    if (randomizer = true) {<br/>      for (o, 0, ListCount(link_list) -1, 1) {<br/>        rand_link = GetRandomInt(0,ListCount(link_list)-1)<br/>        choosen_link = ListItem(link_list,rand_link)<br/>        choosen_page = ListItem(room_list,rand_link)<br/>        list remove (link_list, choosen_link)<br/>        list remove (room_list, choosen_page)<br/>        list add (game&#46;return_list, choosen_link)<br/>        list add (game&#46;location_list, choosen_page)<br/>      }<br/>    }<br/>    else {<br/>      foreach (o, link_list) {<br/>        list add (game&#46;return_list, o)<br/>      }<br/>      foreach (o, room_list) {<br/>        list add (game&#46;location_list, o)<br/>      }<br/>    }<br/>    ShowMenu (&quot;&quot;, game&#46;return_list, false) {<br/>      intItem = 0<br/>      gotItem = 0<br/>      foreach (o, game&#46;return_list) {<br/>        if (o = result) {<br/>          gotItem = intItem<br/>        }<br/>        intItem = intItem +1<br/>      }<br/>      location_in_question = ListItem(game&#46;location_list,gotItem)<br/>      MoveObject (player, GetObject(location_in_question))<br/>    }<br/>  &lt;/function&gt;<br/></code></pre><br/><br/>After that, you'll set up a &quot;Call Function&quot; at the end of a room script like:<br/><pre><code>rand_pagemenu (&quot;(Page 2)&#58;(Page 3)&#58;(Page 4)&quot;, &quot;room2&#58;room3&#58;room4&quot;, &quot;&#58;&quot;, true)</code></pre><br/>1st Parameter = Link display<br/>2nd Parameter = list of room objects<br/>3rd Parameter = Delimiter (what separates the items in the first and second parameters).<br/>4th Parameter = Whether you want the page links to be randomized or not.<br/>true = randomize<br/>false = don't randomize",
      "PostDate": "2013-12-15T17:49:01+00:00",
      "LastEditDate": null
    }
  ]
}

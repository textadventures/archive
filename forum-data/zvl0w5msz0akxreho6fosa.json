{
  "Topic": {
    "TopicId": "zvl0w5msz0akxreho6fosa",
    "ForumId": "18",
    "Title": "Adding Interval Functions to Your Game",
    "LastUpdated": "2018-05-09T17:10:53.8459327Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "53e09412-80b0-4418-8ab8-7fb94f267b17",
      "UserId": 318253,
      "Username": "K.V.",
      "AvatarUrl": "https://i.imgur.com/mBf7TBeb.png",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "# Setting up Quest Interval Functions (Version 2)\r\n\r\n## **Base Setup**\r\n\r\n### Add two functions\r\n\r\n---\r\nCreate a function, naming it \"CreateInterval\".\r\n\r\nGive it the parameters:  \"name\", \"function\", and \"duration\"\r\n\r\nPut this for the script in code view:\r\n```\r\nJS.eval (\"var \"+name+\" = setInterval(function(){ ASLEvent('\"+function+\"', '');}, \"+duration+\");\")\r\n```\r\n\r\nThat function will look like this in Full Code View:  \r\n\r\n<details>\r\n\r\n```\r\n  <function name=\"CreateInterval\" parameters=\"name, function, duration\">\r\n    JS.eval (\"var \"+name+\" = setInterval(function(){ ASLEvent('\"+function+\"', '');}, \"+duration+\");\")\r\n  </function>\r\n```\r\n\r\n</details>\r\n\r\n\r\n---\r\nCreate a second function, naming it \"ClearInterval\".\r\n\r\nGive it the parameter: \"name\"\r\n\r\nPut this for the script in code view:\r\n```\r\nJS.eval(\"clearInterval(\"+name+\");\")\r\n```\r\n\r\nThat function will look like this in Full Code View:  \r\n\r\n<details>\r\n\r\n```\r\n  <function name=\"ClearInterval\" params=\"name\">\r\n    JS.eval (\"clearInterval(\"+name+\");\")\r\n  </function>\r\n```\r\n\r\n</details>\r\n\r\n\r\n---\r\n## **Time to add your own stuff!**\r\n\r\n### Step 1\r\n\r\nCreate a function to be called by your interval.   (You can name the function whatever you like.)\r\n\r\n**IMPORTANT: Be sure your function has ONE SINGLE PARAMETER!  Otherwise, nothing will work!**\r\n\r\nI am creating a function called ```IntervalStuff```.  \r\n\r\nI am calling my SINGLE PARAMETER ```bs```, because that's what it is.\r\n\r\n**IMPORTANT:** I am setting ```game.suppressturnscripts``` to true, because calling a Quest function from Javascript would cause the turn script to fire an extra time otherwise.\r\n\r\nBeyond that, I can do whatever I want in my function.  (In this case, though, I'm simply printing a message.)\r\n\r\n```xml\r\n  <function name=\"IntervalStuff\" parameters=\"bs\">\r\n    game.suppressturnscripts = true\r\n    msg (\"You can print stuff or do anything else you'd like to do here.\")\r\n  </function>\r\n```\r\n\r\n---\r\n### Step 2\r\n\r\n#### Initiating the Interval\r\n\r\nTo make sure this works in saved games, we need to create our interval in User Interface Initialisation, which is run each time our game is loaded.\r\n\r\nSo, I make sure I check \"Show advanced features for the game object.\"  Then, I add this to the User Interface Initialisation script (under 'Advanced scripts' on the game object):\r\n\r\n```c\r\nCreateInterval (\"myInterval\", \"IntervalStuff\", 30000)\r\n```\r\n\r\nI am naming my interval \"myInterval\" \r\n\r\nI am telling it to call the function ```IntervalStuff```\r\n\r\nAnd it will run that function every 30,000 milliseconds, which is 30 seconds.\r\n\r\n---\r\n### Finally\r\n\r\nTo stop it from running:\r\n\r\n```c\r\nClearInterval(\"myInterval\")\r\n```\r\n\r\nNOTE:  My interval was named \"myInterval\".  You must use your interval's name here, and it is case-sensitive.\r\n\r\n\r\n---\r\n# Example game\r\n\r\n<details>\r\n\r\n```xml\r\n<!--Saved by Quest 5.8.6703.19818-->\r\n<asl version=\"550\">\r\n  <include ref=\"English.aslx\" />\r\n  <include ref=\"Core.aslx\" />\r\n  <game name=\"Message Every 30 Seconds\">\r\n    <gameid>078ba543-579c-4697-b798-b0187f53f914</gameid>\r\n    <version>2.0</version>\r\n    <firstpublished>2018</firstpublished>\r\n    <feature_advancedscripts />\r\n    <inituserinterface type=\"script\">\r\n      CreateInterval (\"myInterval\", \"IntervalStuff\", 30000)\r\n    </inituserinterface>\r\n  </game>\r\n  <object name=\"room\">\r\n    <inherit name=\"editor_room\" />\r\n    <object name=\"player\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"editor_player\" />\r\n    </object>\r\n  </object>\r\n  <function name=\"IntervalStuff\" parameters=\"param\">\r\n    game.suppressturnscripts = true\r\n    msg (\"You can print stuff or do anything else you'd like to do here.\")\r\n  </function>\r\n\r\n  <function name=\"CreateInterval\" parameters=\"name, function, duration\">\r\n    JS.eval (\"var \"+name+\" = setInterval(function(){ ASLEvent('\"+function+\"', '');}, \"+duration+\");\")\r\n  </function>\r\n  <function name=\"ClearInterval\" params=\"name\">\r\n    JS.eval (\"clearInterval(\"+name+\");\")\r\n  </function>\r\n</asl>\r\n```\r\n\r\n</details>\r\n\r\n\r\n---\r\n\r\nAn (always?) up-to-date version of this can be found here:\r\n\r\nhttps://github.com/KVonGit/QuestStuff/wiki/Adding-Interval-Functions\r\n\r\n\r\n---\r\n## References\r\n\r\n[Using Javascript](http://docs.textadventures.co.uk/quest/using_javascript.html)\r\n\r\n[UI Callback (ASLEvent)](http://docs.textadventures.co.uk/quest/ui-callback.html)\r\n\r\n[Javascript - using ```setInterval``` (w3schools)](https://www.w3schools.com/jsref/met_win_setinterval.asp)",
      "EditableFormat": "markdown",
      "HTML": "<h1>Setting up Quest Interval Functions (Version 2)</h1>\n<h2><strong>Base Setup</strong></h2>\n<h3>Add two functions</h3>\n<hr>\n<p>Create a function, naming it \"CreateInterval\".</p>\n<p>Give it the parameters:  \"name\", \"function\", and \"duration\"</p>\n<p>Put this for the script in code view:</p>\n<pre><code>JS.eval (\"var \"+name+\" = setInterval(function(){ ASLEvent('\"+function+\"', '');}, \"+duration+\");\")\n</code></pre>\n<p>That function will look like this in Full Code View:</p>\n<details>\n<pre><code>  &lt;function name=\"CreateInterval\" parameters=\"name, function, duration\"&gt;\n    JS.eval (\"var \"+name+\" = setInterval(function(){ ASLEvent('\"+function+\"', '');}, \"+duration+\");\")\n  &lt;/function&gt;\n</code></pre>\n</details>\n<hr>\n<p>Create a second function, naming it \"ClearInterval\".</p>\n<p>Give it the parameter: \"name\"</p>\n<p>Put this for the script in code view:</p>\n<pre><code>JS.eval(\"clearInterval(\"+name+\");\")\n</code></pre>\n<p>That function will look like this in Full Code View:</p>\n<details>\n<pre><code>  &lt;function name=\"ClearInterval\" params=\"name\"&gt;\n    JS.eval (\"clearInterval(\"+name+\");\")\n  &lt;/function&gt;\n</code></pre>\n</details>\n<hr>\n<h2><strong>Time to add your own stuff!</strong></h2>\n<h3>Step 1</h3>\n<p>Create a function to be called by your interval.   (You can name the function whatever you like.)</p>\n<p><strong>IMPORTANT: Be sure your function has ONE SINGLE PARAMETER!  Otherwise, nothing will work!</strong></p>\n<p>I am creating a function called <code>IntervalStuff</code>.</p>\n<p>I am calling my SINGLE PARAMETER <code>bs</code>, because that's what it is.</p>\n<p><strong>IMPORTANT:</strong> I am setting <code>game.suppressturnscripts</code> to true, because calling a Quest function from Javascript would cause the turn script to fire an extra time otherwise.</p>\n<p>Beyond that, I can do whatever I want in my function.  (In this case, though, I'm simply printing a message.)</p>\n<pre><code>  &lt;function name=\"IntervalStuff\" parameters=\"bs\"&gt;\n    game.suppressturnscripts = true\n    msg (\"You can print stuff or do anything else you'd like to do here.\")\n  &lt;/function&gt;\n</code></pre>\n<hr>\n<h3>Step 2</h3>\n<h4>Initiating the Interval</h4>\n<p>To make sure this works in saved games, we need to create our interval in User Interface Initialisation, which is run each time our game is loaded.</p>\n<p>So, I make sure I check \"Show advanced features for the game object.\"  Then, I add this to the User Interface Initialisation script (under 'Advanced scripts' on the game object):</p>\n<pre><code>CreateInterval (\"myInterval\", \"IntervalStuff\", 30000)\n</code></pre>\n<p>I am naming my interval \"myInterval\"</p>\n<p>I am telling it to call the function <code>IntervalStuff</code></p>\n<p>And it will run that function every 30,000 milliseconds, which is 30 seconds.</p>\n<hr>\n<h3>Finally</h3>\n<p>To stop it from running:</p>\n<pre><code>ClearInterval(\"myInterval\")\n</code></pre>\n<p>NOTE:  My interval was named \"myInterval\".  You must use your interval's name here, and it is case-sensitive.</p>\n<hr>\n<h1>Example game</h1>\n<details>\n<pre><code>&lt;!--Saved by Quest 5.8.6703.19818--&gt;\n&lt;asl version=\"550\"&gt;\n  &lt;include ref=\"English.aslx\" /&gt;\n  &lt;include ref=\"Core.aslx\" /&gt;\n  &lt;game name=\"Message Every 30 Seconds\"&gt;\n    &lt;gameid&gt;078ba543-579c-4697-b798-b0187f53f914&lt;/gameid&gt;\n    &lt;version&gt;2.0&lt;/version&gt;\n    &lt;firstpublished&gt;2018&lt;/firstpublished&gt;\n    &lt;feature_advancedscripts /&gt;\n    &lt;inituserinterface type=\"script\"&gt;\n      CreateInterval (\"myInterval\", \"IntervalStuff\", 30000)\n    &lt;/inituserinterface&gt;\n  &lt;/game&gt;\n  &lt;object name=\"room\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;object name=\"player\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"editor_player\" /&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n  &lt;function name=\"IntervalStuff\" parameters=\"param\"&gt;\n    game.suppressturnscripts = true\n    msg (\"You can print stuff or do anything else you'd like to do here.\")\n  &lt;/function&gt;\n\n  &lt;function name=\"CreateInterval\" parameters=\"name, function, duration\"&gt;\n    JS.eval (\"var \"+name+\" = setInterval(function(){ ASLEvent('\"+function+\"', '');}, \"+duration+\");\")\n  &lt;/function&gt;\n  &lt;function name=\"ClearInterval\" params=\"name\"&gt;\n    JS.eval (\"clearInterval(\"+name+\");\")\n  &lt;/function&gt;\n&lt;/asl&gt;\n</code></pre>\n</details>\n<hr>\n<p>An (always?) up-to-date version of this can be found here:</p>\n<p>https://github.com/KVonGit/QuestStuff/wiki/Adding-Interval-Functions</p>\n<hr>\n<h2>References</h2>\n<p><a href=\"http://docs.textadventures.co.uk/quest/using_javascript.html\">Using Javascript</a></p>\n<p><a href=\"http://docs.textadventures.co.uk/quest/ui-callback.html\">UI Callback (ASLEvent)</a></p>\n<p><a href=\"https://www.w3schools.com/jsref/met_win_setinterval.asp\">Javascript - using <code>setInterval</code> (w3schools)</a></p>\n\n",
      "PostDate": "2018-05-09T17:10:53.8459327Z",
      "LastEditDate": "2018-05-09T17:28:31.5148621Z",
      "link": null
    }
  ]
}

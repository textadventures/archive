{
  "Topic": {
    "TopicId": "wr5zhubaduo2xii_ggx48w",
    "ForumId": "10",
    "Title": "Script to remove HTML tags from String?",
    "LastUpdated": "2021-06-10T02:44:02.8628908Z",
    "ReplyCount": 0
  },
  "Posts": [
    {
      "PostId": "d11d6545-5bf1-4e10-a30e-fa0c7d9497ca",
      "UserId": 310554,
      "Username": "hydramystic",
      "AvatarUrl": "https://secure.gravatar.com/avatar/2a47565556f10359c78c7bdc037aa3d4?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Hi, I've been trying to create a pop-up menu using the show menu command but it seems like it can't process text.\r\n\r\nI have a List and the entries look like this:\r\n\r\n```<img src='\" + GetFileURL(\"example.png\") + \"' /> <font color='red'>Text Example</font>```\r\n\r\nIt works with Print or the ShowMenu function but not with the show menu command. \r\n\r\nI can't change the entries text itself  so I need a way to strip the HTML tags from it and then pass it to another list or maybe something else... any  ideas?",
      "EditableFormat": "markdown",
      "HTML": "<p>Hi, I've been trying to create a pop-up menu using the show menu command but it seems like it can't process text.</p>\n<p>I have a List and the entries look like this:</p>\n<p><code>&lt;img src='\" + GetFileURL(\"example.png\") + \"' /&gt; &lt;font color='red'&gt;Text Example&lt;/font&gt;</code></p>\n<p>It works with Print or the ShowMenu function but not with the show menu command.</p>\n<p>I can't change the entries text itself  so I need a way to strip the HTML tags from it and then pass it to another list or maybe something else... any  ideas?</p>\n\n",
      "PostDate": "2021-06-10T02:44:02.8628908Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "c73703ad-0b5e-4a99-bcce-a1d4039aa7ae",
      "UserId": 518866,
      "Username": "K.V.",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a97688aadc8152436180b511021e94a7?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Hello.\r\n\r\n> Hi, I've been trying to create a pop-up menu using the ```show menu``` [<s>command</s> script] but it seems like it can't process text.\r\n\r\nThat menu only displays a raw string; in other words, it doesn't translate the HTML code.\r\n\r\n> It works with ```Print``` or the ```ShowMenu``` function but not with the ```show menu```  [<s>command</s> script].\r\n\r\nThis is because both of these add your HTML code to the web page, where it is displayed as you would expect. (Meaning the HTML is translated when properly added to the web page.)\r\n\r\n> I can't change the entries text itself \r\n\r\nWhy not?\r\n\r\nWhere do these text entries come from?\r\n\r\n> so I need a way to strip the HTML tags from it and then pass it to another list or maybe something else... any ideas?\r\n\r\n**EDIT**\r\n\r\nThis function's code has been updated once since originally posted. I forgot to do subtract ```start``` from ```end``` and then add 1, because the third parameter in ```Mid``` is for the character count from the second parameter, not the actual position of the end character in the string.\r\n\r\n```\r\n  <function name=\"TagStripper\" parameters=\"str\" type=\"string\"><![CDATA[\r\n    str = Trim(str)\r\n    start = Instr (str, \"<\")\r\n    end = Instr (str, \">\")\r\n    tag = \"\"\r\n    if (start > 0 and end > 0) {\r\n      tag = Mid (str, start, end - start + 1)\r\n    }\r\n    str = Replace (str, tag, \"\")\r\n    start = Instr (str, \"<\")\r\n    end = Instr (str, \">\")\r\n    if (start > 0 and end > 0) {\r\n      str = TagStripper (str)\r\n    }\r\n    return (str)\r\n  ]]></function>\r\n```\r\n\r\n---\r\nMaking up stuff to try to emulate what I am guessing you might probably have going on in your code (without really knowing very much):\r\n\r\n```\r\n// You don't need this part.\r\ns = \"<img src='\" + GetFileURL(\"example.png\") + \"' /> <font color='red'>Text Example</font>\"\r\ns2 = \"<img src='\" + GetFileURL(\"example2.png\") + \"' /> <font color='green'>Text Example 2</font>\"\r\ns3 = \"<img src='\" + GetFileURL(\"example3.png\") + \"' /> <font color='blue'>Text Example 3</font>\"\r\nstrings = NewStringList()\r\nlist add (strings, s)\r\nlist add (strings, s2)\r\nlist add (strings, s3)\r\n// Now the fake environment has been created.\r\n```\r\n\r\n```\r\n// The rest of the code is all that should be required (replacing \"strings\" in the foreach with the real list).\r\nchoices = NewStringList()\r\nforeach (str, strings) {\r\n  list add (choices, TagStripper(str))\r\n}\r\nshow menu (\"Whatever question?\", choices, false) {\r\n  msg (result)\r\n}\r\n```\r\n\r\n---\r\n![image](https://user-images.githubusercontent.com/30656341/121544328-3f290c00-c9cf-11eb-8cc7-bb6bf763d084.png)",
      "EditableFormat": "markdown",
      "HTML": "<p>Hello.</p>\n<blockquote>\n<p>Hi, I've been trying to create a pop-up menu using the <code>show menu</code> [<s>command</s> script] but it seems like it can't process text.</p>\n</blockquote>\n<p>That menu only displays a raw string; in other words, it doesn't translate the HTML code.</p>\n<blockquote>\n<p>It works with <code>Print</code> or the <code>ShowMenu</code> function but not with the <code>show menu</code>  [<s>command</s> script].</p>\n</blockquote>\n<p>This is because both of these add your HTML code to the web page, where it is displayed as you would expect. (Meaning the HTML is translated when properly added to the web page.)</p>\n<blockquote>\n<p>I can't change the entries text itself</p>\n</blockquote>\n<p>Why not?</p>\n<p>Where do these text entries come from?</p>\n<blockquote>\n<p>so I need a way to strip the HTML tags from it and then pass it to another list or maybe something else... any ideas?</p>\n</blockquote>\n<p><strong>EDIT</strong></p>\n<p>This function's code has been updated once since originally posted. I forgot to do subtract <code>start</code> from <code>end</code> and then add 1, because the third parameter in <code>Mid</code> is for the character count from the second parameter, not the actual position of the end character in the string.</p>\n<pre><code>  &lt;function name=\"TagStripper\" parameters=\"str\" type=\"string\"&gt;&lt;![CDATA[\n    str = Trim(str)\n    start = Instr (str, \"&lt;\")\n    end = Instr (str, \"&gt;\")\n    tag = \"\"\n    if (start &gt; 0 and end &gt; 0) {\n      tag = Mid (str, start, end - start + 1)\n    }\n    str = Replace (str, tag, \"\")\n    start = Instr (str, \"&lt;\")\n    end = Instr (str, \"&gt;\")\n    if (start &gt; 0 and end &gt; 0) {\n      str = TagStripper (str)\n    }\n    return (str)\n  ]]&gt;&lt;/function&gt;\n</code></pre>\n<hr>\n<p>Making up stuff to try to emulate what I am guessing you might probably have going on in your code (without really knowing very much):</p>\n<pre><code>// You don't need this part.\ns = \"&lt;img src='\" + GetFileURL(\"example.png\") + \"' /&gt; &lt;font color='red'&gt;Text Example&lt;/font&gt;\"\ns2 = \"&lt;img src='\" + GetFileURL(\"example2.png\") + \"' /&gt; &lt;font color='green'&gt;Text Example 2&lt;/font&gt;\"\ns3 = \"&lt;img src='\" + GetFileURL(\"example3.png\") + \"' /&gt; &lt;font color='blue'&gt;Text Example 3&lt;/font&gt;\"\nstrings = NewStringList()\nlist add (strings, s)\nlist add (strings, s2)\nlist add (strings, s3)\n// Now the fake environment has been created.\n</code></pre>\n<pre><code>// The rest of the code is all that should be required (replacing \"strings\" in the foreach with the real list).\nchoices = NewStringList()\nforeach (str, strings) {\n  list add (choices, TagStripper(str))\n}\nshow menu (\"Whatever question?\", choices, false) {\n  msg (result)\n}\n</code></pre>\n<hr>\n<p><img src=\"https://user-images.githubusercontent.com/30656341/121544328-3f290c00-c9cf-11eb-8cc7-bb6bf763d084.png\" alt=\"image\"></p>\n\n",
      "PostDate": "2021-06-10T14:33:57.6484311Z",
      "LastEditDate": "2021-06-10T15:49:50.3886173Z",
      "link": null
    },
    {
      "PostId": "033ba583-dee2-44e4-ad98-c6f00ebb8c10",
      "UserId": 518866,
      "Username": "K.V.",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a97688aadc8152436180b511021e94a7?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "PS\r\n\r\nUse my code at your own risk!\r\n\r\nBest case scenario: everything will work.\r\n\r\nWorst case scenario: your computer will spontaneously combust!\r\n\r\n---\r\n**EDIT**\r\n\r\nThis is the test game I created to test things:\r\n\r\n<details>\r\n\r\n```\r\n<!--Saved by Quest 5.8.7753.35184-->\r\n<asl version=\"580\">\r\n  <include ref=\"English.aslx\" />\r\n  <include ref=\"Core.aslx\" />\r\n  <game name=\"In-room Description Example\">\r\n    <gameid>232ffbf9-b40a-44b3-88c5-5f8bed042232</gameid>\r\n    <version>1.2</version>\r\n    <firstpublished>2021</firstpublished>\r\n    <appendobjectdescription />\r\n  </game>\r\n  <object name=\"room\">\r\n    <inherit name=\"editor_room\" />\r\n    <isroom />\r\n    <enter type=\"script\"><![CDATA[\r\n      // You don't need this part.\r\n      s = \"<img src='\" + GetFileURL(\"example.png\") + \"' /> <font color='red'>Text Example</font>\"\r\n      s2 = \"<img src='\" + GetFileURL(\"example2.png\") + \"' /> <font color='green'>Text Example 2</font>\"\r\n      s3 = \"<img src='\" + GetFileURL(\"example3.png\") + \"' /> <font color='blue'>Text Example 3</font>\"\r\n      strings = NewStringList()\r\n      list add (strings, s)\r\n      list add (strings, s2)\r\n      list add (strings, s3)\r\n      // Now the fake environment has been created.\r\n      // The rest of the code is all that should be required (replacing \"strings\" in the foreach with the real list).\r\n      choices = NewStringList()\r\n      foreach (str, strings) {\r\n        list add (choices, TagStripper(str))\r\n      }\r\n      show menu (\"Whatever question?\", choices, false) {\r\n        msg (result)\r\n      }\r\n    ]]></enter>\r\n    <description type=\"string\"></description>\r\n    <object name=\"player\">\r\n      <inherit name=\"editor_object\" />\r\n      <inherit name=\"editor_player\" />\r\n    </object>\r\n    <object name=\"frob\">\r\n      <inherit name=\"editor_object\" />\r\n      <inroomdescription><![CDATA[{if frob.scenery: <br/>WOW! There is a {object:frob} here!}]]></inroomdescription>\r\n      <scenery />\r\n      <take />\r\n    </object>\r\n  </object>\r\n  <function name=\"TagStripper\" parameters=\"str\" type=\"string\"><![CDATA[\r\n    str = Trim(str)\r\n    start = Instr (str, \"<\")\r\n    end = Instr (str, \">\")\r\n    tag = \"\"\r\n    if (start > 0 and end > 0) {\r\n      tag = Mid (str, start, end - start + 1)\r\n    }\r\n    str = Replace (str, tag, \"\")\r\n    start = Instr (str, \"<\")\r\n    end = Instr (str, \">\")\r\n    if (start > 0 and end > 0) {\r\n      str = TagStripper (str)\r\n    }\r\n    return (str)\r\n  ]]></function>\r\n</asl>\r\n```\r\n\r\n</details>",
      "EditableFormat": "markdown",
      "HTML": "<p>PS</p>\n<p>Use my code at your own risk!</p>\n<p>Best case scenario: everything will work.</p>\n<p>Worst case scenario: your computer will spontaneously combust!</p>\n<hr>\n<p><strong>EDIT</strong></p>\n<p>This is the test game I created to test things:</p>\n<details>\n<pre><code>&lt;!--Saved by Quest 5.8.7753.35184--&gt;\n&lt;asl version=\"580\"&gt;\n  &lt;include ref=\"English.aslx\" /&gt;\n  &lt;include ref=\"Core.aslx\" /&gt;\n  &lt;game name=\"In-room Description Example\"&gt;\n    &lt;gameid&gt;232ffbf9-b40a-44b3-88c5-5f8bed042232&lt;/gameid&gt;\n    &lt;version&gt;1.2&lt;/version&gt;\n    &lt;firstpublished&gt;2021&lt;/firstpublished&gt;\n    &lt;appendobjectdescription /&gt;\n  &lt;/game&gt;\n  &lt;object name=\"room\"&gt;\n    &lt;inherit name=\"editor_room\" /&gt;\n    &lt;isroom /&gt;\n    &lt;enter type=\"script\"&gt;&lt;![CDATA[\n      // You don't need this part.\n      s = \"&lt;img src='\" + GetFileURL(\"example.png\") + \"' /&gt; &lt;font color='red'&gt;Text Example&lt;/font&gt;\"\n      s2 = \"&lt;img src='\" + GetFileURL(\"example2.png\") + \"' /&gt; &lt;font color='green'&gt;Text Example 2&lt;/font&gt;\"\n      s3 = \"&lt;img src='\" + GetFileURL(\"example3.png\") + \"' /&gt; &lt;font color='blue'&gt;Text Example 3&lt;/font&gt;\"\n      strings = NewStringList()\n      list add (strings, s)\n      list add (strings, s2)\n      list add (strings, s3)\n      // Now the fake environment has been created.\n      // The rest of the code is all that should be required (replacing \"strings\" in the foreach with the real list).\n      choices = NewStringList()\n      foreach (str, strings) {\n        list add (choices, TagStripper(str))\n      }\n      show menu (\"Whatever question?\", choices, false) {\n        msg (result)\n      }\n    ]]&gt;&lt;/enter&gt;\n    &lt;description type=\"string\"&gt;&lt;/description&gt;\n    &lt;object name=\"player\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inherit name=\"editor_player\" /&gt;\n    &lt;/object&gt;\n    &lt;object name=\"frob\"&gt;\n      &lt;inherit name=\"editor_object\" /&gt;\n      &lt;inroomdescription&gt;&lt;![CDATA[{if frob.scenery: &lt;br/&gt;WOW! There is a {object:frob} here!}]]&gt;&lt;/inroomdescription&gt;\n      &lt;scenery /&gt;\n      &lt;take /&gt;\n    &lt;/object&gt;\n  &lt;/object&gt;\n  &lt;function name=\"TagStripper\" parameters=\"str\" type=\"string\"&gt;&lt;![CDATA[\n    str = Trim(str)\n    start = Instr (str, \"&lt;\")\n    end = Instr (str, \"&gt;\")\n    tag = \"\"\n    if (start &gt; 0 and end &gt; 0) {\n      tag = Mid (str, start, end - start + 1)\n    }\n    str = Replace (str, tag, \"\")\n    start = Instr (str, \"&lt;\")\n    end = Instr (str, \"&gt;\")\n    if (start &gt; 0 and end &gt; 0) {\n      str = TagStripper (str)\n    }\n    return (str)\n  ]]&gt;&lt;/function&gt;\n&lt;/asl&gt;\n</code></pre>\n</details>\n\n",
      "PostDate": "2021-06-10T14:41:01.0870379Z",
      "LastEditDate": "2021-06-10T16:06:01.52777Z",
      "link": null
    },
    {
      "PostId": "c2ea172b-8960-406f-bfbc-250f548aadd1",
      "UserId": 518866,
      "Username": "K.V.",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a97688aadc8152436180b511021e94a7?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Oh, and I forgot to post this bit:\r\n\r\n---\r\nTrim\r\nhttps://docs.textadventures.co.uk/quest/functions/string/trim.html\r\n\r\n---\r\nInstr\r\nhttps://docs.textadventures.co.uk/quest/functions/string/instr.html\r\n\r\n---\r\nMid\r\nhttps://docs.textadventures.co.uk/quest/functions/string/mid.html\r\n\r\n---\r\nReplace\r\nhttps://docs.textadventures.co.uk/quest/functions/string/replace.html\r\n\r\n---\r\nNewStringList\r\nhttps://docs.textadventures.co.uk/quest/functions/newstringlist.html\r\n\r\n---\r\nforeach\r\nhttps://docs.textadventures.co.uk/quest/scripts/foreach.html\r\n\r\n---\r\nlist add\r\nhttps://docs.textadventures.co.uk/quest/scripts/list_add.html\r\n\r\n---\r\nshow menu\r\nhttps://docs.textadventures.co.uk/quest/scripts/show_menu.html",
      "EditableFormat": "markdown",
      "HTML": "<p>Oh, and I forgot to post this bit:</p>\n<hr>\n<p>Trim<br>\nhttps://docs.textadventures.co.uk/quest/functions/string/trim.html</p>\n<hr>\n<p>Instr<br>\nhttps://docs.textadventures.co.uk/quest/functions/string/instr.html</p>\n<hr>\n<p>Mid<br>\nhttps://docs.textadventures.co.uk/quest/functions/string/mid.html</p>\n<hr>\n<p>Replace<br>\nhttps://docs.textadventures.co.uk/quest/functions/string/replace.html</p>\n<hr>\n<p>NewStringList<br>\nhttps://docs.textadventures.co.uk/quest/functions/newstringlist.html</p>\n<hr>\n<p>foreach<br>\nhttps://docs.textadventures.co.uk/quest/scripts/foreach.html</p>\n<hr>\n<p>list add<br>\nhttps://docs.textadventures.co.uk/quest/scripts/list_add.html</p>\n<hr>\n<p>show menu<br>\nhttps://docs.textadventures.co.uk/quest/scripts/show_menu.html</p>\n\n",
      "PostDate": "2021-06-10T14:47:52.8607853Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "1d682a3e-9099-4c80-9081-0649ca238248",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "EDIT: Fixed a silly error in the code snippet\r\n\r\n> Use my code at your own risk!\r\n\r\nYou put `Mid (str, start, end)` instead of <code style=\"color:green\">Mid (str, start, 1+end-start)</code>. The 3rd parameter to `Mid` is the length of the string to extract, not the end position.\r\n\r\nHowever, it would be more efficient to replace:\r\n<pre><code style=\"color: brown\">    tag = \"\"\r\n    if (start > 0 and end > 0) {\r\n      tag = Mid (str, start, end)\r\n    }\r\n    str = Replace (str, tag, \"\")</code></pre>\r\nwith:\r\n```\r\n    str = Left (str, start-1) + Mid (str, end+1)\r\n```\r\nsticking the bit before the `<` and the bit after the `>` together, rather than finding the whole tag and then doing another bunch of string comparisons to remove it.\r\n\r\nYou probably also want to check for the case where there is a `>` before the `<`; which in your script would remove part of the tag, and with my modified code would duplicate the area in between them.\r\n\r\nA more efficient version of this would be:\r\n```\r\n  <function name=\"TagStripper\" parameters=\"str\" type=\"string\"><![CDATA[\r\n    str = Trim(str)\r\n    while (true) {\r\n      start = Instr (str, \"<\") - 1\r\n      end = Instr (start + 1, str, \">\") + 1\r\n      if (start = -1 or end = 1) {\r\n        return (str)\r\n      }\r\n      str = RTrim (Left (str, start)) + \" \" + LTrim (Mid (str, end))\r\n    }\r\n  ]]></function>\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p>EDIT: Fixed a silly error in the code snippet</p>\n<blockquote>\n<p>Use my code at your own risk!</p>\n</blockquote>\n<p>You put <code>Mid (str, start, end)</code> instead of <code style=\"color: green\">Mid (str, start, 1+end-start)</code>. The 3rd parameter to <code>Mid</code> is the length of the string to extract, not the end position.</p>\n<p>However, it would be more efficient to replace:</p>\n<pre><code style=\"color: brown\">    tag = \"\"\n    if (start &gt; 0 and end &gt; 0) {\n      tag = Mid (str, start, end)\n    }\n    str = Replace (str, tag, \"\")</code></pre>\n<p>with:</p>\n<pre><code>    str = Left (str, start-1) + Mid (str, end+1)\n</code></pre>\n<p>sticking the bit before the <code>&lt;</code> and the bit after the <code>&gt;</code> together, rather than finding the whole tag and then doing another bunch of string comparisons to remove it.</p>\n<p>You probably also want to check for the case where there is a <code>&gt;</code> before the <code>&lt;</code>; which in your script would remove part of the tag, and with my modified code would duplicate the area in between them.</p>\n<p>A more efficient version of this would be:</p>\n<pre><code>  &lt;function name=\"TagStripper\" parameters=\"str\" type=\"string\"&gt;&lt;![CDATA[\n    str = Trim(str)\n    while (true) {\n      start = Instr (str, \"&lt;\") - 1\n      end = Instr (start + 1, str, \"&gt;\") + 1\n      if (start = -1 or end = 1) {\n        return (str)\n      }\n      str = RTrim (Left (str, start)) + \" \" + LTrim (Mid (str, end))\n    }\n  ]]&gt;&lt;/function&gt;\n</code></pre>\n\n",
      "PostDate": "2021-06-10T15:27:05.4319Z",
      "LastEditDate": "2021-06-10T16:16:38.6365992Z",
      "link": null
    },
    {
      "PostId": "4ac2e907-4e3f-4219-b59b-69c4f8973018",
      "UserId": 518866,
      "Username": "K.V.",
      "AvatarUrl": "https://secure.gravatar.com/avatar/a97688aadc8152436180b511021e94a7?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "I had too many tabs open, each with a different forum thread, and I failed to refresh this one before updating my function, which I found had problems after a little more testing.  :)\r\n\r\nNow, I see that I could have saved myself 10 minutes of troubleshooting had I refreshed this page first and seen mrangel's post. (hehehe)\r\n\r\n---\r\n@mrangel\r\n\r\nI tried your version of ```TagStripper```, and I get:\r\n\r\n```\r\nError running script: Error compiling expression 'Instr (str, \">\", start + 1) + 1': FunctionCallElement: Could find not function 'Instr(String, String, Int32)'\r\nError running script: Error compiling expression 'Instr (str, \">\", start + 1) + 1': FunctionCallElement: Could find not function 'Instr(String, String, Int32)'\r\nError running script: Error compiling expression 'Instr (str, \">\", start + 1) + 1': FunctionCallElement: Could find not function 'Instr(String, String, Int32)'\r\nError running script: Value cannot be null.Parameter name: key\r\n```\r\n\r\n---\r\nI agree with every point made about my code. Even after fixing the issue with the third parameter in ```Mid```, my code is still inefficient and only really tested with the strings I posted in the examples.\r\n\r\nSo, I want to use mrangel's, but I can't figure out what's throwing the error.",
      "EditableFormat": "markdown",
      "HTML": "<p>I had too many tabs open, each with a different forum thread, and I failed to refresh this one before updating my function, which I found had problems after a little more testing.  :)</p>\n<p>Now, I see that I could have saved myself 10 minutes of troubleshooting had I refreshed this page first and seen mrangel's post. (hehehe)</p>\n<hr>\n<p>@mrangel</p>\n<p>I tried your version of <code>TagStripper</code>, and I get:</p>\n<pre><code>Error running script: Error compiling expression 'Instr (str, \"&gt;\", start + 1) + 1': FunctionCallElement: Could find not function 'Instr(String, String, Int32)'\nError running script: Error compiling expression 'Instr (str, \"&gt;\", start + 1) + 1': FunctionCallElement: Could find not function 'Instr(String, String, Int32)'\nError running script: Error compiling expression 'Instr (str, \"&gt;\", start + 1) + 1': FunctionCallElement: Could find not function 'Instr(String, String, Int32)'\nError running script: Value cannot be null.Parameter name: key\n</code></pre>\n<hr>\n<p>I agree with every point made about my code. Even after fixing the issue with the third parameter in <code>Mid</code>, my code is still inefficient and only really tested with the strings I posted in the examples.</p>\n<p>So, I want to use mrangel's, but I can't figure out what's throwing the error.</p>\n\n",
      "PostDate": "2021-06-10T15:58:31.8926525Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "3d5324c1-883e-4084-bf36-f3e648d0fad0",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Sorry, I was expecting it to be the same as in other languages. Usually if you have one optional parameter to a function it goes at the end, but it seems Quest's `Instr` puts it at the beginning.\r\n\r\nFixed :)",
      "EditableFormat": "markdown",
      "HTML": "<p>Sorry, I was expecting it to be the same as in other languages. Usually if you have one optional parameter to a function it goes at the end, but it seems Quest's <code>Instr</code> puts it at the beginning.</p>\n<p>Fixed :)</p>\n\n",
      "PostDate": "2021-06-10T16:10:58.2994817Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "8ab7f8fb-34a9-45b0-af08-6f22ff1990ac",
      "UserId": 310554,
      "Username": "hydramystic",
      "AvatarUrl": "https://secure.gravatar.com/avatar/2a47565556f10359c78c7bdc037aa3d4?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Thanks a lot for the responses, this is exactly what I needed. \r\nSorry for not explaining properly, I couldn't find an easy way to do it with my poor English skills haha\r\n\r\nI'm still getting an error with mrangel's version tho\r\n\r\n```\r\nError running script: Error evaluating expression 'Instr (start + 1, str, \">\") + 1': The argument 'Start' must be greater than zero.\r\nError running script: Error evaluating expression 'Instr (start + 1, str, \">\") + 1': The argument 'Start' must be greater than zero.\r\nError running script: Error evaluating expression 'Instr (start + 1, str, \">\") + 1': The argument 'Start' must be greater than zero.\r\nError running script: Value cannot be null. Parameter name: key \r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p>Thanks a lot for the responses, this is exactly what I needed.<br>\nSorry for not explaining properly, I couldn't find an easy way to do it with my poor English skills haha</p>\n<p>I'm still getting an error with mrangel's version tho</p>\n<pre><code>Error running script: Error evaluating expression 'Instr (start + 1, str, \"&gt;\") + 1': The argument 'Start' must be greater than zero.\nError running script: Error evaluating expression 'Instr (start + 1, str, \"&gt;\") + 1': The argument 'Start' must be greater than zero.\nError running script: Error evaluating expression 'Instr (start + 1, str, \"&gt;\") + 1': The argument 'Start' must be greater than zero.\nError running script: Value cannot be null. Parameter name: key \n</code></pre>\n\n",
      "PostDate": "2021-06-10T20:07:37.1417774Z",
      "LastEditDate": null,
      "link": null
    },
    {
      "PostId": "0eb9296a-91f4-40cd-ae75-672a3d767a57",
      "UserId": 319917,
      "Username": "mrangel",
      "AvatarUrl": "https://secure.gravatar.com/avatar/?d=retro",
      "UserAvatar": null,
      "UserGravatar": null,
      "EditableText": "Sorry, my  fault for answering on my phone without checking.\r\n\r\n```\r\n  <function name=\"TagStripper\" parameters=\"str\" type=\"string\"><![CDATA[\r\n    str = Trim(str)\r\n    while (true) {\r\n      start = Instr (str, \"<\") - 1\r\n      if (start < 0) {\r\n        return (str)\r\n      }\r\n      end = Instr (start + 1, str, \">\") + 1\r\n      if (end = 1) {\r\n        return (str)\r\n      }\r\n      str = RTrim (Left (str, start)) + \" \" + LTrim (Mid (str, end))\r\n    }\r\n  ]]></function>\r\n```",
      "EditableFormat": "markdown",
      "HTML": "<p>Sorry, my  fault for answering on my phone without checking.</p>\n<pre><code>  &lt;function name=\"TagStripper\" parameters=\"str\" type=\"string\"&gt;&lt;![CDATA[\n    str = Trim(str)\n    while (true) {\n      start = Instr (str, \"&lt;\") - 1\n      if (start &lt; 0) {\n        return (str)\n      }\n      end = Instr (start + 1, str, \"&gt;\") + 1\n      if (end = 1) {\n        return (str)\n      }\n      str = RTrim (Left (str, start)) + \" \" + LTrim (Mid (str, end))\n    }\n  ]]&gt;&lt;/function&gt;\n</code></pre>\n\n",
      "PostDate": "2021-06-10T21:24:05.8240249Z",
      "LastEditDate": null,
      "link": null
    }
  ]
}
